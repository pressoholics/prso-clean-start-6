;var MultilingualPress=window.MultilingualPress||{};var MultilingualPressRedirectorSettings=window.MultilingualPressRedirectorSettings||{};MultilingualPress.RedirectorSettings=MultilingualPressRedirectorSettings;delete window.MultilingualPressRedirectorSettings;languageManager=window.languageManager||{};(function(t,e,n,i){'use strict';e.LanguageManager=function(){var r,n,e,a=/\[(\d+)\]/i,o=/-(\d+)-/i,s=/\[-(\d+)\]/i,u=function(){var e=t('<p class="mlp-new-language"><button class="button">'+i.newLanguageButtonLabel+'</button></p>');e.insertAfter(n);return e},l=function(){var a=t('<td data-label="Deletor"><button class="mlp-language-deletor button dashicons dashicons-trash" data-action="delete"><span class="screen-reader-text">'+i.languageDeleteButtonLabel+'</span></button></td>'),e=t('<th scope="col" data-label="Deletor">'+i.languageDeleteTableHeadLabel+'</th>');n.find('thead > tr th:last-of-type').after(e.clone());n.find('tfoot > tr th:last-of-type').after(e.clone());n.find('tbody > tr td:last-of-type').after(a);return t('.mlp-language-deletor')},c=function(){var n=e.clone();n.hide().insertAfter(e);e=n;e.find('input').each(function(e,n){t(n).val('');t(n).removeAttr('checked')})},d=function(){e&&e.hide()},f=function(){e&&e.show()},p=function(){var n=-1,i=e.find('input');if(!i){return n};var t=(new RegExp(a)).exec(i[0].getAttribute('name'));return Array.isArray(t)?++t[1]:n},h=function(t,e){t.each(function(t,n){var i=n.getAttribute('name'),r=n.getAttribute('id');n.setAttribute('name',i.replace(a,'['+e+']'));n.setAttribute('id',r.replace(o,'-'+e+'-'))})},g=function(t,e){t.each(function(t,n){var i=n.getAttribute('name');n.setAttribute('name',i.replace(e?s:a,e?'[$1]':'[-$1]'))})},m=function(){f();var t=p();if(-1===t){return};c();h(e.find('input'),t)},v=function(e){if(!e){return};var a=e.parents('tr');if(!a){return};var n=e.attr('data-action')==='undo',o=n?function(e,n){t(n).removeAttr('readonly').css('opacity',1)}:function(e,n){t(n).attr('readonly','readonly').css('opacity',.2)},s=n?i.languageDeleteButtonLabel:i.languageUndoDeleteButtonLabel,r=a.find('input');r.each(o);e.attr('data-action',n?'delete':'undo').find('span').text(s);a.find('button').toggleClass('dashicons-undo dashicons-trash');g(r,n)},b=function(){window.addEventListener('load',function(){n.find('.ui-autocomplete-input').on('autocompleteselect',function(e,n){var i='item' in n&&n.item,a='language' in i&&i.language,r=t(this);if(!a){return};setTimeout(function(){y(r.parents('tr'),a)},0)})})},y=function(t,e){t.find('.native-name').val(e.nativeName);t.find('.english-name').val(e.englishName);t.find('.iso-639-1').val(e.iso639Code1);t.find('.iso-639-2').val(e.iso639Code2);t.find('.iso-639-3').val(e.iso639Code3);t.find('.iso-639-3').val(e.iso639Code3);t.find('.locale').val(e.locale);t.find('.http-code').val(e.httpCode);e.isRtl?t.find('.is-rtl').attr('checked','checked'):t.find('.is-rtl').removeAttr('checked')};this.init=function(){if(r){return this};n=t('#mlp-language-manager-table');if(!n){return this};e=n.find('tbody tr:last-of-type');d(e);var a=l();a.live('click',function(e){e.preventDefault();e.stopPropagation();v(t(this))});var i=u(n);i.click(function(t){t.preventDefault();t.stopPropagation();m()});b();r=!0;return this}}}(jQuery,MultilingualPress,ajaxurl,languageManager));(function(t,e,n){'use strict';e.LanguageSearch=function(e){var u=!1,o,a,r,i,l,s={};var c=function(i,a){t.ajax({url:n,method:'POST',dataType:'json',data:{action:e.data('action'),search:i}}).done(function(e){if(e.success&&e.data&&t.isArray(e.data)){s[i]=e.data;return a(e.data)};return[]}).fail(function(){return a([])})};this.init=function(){if(!u){o=e.closest('td');a=t(e.data('connected'));r=o.find('.current-selection');i=o.find('.remove-selection');l=e.data('none');e.autocomplete({minLength:2,select:function(e,n){r&&r.text(n.item.label);a&&a.val(n.item.value);i&&i.show();t(this).val('');return!1},source:function(t,e){if(t.term in s){e(s[t.term]);return};c(t.term,e)}});i.click(function(t){t.preventDefault();r.text(l);a.val('');e.val('');i.hide()});u=!0};return this}}}(jQuery,MultilingualPress,ajaxurl));(function(t,e,n){'use strict';e.NavMenu=function(e,i,a){var u=!1,r,l,c,d=function(t){c.css('visibility',t?'visible':'hidden')},f=function(){var e=[];r.filter(':checked').each(function(){e.push(Number(t(this).val()||0))});return e},o=function(){e.prop('disabled',!(i.length&&f().length))},s=function(){alert('AJAX error.')},p=function(t){if(!t.length){s();return};i.append(t)},h=function(t){var i=e.data('nonce-action'),r=e.data('nonce'),o=e.data('action'),n={action:o,mlp_sites:t,menu:a.val(),};n[i]=r;return n},g=function(i){d(!0);e.prop('disabled',!0);r.prop('disabled',!0);t.ajax({url:n,method:'POST',dataType:'json',data:h(i)}).done(function(e){if(e.success&&e.data&&typeof e.data==='string'){p(t(e.data));return};s()}).fail(function(){s()}).always(function(){d(!1);r.prop('checked',!1);r.prop('disabled',!1);e.prop('disabled',!0)})};this.init=function(){if(!u){r=t(e.data('languages'));l=t(e.data('select-all'));c=e.siblings('.spinner');r.click(function(){o()});l.click(function(t){t.preventDefault();r.prop('checked',!0);o()});e.click(function(){var t=f();if(t&&i.length){g(t)}});o();u=!0};return this}}}(jQuery,MultilingualPress,ajaxurl));(function(t,e){'use strict';e.NewSiteLanguage=function(e,n){var i=!1,a=function(t){var e=n.find('option[data-locale="'+t+'"]');if(e.length){return e.attr('value')};return null},r=function(t){var e=n.find('option[data-iso="'+t+'"]');if(e.length){return e.attr('value')};return null},o=function(t){var e=t.split('_'),i;while(e.length){e.pop();i=n.find('option[data-locale="'+e.join('_')+'"]');if(i.length){return i.attr('value')}};return null},s=function(){var e=t(this).val(),i,s,u;i=a(e);if(i){n.val(i);return};s=r(e);if(s){n.val(s);return};u=o(e);if(u){n.val(u)}};this.init=function(){if(!i){e.change(s);i=!0};return this}}}(jQuery,MultilingualPress));(function(t,e){'use strict';e.PostTranslationContext=function(t){var n=!1,e={};this.init=function(){if(!n){e.source_site_id=t.data('source-site');e.source_post_id=t.data('source-post');e.remote_site_id=t.data('remote-site');e.remote_post_id=t.data('remote-post');e.post_type=t.data('post-type');n=!0};return this};this.sourceSiteId=function(){return Number(e.source_site_id||0)};this.sourcePostId=function(){return Number(e.source_post_id||0)};this.remoteSiteId=function(){return Number(e.remote_site_id||0)};this.remotePostId=function(){return Number(e.remote_post_id||0)};this.postType=function(){return String(e.post_type||'')}}}(jQuery,MultilingualPress));(function(t,e){'use strict';e.PostTranslationTaxonomies=function(e,n){var i=!1;this.init=function(){if(!i){i=!0;if(n.length){e.change(function(){n.toggle(!t(this).is(':checked'))})}};return this}}}(jQuery,MultilingualPress));(function(t,e){'use strict';e.SitesRelationshipBulkSelection=function(){var e=!1,n=function(e){e.preventDefault();e.stopImmediatePropagation();var n=t('.mlp-relationships-languages');if(!n.length){return};n.find('input[type="checkbox"]').each(function(n,i){i.checked=(t(e.currentTarget).data('action')==='select')})};this.init=function(){if(!e){t('.mlp-site-bulk-relations').on('click',n);e=!0};return this}}}(jQuery,MultilingualPress));(function(t,e){'use strict';e.TermTranslationContext=function(t){var n=!1,e={};this.init=function(){if(!n){e.source_site_id=t.data('source-site');e.source_term_id=t.data('source-term');e.remote_site_id=t.data('remote-site');e.remote_term_id=t.data('remote-term');e.taxonomy=t.data('taxonomy');n=!0};return this};this.sourceSiteId=function(){return Number(e.source_site_id||0)};this.sourceTermId=function(){return Number(e.source_term_id||0)};this.remoteSiteId=function(){return Number(e.remote_site_id||0)};this.remoteTermId=function(){return Number(e.remote_term_id||0)};this.taxonomy=function(){return String(e.taxonomy||'')}}}(jQuery,MultilingualPress));(function(t,e){'use strict';e.TranslationBoxFactory={createContext:function(t,n){if(t==='term'){return new e.TermTranslationContext(n)};return new e.PostTranslationContext(n)},create:function(t,n){var i=n.find('.tab-relation'),l=i.find('.search-input-row'),o=i.find('.update-relationship'),c=i.find('.main-row input'),a=e.TranslationBoxFactory.createContext(t,n),s=new e.TraslationBoxTabs(n),r=new e.TranslationSearch(t,a,l,o),d=new e.TranslationRelationshipUpdater(t,r,a,n),f=new e.TranslationRelationship(d,s,r,c,o),u;a.init();s.init();r.init();f.init();if(t==='post'){u=new e.PostTranslationTaxonomies(n.find('.mlp-taxonomy-sync input'),n.find('.mlp-taxonomy-box'));u.init()}}}}(jQuery,MultilingualPress));(function(t,e){'use strict';e.TranslationRelationship=function(e,n,i,a,r){var l=!1,o,s,c=function(){var t;if(!o){t=n.findInPanel('relation','input, select, textarea');o=n.findInAllPanels('input, select, textarea').not(t)};return o},d=function(){return a.filter(':checked').val()},u=function(t){var e=t||d();i.hideResults();if(e==='new'||e==='leave'){c().attr('disabled',!1);n.enable();r.hide().attr('disabled',!0);i.showField(!1);return};if(e==='nothing'){r.hide().attr('disabled',!0)};i.showField(e==='existing');n.activate('relation');n.disable();c().attr('disabled',!0);if(e==='existing'||e==='remove'){r.attr('disabled',e==='existing').show()}},f=function(e){if(!s){s=t('<span class="spinner" style="float: none; margin: 0 10px 5px;"></span>').appendTo(r.parent())};s.css('visibility',e?'visible':'hidden')},p=function(){a.attr('disabled',!0);r.attr('disabled',!0);i.hideResults();i.showField(!1);f(!0)},h=function(){u();a.attr('disabled',!1);f(!1)};this.init=function(){if(!l){a.on('change',function(){u(t(this).val())});r.on('click',function(t){t.preventDefault();e.updateRelation(d(),p,h)});u();l=!0};return this}}}(jQuery,MultilingualPress));(function(t,e,n){'use strict';e.TranslationRelationshipUpdater=function(i,a,r,o){var s=function(t,e){var n={task:t,source_site_id:r.sourceSiteId(),remote_site_id:r.remoteSiteId(),};if(i==='term'){if(!e){e=r.remoteTermId()};n.source_term_id=r.sourceTermId();n.remote_term_id=e;n.action='multilingualpress_update_term_relationship';return n};if(!e){e=r.remotePostId()};n.source_post_id=r.sourcePostId();n.remote_post_id=e;n.action='multilingualpress_update_post_relationship';return n},u=function(n){var r,a;if(!n.success||!n.data||typeof n.data!=='string'){return!1};a=t(n.data);if(!a.length){return!1};r=o.parent();r.find('.mlp-warning').remove();o.remove();a.appendTo(r);o=e.TranslationBoxFactory.create(i,a);return!0},l=function(t){var e,n;if(t!=='existing'&&t!=='remove'){return null};if(t==='existing'){e=a.selectedResult();if(!e){return null}};n=t==='existing'?e:null;return s(t,n)};this.updateRelation=function(e,i,a){var r=l(e);if(!r){return};i();t.ajax({url:n,method:'POST',dataType:'json',data:r}).done(function(t){if(!u(t)){a()}}).fail(function(){a()})}}}(jQuery,MultilingualPress,ajaxurl));(function(t,e,n){'use strict';e.TranslationSearch=function(e,i,a,s){var u=this,r,l,o,g,d,f,p,h=0,c={};var m=function(t){var e,n,i,a;if(typeof t!=='object'||!t){return null};e=t.id||0;n=t.title||'';if(!e||!n){return null};i=g.clone();a=i.find('input');a.val(e);a.attr('aria-label',n);i.find('span').text(n+' (ID: '+e+')');return i},v=function(e){var n=m(e);if(!n){return};n.find('input').on('change',function(){var e=t(this);if(e.is(':checked')){s.attr('disabled',!1);n.closest('table').find('td').removeClass('selected');e.closest('td').addClass('selected')}});n.appendTo(o);h++},b=function(t){h=0;o.empty();s.attr('disabled',!0);if(typeof t!=='object'||!t||!t.map){d.clone().appendTo(o);return};t.map(v);if(h<1){d.clone().appendTo(o)}},y=function(t,e){var n={action:r.data('action'),search:e,source_site_id:i.sourceSiteId(),remote_site_id:i.remoteSiteId(),};if(t==='term'){n.source_term_id=i.sourceTermId();n.remote_term_id=i.remoteTermId();return n};n.source_post_id=i.sourcePostId();n.remote_post_id=i.remotePostId();return n},w=function(i){var a=c[e]||{};if(i in a){u.showResults(a[i]);return};if(!(e in c)){c[e]={}};r.addClass('ui-autocomplete-loading');t.ajax({url:n,method:'POST',dataType:'json',data:y(e,i)}).done(function(t){var n=t.success&&t.data?t.data:!1;if(n){c[e][i]=n};u.showResults(n)}).fail(function(){u.showResults(!1)}).always(function(){r.removeClass('ui-autocomplete-loading')})},T=function(t){var e;if(t.which===13){return};if(p){clearTimeout(p)};e=r.val();if(e===f){return};if(e.length<2){u.hideResults(!1);return};f=e;p=setTimeout(function(){w(e);f=null},300)};this.init=function(){var e,n;if(!r){r=a.find('input');r.val('');r.keyup(T).keydown(function(t){if(t.which===13){t.preventDefault()}});l=t(r.data('results'));o=l.find('table tbody');e=o.find('.search-results-row');n=o.find('.search-results-none');g=e.clone().show();d=n.clone().show();e.remove();n.remove()}};this.showField=function(t){a.toggle(t)};this.showResults=function(t){b(t);l.show()};this.hideResults=function(t){o.empty();l.hide();if(t!==!1){r.val('')}};this.selectedResult=function(){var t=o.find('input:checked').eq(0);if(t.length){return t.val()};return null}}}(jQuery,MultilingualPress,ajaxurl));(function(t,e){'use strict';e.TraslationBoxTabs=function(e){var n,i,a=!1,r,o,s=function(){if(!n){n=e.find('.wp-tab-panel')};return n},u=function(){if(!i){i=e.find('.nav-tab')};return i};this.init=function(){if(!a){e.tabs({active:0,activate:function(t,e){r=e.newTab;o=e.newPanel},create:function(t,e){r=e.tab;o=e.panel}});a=!0};return this};this.disable=function(){this.init();e.tabs('disable')};this.enable=function(){this.init();e.tabs('enable')};this.activate=function(n){var i=0;this.init();if(!n){return};u().each(function(){var a=t(this).attr('id').match(/tab-([a-z-]+)$/);if(a[1]===n){e.tabs('option','active',i)};i++})};this.findInPanel=function(t,i){var a;if(!n){n=e.find('.wp-tab-panel')};a=n.find('.tab-'+t);if(!a.length){return a};return a.find(i)};this.findInAllPanels=function(t){return s().find(t)}}}(jQuery,MultilingualPress));(function(t,e,n){'use strict';t(function(){var a,i,r,o,s;if(n==='post-new-php'||n==='post-php'){t('.post-translation-metabox').each(function(){e.TranslationBoxFactory.create('post',t(this))})};if(n==='term-php'){t('.term-translation-metabox').each(function(){e.TranslationBoxFactory.create('term',t(this))})};if(n==='site-new-php'){a=new e.NewSiteLanguage(t('#site-language'),t('#mlp-site-language'));a.init()};if(n==='sites_page_multilingualpress-site-settings'){i=new e.LanguageSearch(t('#mlp-site-language'));i.init()};if(n==='site-new-php'||n==='sites_page_multilingualpress-site-settings'){r=new e.SitesRelationshipBulkSelection();r.init()};if(n==='nav-menus-php'){o=new e.NavMenu(t('#mlp-languages-submit'),t('#menu-to-edit'),t('#menu'));o.init()};if(n==='multilingualpress_page_language-manager'){s=new e.LanguageManager();s.init();i=new e.LanguageSearch(t('#mlp-language-manager-table').find('td:first-child').find('input'));i.init()}})}(jQuery,MultilingualPress,adminpage));