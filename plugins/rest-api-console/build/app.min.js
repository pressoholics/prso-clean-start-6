(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
if(!window)throw new Error("Not a browser window.");var path=require("./path"),ui=require("./ui"),querystring=require("querystring"),dev=new ui.Dev,querystring=require("querystring"),$=require("zepto-browserify").$,authScheme=require("./auth")();$(function(){var e=new ui.AuthPanel("#auth",{scheme:t,onCheckToken:function(e,t){d({path:"/v1/me"},t)}}),t=authScheme(e),a=t.request.bind(t),n=new ui.ReferencePanel({search_url:rest_api_console.search_url,defaultValue:[],versionSelector:$("#versions"),onSelect:function(e){u(e)},onLoadVersions:function(e){e(null,["2"],"2")},onLoadEndpoints:function(e,t){$.ajax({headers:{accept:"application/json"},url:rest_api_console.rest_url,success:function(e){t(null,e)}})}}),r=new ui.OptionSelector($("#method"),{values:["GET","POST","PUT","DELETE","OPTIONS"]}),o=new ui.ParamBuilder($("#query"),{title:"Query"}),i=new ui.ParamBuilder($("#body"),{title:"Body"}),s=new ui.Tip("#tip"),l=new ui.PathField($("#path"),{defaultValue:new path.DefaultPath,itemTemplate:function(e){if("string"==typeof e)return $("<li></li>").addClass("group").addClass("unselectable").text(e);if(e.loading===!0)return $("<li></li>").addClass("unselectable").addClass("loading").append($("<div><div></div></div>").addClass("throbber"));if(e.history===!0)return $("<li></li>").addClass("unselectable").addClass("history").text(e.label).addClass("group");var t=$("<li></li>");$("<span></span>").text(e.method).appendTo(t),$("<code></code>").text(e.path_labeled).appendTo(t.append(" ")),$("<strong></strong>").text(e.namespace).appendTo(t.append(" ")),$("<em></em>").text(e.description).appendTo(t.append(" "));return t},onSelect:function(e){u(e)},onSearch:n.onSearch}),u=function(e){var t=new path.Path(e.path_labeled,{});t.parts.push(new path.Part("?",{label:"?",type:"segment",editable:!1})),t.parts.push(new path.QueryPart),l.setValue(t),r.setValue(e.method),r.disable(),o.setValue({}),i.setValue({}),n.addHistory(e)},d=function(e,t){var n=new ui.RequestViewer({container:"#requests"});e.path&&0!==e.path.indexOf("/")&&(e.path="/"+e.path),e.path="?"==e.path.charAt(e.path.length-1)?e.path.substring(0,e.path.length-1):e.path,e.apiVersion="1.1";var r=/^\/v([\d][^\/]{0,})\//,o=e.path.match(r);return o&&(e.apiVersion=o[1],e.path=e.path.replace(r,"/")),n.setValue(e),a(e,function(e,a,r){t&&t(e,a,r),n.onResponse(e,a,r)}),n.sent(),n};i.disable(),r.on("enabled",function(){r.node.attr("tabindex","1").addClass("enabled")}),r.on("disabled",function(){r.node.attr("tabindex",null).removeClass("enabled")}),r.on("change",function(){-1===["GET","DELETE","OPTIONS"].indexOf(r.getValue())?i.enable():i.disable()}),l.on("reset",function(){r.enable(),o.reset(),i.reset(),s.reset()}),$(document).on("keydown",function(e){return 77!=e.which||!e.ctrlKey||e.altKey||e.shiftKey||e.metaKey?191!=e.which||!e.ctrlKey||e.altKey||e.shiftKey||e.metaKey?27==e.which?(e.preventDefault(),e.stopPropagation(),l.reset(),!1):void 0:(e.preventDefault(),l.focus(),!1):(e.preventDefault(),r.toggle(),!1)}),i.on("disable",function(){i.node.addClass("disabled")}),i.on("enable",function(){i.node.removeClass("disabled")});var c=s.setValue.bind(s);l.on("tip",c),o.on("tip",c),i.on("tip",c),l.on("changeParams",function(e){var t=e.query;o.setParams(querystring.parse(t))}),o.on("changeParams",function(e){l.setFieldValue("query",$.param(e))});var p=document.createElement("a");l.on("submit",function(e){var t=r.getValue(),a=i.getQuery(),n={method:t,body:a};p.href=e,n.path=p.pathname,n.query=p.search.substring(1,p.search.length),d(n).focus()});try{n.setHistory(JSON.parse(localStorage.history))}catch(e){}n.on("history",function(e){localStorage.history=JSON.stringify(e)}),n.on("change",function(){l.requery()}),dev.on("change",function(e){e?(console.log("Developer mode activated"),localStorage.developer="a8c"):delete localStorage.developer,n.refresh()}),dev.setValue("a8c"===localStorage.developer),n.load(),window.send=d});

},{"./auth":2,"./path":4,"./ui":10,"querystring":27,"zepto-browserify":31}],2:[function(require,module,exports){
module.exports=function(){return require("./nonce")()};

},{"./nonce":3}],3:[function(require,module,exports){
function authHeaders(){return rest_api_console.rest_nonce?{"X-WP-Nonce":rest_api_console.rest_nonce}:{}}function sendRequest(e,t){$.ajax({type:e.method,url:rest_api_console.rest_url+e.path+(e.query?"?"+e.query:""),data:-1===["GET","DELETE","OPTIONS"].indexOf(e.method)?e.body:null,headers:$.extend({accept:"application/json"},authHeaders()),success:function(e,r,n){t(null,e,n)},error:function(e,r,n){var u=e.response;try{u=JSON.parse(u)}catch(e){}t({status:e.status,error:n,errorType:r,body:u},null,e)}})}function auth(e){}function buildAuth(e){return new auth(e)}var $=require("zepto-browserify").$;auth.prototype.request=sendRequest,module.exports=function(){return buildAuth};

},{"zepto-browserify":31}],4:[function(require,module,exports){
function Path(t,r){r||(r={}),this.path=t,this.parts=reduceParts(t,function(t){return builder.build(t,r)})}function reduceParts(t,r){var e=0,a=[],u=function(t){t&&a.push(t)};do{var i=t.indexOf(VARIABLE_START,e),o=t.indexOf(VARIABLE_END,i);if(i===-1){u(r(t.slice(e)));break}if(i>e&&u(r(t.slice(e,i))),o===-1){u(r(t.slice(i)));break}u(r(t.slice(i,o+1))),e=o+1}while(e<t.length);return a}function DefaultPath(){var t=new Part("path",{label:"",type:"param",editable:!0});t.toString=function(t){return this.encode(t.path||"")},this.parts=[t]}function QueryPart(){Part.call(this,"query",{type:"param",label:"query",editable:!0})}var PATH_SEPERATOR="/",VARIABLE_START="{",VARIABLE_END="}",part_builder=require("./part_builder"),builder=part_builder(),Part=require("./part").Part;Path.prototype.toString=function(t){for(var r="",e=0;e<this.parts.length;e++){var a=this.parts[e];r+=a.toString(t)}return r},DefaultPath.prototype=Object.create(Path.prototype),QueryPart.prototype=Object.create(Part.prototype),QueryPart.prototype.toString=function(t){return t.query||""},module.exports.Path=Path,module.exports.Part=Part,module.exports.DefaultPath=DefaultPath,module.exports.QueryPart=QueryPart;

},{"./part":5,"./part_builder":6}],5:[function(require,module,exports){
function Part(t,e){this.name=t,this.options=e||{},this.type=this.options.type||"",this.label=this.options.label,this.editable=this.options.editable||!1,this.encode=this.options.encode||function(t){return encodeURI(t)}}Part.prototype.toString=function(t){if(t){var e=t[this.name];return e?this.encode(e):this.name}return this.name},Part.prototype.getLabel=function(){return this.label},Part.prototype.getType=function(){return this.type},module.exports=function(){},module.exports.Part=Part;

},{}],6:[function(require,module,exports){
function PartBuilder(e){this.builders=e}function paramType(e,t){if(0===e.indexOf("{"))return new Part(e,{type:"param",label:e,editable:!0,meta:t[e],encode:function(e){return encodeURIComponent(e)}})}function segmentType(e,t){return new Part(e,{type:"segment",label:e,editable:!1})}function PathPart(){}var Part=require("./part").Part;PartBuilder.prototype.build=function(e,t){for(var r,n=0;n<this.builders.length;n++)if(r=this.builders[n](e,t))return r},module.exports=function(){},module.exports=function(){return new PartBuilder([paramType,segmentType])},module.exports.PartBuilder=PartBuilder,module.exports.PathPart=PathPart;

},{"./part":5}],7:[function(require,module,exports){
var Component=require("./component"),$=Component.$,transparent="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNgYAAAAAMAASsJTYQAAAAASUVORK5CYII=",AuthPanel=Component.extend({loadingClass:"loading",authorizedClass:"authorized",activeClass:"active",labelClass:"label",imgClass:"img",extraClass:"extra",signInText:"Sign In",signOutText:"Sign Out",onChange:function(t){if(t){this.extra.text(this.options.signOutText),this.node.addClass(this.options.authorizedClass);var s=this.avatar.show(),i=new Image;$(i).on("load",function(){s.attr("src",t.avatar_URL).css("opacity","1")}).attr("src",t?t.avatar_URL:"")}else this.extra.text(this.options.signInText),this.node.removeClass(this.options.authorizedClass),this.avatar.attr("src",transparent).hide()},onCheckToken:function(){console.warn("No auth token check")},init:function(){this.node.on("click",this.onClick.bind(this)),this.node.on("keydown",this.detectActive.bind(this)),this.node.on("keypress",this.onKeypress.bind(this)),this.label=$("<span></span>").appendTo(this.node).addClass(this.options.labelClass),this.extra=$("<span></span>").appendTo(this.node).addClass(this.options.extraClass).text(this.options.signInText),this.img=$("<span></span>").appendTo(this.node).addClass(this.options.imgClass),this.avatar=$("<img>").appendTo(this.img).hide(),this.throbber=$("<div><div></div></div>").addClass("throbber").appendTo(this.node)}});AuthPanel.prototype.checkAuthentication=function(){this.node.addClass(this.options.loadingClass),this.emit("check",this.onCheck.bind(this))},AuthPanel.prototype.abortAuth=function(){this.node.removeClass(this.options.loadingClass),this.setValue(null)},AuthPanel.prototype.onCheck=function(t,s){this.node.removeClass(this.options.loadingClass),t?this.setValue(null):this.setValue(s)},AuthPanel.prototype.getRedirectUri=function(){return $("meta[name=redirect_uri]").attr("content")},AuthPanel.prototype.performAuthAction=function(){if(!this.node.hasClass(this.options.loadingClass))return this.getValue()?void this.emit("signout",this):void this.emit("signin",this)},AuthPanel.prototype.authenticate=AuthPanel.prototype.performAuthAction,AuthPanel.prototype.onClick=function(){this.performAuthAction()},AuthPanel.prototype.onKeypress=function(t){13!=t.which&&32!=t.which||this.performAuthAction()},AuthPanel.prototype.detectActive=function(t){var s=this.node,i=this.options.activeClass;13!=t.which&&32!=t.which||(s.addClass(i),setTimeout(function(){s.removeClass(i)},200))},module.exports=AuthPanel;

},{"./component":8}],8:[function(require,module,exports){
function Component(t,e){events.EventEmitter.apply(this,arguments),this.$=$,this.node=$(t),this.options=e,this.node.addClass(this.options.className),this.options.init&&this.options.init.apply(this,[this.node,this.options]),this.setValue(this.options.defaultValue),this.options.afterInit&&this.options.afterInit.apply(this)}var events=require("events"),util=require("util"),noop=function(){},componentOptions={init:noop,beforeChange:function(){return arguments[0]},afterChange:noop,onChange:noop,onReset:noop,element:"div",className:""},$=require("zepto-browserify").$;Component.$=$,util.inherits(Component,events.EventEmitter),Component.prototype.focus=function(){this.node.focus()},Component.prototype.setValue=function(t){var e=this.value;return t=this.options.beforeChange.call(this,t),t===this.value?this.getValue():(this.value=t,this.options.onChange.call(this,this.value,e),this.emit("change",this.value,e),this.options.afterChange.call(this,this.value),this.getValue())},Component.prototype.getValue=function(){return this.value},Component.prototype.reset=function(){this.setValue(this.options.defaultValue),this.options.onReset.apply(this),this.emit("reset")},Component.extend=function(t){var e=function(e,n){$.isPlainObject(e)&&(n=e,e=null);var o={};$.extend(o,componentOptions,t,n),e||(e=$(document.createElement(o.element))),Component.call(this,e,o)};return util.inherits(e,Component),e},module.exports=Component;

},{"events":22,"util":30,"zepto-browserify":31}],9:[function(require,module,exports){
function keyListener(e){this.cancelTimeout=this.wait(),e.which===this.sequence[0]?(this.sequence.shift(),0===this.sequence.length&&this.success()):this.reset()}function timeout(){this.reset()}var Component=require("./component"),$=Component.$,fn=require("fn"),Dev=Component.extend({defaultValue:!1,sequence:[38,38,40,40,37,39,37,39,66,65],init:function(){this.wait=fn.rateLimit(1e3,timeout.bind(this)),this.keyListener=keyListener.bind(this),this.cancelTimeout=function(){},this.reset(),$(document).on("keydown",this.keyListener)},onChange:function(e){e&&$(document).off("keydown",this.keyListener)}});Dev.prototype.filterEndpoints=function(e){var t=this.getValue();return t?e:e.filter(function(e){return"__do_not_document"!=e.group})},Dev.prototype.reset=function(){this.sequence=this.options.sequence.slice(),this.cancelTimeout()},Dev.prototype.success=function(){this.setValue(!0)},module.exports=Dev;

},{"./component":8,"fn":23}],10:[function(require,module,exports){
module.exports={PathField:require("./path_field"),LookupPane:require("./lookup_pane"),OptionSelector:require("./option_selector"),ParamBuilder:require("./param_builder"),RequestViewer:require("./request_viewer"),AuthPanel:require("./auth_panel"),Tip:require("./tip"),ReferencePanel:require("./reference_panel"),Dev:require("./dev")};

},{"./auth_panel":7,"./dev":9,"./lookup_pane":13,"./option_selector":14,"./param_builder":15,"./path_field":16,"./reference_panel":17,"./request_viewer":19,"./tip":20}],11:[function(require,module,exports){
function render(e,n){if(n=n===!0,!n){var r=stringifyJson(e);return r}return $.isPlainObject(e)?renderObject(e):$.isArray(e)?renderArray(e):stringifyJson(e)}function renderObject(e,n){var r=$("<ol></ol>").addClass("browse-object");n=n===!0;for(var o in e)r.append(buildRow($("<code></code>").text('"'+o+'"').append(": "),e[o],n));return r}function renderArray(e,n){var r=$("<ol></ol>").addClass("browse-array");n=n===!0;for(var o=0;o<e.length;o++)r.append(buildRow($("<code></code>").text(o).append(": "),e[o]));return r}function buildRow(e,n,r){var o=$("<li></li>");return o.append($("<span></span>").addClass("key").append(e)).append(render(n,r)),makeExpandable(o,n),o}function isEmptyJson(e){if($.isArray(e)&&0===e.length)return!0;for(var n in e)if(e.hasOwnProperty(n))return!1;return!0}function makeExpandable(e,n){if(($.isArray(n)||$.isPlainObject(n))&&!isEmptyJson(n)){var r=e.find(".compact"),o=null;e.addClass("closed"),e.on("click","span.key, .compact",function(a){return a.stopPropagation(),a.preventDefault(),null===o&&(o=render(n,!0)),e.hasClass("open")?(e.removeClass("open").addClass("closed"),o.replaceWith(r)):(e.removeClass("closed").addClass("open"),r.replaceWith(o)),!1})}}var Component=require("./component"),$=Component.$,util=require("./util"),stringifyJson=util.stringifyJson,JsonBrowser=Component.extend({className:"json-browse",compact:!1,label:"",onChange:function(e){this.node.children().remove(),this.options.compact===!0?$("<ol></ol>").append(buildRow(this.options.label,e)).appendTo(this.node):render(e,!0).appendTo(this.node)}});module.exports=JsonBrowser;

},{"./component":8,"./util":21}],12:[function(require,module,exports){
function updateList(t){if(this.node.children().remove(),"all"!==t[0]){var e=$(),i=this,n=this.options.itemTemplate;_.each(t,function(t,s){t.methods.forEach(function(t){var o={method:t,version:"2",path_labeled:s,description:""};e=e.add(n(o,i))})});var s=this.node.parent(),o=this.node.next();this.node.remove(),this.node.children().remove(),this.node.append(e),o.length>0?this.node.insertBefore(o):this.node.appendTo(s),this.options.autoSelect&&this.selectItem(this.node.children().first())}}var Component=require("./component"),$=Component.$,ListComponent=Component.extend({element:"ol",defaultValue:[],tabindex:"0",autoSelect:!0,selectedClass:"selected",disabledClass:"disabled",itemTemplate:function(t){return $("<li></li>").text(t)},init:function(t,e){this.node.on("click","li",this.onClickItem.bind(this)),this.node.on("dblclick","li",this.onDblClickItem.bind(this)),this.node.on("keydown",this.onKeydown.bind(this)),this.node.on("keypress",this.onKeypress.bind(this)),this.enable()},afterInit:function(){updateList.call(this,this.options.defaultValue)},onChange:function(t,e){updateList.call(this,t)}});ListComponent.prototype.disable=function(){this.node.addClass(this.options.disabledClass),this.node.attr("tabindex",null)},ListComponent.prototype.enable=function(){this.node.removeClass(this.options.disabledClass),this.node.attr("tabindex",this.options.tabindex)},ListComponent.prototype.isDisabled=function(){return!this.isEnabled()},ListComponent.prototype.isEnabled=function(){return!this.node.hasClass(this.options.disabledClass)},ListComponent.prototype.onKeydown=function(t){if(!this.isDisabled())return 38==t.which?(t.preventDefault(),this.selectPrevious(),!1):40==t.which?(t.preventDefault(),this.selectNext(),!1):void 0},ListComponent.prototype.onKeypress=function(t){if(!this.isDisabled())return 13==t.which?(t.preventDefault(),t.stopPropagation(),this.submitItem(this.getSelectedItem()),!1):void 0},ListComponent.prototype.getSelectedItem=function(){return this.node.find("."+this.options.selectedClass)},ListComponent.prototype.onClickItem=function(t){this.isDisabled()||this.selectItem($(t.currentTarget))},ListComponent.prototype.onDblClickItem=function(t){if(!this.isDisabled()){var e=$(t.currentTarget);this.selectItem(e),this.submitItem(e)}},ListComponent.prototype.selectNext=function(){var t=this.getSelectedItem().next();t.length>0&&this.selectItem(t)},ListComponent.prototype.selectPrevious=function(){var t=this.getSelectedItem().prev();t.length>0&&this.selectItem(t)},ListComponent.prototype.reselectSelectedItem=function(){var t=this.getSelectedItem();t.length>0&&this.selectItem(t)},ListComponent.prototype.selectItem=function(t){var e=this.getSelectedItem(),i=this.getValue(),n=e.index(),s=t.index();e.removeClass(this.options.selectedClass),t.addClass(this.options.selectedClass),e.length>0&&this.emit("deselect",i[n],n,e),t.length>0&&this.emit("select",i[s],s,t)},ListComponent.prototype.submitItem=function(t){var e=t.index(),i=this.getValue()[e];i&&(console.log("Submit",i,e,t),this.emit("submit",i,e,t))},module.exports=ListComponent;

},{"./component":8}],13:[function(require,module,exports){
var Component=require("./component"),$=Component.$;LookupPane=Component.extend({max:32,template:function(t){return $("<li></li>").text(t)},highlightClass:"highlight",unselectableClass:"unselectable",defaultValue:null,init:function(){this.listNode=Component.$("<ol></ol>").appendTo(this.node),this.node.on("mousedown","li",this.onClick.bind(this)),this.last_index=-1,this.enableMouse()},onChange:function(t,e){return e&&e.removeClass(this.options.highlightClass),t?(this.last_index=t.index(),t.addClass(this.options.highlightClass),void(this.disableScroll||this.scrollSelectedToVisible())):void(this.last_index=-1)}}),LookupPane.prototype.displayResults=function(t,e){var i=this.listNode,s=this.options.template;null===e?this.options.max:e;this.clearResults(),this.results=t;var o=$([]);this.results.forEach(function(t){o=o.add(s(t))}),i.append(o),this.last_index!==-1&&(this.last_index>o.length-1&&(this.last_index=0),this.highlightNearestSelectable(this.last_index))},LookupPane.prototype.hide=function(){this.node.hide()},LookupPane.prototype.show=function(){this.node.show();var t=this.node.offset().top,e=$(window).height()-t-8;this.listNode.css("max-height",e)},LookupPane.prototype.clearResults=function(){this.listNode.children().remove(),this.results=[]},LookupPane.prototype.reset=function(){this.clearResults(),this.last_index=-1},LookupPane.prototype.onClick=function(t){t.preventDefault();var e=$(t.currentTarget);return!e.hasClass(this.options.unselectableClass)&&(this.setValue($(t.currentTarget)),this.selectCurrent(),!1)},LookupPane.prototype.selectCurrent=function(){if(!this.getValue())return!1;var t=this.getValue().index(),e=!!this.results&&this.results[t];return!!e&&(this.emit("select",e),!0)},LookupPane.prototype.highlightFirst=function(){this.highlightNearestSelectable(0)},LookupPane.prototype.highlightLast=function(){this.highlightNearestSelectable(this.listNode.children().length-1,-1)},LookupPane.prototype.highlightNearestSelectable=function(t,e){null!==e&&void 0!==e||(e=1);var i=this.listNode.children(),s=null;if(0===i.length)return this.setValue(null);if(1===i.length)return this.setValue(i.eq(0));do if(s=i.eq(t),t+=e,t<0||t>=i.length)break;while(0===s.length||s.hasClass(this.options.unselectableClass));this.setValue(s)},LookupPane.prototype.highlightNext=function(){var t=this.getValue(),e=null;if(!t)return this.highlightFirst();for(e=t.next();e.hasClass(this.options.unselectableClass);)e=e.next();return 0===e.length?this.highlightFirst():void this.setValue(e)},LookupPane.prototype.highlightPrevious=function(){var t=this.getValue(),e=null;if(!t)return void this.highlightLast();for(e=t.prev();e.hasClass(this.options.unselectableClass);)e=e.prev();return 0===e.length?this.highlightLast():void this.setValue(e)},LookupPane.prototype.onHover=function(t){this.disableScroll=!0,this.setValue($(t.currentTarget)),this.disableScroll=!1},LookupPane.prototype.scrollSelectedToVisible=function(){var t=this.getValue();if(!t)return void this.node.scrollTop(0);var e=t,i=(e.position(),e[0].offsetTop),s=e[0].offsetHeight,o=i+s,l=this.listNode.height(),n=this.listNode.scrollTop(),h=n+this.listNode.height();i<=n?this.listNode.scrollTop(i-s):o>=h&&this.listNode.scrollTop(o-l+s)},LookupPane.prototype.ignoreMouse=function(){this.node.off("mouseenter.lookup-pane"),this.node.one("mousemove",this.enableMouse.bind(this))},LookupPane.prototype.enableMouse=function(){this.node.on("mouseenter.lookup-pane","li",this.onHover.bind(this))},module.exports=LookupPane;

},{"./component":8}],14:[function(require,module,exports){
var Component=require("./component"),$=Component.$,OptionSelector=Component.extend({className:"option_selector",values:[],labelClass:"label",optionsClass:"options",highlightClass:"highlight",disabledClass:"disabled",tabIndex:1,label:function(t){return t},optionLabel:function(t,e){return t},init:function(){this.enabled=!0,this.label=$("<span></span>").addClass(this.options.labelClass).appendTo(this.node),this.container=$("<div></div>").addClass(this.options.optionsClass).appendTo(this.node),this.container.hide(),this.node.on("focus",this.onFocus.bind(this)),this.node.on("blur",this.onBlur.bind(this)),this.node.on("mouseleave",this.onLeave.bind(this)),this.node.on("mousedown",this.onDown.bind(this)),this.node.on("click",this.onClick.bind(this)),this.node.on("click","li",this.onClickOption.bind(this)),this.keyListener=this.onKeypress.bind(this),this.options.values.length>0&&this.options.defaultValue!==!1&&(this.options.defaultValue=this.options.values[0]),this.open=!1,this.enable(),this.setOptions(this.options.values),this.reset()},onChange:function(t,e){this.label.text(this.options.label(t?t:"")),this.refreshItems()}});OptionSelector.prototype.disable=function(){this.enabled=!1,this.node.addClass(this.options.disabledClass).attr("tabIndex",null),this.emit("disabled")},OptionSelector.prototype.enable=function(){this.enabled=!0,this.node.removeClass(this.options.disabledClass).attr("tabIndex",this.options.tabIndex),this.emit("enabled")},OptionSelector.prototype.onFocus=function(){this.focused=!0,this.showOptions()},OptionSelector.prototype.onBlur=function(){this.focused=!1,this.hideOptions()},OptionSelector.prototype.onLeave=function(){this.node.blur()},OptionSelector.prototype.showOptions=function(){this.enabled&&(this.open=!0,this.refreshItems(),this.container.show(),this.node.off("keydown",this.keyListener),this.node.on("keydown",this.keyListener))},OptionSelector.prototype.hideOptions=function(){this.open=!1,this.container.hide(),this.node.off("keydown",this.keyListener)},OptionSelector.prototype.onKeypress=function(t){return 38==t.which?(t.preventDefault(),this.highlightPrev(),!1):40==t.which?(t.preventDefault(),this.highlightNext(),!1):13==t.which?(t.preventDefault(),t.stopImmediatePropagation(),this.selectHighlighted(),!1):27==t.which?(this.node.blur(),t.preventDefault(),!1):void 0},OptionSelector.prototype.onDown=function(){this.closeOnClick=this.open},OptionSelector.prototype.onClick=function(t){return t.preventDefault(),this.closeOnClick&&this.node.blur(),!1},OptionSelector.prototype.onClickOption=function(t){t.preventDefault();var e=this.options.values[$(t.currentTarget).index()];return this.setValue(e),!1},OptionSelector.prototype.setValue=function(t){this.enabled&&Component.prototype.setValue.apply(this,arguments)},OptionSelector.prototype.setOptions=function(t){this.options.values=t,this.options.values.length<=1?this.disable():this.enable(),this.open&&this.refreshItems()},OptionSelector.prototype.refreshItems=function(){this.removeItems(),this.addItems(),this.highlightNext()},OptionSelector.prototype.addItems=function(){var t=$("<ul></ul>"),e=this.getValue(),i=this.options.optionLabel;this.options.values.forEach(function(o,s){var n=$("<li></li>"),h=i(o,s);o===e&&n.addClass("selected"),"string"==typeof h?n.text(h):n.append(h),t.append(n)}),t.appendTo(this.container)},OptionSelector.prototype.removeItems=function(){this.container.find("ul").remove()},OptionSelector.prototype.getHighlighted=function(){return this.container.find("li."+this.options.highlightClass)},OptionSelector.prototype.selectHighlighted=function(){var t=this.getHighlighted();t.length>0&&this.setValue(this.options.values[t.index()])},OptionSelector.prototype.highlightNext=function(){var t=this.getHighlighted(),e=t.next("li");0===e.length&&(e=this.container.find("li").first()),t.removeClass(this.options.highlightClass),e.addClass(this.options.highlightClass)},OptionSelector.prototype.highlightPrev=function(){var t=this.getHighlighted(),e=t.prev("li");0===e.length&&(e=this.container.find("li").last()),t.removeClass(this.options.highlightClass),e.addClass(this.options.highlightClass)},OptionSelector.prototype.toggle=function(){var t=this.getValue(),e=this.options.values.indexOf(t);e===this.options.values.length-1&&(e=-1),e++,this.setValue(this.options.values[e])},module.exports=OptionSelector;

},{"./component":8}],15:[function(require,module,exports){
var Component=require("./component"),$=Component.$,querystring=require("querystring"),fn=require("fn"),ParamBuilder=Component.extend({title:null,rawClass:"raw",tableClass:"table",init:function(){this.enabled=!0,this.node.append($("<header></header>").text(this.options.title)),this.focusListener=this.onFocus.bind(this),this.blurListener=this.onBlur.bind(this),this.changeListener=this.onChange.bind(this),this.inputListener=this.onInput.bind(this),this.pasteListener=this.onPaste.bind(this),this.scrollCancel=function(){},this.scrollCalculator=fn.rateLimit(100,this.scrollIntoView.bind(this)),this.section=$("<div></div>").addClass("container").appendTo(this.node),this.scroller=$("<div></div>").addClass("scroller").appendTo(this.section),this.table=$("<table></table>").addClass(this.options.tableClass).appendTo(this.scroller),this.raw=$("<div></div>").addClass(this.options.rawClass).appendTo(this.node),this.setupInput(this.raw,function(t,e){t.rawParams=t.raw.text()}),this.params={},this.section.hide(),this.scroller.on("scroll",this.onScroll.bind(this))},beforeChange:function(t){return $.isArray(t)?null:t},onChange:function(t,e){var i=$([]);if(!t)return this.section.hide(),void this.raw.show();this.section.show(),this.raw.hide(),this.fields={};for(var s in t)i=i.add($("<tr></tr>").append($("<th></th>").text(s)).append($("<td></td>").append(this.setupFieldInput(s,$("<div></div>").text(this.getParam(s))))));this.table.find("div").off(),this.table.find("tr").remove(),this.table.append(i),this.table.on("click","th",function(t){$(t.currentTarget).parents("tr").find("div").focus()}),this.updateScroller()}});ParamBuilder.prototype.setupInput=function(t,e){return e||(formatter=function(){}),t.attr("contenteditable",!0).attr("tabindex","1").on("keydown",this.inputListener).on("keyup",fn.arglock(this.changeListener,e)).on("paste",this.pasteListener),t},ParamBuilder.prototype.setupFieldInput=function(t,e){var i=function(i){var s=e.html().replace(/<br><br>$/,"\n").replace(/<br>/g,"\n").trim();i.setParam(t,s)},s=$.extend({name:t,context:e},this.value[t]);return this.fields[t]=e.eq(0),this.setupInput(e,i).on("focus",fn.arglock(this.focusListener,e,s)).on("blur",fn.arglock(this.blurListener,e))},ParamBuilder.prototype.setParam=function(t,e){""===e?delete this.params[t]:this.params[t]=e,this.emit("changeParams",this.params)},ParamBuilder.prototype.getParams=function(){var t={};for(var e in this.value)this.params[e]&&""!==this.params[e]&&(t[e]=this.params[e]);return t},ParamBuilder.prototype.setParams=function(t){this.params=t;for(var e in this.fields)$(this.fields[e]).text(this.params[e]||"")},ParamBuilder.prototype.getParam=function(t){var e=this.params[t];return e||""},ParamBuilder.prototype.enable=function(){this.enabled=!0,this.table.find("div").add(this.raw).attr("contenteditable",!0).attr("tabindex","1"),this.emit("enable")},ParamBuilder.prototype.disable=function(){this.enabled=!1,this.table.find("div").add(this.raw).attr("contenteditable",null).attr("tabindex",null),this.emit("disable")},ParamBuilder.prototype.onFocus=function(t,e,i){this.focusedTip=e,this.emit("tip",e)},ParamBuilder.prototype.onBlur=function(t,e){this.focusedTip=null},ParamBuilder.prototype.onChange=function(t,e){var i=$(e.currentTarget);querystring.parse(i.text());t(this,e),this.updateScroller()},ParamBuilder.prototype.onInput=function(t){if(13===t.which)return document.execCommand("insertHTML",!1,"<br><br>"),t.preventDefault(),!1},ParamBuilder.prototype.onPaste=function(t){var e=t.clipboardData.getData("text/plain");return t.preventDefault(),document.execCommand("insertHTML",!1,e.replace(/\n$/,"<br><br>").replace(/\n/g,"<br>")),!1},ParamBuilder.prototype.onScroll=function(t){this.focusedTip&&this.emit("tip",null),this.updateScroller(),this.scrollCancel(),this.scrollCancel=this.scrollCalculator()},ParamBuilder.prototype.scrollIntoView=function(){var t=this.scroller.get(0),e={top:t.scrollTop,bottom:t.clientHeight+t.scrollTop,height:t.clientHeight};if(this.focusedTip){var i=this.focusedTip.context.position();i.bottom=i.top+this.focusedTip.context.height(),i.bottom>0&&i.top<e.height&&this.emit("tip",this.focusedTip)}},ParamBuilder.prototype.updateScroller=function(){var t=this.scroller.get(0),e=t.scrollTop,i=0===e,s=t.scrollHeight-e===t.clientHeight;this.section.hasClass("at-top")&&!i?this.section.removeClass("at-top"):!this.section.hasClass("at-top")&&i&&this.section.addClass("at-top"),this.section.hasClass("at-bottom")&&!s?this.section.removeClass("at-bottom"):!this.section.hasClass("at-bottom")&&s&&this.section.addClass("at-bottom")},ParamBuilder.prototype.getQuery=function(){if(!this.value||""===this.value)try{return querystring.parse(this.raw.text())}catch(t){return{}}return this.getParams()},module.exports=ParamBuilder;

},{"./component":8,"fn":23,"querystring":27}],16:[function(require,module,exports){
function buildNode(t){var e=this,i=$("<div></div>").text(t.getLabel()).addClass(t.getType()).appendTo(this.partsNode);if(t.options.editable){var o=e.focusable_parts[e.focusable_parts.length-1],s={node:i.get(0),part:t,previous:o},n=e.getParam(t.name),a=n&&""!==n;o&&(o.next=s),e.focusable_parts.push(s),i.text(n).toggleClass("modified",a).attr("contenteditable",!0).attr("tabindex",1).attr("data-label",t.getLabel()).on("paste",function(t){return t.preventDefault(),document.execCommand("insertText",!1,t.clipboardData.getData("text/plain")),""!==i.text()&&i.addClass("modified"),!1}).on("keydown",function(t){var o=e.hasSelection();if(o||e.lookupPane.ignoreMouse(),38==t.which&&!o)return t.preventDefault(),void e.lookupPane.highlightPrevious();if(40==t.which&&!o)return t.preventDefault(),e.performSearch(),e.lookupPane.show(),void e.lookupPane.highlightNext();if(13==t.which){if(t.preventDefault(),o||!e.lookupPane.selectCurrent()){if(e.lookupPane.hide(),s.next)return e.focus(s.next),!1;e.buildPath(),e.detectActive(t)}return!1}if(27!=t.which||o||(e.preventSearch=!0),8==t.which&&!i.hasClass("modified")){if(t.preventDefault(),s.previous)return e.focus(s.previous),!1;if(e.hasSelection())return e.reset(),!1}}).on("keypress",function(t){t.charCode>0&&!i.hasClass("modified")&&i.addClass("modified")}).on("keyup",function(){e.setParam(t.name,i.text()),""===e.getParam(t.name)&&(i.removeClass("modified"),i.html(""))}).on("focus",function(){var o=e.getParam(t.name);t.options.meta&&e.emit("tip",$.extend({name:t.name,context:i,position:"below"},t.options.meta)),""!==o&&i.addClass("modified"),e.focused=!0,e.onFocusPart(t,i.get(0))}).on("blur",function(){e.getParam(t.name);e.focused=!1,e.onBlurPart(t,i)})}}var Component=require("./component"),$=Component.$,LookupPane=require("./lookup_pane"),fn=require("fn"),noop=function(){},util=require("util"),PathField=Component.extend({decorators:"#method,#submit,#search,#parts,#lookup",submit:"#submit",search:"#search",container:"#parts",lookup:"#lookup",activeClass:"active",onSearch:noop,onSelect:noop,itemTemplate:function(t){return $("<li></li>").text("item")},init:function(){this.values={path:""},this.node.on("click",this.options.submit,this.buildPath.bind(this)),this.node.on("click",this.options.search,this.onSearch.bind(this)),this.node.on("keydown",this.options.submit,this.detectActive.bind(this)),this.node.on("keypress",this.options.submit,this.onSubmitKeypress.bind(this)),this.partsNode=this.node.find(this.options.container),this.lookupPane=new LookupPane($(this.options.lookup),{template:this.options.itemTemplate}),this.last_query=null,this.cancel_search=noop,this.search=fn.rateLimit(200,function(t){this.options.onSearch(t,fn.arglock(this.onResults,t).bind(this))}.bind(this)),this.lookupPane.on("select",this.options.onSelect),this.keyListener=this.onKeydown.bind(this),$(document).on("keydown",this.keyListener)},onChange:function(t){t&&(this.clearNodes(),this.hasSelection()?this.node.addClass("endpoint"):this.node.removeClass("endpoint"),this.focusable_parts=[],t.parts.forEach(buildNode.bind(this)),this.focus(),this.hasSelection()?this.lookupPane.hide():this.lookupPane.show(),this.last_query=null)}});PathField.prototype.reset=function(){this.hasSelection()?Component.prototype.reset.apply(this):(this.last_query=null,debug_on_search=!0,this.cancel_search(),this.lookupPane.reset(),this.lookupPane.hide())},PathField.prototype.clearNodes=function(){this.partsNode.children().not(this.options.decorators).remove()},PathField.prototype.hasSelection=function(){return this.options.defaultValue!==this.value},PathField.prototype.hasPath=function(){return""!==this.value.toString(this.values)},PathField.prototype.buildPath=function(){this.hasPath()&&(this.cancel_search(),this.emit("submit",this.value.toString(this.values),this.hasSelection()?this.value:null))},PathField.prototype.setFieldValue=function(t,e){var i=this.getField(t),o=$(i.node);this.values[t]=e,o.text(e),e&&""!==e&&o.addClass("modified")},PathField.prototype.getField=function(t){for(var e=0;e<this.focusable_parts.length;e++){var i=this.focusable_parts[e];if(t==i.part.name)return i}return null},PathField.prototype.setParam=function(t,e){this.values[t]!=e&&(this.values[t]=e,this.emit("changeParams",this.values),this.performSearch())},PathField.prototype.performSearch=function(){if(!this.hasSelection()){var t=decodeURI(this.value.toString(this.values));this.last_query!==t&&(this.last_query=t,this.cancel_search(),this.cancel_search=this.search(t))}},PathField.prototype.requery=function(){this.last_query=null,this.performSearch()},PathField.prototype.getParam=function(t){return this.values[t]||""},PathField.prototype.onSearch=function(){this.hasSelection()&&this.reset(),this.focus()},PathField.prototype.onResults=function(t,e){this.lookupPane.displayResults(e)},PathField.prototype.focus=function(t){t||(t=this.focusable_parts[0]),t?$(t.node).focus():this.node.find(this.options.submit).focus()},PathField.prototype.updateRange=function(t,e){var i=document.createRange(),o=window.getSelection(),s=this.getParam(t.name);""===s?i.setStart(e,0):i.setStartAfter(e.firstChild),o.removeAllRanges(),o.addRange(i)},PathField.prototype.onKeydown=function(t){var e=this.hasSelection();if(13==t.which&&!e&&this.lookupPane.selectCurrent())return t.preventDefault(),!1},PathField.prototype.detectActive=function(t){var e=this.node.find(this.options.submit),i=this.options.activeClass;if((13==t.which||32==t.which)&&"keydown"==t.type){if(t.stopPropagation(),!this.hasPath())return;e.addClass(i),setTimeout(function(){e.removeClass(i)},100)}},PathField.prototype.onSubmitKeypress=function(t){if(13==t.which||32==t.which)return t.stopPropagation(),this.buildPath(),!1},PathField.prototype.onFocusPart=function(t,e){clearTimeout(this.blur_timeout),this.hasSelection()||(this.performSearch(),this.lookupPane.show()),this.updateRange(t,e)},PathField.prototype.onBlurPart=function(t,e){var i=this;this.blur_timeout=setTimeout(function(){i.hasSelection()||i.lookupPane.hide()},10)},module.exports=PathField;

},{"./component":8,"./lookup_pane":13,"fn":23,"util":30}],17:[function(require,module,exports){
var Component=require("./component"),$=Component.$,ListComponent=require("./list_component"),OptionSelector=require("./option_selector"),fn=require("fn"),ReferencePanel=Component.extend({openClass:"open",browserClass:"browser",history:[],search_url:null,filter:function(){return arguments[0]},onSelect:function(){},onLoadVersions:function(){},onLoadEndpoints:function(){},init:function(e,t){this.onSearch=this.search.bind(this),this.onReference=this.partitionedEndpoints.bind(this),this.groupsList=new ListComponent({tabindex:"1",className:"groups",itemTemplate:function(e){return $("<li></li>").append($("<span></span>").text(e))}}),this.endpointsList=new ListComponent({tabindex:"1",className:"endpoints",itemTemplate:function(e){return $("<li></li>").append($("<span></span>").text(e.method+" "+(e.path_labeled||"?")).addClass("path")).append($("<span></span>").text(e.description).addClass("description"))}}),this.groupOption=new OptionSelector({defaultValue:"all"}),this.versionOption=new OptionSelector(this.options.versionSelector,{tabIndex:"2",label:function(e){return"v"+e},optionLabel:function(e){return"v"+e}}),this.header=$("<header></header>").appendTo(this.node),this.browser=$("<div></div>").addClass(this.options.browserClass).appendTo(this.node),this.header.append($("<h2></h2>").text("API Reference")).append($("<div></div>").append($("<span></span>").text("Group")).append(this.groupOption.node)),this.groupOption.on("change",this.updateEndpoints.bind(this)),this.endpointsList.on("select",this.updateDetail.bind(this)),this.endpointsList.on("submit",this.selectEndpoint.bind(this)),this.endpointsList.node.appendTo($("<div></div>").appendTo(this.browser)),this.detail=$("<div></div>").appendTo(this.browser),this.node.addClass(this.options.openClass),this.versionOption.on("change",function(e){this.loadingEndpoints=!0,this.options.onLoadEndpoints(e,fn.arglock(this.onIndex,e).bind(this))}.bind(this)),this.versionOption.node.hide(),this.ranker=new Worker(this.options.search_url||"search.js"),this.ranker.onmessage=function(e){console.log("Results",e.data.ms),this.onRanking(e.data.results)}.bind(this)},onChange:function(e,t){var n=[],i={},o=this.getEndpoints();_.each(o,function(e,t){var o=e.namespace||"";n.indexOf(o)===-1&&n.push(o),i[o]||(i[o]={}),i[o][t]=e}),n.sort(function(e,t){var n=e.toLowerCase(),i=t.toLowerCase();return n==i?0:n<i?-1:1}),n.unshift("all"),i.all=o,this.groups=n,this.group_endpoints=i,this.groupOption.setOptions(n),this.groupsList.setValue(n),this.endpointsList.setValue(o)}});ReferencePanel.prototype.load=function(){this.options.onLoadVersions(this.onVersions.bind(this))},ReferencePanel.prototype.refresh=function(){var e=this.getValue();this.reset(),this.setValue(e)},ReferencePanel.prototype.toggle=function(){this.node.toggleClass(this.options.openClass),this.node.hasClass(this.options.openClass)?this.onOpen():this.onClose()},ReferencePanel.prototype.isOpen=function(){return this.node.hasClass(this.options.openClass)},ReferencePanel.prototype.close=function(){this.isOpen()&&this.toggle()},ReferencePanel.prototype.open=function(){this.isOpen()||this.toggle()},ReferencePanel.prototype.onOpen=function(){this.groupsList.enable(),this.endpointsList.enable(),this.endpointsList.node.focus()},ReferencePanel.prototype.onClose=function(){this.groupsList.disable(),this.endpointsList.disable()},ReferencePanel.prototype.getEndpoints=function(){return this.options.filter(this.getValue())},ReferencePanel.prototype.partitionedEndpoints=function(){var e=[],t=this.groups||[],n=this.group_endpoints;return $.each(t,function(t,i){"all"!=i&&(e.push(i),_.each(n[i],function(t,n){t.methods.forEach(function(t){var i={method:t,version:"2",path_labeled:n,description:""};e.push(i)})}))}),this.options.history.length>0&&(e=[{history:!0,label:"Recent"}].concat(this.options.history).concat(e)),e},ReferencePanel.prototype.updateEndpoints=function(e){var t=this.group_endpoints[e];this.endpointsList.setValue(t)},ReferencePanel.prototype.updateDetail=function(e){this.detail.children().remove(),$("<pre></pre>").appendTo(this.detail).text(JSON.stringify(e,null,"  "))},ReferencePanel.prototype.search=function(e,t){return this.loadingEndpoints?(t(this.partitionedEndpoints().concat([{loading:!0}])),void(this.onLoadingComplete=fn.arglock(this.search,e,t).bind(this))):(delete this.onLoadingComplete,""===e||null===e?void t(this.partitionedEndpoints()):(this.ranker.postMessage({query:e,index:this.getEndpoints()}),void(this.onRanking=t)))},ReferencePanel.prototype.selectEndpoint=function(e){this.options.onSelect(e)},ReferencePanel.prototype.onVersions=function(e,t,n){this.versionOption.disable(),this.versionOption.setOptions(t),this.versionOption.enable(),this.versionOption.setValue(n),this.versionOption.node.toggle(t.length>1)},ReferencePanel.prototype.onIndex=function(e,t,n){this.setValue(n.routes),this.loadingEndpoints=!1,this.onLoadingComplete&&this.onLoadingComplete()},ReferencePanel.prototype.setHistory=function(e){this.options.history=e},ReferencePanel.prototype.addHistory=function(e){this.options.history||(this.options.history=[]),this.options.history=this.options.history.filter(function(t){return!(t.path_labeled==e.path_labeled&&t.method==e.method)}).slice(0,10),this.options.history.unshift(e),this.emit("history",this.options.history)},module.exports=ReferencePanel;

},{"./component":8,"./list_component":12,"./option_selector":14,"fn":23}],18:[function(require,module,exports){
var Component=require("./component"),querystring=require("querystring"),$=Component.$,RequestHeader=Component.extend({element:"header",init:function(){this.node.append("<code></code><code></code>");var e=this.node.find("code");this.method=e.eq(0),this.path=e.eq(1)},onChange:function(e){this.method.text(e.method||"GET"),this.path.text(e.path);var t=$.isPlainObject(e.query)?querystring.stringify(e.query):e.query;t&&""!==t&&this.path.append($("<em></em>").text("?"+t))}});module.exports=RequestHeader;

},{"./component":8,"querystring":27}],19:[function(require,module,exports){
function ts(){return(new Date).getTime()}var Component=require("./component"),$=Component.$,RequestHeader=require("./request_header"),JsonBrowser=require("./json_browser"),fn=require("fn"),util=require("./util"),RequestViewer=Component.extend({container:"#requests",downloadLabel:"Download",loadingClass:"loading",completeClass:"complete",className:"log",errorClass:"request-error",init:function(){this.container=$(this.options.container),this.header=new RequestHeader,this.disclosure=$("<div></div>"),this.node.append($("<div></div>").append(this.header.node).add(this.disclosure)),this.node.prependTo(this.container),this.onResponse=this.onResponse.bind(this)},onChange:function(e){this.header.setValue(e)}});RequestViewer.prototype.sent=function(){this.start_time=ts(),this.node.addClass(this.options.loadingClass),this.disclosure.append($('<div class="throbber"><div></div></div>'))},RequestViewer.prototype.onResponse=function(e,t){var s=$("<span></span>").appendTo(this.header.node);this.response=t,this.responseError=e,this.node.removeClass(this.options.loadingClass).addClass(this.options.completeClass),this.end_time=ts(),this.ellapsed=this.end_time-this.start_time;var i=null;if(e?(this.node.addClass(this.options.errorClass),"abort"!==e.errorType?s.text(e.status+" – "+e.error):s.text("Client Error"),i=e.body):(s.text(this.ellapsed+"ms"),i=t),this.disclosure.children().remove(),i){var o=$("<a></a>").attr("title",this.options.downloadLabel).attr("href","data:application/json;charset=UTF-8,"+encodeURIComponent(JSON.stringify(i,null,"\t"))).attr("download",this.getDownloadFileName()).attr("target","_blank"),n=new JsonBrowser;this.disclosure.append(o),n.setValue(i),$("<div></div>").append(n.node).addClass("body").appendTo(this.header.node.parent())}this.emit("response",e,t)},RequestViewer.prototype.stringify=util.stringifyJson,RequestViewer.prototype.getDownloadFileName=function(){var e=this.getValue().path;return 0===e.indexOf("/")&&(e=e.slice(1)),e.replace(/\//g,"-")+".json"},RequestViewer.prototype.onKeydown=function(e){var t=!1;if(74==e.which||40==e.which?(t=!0,this.node.next().focus()):75==e.which||38==e.which?(t=!0,this.node.prev().focus()):13!=e.which&&32!=e.which&&39!=e.which||(t=!0,this.emit("open",this)),t)return e.preventDefault(),!1},RequestViewer.prototype.onClick=function(e){if(!$(e.target).is("a[download]"))return e.preventDefault(),this.emit("open",this),!1},module.exports=RequestViewer;

},{"./component":8,"./json_browser":11,"./request_header":18,"./util":21,"fn":23}],20:[function(require,module,exports){
var Component=require("./component"),$=Component.$,fn=require("fn"),Tip=Component.extend({opacity:"0.9",init:function(){this.header=this.node.find("header"),this.name=this.header.find("code"),this.type=this.header.find("em"),this.anchor=this.node.find(".anchor"),this.cancel=function(){},this.cancelResize=function(){},this.contextBlurListener=this.onBlur.bind(this),this.resizeListener=this.onResize.bind(this),this.positionDelayed=fn.rateLimit(200,this.positionTip.bind(this)),this.redisplay=fn.rateLimit(100,this.redisplayTip.bind(this)),$(window).on("resize",this.resizeListener),this.hide()},onChange:function(t,i){return this.currentContext&&this.currentContext.off("blur",this.contextBlurListener),t?(this.name.text(t.name),this.type.text(t.type),this.displayDescription(t.description),void(t.context&&(this.currentContext=t.context,this.cancel(),this.cancel=this.positionDelayed(t.context,t.position),t.context.one("blur",this.contextBlurListener)))):(this.cancel(),void this.hide())}});Tip.prototype.redisplayTip=function(){if(this.value){var t=this.value.context||null;t&&this.options.onChange.call(this,this.value)}},Tip.prototype.positionTip=function(t,i,e){var o,n=t.offset(),s=$("body"),h={},p={},a=!1;switch(e=e||[],i=i||"right",this.node.hide(),limit={width:s.width(),height:s.height()},this.node.css({opacity:"0",visibility:"hidden",left:0,top:0,width:null}).show(),o=this.node.offset(),this.node.css({width:o.width}),i){case"above":h={top:n.top-o.height-8,left:n.left},p={top:o.height,left:16};break;case"below":h={top:n.top+n.height+8,left:n.left},p={top:0,left:16};break;case"right":h={top:n.top,left:n.width+n.left+8},p={top:16,left:0};break;case"left":h={top:n.top,left:n.left-o.width-8},p={top:16,left:o.width}}switch(this.anchor.css(p),this.node.css(h),o=this.node.offset(),o.right=o.left+o.width,o.bottom=o.top+o.height,i){case"below":o.bottom>limit.height&&(a="right");break;case"above":o.top<0&&(a="left");break;case"left":o.left<0&&(a="below");break;case"right":o.right>limit.width&&(a="above")}if(a!==!1&&e.indexOf(a)===-1)return void this.positionTip(t,a,e.concat(i));var r,d;o.right>limit.width-8&&(r=limit.width-o.width-8,d=r-o.left,this.node.css("left",r),this.anchor.css({left:p.left-d})),o.bottom>limit.height-8&&(r=Math.max(8,limit.height-o.height-8),d=r-o.top,this.node.css("top",r),this.anchor.css("top",p.top-d)),this.node.css({visibility:"visible",opacity:this.options.opacity})},Tip.prototype.displayDescription=function(t){var i=this.node.find("ul"),e=$();if(i.find("li").remove(),!Component.$.isPlainObject(t))return void this.formatDescription(t).appendTo(i);for(var o in t)e=e.add(this.formatDescription(o,t[o]));i.append(e)},Tip.prototype.onResize=function(){this.cancel(),this.node.hide(),this.cancelResize(),this.cancelResize=this.redisplay()},Tip.prototype.onBlur=function(){this.hide()},Tip.prototype.formatDescription=function(t,i){var e=$("<li></li>"),o="(default)",n="Optional.";return i?e.append($("<code></code>").text(t)).append(" – "):i=t,i?(0===i.indexOf(o)&&(e.append($("<em></em>").text("Default")),i=i.slice(o.length),""!==i.trim()&&e.append(" – ")),0===i.indexOf(n)&&(e.append($("<em></em>").text("Optional")).append(" – "),i=i.slice(n.length)),e.append($("<span></span>").text(i))):e},Tip.prototype.hide=function(){this.value=null,this.cancel(),this.node.hide()},module.exports=Tip;

},{"./component":8,"fn":23}],21:[function(require,module,exports){
function stringifyJson(e,n){if(n||(n=$("<code></code>").addClass("compact")),$.isPlainObject(e)){n.append("{");var p="";for(var a in e)if(n.append(p),p=", ",n.append($("<span></span>").addClass("key").text('"'+a+'"')).append(": "),stringifyJson(e[a],n),n.text().length>200)return n.append(" …}"),n;n.last().remove(),n.append("}")}else if($.isArray(e)){n.append("[");for(var s=0;s<e.length;s++)if(s>0&&n.append(", "),stringifyJson(e[s],n),n.text().length>200)return n.append(" …]"),n;n.append("]")}else"string"==typeof e?n.append($("<span></span>").addClass("string").text('"'+e.replace(/"/g,'\\"')+'"')):n.append($("<span></span>").addClass(typeof e).text(e));return n}var $=require("zepto-browserify").$;module.exports={stringifyJson:stringifyJson};

},{"zepto-browserify":31}],22:[function(require,module,exports){
// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.

function EventEmitter() {
  this._events = this._events || {};
  this._maxListeners = this._maxListeners || undefined;
}
module.exports = EventEmitter;

// Backwards-compat with node 0.10.x
EventEmitter.EventEmitter = EventEmitter;

EventEmitter.prototype._events = undefined;
EventEmitter.prototype._maxListeners = undefined;

// By default EventEmitters will print a warning if more than 10 listeners are
// added to it. This is a useful default which helps finding memory leaks.
EventEmitter.defaultMaxListeners = 10;

// Obviously not all Emitters should be limited to 10. This function allows
// that to be increased. Set to zero for unlimited.
EventEmitter.prototype.setMaxListeners = function(n) {
  if (!isNumber(n) || n < 0 || isNaN(n))
    throw TypeError('n must be a positive number');
  this._maxListeners = n;
  return this;
};

EventEmitter.prototype.emit = function(type) {
  var er, handler, len, args, i, listeners;

  if (!this._events)
    this._events = {};

  // If there is no 'error' event listener then throw.
  if (type === 'error') {
    if (!this._events.error ||
        (isObject(this._events.error) && !this._events.error.length)) {
      er = arguments[1];
      if (er instanceof Error) {
        throw er; // Unhandled 'error' event
      }
      throw TypeError('Uncaught, unspecified "error" event.');
    }
  }

  handler = this._events[type];

  if (isUndefined(handler))
    return false;

  if (isFunction(handler)) {
    switch (arguments.length) {
      // fast cases
      case 1:
        handler.call(this);
        break;
      case 2:
        handler.call(this, arguments[1]);
        break;
      case 3:
        handler.call(this, arguments[1], arguments[2]);
        break;
      // slower
      default:
        len = arguments.length;
        args = new Array(len - 1);
        for (i = 1; i < len; i++)
          args[i - 1] = arguments[i];
        handler.apply(this, args);
    }
  } else if (isObject(handler)) {
    len = arguments.length;
    args = new Array(len - 1);
    for (i = 1; i < len; i++)
      args[i - 1] = arguments[i];

    listeners = handler.slice();
    len = listeners.length;
    for (i = 0; i < len; i++)
      listeners[i].apply(this, args);
  }

  return true;
};

EventEmitter.prototype.addListener = function(type, listener) {
  var m;

  if (!isFunction(listener))
    throw TypeError('listener must be a function');

  if (!this._events)
    this._events = {};

  // To avoid recursion in the case that type === "newListener"! Before
  // adding it to the listeners, first emit "newListener".
  if (this._events.newListener)
    this.emit('newListener', type,
              isFunction(listener.listener) ?
              listener.listener : listener);

  if (!this._events[type])
    // Optimize the case of one listener. Don't need the extra array object.
    this._events[type] = listener;
  else if (isObject(this._events[type]))
    // If we've already got an array, just append.
    this._events[type].push(listener);
  else
    // Adding the second element, need to change to array.
    this._events[type] = [this._events[type], listener];

  // Check for listener leak
  if (isObject(this._events[type]) && !this._events[type].warned) {
    var m;
    if (!isUndefined(this._maxListeners)) {
      m = this._maxListeners;
    } else {
      m = EventEmitter.defaultMaxListeners;
    }

    if (m && m > 0 && this._events[type].length > m) {
      this._events[type].warned = true;
      console.error('(node) warning: possible EventEmitter memory ' +
                    'leak detected. %d listeners added. ' +
                    'Use emitter.setMaxListeners() to increase limit.',
                    this._events[type].length);
      if (typeof console.trace === 'function') {
        // not supported in IE 10
        console.trace();
      }
    }
  }

  return this;
};

EventEmitter.prototype.on = EventEmitter.prototype.addListener;

EventEmitter.prototype.once = function(type, listener) {
  if (!isFunction(listener))
    throw TypeError('listener must be a function');

  var fired = false;

  function g() {
    this.removeListener(type, g);

    if (!fired) {
      fired = true;
      listener.apply(this, arguments);
    }
  }

  g.listener = listener;
  this.on(type, g);

  return this;
};

// emits a 'removeListener' event iff the listener was removed
EventEmitter.prototype.removeListener = function(type, listener) {
  var list, position, length, i;

  if (!isFunction(listener))
    throw TypeError('listener must be a function');

  if (!this._events || !this._events[type])
    return this;

  list = this._events[type];
  length = list.length;
  position = -1;

  if (list === listener ||
      (isFunction(list.listener) && list.listener === listener)) {
    delete this._events[type];
    if (this._events.removeListener)
      this.emit('removeListener', type, listener);

  } else if (isObject(list)) {
    for (i = length; i-- > 0;) {
      if (list[i] === listener ||
          (list[i].listener && list[i].listener === listener)) {
        position = i;
        break;
      }
    }

    if (position < 0)
      return this;

    if (list.length === 1) {
      list.length = 0;
      delete this._events[type];
    } else {
      list.splice(position, 1);
    }

    if (this._events.removeListener)
      this.emit('removeListener', type, listener);
  }

  return this;
};

EventEmitter.prototype.removeAllListeners = function(type) {
  var key, listeners;

  if (!this._events)
    return this;

  // not listening for removeListener, no need to emit
  if (!this._events.removeListener) {
    if (arguments.length === 0)
      this._events = {};
    else if (this._events[type])
      delete this._events[type];
    return this;
  }

  // emit removeListener for all listeners on all events
  if (arguments.length === 0) {
    for (key in this._events) {
      if (key === 'removeListener') continue;
      this.removeAllListeners(key);
    }
    this.removeAllListeners('removeListener');
    this._events = {};
    return this;
  }

  listeners = this._events[type];

  if (isFunction(listeners)) {
    this.removeListener(type, listeners);
  } else {
    // LIFO order
    while (listeners.length)
      this.removeListener(type, listeners[listeners.length - 1]);
  }
  delete this._events[type];

  return this;
};

EventEmitter.prototype.listeners = function(type) {
  var ret;
  if (!this._events || !this._events[type])
    ret = [];
  else if (isFunction(this._events[type]))
    ret = [this._events[type]];
  else
    ret = this._events[type].slice();
  return ret;
};

EventEmitter.listenerCount = function(emitter, type) {
  var ret;
  if (!emitter._events || !emitter._events[type])
    ret = 0;
  else if (isFunction(emitter._events[type]))
    ret = 1;
  else
    ret = emitter._events[type].length;
  return ret;
};

function isFunction(arg) {
  return typeof arg === 'function';
}

function isNumber(arg) {
  return typeof arg === 'number';
}

function isObject(arg) {
  return typeof arg === 'object' && arg !== null;
}

function isUndefined(arg) {
  return arg === void 0;
}

},{}],23:[function(require,module,exports){

module.exports = {
  arglock: arglock,
  when: when,
  counts: counts,
  debounce: debounce,
  times: times,
  rateLimit: rateLimit
};

/****************************

when(check, fn, args ...)

returns a function that will only be called when `check()` returns true.
Additional argrument are used in the returned function.

check - function to determine if `fn` should be called
fn - function to be called if `check` returns true
args - arguments to be used when `fn` is called

returns function

Example

    var doLog = false;
        toggle = function() { doLog = !doLog; return doLog; };
        logEveryOther = fn.when(toggle, console.log.bind(console), 'Hello World');

logEveryOther('boom');

// => 'Hello World', 'boom'

logEveryOther('bam');

// < silence >

logEveryOther('foo', 'bar');

// => 'Hello World', 'foo', 'bar'


*****************************/
function when(check, fn){

  var args = [].slice.call(arguments, 2);

  return function(){
    if (check()) return fn.apply(this, args.concat([].slice.call(arguments)));
  };

}

/****************************
debounce(every, fn, args ...)

Perform a function every `n` times. Additional arguments are applied to `fn` when called. 

every - number of times to call function before firing `fn`
fn - function to be called after `every` n times.
args - additinal args to be applied to `fn` when called

Example:

  var logEvery4 = fn.debounce(5, console.log.bind(console), "Log!");

  logEvery4('Hi');
  => < silence > 
  
  logEvery4('Hi');
  => < silence > 
  
  logEvery4('Hi');
  => < silence > 
  
  logEvery4('Hi');
  => "Log!", "Hi"

****************************/
function debounce(every, fn){

  var args = [].slice.call(arguments, 2),
      count = 0,
      debouncer = function(){
        count ++;
        return count % every === 0;
      };

  return when.apply(this, [debouncer, fn].concat(args));
}

/****************************
counts(times, fn, args ...)

Returned function will execute a maximum of `times`.

times - number of times `fn` can be executed
fn - function to be called
args - applied to `fn` when called

Example:

  var log = fn.counts(2, console.log.bind(console), 'Hello');

  log('World!);
  // => 'Hello', 'World!'
  
  log('Everyone');
  // => 'Hello', 'Everyone'
  
  log('World!);
  // => <silence>
  
****************************/
function counts(times, fn){

  var args = [].slice.call(arguments, 2),
    count = 0,
    counter = function(){
      if (count == times) return true;
      count ++;
      return false;
    };

  return when.apply(this, [counter, fn].concat(args));

}

/***************************
arglock(fn, args ...)

Returns function that will have `args` applied when called.

Example:

  var log = fn.arglock(console.log.bind(console), 'Test');

  log('1');
  => 'Test', '1'

***************************/
function arglock(){
  var slice = [].slice,
      args = slice.apply(arguments);

  if (args.length === 0 || typeof(args[0]) != 'function') throw new Error("first argument must be a function");

  var fn = args.shift();

  return function(){
    return fn.apply(this, args.concat(slice.apply(arguments)));
  };
}

/***************************
times(count, fn, args ...)

Returns a function that will execute `fn` `count` times with `args` applied.

count - number fo times to call `fn`
fn - callback to be execuited
args - arguments to be applied to `fn` when called

Example:

  var log = fn.times(3, console.log.bind(console), 'Hello');

  log('World!);
  => 'Hello', 'World!'
  => 'Hello', 'World!'
  => 'Hello', 'World!'


***************************/
function times(count, fn){

  var args = [].slice.call(arguments, 2),
      multiplied = function(){
        var results = [];
        for (var i = 0; i < count; i++) {
          results.push(fn.apply(this, args));
        }
        return results;
      };

  return multiplied;

}

/**************************
rateLimit(wait, fn, args);

Returns a function that will only execute `fn` after waiting `wait` milliseconds
since the last time called.

wait - number of milliseconds to wait
fn - function to call after waiting `wait` milliseconds
args - arguments to apply to `fn` when called

returns function - sets timeout when called that waits `wait` milliseconds to call `fn` and 
        returns a function that cancels the timeout when called.

Example:

  var log = fn.rateLimit(100, console.log.bind(console), 'Hello'),
      cancel = log('World!');
  
  // after 100 ms unless `cancel` is called
  // => 'Hello', 'World!'


**************************/
function rateLimit(wait, fn) {

  var clear,
      limited = function() {
        if (clear) clear();

        var args = arguments,
        timeoutId = setTimeout(function(){
          fn.apply(this, args);
        }, wait);

        clear = function() {
          clearTimeout(timeoutId);
        };

        return clear;

      };

  return limited;

}
},{}],24:[function(require,module,exports){
// shim for using process in browser
var process = module.exports = {};

// cached from whatever global is present so that test runners that stub it
// don't break things.  But we need to wrap it in a try catch in case it is
// wrapped in strict mode code which doesn't define any globals.  It's inside a
// function because try/catches deoptimize in certain engines.

var cachedSetTimeout;
var cachedClearTimeout;

function defaultSetTimout() {
    throw new Error('setTimeout has not been defined');
}
function defaultClearTimeout () {
    throw new Error('clearTimeout has not been defined');
}
(function () {
    try {
        if (typeof setTimeout === 'function') {
            cachedSetTimeout = setTimeout;
        } else {
            cachedSetTimeout = defaultSetTimout;
        }
    } catch (e) {
        cachedSetTimeout = defaultSetTimout;
    }
    try {
        if (typeof clearTimeout === 'function') {
            cachedClearTimeout = clearTimeout;
        } else {
            cachedClearTimeout = defaultClearTimeout;
        }
    } catch (e) {
        cachedClearTimeout = defaultClearTimeout;
    }
} ())
function runTimeout(fun) {
    if (cachedSetTimeout === setTimeout) {
        //normal enviroments in sane situations
        return setTimeout(fun, 0);
    }
    // if setTimeout wasn't available but was latter defined
    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {
        cachedSetTimeout = setTimeout;
        return setTimeout(fun, 0);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedSetTimeout(fun, 0);
    } catch(e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally
            return cachedSetTimeout.call(null, fun, 0);
        } catch(e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error
            return cachedSetTimeout.call(this, fun, 0);
        }
    }


}
function runClearTimeout(marker) {
    if (cachedClearTimeout === clearTimeout) {
        //normal enviroments in sane situations
        return clearTimeout(marker);
    }
    // if clearTimeout wasn't available but was latter defined
    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {
        cachedClearTimeout = clearTimeout;
        return clearTimeout(marker);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedClearTimeout(marker);
    } catch (e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally
            return cachedClearTimeout.call(null, marker);
        } catch (e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.
            // Some versions of I.E. have different rules for clearTimeout vs setTimeout
            return cachedClearTimeout.call(this, marker);
        }
    }



}
var queue = [];
var draining = false;
var currentQueue;
var queueIndex = -1;

function cleanUpNextTick() {
    if (!draining || !currentQueue) {
        return;
    }
    draining = false;
    if (currentQueue.length) {
        queue = currentQueue.concat(queue);
    } else {
        queueIndex = -1;
    }
    if (queue.length) {
        drainQueue();
    }
}

function drainQueue() {
    if (draining) {
        return;
    }
    var timeout = runTimeout(cleanUpNextTick);
    draining = true;

    var len = queue.length;
    while(len) {
        currentQueue = queue;
        queue = [];
        while (++queueIndex < len) {
            if (currentQueue) {
                currentQueue[queueIndex].run();
            }
        }
        queueIndex = -1;
        len = queue.length;
    }
    currentQueue = null;
    draining = false;
    runClearTimeout(timeout);
}

process.nextTick = function (fun) {
    var args = new Array(arguments.length - 1);
    if (arguments.length > 1) {
        for (var i = 1; i < arguments.length; i++) {
            args[i - 1] = arguments[i];
        }
    }
    queue.push(new Item(fun, args));
    if (queue.length === 1 && !draining) {
        runTimeout(drainQueue);
    }
};

// v8 likes predictible objects
function Item(fun, array) {
    this.fun = fun;
    this.array = array;
}
Item.prototype.run = function () {
    this.fun.apply(null, this.array);
};
process.title = 'browser';
process.browser = true;
process.env = {};
process.argv = [];
process.version = ''; // empty string to avoid regexp issues
process.versions = {};

function noop() {}

process.on = noop;
process.addListener = noop;
process.once = noop;
process.off = noop;
process.removeListener = noop;
process.removeAllListeners = noop;
process.emit = noop;

process.binding = function (name) {
    throw new Error('process.binding is not supported');
};

process.cwd = function () { return '/' };
process.chdir = function (dir) {
    throw new Error('process.chdir is not supported');
};
process.umask = function() { return 0; };

},{}],25:[function(require,module,exports){
// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.

'use strict';

// If obj.hasOwnProperty has been overridden, then calling
// obj.hasOwnProperty(prop) will break.
// See: https://github.com/joyent/node/issues/1707
function hasOwnProperty(obj, prop) {
  return Object.prototype.hasOwnProperty.call(obj, prop);
}

module.exports = function(qs, sep, eq, options) {
  sep = sep || '&';
  eq = eq || '=';
  var obj = {};

  if (typeof qs !== 'string' || qs.length === 0) {
    return obj;
  }

  var regexp = /\+/g;
  qs = qs.split(sep);

  var maxKeys = 1000;
  if (options && typeof options.maxKeys === 'number') {
    maxKeys = options.maxKeys;
  }

  var len = qs.length;
  // maxKeys <= 0 means that we should not limit keys count
  if (maxKeys > 0 && len > maxKeys) {
    len = maxKeys;
  }

  for (var i = 0; i < len; ++i) {
    var x = qs[i].replace(regexp, '%20'),
        idx = x.indexOf(eq),
        kstr, vstr, k, v;

    if (idx >= 0) {
      kstr = x.substr(0, idx);
      vstr = x.substr(idx + 1);
    } else {
      kstr = x;
      vstr = '';
    }

    k = decodeURIComponent(kstr);
    v = decodeURIComponent(vstr);

    if (!hasOwnProperty(obj, k)) {
      obj[k] = v;
    } else if (isArray(obj[k])) {
      obj[k].push(v);
    } else {
      obj[k] = [obj[k], v];
    }
  }

  return obj;
};

var isArray = Array.isArray || function (xs) {
  return Object.prototype.toString.call(xs) === '[object Array]';
};

},{}],26:[function(require,module,exports){
// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.

'use strict';

var stringifyPrimitive = function(v) {
  switch (typeof v) {
    case 'string':
      return v;

    case 'boolean':
      return v ? 'true' : 'false';

    case 'number':
      return isFinite(v) ? v : '';

    default:
      return '';
  }
};

module.exports = function(obj, sep, eq, name) {
  sep = sep || '&';
  eq = eq || '=';
  if (obj === null) {
    obj = undefined;
  }

  if (typeof obj === 'object') {
    return map(objectKeys(obj), function(k) {
      var ks = encodeURIComponent(stringifyPrimitive(k)) + eq;
      if (isArray(obj[k])) {
        return map(obj[k], function(v) {
          return ks + encodeURIComponent(stringifyPrimitive(v));
        }).join(sep);
      } else {
        return ks + encodeURIComponent(stringifyPrimitive(obj[k]));
      }
    }).join(sep);

  }

  if (!name) return '';
  return encodeURIComponent(stringifyPrimitive(name)) + eq +
         encodeURIComponent(stringifyPrimitive(obj));
};

var isArray = Array.isArray || function (xs) {
  return Object.prototype.toString.call(xs) === '[object Array]';
};

function map (xs, f) {
  if (xs.map) return xs.map(f);
  var res = [];
  for (var i = 0; i < xs.length; i++) {
    res.push(f(xs[i], i));
  }
  return res;
}

var objectKeys = Object.keys || function (obj) {
  var res = [];
  for (var key in obj) {
    if (Object.prototype.hasOwnProperty.call(obj, key)) res.push(key);
  }
  return res;
};

},{}],27:[function(require,module,exports){
'use strict';

exports.decode = exports.parse = require('./decode');
exports.encode = exports.stringify = require('./encode');

},{"./decode":25,"./encode":26}],28:[function(require,module,exports){
if (typeof Object.create === 'function') {
  // implementation from standard node.js 'util' module
  module.exports = function inherits(ctor, superCtor) {
    ctor.super_ = superCtor
    ctor.prototype = Object.create(superCtor.prototype, {
      constructor: {
        value: ctor,
        enumerable: false,
        writable: true,
        configurable: true
      }
    });
  };
} else {
  // old school shim for old browsers
  module.exports = function inherits(ctor, superCtor) {
    ctor.super_ = superCtor
    var TempCtor = function () {}
    TempCtor.prototype = superCtor.prototype
    ctor.prototype = new TempCtor()
    ctor.prototype.constructor = ctor
  }
}

},{}],29:[function(require,module,exports){
module.exports = function isBuffer(arg) {
  return arg && typeof arg === 'object'
    && typeof arg.copy === 'function'
    && typeof arg.fill === 'function'
    && typeof arg.readUInt8 === 'function';
}
},{}],30:[function(require,module,exports){
(function (process,global){
// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.

var formatRegExp = /%[sdj%]/g;
exports.format = function(f) {
  if (!isString(f)) {
    var objects = [];
    for (var i = 0; i < arguments.length; i++) {
      objects.push(inspect(arguments[i]));
    }
    return objects.join(' ');
  }

  var i = 1;
  var args = arguments;
  var len = args.length;
  var str = String(f).replace(formatRegExp, function(x) {
    if (x === '%%') return '%';
    if (i >= len) return x;
    switch (x) {
      case '%s': return String(args[i++]);
      case '%d': return Number(args[i++]);
      case '%j':
        try {
          return JSON.stringify(args[i++]);
        } catch (_) {
          return '[Circular]';
        }
      default:
        return x;
    }
  });
  for (var x = args[i]; i < len; x = args[++i]) {
    if (isNull(x) || !isObject(x)) {
      str += ' ' + x;
    } else {
      str += ' ' + inspect(x);
    }
  }
  return str;
};


// Mark that a method should not be used.
// Returns a modified function which warns once by default.
// If --no-deprecation is set, then it is a no-op.
exports.deprecate = function(fn, msg) {
  // Allow for deprecating things in the process of starting up.
  if (isUndefined(global.process)) {
    return function() {
      return exports.deprecate(fn, msg).apply(this, arguments);
    };
  }

  if (process.noDeprecation === true) {
    return fn;
  }

  var warned = false;
  function deprecated() {
    if (!warned) {
      if (process.throwDeprecation) {
        throw new Error(msg);
      } else if (process.traceDeprecation) {
        console.trace(msg);
      } else {
        console.error(msg);
      }
      warned = true;
    }
    return fn.apply(this, arguments);
  }

  return deprecated;
};


var debugs = {};
var debugEnviron;
exports.debuglog = function(set) {
  if (isUndefined(debugEnviron))
    debugEnviron = process.env.NODE_DEBUG || '';
  set = set.toUpperCase();
  if (!debugs[set]) {
    if (new RegExp('\\b' + set + '\\b', 'i').test(debugEnviron)) {
      var pid = process.pid;
      debugs[set] = function() {
        var msg = exports.format.apply(exports, arguments);
        console.error('%s %d: %s', set, pid, msg);
      };
    } else {
      debugs[set] = function() {};
    }
  }
  return debugs[set];
};


/**
 * Echos the value of a value. Trys to print the value out
 * in the best way possible given the different types.
 *
 * @param {Object} obj The object to print out.
 * @param {Object} opts Optional options object that alters the output.
 */
/* legacy: obj, showHidden, depth, colors*/
function inspect(obj, opts) {
  // default options
  var ctx = {
    seen: [],
    stylize: stylizeNoColor
  };
  // legacy...
  if (arguments.length >= 3) ctx.depth = arguments[2];
  if (arguments.length >= 4) ctx.colors = arguments[3];
  if (isBoolean(opts)) {
    // legacy...
    ctx.showHidden = opts;
  } else if (opts) {
    // got an "options" object
    exports._extend(ctx, opts);
  }
  // set default options
  if (isUndefined(ctx.showHidden)) ctx.showHidden = false;
  if (isUndefined(ctx.depth)) ctx.depth = 2;
  if (isUndefined(ctx.colors)) ctx.colors = false;
  if (isUndefined(ctx.customInspect)) ctx.customInspect = true;
  if (ctx.colors) ctx.stylize = stylizeWithColor;
  return formatValue(ctx, obj, ctx.depth);
}
exports.inspect = inspect;


// http://en.wikipedia.org/wiki/ANSI_escape_code#graphics
inspect.colors = {
  'bold' : [1, 22],
  'italic' : [3, 23],
  'underline' : [4, 24],
  'inverse' : [7, 27],
  'white' : [37, 39],
  'grey' : [90, 39],
  'black' : [30, 39],
  'blue' : [34, 39],
  'cyan' : [36, 39],
  'green' : [32, 39],
  'magenta' : [35, 39],
  'red' : [31, 39],
  'yellow' : [33, 39]
};

// Don't use 'blue' not visible on cmd.exe
inspect.styles = {
  'special': 'cyan',
  'number': 'yellow',
  'boolean': 'yellow',
  'undefined': 'grey',
  'null': 'bold',
  'string': 'green',
  'date': 'magenta',
  // "name": intentionally not styling
  'regexp': 'red'
};


function stylizeWithColor(str, styleType) {
  var style = inspect.styles[styleType];

  if (style) {
    return '\u001b[' + inspect.colors[style][0] + 'm' + str +
           '\u001b[' + inspect.colors[style][1] + 'm';
  } else {
    return str;
  }
}


function stylizeNoColor(str, styleType) {
  return str;
}


function arrayToHash(array) {
  var hash = {};

  array.forEach(function(val, idx) {
    hash[val] = true;
  });

  return hash;
}


function formatValue(ctx, value, recurseTimes) {
  // Provide a hook for user-specified inspect functions.
  // Check that value is an object with an inspect function on it
  if (ctx.customInspect &&
      value &&
      isFunction(value.inspect) &&
      // Filter out the util module, it's inspect function is special
      value.inspect !== exports.inspect &&
      // Also filter out any prototype objects using the circular check.
      !(value.constructor && value.constructor.prototype === value)) {
    var ret = value.inspect(recurseTimes, ctx);
    if (!isString(ret)) {
      ret = formatValue(ctx, ret, recurseTimes);
    }
    return ret;
  }

  // Primitive types cannot have properties
  var primitive = formatPrimitive(ctx, value);
  if (primitive) {
    return primitive;
  }

  // Look up the keys of the object.
  var keys = Object.keys(value);
  var visibleKeys = arrayToHash(keys);

  if (ctx.showHidden) {
    keys = Object.getOwnPropertyNames(value);
  }

  // IE doesn't make error fields non-enumerable
  // http://msdn.microsoft.com/en-us/library/ie/dww52sbt(v=vs.94).aspx
  if (isError(value)
      && (keys.indexOf('message') >= 0 || keys.indexOf('description') >= 0)) {
    return formatError(value);
  }

  // Some type of object without properties can be shortcutted.
  if (keys.length === 0) {
    if (isFunction(value)) {
      var name = value.name ? ': ' + value.name : '';
      return ctx.stylize('[Function' + name + ']', 'special');
    }
    if (isRegExp(value)) {
      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');
    }
    if (isDate(value)) {
      return ctx.stylize(Date.prototype.toString.call(value), 'date');
    }
    if (isError(value)) {
      return formatError(value);
    }
  }

  var base = '', array = false, braces = ['{', '}'];

  // Make Array say that they are Array
  if (isArray(value)) {
    array = true;
    braces = ['[', ']'];
  }

  // Make functions say that they are functions
  if (isFunction(value)) {
    var n = value.name ? ': ' + value.name : '';
    base = ' [Function' + n + ']';
  }

  // Make RegExps say that they are RegExps
  if (isRegExp(value)) {
    base = ' ' + RegExp.prototype.toString.call(value);
  }

  // Make dates with properties first say the date
  if (isDate(value)) {
    base = ' ' + Date.prototype.toUTCString.call(value);
  }

  // Make error with message first say the error
  if (isError(value)) {
    base = ' ' + formatError(value);
  }

  if (keys.length === 0 && (!array || value.length == 0)) {
    return braces[0] + base + braces[1];
  }

  if (recurseTimes < 0) {
    if (isRegExp(value)) {
      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');
    } else {
      return ctx.stylize('[Object]', 'special');
    }
  }

  ctx.seen.push(value);

  var output;
  if (array) {
    output = formatArray(ctx, value, recurseTimes, visibleKeys, keys);
  } else {
    output = keys.map(function(key) {
      return formatProperty(ctx, value, recurseTimes, visibleKeys, key, array);
    });
  }

  ctx.seen.pop();

  return reduceToSingleString(output, base, braces);
}


function formatPrimitive(ctx, value) {
  if (isUndefined(value))
    return ctx.stylize('undefined', 'undefined');
  if (isString(value)) {
    var simple = '\'' + JSON.stringify(value).replace(/^"|"$/g, '')
                                             .replace(/'/g, "\\'")
                                             .replace(/\\"/g, '"') + '\'';
    return ctx.stylize(simple, 'string');
  }
  if (isNumber(value))
    return ctx.stylize('' + value, 'number');
  if (isBoolean(value))
    return ctx.stylize('' + value, 'boolean');
  // For some reason typeof null is "object", so special case here.
  if (isNull(value))
    return ctx.stylize('null', 'null');
}


function formatError(value) {
  return '[' + Error.prototype.toString.call(value) + ']';
}


function formatArray(ctx, value, recurseTimes, visibleKeys, keys) {
  var output = [];
  for (var i = 0, l = value.length; i < l; ++i) {
    if (hasOwnProperty(value, String(i))) {
      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,
          String(i), true));
    } else {
      output.push('');
    }
  }
  keys.forEach(function(key) {
    if (!key.match(/^\d+$/)) {
      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,
          key, true));
    }
  });
  return output;
}


function formatProperty(ctx, value, recurseTimes, visibleKeys, key, array) {
  var name, str, desc;
  desc = Object.getOwnPropertyDescriptor(value, key) || { value: value[key] };
  if (desc.get) {
    if (desc.set) {
      str = ctx.stylize('[Getter/Setter]', 'special');
    } else {
      str = ctx.stylize('[Getter]', 'special');
    }
  } else {
    if (desc.set) {
      str = ctx.stylize('[Setter]', 'special');
    }
  }
  if (!hasOwnProperty(visibleKeys, key)) {
    name = '[' + key + ']';
  }
  if (!str) {
    if (ctx.seen.indexOf(desc.value) < 0) {
      if (isNull(recurseTimes)) {
        str = formatValue(ctx, desc.value, null);
      } else {
        str = formatValue(ctx, desc.value, recurseTimes - 1);
      }
      if (str.indexOf('\n') > -1) {
        if (array) {
          str = str.split('\n').map(function(line) {
            return '  ' + line;
          }).join('\n').substr(2);
        } else {
          str = '\n' + str.split('\n').map(function(line) {
            return '   ' + line;
          }).join('\n');
        }
      }
    } else {
      str = ctx.stylize('[Circular]', 'special');
    }
  }
  if (isUndefined(name)) {
    if (array && key.match(/^\d+$/)) {
      return str;
    }
    name = JSON.stringify('' + key);
    if (name.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)) {
      name = name.substr(1, name.length - 2);
      name = ctx.stylize(name, 'name');
    } else {
      name = name.replace(/'/g, "\\'")
                 .replace(/\\"/g, '"')
                 .replace(/(^"|"$)/g, "'");
      name = ctx.stylize(name, 'string');
    }
  }

  return name + ': ' + str;
}


function reduceToSingleString(output, base, braces) {
  var numLinesEst = 0;
  var length = output.reduce(function(prev, cur) {
    numLinesEst++;
    if (cur.indexOf('\n') >= 0) numLinesEst++;
    return prev + cur.replace(/\u001b\[\d\d?m/g, '').length + 1;
  }, 0);

  if (length > 60) {
    return braces[0] +
           (base === '' ? '' : base + '\n ') +
           ' ' +
           output.join(',\n  ') +
           ' ' +
           braces[1];
  }

  return braces[0] + base + ' ' + output.join(', ') + ' ' + braces[1];
}


// NOTE: These type checking functions intentionally don't use `instanceof`
// because it is fragile and can be easily faked with `Object.create()`.
function isArray(ar) {
  return Array.isArray(ar);
}
exports.isArray = isArray;

function isBoolean(arg) {
  return typeof arg === 'boolean';
}
exports.isBoolean = isBoolean;

function isNull(arg) {
  return arg === null;
}
exports.isNull = isNull;

function isNullOrUndefined(arg) {
  return arg == null;
}
exports.isNullOrUndefined = isNullOrUndefined;

function isNumber(arg) {
  return typeof arg === 'number';
}
exports.isNumber = isNumber;

function isString(arg) {
  return typeof arg === 'string';
}
exports.isString = isString;

function isSymbol(arg) {
  return typeof arg === 'symbol';
}
exports.isSymbol = isSymbol;

function isUndefined(arg) {
  return arg === void 0;
}
exports.isUndefined = isUndefined;

function isRegExp(re) {
  return isObject(re) && objectToString(re) === '[object RegExp]';
}
exports.isRegExp = isRegExp;

function isObject(arg) {
  return typeof arg === 'object' && arg !== null;
}
exports.isObject = isObject;

function isDate(d) {
  return isObject(d) && objectToString(d) === '[object Date]';
}
exports.isDate = isDate;

function isError(e) {
  return isObject(e) &&
      (objectToString(e) === '[object Error]' || e instanceof Error);
}
exports.isError = isError;

function isFunction(arg) {
  return typeof arg === 'function';
}
exports.isFunction = isFunction;

function isPrimitive(arg) {
  return arg === null ||
         typeof arg === 'boolean' ||
         typeof arg === 'number' ||
         typeof arg === 'string' ||
         typeof arg === 'symbol' ||  // ES6 symbol
         typeof arg === 'undefined';
}
exports.isPrimitive = isPrimitive;

exports.isBuffer = require('./support/isBuffer');

function objectToString(o) {
  return Object.prototype.toString.call(o);
}


function pad(n) {
  return n < 10 ? '0' + n.toString(10) : n.toString(10);
}


var months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep',
              'Oct', 'Nov', 'Dec'];

// 26 Feb 16:19:34
function timestamp() {
  var d = new Date();
  var time = [pad(d.getHours()),
              pad(d.getMinutes()),
              pad(d.getSeconds())].join(':');
  return [d.getDate(), months[d.getMonth()], time].join(' ');
}


// log is just a thin wrapper to console.log that prepends a timestamp
exports.log = function() {
  console.log('%s - %s', timestamp(), exports.format.apply(exports, arguments));
};


/**
 * Inherit the prototype methods from one constructor into another.
 *
 * The Function.prototype.inherits from lang.js rewritten as a standalone
 * function (not on Function.prototype). NOTE: If this file is to be loaded
 * during bootstrapping this function needs to be rewritten using some native
 * functions as prototype setup using normal JavaScript does not work as
 * expected during bootstrapping (see mirror.js in r114903).
 *
 * @param {function} ctor Constructor function which needs to inherit the
 *     prototype.
 * @param {function} superCtor Constructor function to inherit prototype from.
 */
exports.inherits = require('inherits');

exports._extend = function(origin, add) {
  // Don't do anything if add isn't an object
  if (!add || !isObject(add)) return origin;

  var keys = Object.keys(add);
  var i = keys.length;
  while (i--) {
    origin[keys[i]] = add[keys[i]];
  }
  return origin;
};

function hasOwnProperty(obj, prop) {
  return Object.prototype.hasOwnProperty.call(obj, prop);
}

}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./support/isBuffer":29,"_process":24,"inherits":28}],31:[function(require,module,exports){
/* Zepto v1.1.6 - zepto event ajax form ie - zeptojs.com/license */

var Zepto = (function() {
  var undefined, key, $, classList, emptyArray = [], slice = emptyArray.slice, filter = emptyArray.filter,
    document = window.document,
    elementDisplay = {}, classCache = {},
    cssNumber = { 'column-count': 1, 'columns': 1, 'font-weight': 1, 'line-height': 1,'opacity': 1, 'z-index': 1, 'zoom': 1 },
    fragmentRE = /^\s*<(\w+|!)[^>]*>/,
    singleTagRE = /^<(\w+)\s*\/?>(?:<\/\1>|)$/,
    tagExpanderRE = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,
    rootNodeRE = /^(?:body|html)$/i,
    capitalRE = /([A-Z])/g,

    // special attributes that should be get/set via method calls
    methodAttributes = ['val', 'css', 'html', 'text', 'data', 'width', 'height', 'offset'],

    adjacencyOperators = [ 'after', 'prepend', 'before', 'append' ],
    table = document.createElement('table'),
    tableRow = document.createElement('tr'),
    containers = {
      'tr': document.createElement('tbody'),
      'tbody': table, 'thead': table, 'tfoot': table,
      'td': tableRow, 'th': tableRow,
      '*': document.createElement('div')
    },
    readyRE = /complete|loaded|interactive/,
    simpleSelectorRE = /^[\w-]*$/,
    class2type = {},
    toString = class2type.toString,
    zepto = {},
    camelize, uniq,
    tempParent = document.createElement('div'),
    propMap = {
      'tabindex': 'tabIndex',
      'readonly': 'readOnly',
      'for': 'htmlFor',
      'class': 'className',
      'maxlength': 'maxLength',
      'cellspacing': 'cellSpacing',
      'cellpadding': 'cellPadding',
      'rowspan': 'rowSpan',
      'colspan': 'colSpan',
      'usemap': 'useMap',
      'frameborder': 'frameBorder',
      'contenteditable': 'contentEditable'
    },
    isArray = Array.isArray ||
      function(object){ return object instanceof Array }

  zepto.matches = function(element, selector) {
    if (!selector || !element || element.nodeType !== 1) return false
    var matchesSelector = element.webkitMatchesSelector || element.mozMatchesSelector ||
                          element.oMatchesSelector || element.matchesSelector
    if (matchesSelector) return matchesSelector.call(element, selector)
    // fall back to performing a selector:
    var match, parent = element.parentNode, temp = !parent
    if (temp) (parent = tempParent).appendChild(element)
    match = ~zepto.qsa(parent, selector).indexOf(element)
    temp && tempParent.removeChild(element)
    return match
  }

  function type(obj) {
    return obj == null ? String(obj) :
      class2type[toString.call(obj)] || "object"
  }

  function isFunction(value) { return type(value) == "function" }
  function isWindow(obj)     { return obj != null && obj == obj.window }
  function isDocument(obj)   { return obj != null && obj.nodeType == obj.DOCUMENT_NODE }
  function isObject(obj)     { return type(obj) == "object" }
  function isPlainObject(obj) {
    return isObject(obj) && !isWindow(obj) && Object.getPrototypeOf(obj) == Object.prototype
  }
  function likeArray(obj) { return typeof obj.length == 'number' }

  function compact(array) { return filter.call(array, function(item){ return item != null }) }
  function flatten(array) { return array.length > 0 ? $.fn.concat.apply([], array) : array }
  camelize = function(str){ return str.replace(/-+(.)?/g, function(match, chr){ return chr ? chr.toUpperCase() : '' }) }
  function dasherize(str) {
    return str.replace(/::/g, '/')
           .replace(/([A-Z]+)([A-Z][a-z])/g, '$1_$2')
           .replace(/([a-z\d])([A-Z])/g, '$1_$2')
           .replace(/_/g, '-')
           .toLowerCase()
  }
  uniq = function(array){ return filter.call(array, function(item, idx){ return array.indexOf(item) == idx }) }

  function classRE(name) {
    return name in classCache ?
      classCache[name] : (classCache[name] = new RegExp('(^|\\s)' + name + '(\\s|$)'))
  }

  function maybeAddPx(name, value) {
    return (typeof value == "number" && !cssNumber[dasherize(name)]) ? value + "px" : value
  }

  function defaultDisplay(nodeName) {
    var element, display
    if (!elementDisplay[nodeName]) {
      element = document.createElement(nodeName)
      document.body.appendChild(element)
      display = getComputedStyle(element, '').getPropertyValue("display")
      element.parentNode.removeChild(element)
      display == "none" && (display = "block")
      elementDisplay[nodeName] = display
    }
    return elementDisplay[nodeName]
  }

  function children(element) {
    return 'children' in element ?
      slice.call(element.children) :
      $.map(element.childNodes, function(node){ if (node.nodeType == 1) return node })
  }

  // `$.zepto.fragment` takes a html string and an optional tag name
  // to generate DOM nodes nodes from the given html string.
  // The generated DOM nodes are returned as an array.
  // This function can be overriden in plugins for example to make
  // it compatible with browsers that don't support the DOM fully.
  zepto.fragment = function(html, name, properties) {
    var dom, nodes, container

    // A special case optimization for a single tag
    if (singleTagRE.test(html)) dom = $(document.createElement(RegExp.$1))

    if (!dom) {
      if (html.replace) html = html.replace(tagExpanderRE, "<$1></$2>")
      if (name === undefined) name = fragmentRE.test(html) && RegExp.$1
      if (!(name in containers)) name = '*'

      container = containers[name]
      container.innerHTML = '' + html
      dom = $.each(slice.call(container.childNodes), function(){
        container.removeChild(this)
      })
    }

    if (isPlainObject(properties)) {
      nodes = $(dom)
      $.each(properties, function(key, value) {
        if (methodAttributes.indexOf(key) > -1) nodes[key](value)
        else nodes.attr(key, value)
      })
    }

    return dom
  }

  // `$.zepto.Z` swaps out the prototype of the given `dom` array
  // of nodes with `$.fn` and thus supplying all the Zepto functions
  // to the array. Note that `__proto__` is not supported on Internet
  // Explorer. This method can be overriden in plugins.
  zepto.Z = function(dom, selector) {
    dom = dom || []
    dom.__proto__ = $.fn
    dom.selector = selector || ''
    return dom
  }

  // `$.zepto.isZ` should return `true` if the given object is a Zepto
  // collection. This method can be overriden in plugins.
  zepto.isZ = function(object) {
    return object instanceof zepto.Z
  }

  // `$.zepto.init` is Zepto's counterpart to jQuery's `$.fn.init` and
  // takes a CSS selector and an optional context (and handles various
  // special cases).
  // This method can be overriden in plugins.
  zepto.init = function(selector, context) {
    var dom
    // If nothing given, return an empty Zepto collection
    if (!selector) return zepto.Z()
    // Optimize for string selectors
    else if (typeof selector == 'string') {
      selector = selector.trim()
      // If it's a html fragment, create nodes from it
      // Note: In both Chrome 21 and Firefox 15, DOM error 12
      // is thrown if the fragment doesn't begin with <
      if (selector[0] == '<' && fragmentRE.test(selector))
        dom = zepto.fragment(selector, RegExp.$1, context), selector = null
      // If there's a context, create a collection on that context first, and select
      // nodes from there
      else if (context !== undefined) return $(context).find(selector)
      // If it's a CSS selector, use it to select nodes.
      else dom = zepto.qsa(document, selector)
    }
    // If a function is given, call it when the DOM is ready
    else if (isFunction(selector)) return $(document).ready(selector)
    // If a Zepto collection is given, just return it
    else if (zepto.isZ(selector)) return selector
    else {
      // normalize array if an array of nodes is given
      if (isArray(selector)) dom = compact(selector)
      // Wrap DOM nodes.
      else if (isObject(selector))
        dom = [selector], selector = null
      // If it's a html fragment, create nodes from it
      else if (fragmentRE.test(selector))
        dom = zepto.fragment(selector.trim(), RegExp.$1, context), selector = null
      // If there's a context, create a collection on that context first, and select
      // nodes from there
      else if (context !== undefined) return $(context).find(selector)
      // And last but no least, if it's a CSS selector, use it to select nodes.
      else dom = zepto.qsa(document, selector)
    }
    // create a new Zepto collection from the nodes found
    return zepto.Z(dom, selector)
  }

  // `$` will be the base `Zepto` object. When calling this
  // function just call `$.zepto.init, which makes the implementation
  // details of selecting nodes and creating Zepto collections
  // patchable in plugins.
  $ = function(selector, context){
    return zepto.init(selector, context)
  }

  function extend(target, source, deep) {
    for (key in source)
      if (deep && (isPlainObject(source[key]) || isArray(source[key]))) {
        if (isPlainObject(source[key]) && !isPlainObject(target[key]))
          target[key] = {}
        if (isArray(source[key]) && !isArray(target[key]))
          target[key] = []
        extend(target[key], source[key], deep)
      }
      else if (source[key] !== undefined) target[key] = source[key]
  }

  // Copy all but undefined properties from one or more
  // objects to the `target` object.
  $.extend = function(target){
    var deep, args = slice.call(arguments, 1)
    if (typeof target == 'boolean') {
      deep = target
      target = args.shift()
    }
    args.forEach(function(arg){ extend(target, arg, deep) })
    return target
  }

  // `$.zepto.qsa` is Zepto's CSS selector implementation which
  // uses `document.querySelectorAll` and optimizes for some special cases, like `#id`.
  // This method can be overriden in plugins.
  zepto.qsa = function(element, selector){
    var found,
        maybeID = selector[0] == '#',
        maybeClass = !maybeID && selector[0] == '.',
        nameOnly = maybeID || maybeClass ? selector.slice(1) : selector, // Ensure that a 1 char tag name still gets checked
        isSimple = simpleSelectorRE.test(nameOnly)
    return (isDocument(element) && isSimple && maybeID) ?
      ( (found = element.getElementById(nameOnly)) ? [found] : [] ) :
      (element.nodeType !== 1 && element.nodeType !== 9) ? [] :
      slice.call(
        isSimple && !maybeID ?
          maybeClass ? element.getElementsByClassName(nameOnly) : // If it's simple, it could be a class
          element.getElementsByTagName(selector) : // Or a tag
          element.querySelectorAll(selector) // Or it's not simple, and we need to query all
      )
  }

  function filtered(nodes, selector) {
    return selector == null ? $(nodes) : $(nodes).filter(selector)
  }

  $.contains = document.documentElement.contains ?
    function(parent, node) {
      return parent !== node && parent.contains(node)
    } :
    function(parent, node) {
      while (node && (node = node.parentNode))
        if (node === parent) return true
      return false
    }

  function funcArg(context, arg, idx, payload) {
    return isFunction(arg) ? arg.call(context, idx, payload) : arg
  }

  function setAttribute(node, name, value) {
    value == null ? node.removeAttribute(name) : node.setAttribute(name, value)
  }

  // access className property while respecting SVGAnimatedString
  function className(node, value){
    var klass = node.className || '',
        svg   = klass && klass.baseVal !== undefined

    if (value === undefined) return svg ? klass.baseVal : klass
    svg ? (klass.baseVal = value) : (node.className = value)
  }

  // "true"  => true
  // "false" => false
  // "null"  => null
  // "42"    => 42
  // "42.5"  => 42.5
  // "08"    => "08"
  // JSON    => parse if valid
  // String  => self
  function deserializeValue(value) {
    try {
      return value ?
        value == "true" ||
        ( value == "false" ? false :
          value == "null" ? null :
          +value + "" == value ? +value :
          /^[\[\{]/.test(value) ? $.parseJSON(value) :
          value )
        : value
    } catch(e) {
      return value
    }
  }

  $.type = type
  $.isFunction = isFunction
  $.isWindow = isWindow
  $.isArray = isArray
  $.isPlainObject = isPlainObject

  $.isEmptyObject = function(obj) {
    var name
    for (name in obj) return false
    return true
  }

  $.inArray = function(elem, array, i){
    return emptyArray.indexOf.call(array, elem, i)
  }

  $.camelCase = camelize
  $.trim = function(str) {
    return str == null ? "" : String.prototype.trim.call(str)
  }

  // plugin compatibility
  $.uuid = 0
  $.support = { }
  $.expr = { }

  $.map = function(elements, callback){
    var value, values = [], i, key
    if (likeArray(elements))
      for (i = 0; i < elements.length; i++) {
        value = callback(elements[i], i)
        if (value != null) values.push(value)
      }
    else
      for (key in elements) {
        value = callback(elements[key], key)
        if (value != null) values.push(value)
      }
    return flatten(values)
  }

  $.each = function(elements, callback){
    var i, key
    if (likeArray(elements)) {
      for (i = 0; i < elements.length; i++)
        if (callback.call(elements[i], i, elements[i]) === false) return elements
    } else {
      for (key in elements)
        if (callback.call(elements[key], key, elements[key]) === false) return elements
    }

    return elements
  }

  $.grep = function(elements, callback){
    return filter.call(elements, callback)
  }

  if (window.JSON) $.parseJSON = JSON.parse

  // Populate the class2type map
  $.each("Boolean Number String Function Array Date RegExp Object Error".split(" "), function(i, name) {
    class2type[ "[object " + name + "]" ] = name.toLowerCase()
  })

  // Define methods that will be available on all
  // Zepto collections
  $.fn = {
    // Because a collection acts like an array
    // copy over these useful array functions.
    forEach: emptyArray.forEach,
    reduce: emptyArray.reduce,
    push: emptyArray.push,
    sort: emptyArray.sort,
    indexOf: emptyArray.indexOf,
    concat: emptyArray.concat,

    // `map` and `slice` in the jQuery API work differently
    // from their array counterparts
    map: function(fn){
      return $($.map(this, function(el, i){ return fn.call(el, i, el) }))
    },
    slice: function(){
      return $(slice.apply(this, arguments))
    },

    ready: function(callback){
      // need to check if document.body exists for IE as that browser reports
      // document ready when it hasn't yet created the body element
      if (readyRE.test(document.readyState) && document.body) callback($)
      else document.addEventListener('DOMContentLoaded', function(){ callback($) }, false)
      return this
    },
    get: function(idx){
      return idx === undefined ? slice.call(this) : this[idx >= 0 ? idx : idx + this.length]
    },
    toArray: function(){ return this.get() },
    size: function(){
      return this.length
    },
    remove: function(){
      return this.each(function(){
        if (this.parentNode != null)
          this.parentNode.removeChild(this)
      })
    },
    each: function(callback){
      emptyArray.every.call(this, function(el, idx){
        return callback.call(el, idx, el) !== false
      })
      return this
    },
    filter: function(selector){
      if (isFunction(selector)) return this.not(this.not(selector))
      return $(filter.call(this, function(element){
        return zepto.matches(element, selector)
      }))
    },
    add: function(selector,context){
      return $(uniq(this.concat($(selector,context))))
    },
    is: function(selector){
      return this.length > 0 && zepto.matches(this[0], selector)
    },
    not: function(selector){
      var nodes=[]
      if (isFunction(selector) && selector.call !== undefined)
        this.each(function(idx){
          if (!selector.call(this,idx)) nodes.push(this)
        })
      else {
        var excludes = typeof selector == 'string' ? this.filter(selector) :
          (likeArray(selector) && isFunction(selector.item)) ? slice.call(selector) : $(selector)
        this.forEach(function(el){
          if (excludes.indexOf(el) < 0) nodes.push(el)
        })
      }
      return $(nodes)
    },
    has: function(selector){
      return this.filter(function(){
        return isObject(selector) ?
          $.contains(this, selector) :
          $(this).find(selector).size()
      })
    },
    eq: function(idx){
      return idx === -1 ? this.slice(idx) : this.slice(idx, + idx + 1)
    },
    first: function(){
      var el = this[0]
      return el && !isObject(el) ? el : $(el)
    },
    last: function(){
      var el = this[this.length - 1]
      return el && !isObject(el) ? el : $(el)
    },
    find: function(selector){
      var result, $this = this
      if (!selector) result = $()
      else if (typeof selector == 'object')
        result = $(selector).filter(function(){
          var node = this
          return emptyArray.some.call($this, function(parent){
            return $.contains(parent, node)
          })
        })
      else if (this.length == 1) result = $(zepto.qsa(this[0], selector))
      else result = this.map(function(){ return zepto.qsa(this, selector) })
      return result
    },
    closest: function(selector, context){
      var node = this[0], collection = false
      if (typeof selector == 'object') collection = $(selector)
      while (node && !(collection ? collection.indexOf(node) >= 0 : zepto.matches(node, selector)))
        node = node !== context && !isDocument(node) && node.parentNode
      return $(node)
    },
    parents: function(selector){
      var ancestors = [], nodes = this
      while (nodes.length > 0)
        nodes = $.map(nodes, function(node){
          if ((node = node.parentNode) && !isDocument(node) && ancestors.indexOf(node) < 0) {
            ancestors.push(node)
            return node
          }
        })
      return filtered(ancestors, selector)
    },
    parent: function(selector){
      return filtered(uniq(this.pluck('parentNode')), selector)
    },
    children: function(selector){
      return filtered(this.map(function(){ return children(this) }), selector)
    },
    contents: function() {
      return this.map(function() { return slice.call(this.childNodes) })
    },
    siblings: function(selector){
      return filtered(this.map(function(i, el){
        return filter.call(children(el.parentNode), function(child){ return child!==el })
      }), selector)
    },
    empty: function(){
      return this.each(function(){ this.innerHTML = '' })
    },
    // `pluck` is borrowed from Prototype.js
    pluck: function(property){
      return $.map(this, function(el){ return el[property] })
    },
    show: function(){
      return this.each(function(){
        this.style.display == "none" && (this.style.display = '')
        if (getComputedStyle(this, '').getPropertyValue("display") == "none")
          this.style.display = defaultDisplay(this.nodeName)
      })
    },
    replaceWith: function(newContent){
      return this.before(newContent).remove()
    },
    wrap: function(structure){
      var func = isFunction(structure)
      if (this[0] && !func)
        var dom   = $(structure).get(0),
            clone = dom.parentNode || this.length > 1

      return this.each(function(index){
        $(this).wrapAll(
          func ? structure.call(this, index) :
            clone ? dom.cloneNode(true) : dom
        )
      })
    },
    wrapAll: function(structure){
      if (this[0]) {
        $(this[0]).before(structure = $(structure))
        var children
        // drill down to the inmost element
        while ((children = structure.children()).length) structure = children.first()
        $(structure).append(this)
      }
      return this
    },
    wrapInner: function(structure){
      var func = isFunction(structure)
      return this.each(function(index){
        var self = $(this), contents = self.contents(),
            dom  = func ? structure.call(this, index) : structure
        contents.length ? contents.wrapAll(dom) : self.append(dom)
      })
    },
    unwrap: function(){
      this.parent().each(function(){
        $(this).replaceWith($(this).children())
      })
      return this
    },
    clone: function(){
      return this.map(function(){ return this.cloneNode(true) })
    },
    hide: function(){
      return this.css("display", "none")
    },
    toggle: function(setting){
      return this.each(function(){
        var el = $(this)
        ;(setting === undefined ? el.css("display") == "none" : setting) ? el.show() : el.hide()
      })
    },
    prev: function(selector){ return $(this.pluck('previousElementSibling')).filter(selector || '*') },
    next: function(selector){ return $(this.pluck('nextElementSibling')).filter(selector || '*') },
    html: function(html){
      return 0 in arguments ?
        this.each(function(idx){
          var originHtml = this.innerHTML
          $(this).empty().append( funcArg(this, html, idx, originHtml) )
        }) :
        (0 in this ? this[0].innerHTML : null)
    },
    text: function(text){
      return 0 in arguments ?
        this.each(function(idx){
          var newText = funcArg(this, text, idx, this.textContent)
          this.textContent = newText == null ? '' : ''+newText
        }) :
        (0 in this ? this[0].textContent : null)
    },
    attr: function(name, value){
      var result
      return (typeof name == 'string' && !(1 in arguments)) ?
        (!this.length || this[0].nodeType !== 1 ? undefined :
          (!(result = this[0].getAttribute(name)) && name in this[0]) ? this[0][name] : result
        ) :
        this.each(function(idx){
          if (this.nodeType !== 1) return
          if (isObject(name)) for (key in name) setAttribute(this, key, name[key])
          else setAttribute(this, name, funcArg(this, value, idx, this.getAttribute(name)))
        })
    },
    removeAttr: function(name){
      return this.each(function(){ this.nodeType === 1 && name.split(' ').forEach(function(attribute){
        setAttribute(this, attribute)
      }, this)})
    },
    prop: function(name, value){
      name = propMap[name] || name
      return (1 in arguments) ?
        this.each(function(idx){
          this[name] = funcArg(this, value, idx, this[name])
        }) :
        (this[0] && this[0][name])
    },
    data: function(name, value){
      var attrName = 'data-' + name.replace(capitalRE, '-$1').toLowerCase()

      var data = (1 in arguments) ?
        this.attr(attrName, value) :
        this.attr(attrName)

      return data !== null ? deserializeValue(data) : undefined
    },
    val: function(value){
      return 0 in arguments ?
        this.each(function(idx){
          this.value = funcArg(this, value, idx, this.value)
        }) :
        (this[0] && (this[0].multiple ?
           $(this[0]).find('option').filter(function(){ return this.selected }).pluck('value') :
           this[0].value)
        )
    },
    offset: function(coordinates){
      if (coordinates) return this.each(function(index){
        var $this = $(this),
            coords = funcArg(this, coordinates, index, $this.offset()),
            parentOffset = $this.offsetParent().offset(),
            props = {
              top:  coords.top  - parentOffset.top,
              left: coords.left - parentOffset.left
            }

        if ($this.css('position') == 'static') props['position'] = 'relative'
        $this.css(props)
      })
      if (!this.length) return null
      var obj = this[0].getBoundingClientRect()
      return {
        left: obj.left + window.pageXOffset,
        top: obj.top + window.pageYOffset,
        width: Math.round(obj.width),
        height: Math.round(obj.height)
      }
    },
    css: function(property, value){
      if (arguments.length < 2) {
        var computedStyle, element = this[0]
        if(!element) return
        computedStyle = getComputedStyle(element, '')
        if (typeof property == 'string')
          return element.style[camelize(property)] || computedStyle.getPropertyValue(property)
        else if (isArray(property)) {
          var props = {}
          $.each(property, function(_, prop){
            props[prop] = (element.style[camelize(prop)] || computedStyle.getPropertyValue(prop))
          })
          return props
        }
      }

      var css = ''
      if (type(property) == 'string') {
        if (!value && value !== 0)
          this.each(function(){ this.style.removeProperty(dasherize(property)) })
        else
          css = dasherize(property) + ":" + maybeAddPx(property, value)
      } else {
        for (key in property)
          if (!property[key] && property[key] !== 0)
            this.each(function(){ this.style.removeProperty(dasherize(key)) })
          else
            css += dasherize(key) + ':' + maybeAddPx(key, property[key]) + ';'
      }

      return this.each(function(){ this.style.cssText += ';' + css })
    },
    index: function(element){
      return element ? this.indexOf($(element)[0]) : this.parent().children().indexOf(this[0])
    },
    hasClass: function(name){
      if (!name) return false
      return emptyArray.some.call(this, function(el){
        return this.test(className(el))
      }, classRE(name))
    },
    addClass: function(name){
      if (!name) return this
      return this.each(function(idx){
        if (!('className' in this)) return
        classList = []
        var cls = className(this), newName = funcArg(this, name, idx, cls)
        newName.split(/\s+/g).forEach(function(klass){
          if (!$(this).hasClass(klass)) classList.push(klass)
        }, this)
        classList.length && className(this, cls + (cls ? " " : "") + classList.join(" "))
      })
    },
    removeClass: function(name){
      return this.each(function(idx){
        if (!('className' in this)) return
        if (name === undefined) return className(this, '')
        classList = className(this)
        funcArg(this, name, idx, classList).split(/\s+/g).forEach(function(klass){
          classList = classList.replace(classRE(klass), " ")
        })
        className(this, classList.trim())
      })
    },
    toggleClass: function(name, when){
      if (!name) return this
      return this.each(function(idx){
        var $this = $(this), names = funcArg(this, name, idx, className(this))
        names.split(/\s+/g).forEach(function(klass){
          (when === undefined ? !$this.hasClass(klass) : when) ?
            $this.addClass(klass) : $this.removeClass(klass)
        })
      })
    },
    scrollTop: function(value){
      if (!this.length) return
      var hasScrollTop = 'scrollTop' in this[0]
      if (value === undefined) return hasScrollTop ? this[0].scrollTop : this[0].pageYOffset
      return this.each(hasScrollTop ?
        function(){ this.scrollTop = value } :
        function(){ this.scrollTo(this.scrollX, value) })
    },
    scrollLeft: function(value){
      if (!this.length) return
      var hasScrollLeft = 'scrollLeft' in this[0]
      if (value === undefined) return hasScrollLeft ? this[0].scrollLeft : this[0].pageXOffset
      return this.each(hasScrollLeft ?
        function(){ this.scrollLeft = value } :
        function(){ this.scrollTo(value, this.scrollY) })
    },
    position: function() {
      if (!this.length) return

      var elem = this[0],
        // Get *real* offsetParent
        offsetParent = this.offsetParent(),
        // Get correct offsets
        offset       = this.offset(),
        parentOffset = rootNodeRE.test(offsetParent[0].nodeName) ? { top: 0, left: 0 } : offsetParent.offset()

      // Subtract element margins
      // note: when an element has margin: auto the offsetLeft and marginLeft
      // are the same in Safari causing offset.left to incorrectly be 0
      offset.top  -= parseFloat( $(elem).css('margin-top') ) || 0
      offset.left -= parseFloat( $(elem).css('margin-left') ) || 0

      // Add offsetParent borders
      parentOffset.top  += parseFloat( $(offsetParent[0]).css('border-top-width') ) || 0
      parentOffset.left += parseFloat( $(offsetParent[0]).css('border-left-width') ) || 0

      // Subtract the two offsets
      return {
        top:  offset.top  - parentOffset.top,
        left: offset.left - parentOffset.left
      }
    },
    offsetParent: function() {
      return this.map(function(){
        var parent = this.offsetParent || document.body
        while (parent && !rootNodeRE.test(parent.nodeName) && $(parent).css("position") == "static")
          parent = parent.offsetParent
        return parent
      })
    }
  }

  // for now
  $.fn.detach = $.fn.remove

  // Generate the `width` and `height` functions
  ;['width', 'height'].forEach(function(dimension){
    var dimensionProperty =
      dimension.replace(/./, function(m){ return m[0].toUpperCase() })

    $.fn[dimension] = function(value){
      var offset, el = this[0]
      if (value === undefined) return isWindow(el) ? el['inner' + dimensionProperty] :
        isDocument(el) ? el.documentElement['scroll' + dimensionProperty] :
        (offset = this.offset()) && offset[dimension]
      else return this.each(function(idx){
        el = $(this)
        el.css(dimension, funcArg(this, value, idx, el[dimension]()))
      })
    }
  })

  function traverseNode(node, fun) {
    fun(node)
    for (var i = 0, len = node.childNodes.length; i < len; i++)
      traverseNode(node.childNodes[i], fun)
  }

  // Generate the `after`, `prepend`, `before`, `append`,
  // `insertAfter`, `insertBefore`, `appendTo`, and `prependTo` methods.
  adjacencyOperators.forEach(function(operator, operatorIndex) {
    var inside = operatorIndex % 2 //=> prepend, append

    $.fn[operator] = function(){
      // arguments can be nodes, arrays of nodes, Zepto objects and HTML strings
      var argType, nodes = $.map(arguments, function(arg) {
            argType = type(arg)
            return argType == "object" || argType == "array" || arg == null ?
              arg : zepto.fragment(arg)
          }),
          parent, copyByClone = this.length > 1
      if (nodes.length < 1) return this

      return this.each(function(_, target){
        parent = inside ? target : target.parentNode

        // convert all methods to a "before" operation
        target = operatorIndex == 0 ? target.nextSibling :
                 operatorIndex == 1 ? target.firstChild :
                 operatorIndex == 2 ? target :
                 null

        var parentInDocument = $.contains(document.documentElement, parent)

        nodes.forEach(function(node){
          if (copyByClone) node = node.cloneNode(true)
          else if (!parent) return $(node).remove()

          parent.insertBefore(node, target)
          if (parentInDocument) traverseNode(node, function(el){
            if (el.nodeName != null && el.nodeName.toUpperCase() === 'SCRIPT' &&
               (!el.type || el.type === 'text/javascript') && !el.src)
              window['eval'].call(window, el.innerHTML)
          })
        })
      })
    }

    // after    => insertAfter
    // prepend  => prependTo
    // before   => insertBefore
    // append   => appendTo
    $.fn[inside ? operator+'To' : 'insert'+(operatorIndex ? 'Before' : 'After')] = function(html){
      $(html)[operator](this)
      return this
    }
  })

  zepto.Z.prototype = $.fn

  // Export internal API functions in the `$.zepto` namespace
  zepto.uniq = uniq
  zepto.deserializeValue = deserializeValue
  $.zepto = zepto

  return $
})()

window.Zepto = Zepto
window.$ === undefined && (window.$ = Zepto)

// Added by github/jiyinyiyong to create an npm package
exports.Zepto = window.Zepto
exports.$ = window.$

;(function($){
  var _zid = 1, undefined,
      slice = Array.prototype.slice,
      isFunction = $.isFunction,
      isString = function(obj){ return typeof obj == 'string' },
      handlers = {},
      specialEvents={},
      focusinSupported = 'onfocusin' in window,
      focus = { focus: 'focusin', blur: 'focusout' },
      hover = { mouseenter: 'mouseover', mouseleave: 'mouseout' }

  specialEvents.click = specialEvents.mousedown = specialEvents.mouseup = specialEvents.mousemove = 'MouseEvents'

  function zid(element) {
    return element._zid || (element._zid = _zid++)
  }
  function findHandlers(element, event, fn, selector) {
    event = parse(event)
    if (event.ns) var matcher = matcherFor(event.ns)
    return (handlers[zid(element)] || []).filter(function(handler) {
      return handler
        && (!event.e  || handler.e == event.e)
        && (!event.ns || matcher.test(handler.ns))
        && (!fn       || zid(handler.fn) === zid(fn))
        && (!selector || handler.sel == selector)
    })
  }
  function parse(event) {
    var parts = ('' + event).split('.')
    return {e: parts[0], ns: parts.slice(1).sort().join(' ')}
  }
  function matcherFor(ns) {
    return new RegExp('(?:^| )' + ns.replace(' ', ' .* ?') + '(?: |$)')
  }

  function eventCapture(handler, captureSetting) {
    return handler.del &&
      (!focusinSupported && (handler.e in focus)) ||
      !!captureSetting
  }

  function realEvent(type) {
    return hover[type] || (focusinSupported && focus[type]) || type
  }

  function add(element, events, fn, data, selector, delegator, capture){
    var id = zid(element), set = (handlers[id] || (handlers[id] = []))
    events.split(/\s/).forEach(function(event){
      if (event == 'ready') return $(document).ready(fn)
      var handler   = parse(event)
      handler.fn    = fn
      handler.sel   = selector
      // emulate mouseenter, mouseleave
      if (handler.e in hover) fn = function(e){
        var related = e.relatedTarget
        if (!related || (related !== this && !$.contains(this, related)))
          return handler.fn.apply(this, arguments)
      }
      handler.del   = delegator
      var callback  = delegator || fn
      handler.proxy = function(e){
        e = compatible(e)
        if (e.isImmediatePropagationStopped()) return
        e.data = data
        var result = callback.apply(element, e._args == undefined ? [e] : [e].concat(e._args))
        if (result === false) e.preventDefault(), e.stopPropagation()
        return result
      }
      handler.i = set.length
      set.push(handler)
      if ('addEventListener' in element)
        element.addEventListener(realEvent(handler.e), handler.proxy, eventCapture(handler, capture))
    })
  }
  function remove(element, events, fn, selector, capture){
    var id = zid(element)
    ;(events || '').split(/\s/).forEach(function(event){
      findHandlers(element, event, fn, selector).forEach(function(handler){
        delete handlers[id][handler.i]
      if ('removeEventListener' in element)
        element.removeEventListener(realEvent(handler.e), handler.proxy, eventCapture(handler, capture))
      })
    })
  }

  $.event = { add: add, remove: remove }

  $.proxy = function(fn, context) {
    var args = (2 in arguments) && slice.call(arguments, 2)
    if (isFunction(fn)) {
      var proxyFn = function(){ return fn.apply(context, args ? args.concat(slice.call(arguments)) : arguments) }
      proxyFn._zid = zid(fn)
      return proxyFn
    } else if (isString(context)) {
      if (args) {
        args.unshift(fn[context], fn)
        return $.proxy.apply(null, args)
      } else {
        return $.proxy(fn[context], fn)
      }
    } else {
      throw new TypeError("expected function")
    }
  }

  $.fn.bind = function(event, data, callback){
    return this.on(event, data, callback)
  }
  $.fn.unbind = function(event, callback){
    return this.off(event, callback)
  }
  $.fn.one = function(event, selector, data, callback){
    return this.on(event, selector, data, callback, 1)
  }

  var returnTrue = function(){return true},
      returnFalse = function(){return false},
      ignoreProperties = /^([A-Z]|returnValue$|layer[XY]$)/,
      eventMethods = {
        preventDefault: 'isDefaultPrevented',
        stopImmediatePropagation: 'isImmediatePropagationStopped',
        stopPropagation: 'isPropagationStopped'
      }

  function compatible(event, source) {
    if (source || !event.isDefaultPrevented) {
      source || (source = event)

      $.each(eventMethods, function(name, predicate) {
        var sourceMethod = source[name]
        event[name] = function(){
          this[predicate] = returnTrue
          return sourceMethod && sourceMethod.apply(source, arguments)
        }
        event[predicate] = returnFalse
      })

      if (source.defaultPrevented !== undefined ? source.defaultPrevented :
          'returnValue' in source ? source.returnValue === false :
          source.getPreventDefault && source.getPreventDefault())
        event.isDefaultPrevented = returnTrue
    }
    return event
  }

  function createProxy(event) {
    var key, proxy = { originalEvent: event }
    for (key in event)
      if (!ignoreProperties.test(key) && event[key] !== undefined) proxy[key] = event[key]

    return compatible(proxy, event)
  }

  $.fn.delegate = function(selector, event, callback){
    return this.on(event, selector, callback)
  }
  $.fn.undelegate = function(selector, event, callback){
    return this.off(event, selector, callback)
  }

  $.fn.live = function(event, callback){
    $(document.body).delegate(this.selector, event, callback)
    return this
  }
  $.fn.die = function(event, callback){
    $(document.body).undelegate(this.selector, event, callback)
    return this
  }

  $.fn.on = function(event, selector, data, callback, one){
    var autoRemove, delegator, $this = this
    if (event && !isString(event)) {
      $.each(event, function(type, fn){
        $this.on(type, selector, data, fn, one)
      })
      return $this
    }

    if (!isString(selector) && !isFunction(callback) && callback !== false)
      callback = data, data = selector, selector = undefined
    if (isFunction(data) || data === false)
      callback = data, data = undefined

    if (callback === false) callback = returnFalse

    return $this.each(function(_, element){
      if (one) autoRemove = function(e){
        remove(element, e.type, callback)
        return callback.apply(this, arguments)
      }

      if (selector) delegator = function(e){
        var evt, match = $(e.target).closest(selector, element).get(0)
        if (match && match !== element) {
          evt = $.extend(createProxy(e), {currentTarget: match, liveFired: element})
          return (autoRemove || callback).apply(match, [evt].concat(slice.call(arguments, 1)))
        }
      }

      add(element, event, callback, data, selector, delegator || autoRemove)
    })
  }
  $.fn.off = function(event, selector, callback){
    var $this = this
    if (event && !isString(event)) {
      $.each(event, function(type, fn){
        $this.off(type, selector, fn)
      })
      return $this
    }

    if (!isString(selector) && !isFunction(callback) && callback !== false)
      callback = selector, selector = undefined

    if (callback === false) callback = returnFalse

    return $this.each(function(){
      remove(this, event, callback, selector)
    })
  }

  $.fn.trigger = function(event, args){
    event = (isString(event) || $.isPlainObject(event)) ? $.Event(event) : compatible(event)
    event._args = args
    return this.each(function(){
      // handle focus(), blur() by calling them directly
      if (event.type in focus && typeof this[event.type] == "function") this[event.type]()
      // items in the collection might not be DOM elements
      else if ('dispatchEvent' in this) this.dispatchEvent(event)
      else $(this).triggerHandler(event, args)
    })
  }

  // triggers event handlers on current element just as if an event occurred,
  // doesn't trigger an actual event, doesn't bubble
  $.fn.triggerHandler = function(event, args){
    var e, result
    this.each(function(i, element){
      e = createProxy(isString(event) ? $.Event(event) : event)
      e._args = args
      e.target = element
      $.each(findHandlers(element, event.type || event), function(i, handler){
        result = handler.proxy(e)
        if (e.isImmediatePropagationStopped()) return false
      })
    })
    return result
  }

  // shortcut methods for `.bind(event, fn)` for each event type
  ;('focusin focusout focus blur load resize scroll unload click dblclick '+
  'mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave '+
  'change select keydown keypress keyup error').split(' ').forEach(function(event) {
    $.fn[event] = function(callback) {
      return (0 in arguments) ?
        this.bind(event, callback) :
        this.trigger(event)
    }
  })

  $.Event = function(type, props) {
    if (!isString(type)) props = type, type = props.type
    var event = document.createEvent(specialEvents[type] || 'Events'), bubbles = true
    if (props) for (var name in props) (name == 'bubbles') ? (bubbles = !!props[name]) : (event[name] = props[name])
    event.initEvent(type, bubbles, true)
    return compatible(event)
  }

})(Zepto)

;(function($){
  var jsonpID = 0,
      document = window.document,
      key,
      name,
      rscript = /<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,
      scriptTypeRE = /^(?:text|application)\/javascript/i,
      xmlTypeRE = /^(?:text|application)\/xml/i,
      jsonType = 'application/json',
      htmlType = 'text/html',
      blankRE = /^\s*$/,
      originAnchor = document.createElement('a')

  originAnchor.href = window.location.href

  // trigger a custom event and return false if it was cancelled
  function triggerAndReturn(context, eventName, data) {
    var event = $.Event(eventName)
    $(context).trigger(event, data)
    return !event.isDefaultPrevented()
  }

  // trigger an Ajax "global" event
  function triggerGlobal(settings, context, eventName, data) {
    if (settings.global) return triggerAndReturn(context || document, eventName, data)
  }

  // Number of active Ajax requests
  $.active = 0

  function ajaxStart(settings) {
    if (settings.global && $.active++ === 0) triggerGlobal(settings, null, 'ajaxStart')
  }
  function ajaxStop(settings) {
    if (settings.global && !(--$.active)) triggerGlobal(settings, null, 'ajaxStop')
  }

  // triggers an extra global event "ajaxBeforeSend" that's like "ajaxSend" but cancelable
  function ajaxBeforeSend(xhr, settings) {
    var context = settings.context
    if (settings.beforeSend.call(context, xhr, settings) === false ||
        triggerGlobal(settings, context, 'ajaxBeforeSend', [xhr, settings]) === false)
      return false

    triggerGlobal(settings, context, 'ajaxSend', [xhr, settings])
  }
  function ajaxSuccess(data, xhr, settings, deferred) {
    var context = settings.context, status = 'success'
    settings.success.call(context, data, status, xhr)
    if (deferred) deferred.resolveWith(context, [data, status, xhr])
    triggerGlobal(settings, context, 'ajaxSuccess', [xhr, settings, data])
    ajaxComplete(status, xhr, settings)
  }
  // type: "timeout", "error", "abort", "parsererror"
  function ajaxError(error, type, xhr, settings, deferred) {
    var context = settings.context
    settings.error.call(context, xhr, type, error)
    if (deferred) deferred.rejectWith(context, [xhr, type, error])
    triggerGlobal(settings, context, 'ajaxError', [xhr, settings, error || type])
    ajaxComplete(type, xhr, settings)
  }
  // status: "success", "notmodified", "error", "timeout", "abort", "parsererror"
  function ajaxComplete(status, xhr, settings) {
    var context = settings.context
    settings.complete.call(context, xhr, status)
    triggerGlobal(settings, context, 'ajaxComplete', [xhr, settings])
    ajaxStop(settings)
  }

  // Empty function, used as default callback
  function empty() {}

  $.ajaxJSONP = function(options, deferred){
    if (!('type' in options)) return $.ajax(options)

    var _callbackName = options.jsonpCallback,
      callbackName = ($.isFunction(_callbackName) ?
        _callbackName() : _callbackName) || ('jsonp' + (++jsonpID)),
      script = document.createElement('script'),
      originalCallback = window[callbackName],
      responseData,
      abort = function(errorType) {
        $(script).triggerHandler('error', errorType || 'abort')
      },
      xhr = { abort: abort }, abortTimeout

    if (deferred) deferred.promise(xhr)

    $(script).on('load error', function(e, errorType){
      clearTimeout(abortTimeout)
      $(script).off().remove()

      if (e.type == 'error' || !responseData) {
        ajaxError(null, errorType || 'error', xhr, options, deferred)
      } else {
        ajaxSuccess(responseData[0], xhr, options, deferred)
      }

      window[callbackName] = originalCallback
      if (responseData && $.isFunction(originalCallback))
        originalCallback(responseData[0])

      originalCallback = responseData = undefined
    })

    if (ajaxBeforeSend(xhr, options) === false) {
      abort('abort')
      return xhr
    }

    window[callbackName] = function(){
      responseData = arguments
    }

    script.src = options.url.replace(/\?(.+)=\?/, '?$1=' + callbackName)
    document.head.appendChild(script)

    if (options.timeout > 0) abortTimeout = setTimeout(function(){
      abort('timeout')
    }, options.timeout)

    return xhr
  }

  $.ajaxSettings = {
    // Default type of request
    type: 'GET',
    // Callback that is executed before request
    beforeSend: empty,
    // Callback that is executed if the request succeeds
    success: empty,
    // Callback that is executed the the server drops error
    error: empty,
    // Callback that is executed on request complete (both: error and success)
    complete: empty,
    // The context for the callbacks
    context: null,
    // Whether to trigger "global" Ajax events
    global: true,
    // Transport
    xhr: function () {
      return new window.XMLHttpRequest()
    },
    // MIME types mapping
    // IIS returns Javascript as "application/x-javascript"
    accepts: {
      script: 'text/javascript, application/javascript, application/x-javascript',
      json:   jsonType,
      xml:    'application/xml, text/xml',
      html:   htmlType,
      text:   'text/plain'
    },
    // Whether the request is to another domain
    crossDomain: false,
    // Default timeout
    timeout: 0,
    // Whether data should be serialized to string
    processData: true,
    // Whether the browser should be allowed to cache GET responses
    cache: true
  }

  function mimeToDataType(mime) {
    if (mime) mime = mime.split(';', 2)[0]
    return mime && ( mime == htmlType ? 'html' :
      mime == jsonType ? 'json' :
      scriptTypeRE.test(mime) ? 'script' :
      xmlTypeRE.test(mime) && 'xml' ) || 'text'
  }

  function appendQuery(url, query) {
    if (query == '') return url
    return (url + '&' + query).replace(/[&?]{1,2}/, '?')
  }

  // serialize payload and append it to the URL for GET requests
  function serializeData(options) {
    if (options.processData && options.data && $.type(options.data) != "string")
      options.data = $.param(options.data, options.traditional)
    if (options.data && (!options.type || options.type.toUpperCase() == 'GET'))
      options.url = appendQuery(options.url, options.data), options.data = undefined
  }

  $.ajax = function(options){
    var settings = $.extend({}, options || {}),
        deferred = $.Deferred && $.Deferred(),
        urlAnchor
    for (key in $.ajaxSettings) if (settings[key] === undefined) settings[key] = $.ajaxSettings[key]

    ajaxStart(settings)

    if (!settings.crossDomain) {
      urlAnchor = document.createElement('a')
      urlAnchor.href = settings.url
      urlAnchor.href = urlAnchor.href
      settings.crossDomain = (originAnchor.protocol + '//' + originAnchor.host) !== (urlAnchor.protocol + '//' + urlAnchor.host)
    }

    if (!settings.url) settings.url = window.location.toString()
    serializeData(settings)

    var dataType = settings.dataType, hasPlaceholder = /\?.+=\?/.test(settings.url)
    if (hasPlaceholder) dataType = 'jsonp'

    if (settings.cache === false || (
         (!options || options.cache !== true) &&
         ('script' == dataType || 'jsonp' == dataType)
        ))
      settings.url = appendQuery(settings.url, '_=' + Date.now())

    if ('jsonp' == dataType) {
      if (!hasPlaceholder)
        settings.url = appendQuery(settings.url,
          settings.jsonp ? (settings.jsonp + '=?') : settings.jsonp === false ? '' : 'callback=?')
      return $.ajaxJSONP(settings, deferred)
    }

    var mime = settings.accepts[dataType],
        headers = { },
        setHeader = function(name, value) { headers[name.toLowerCase()] = [name, value] },
        protocol = /^([\w-]+:)\/\//.test(settings.url) ? RegExp.$1 : window.location.protocol,
        xhr = settings.xhr(),
        nativeSetHeader = xhr.setRequestHeader,
        abortTimeout

    if (deferred) deferred.promise(xhr)

    if (!settings.crossDomain) setHeader('X-Requested-With', 'XMLHttpRequest')
    setHeader('Accept', mime || '*/*')
    if (mime = settings.mimeType || mime) {
      if (mime.indexOf(',') > -1) mime = mime.split(',', 2)[0]
      xhr.overrideMimeType && xhr.overrideMimeType(mime)
    }
    if (settings.contentType || (settings.contentType !== false && settings.data && settings.type.toUpperCase() != 'GET'))
      setHeader('Content-Type', settings.contentType || 'application/x-www-form-urlencoded')

    if (settings.headers) for (name in settings.headers) setHeader(name, settings.headers[name])
    xhr.setRequestHeader = setHeader

    xhr.onreadystatechange = function(){
      if (xhr.readyState == 4) {
        xhr.onreadystatechange = empty
        clearTimeout(abortTimeout)
        var result, error = false
        if ((xhr.status >= 200 && xhr.status < 300) || xhr.status == 304 || (xhr.status == 0 && protocol == 'file:')) {
          dataType = dataType || mimeToDataType(settings.mimeType || xhr.getResponseHeader('content-type'))
          result = xhr.responseText

          try {
            // http://perfectionkills.com/global-eval-what-are-the-options/
            if (dataType == 'script')    (1,eval)(result)
            else if (dataType == 'xml')  result = xhr.responseXML
            else if (dataType == 'json') result = blankRE.test(result) ? null : $.parseJSON(result)
          } catch (e) { error = e }

          if (error) ajaxError(error, 'parsererror', xhr, settings, deferred)
          else ajaxSuccess(result, xhr, settings, deferred)
        } else {
          ajaxError(xhr.statusText || null, xhr.status ? 'error' : 'abort', xhr, settings, deferred)
        }
      }
    }

    if (ajaxBeforeSend(xhr, settings) === false) {
      xhr.abort()
      ajaxError(null, 'abort', xhr, settings, deferred)
      return xhr
    }

    if (settings.xhrFields) for (name in settings.xhrFields) xhr[name] = settings.xhrFields[name]

    var async = 'async' in settings ? settings.async : true
    xhr.open(settings.type, settings.url, async, settings.username, settings.password)

    for (name in headers) nativeSetHeader.apply(xhr, headers[name])

    if (settings.timeout > 0) abortTimeout = setTimeout(function(){
        xhr.onreadystatechange = empty
        xhr.abort()
        ajaxError(null, 'timeout', xhr, settings, deferred)
      }, settings.timeout)

    // avoid sending empty string (#319)
    xhr.send(settings.data ? settings.data : null)
    return xhr
  }

  // handle optional data/success arguments
  function parseArguments(url, data, success, dataType) {
    if ($.isFunction(data)) dataType = success, success = data, data = undefined
    if (!$.isFunction(success)) dataType = success, success = undefined
    return {
      url: url
    , data: data
    , success: success
    , dataType: dataType
    }
  }

  $.get = function(/* url, data, success, dataType */){
    return $.ajax(parseArguments.apply(null, arguments))
  }

  $.post = function(/* url, data, success, dataType */){
    var options = parseArguments.apply(null, arguments)
    options.type = 'POST'
    return $.ajax(options)
  }

  $.getJSON = function(/* url, data, success */){
    var options = parseArguments.apply(null, arguments)
    options.dataType = 'json'
    return $.ajax(options)
  }

  $.fn.load = function(url, data, success){
    if (!this.length) return this
    var self = this, parts = url.split(/\s/), selector,
        options = parseArguments(url, data, success),
        callback = options.success
    if (parts.length > 1) options.url = parts[0], selector = parts[1]
    options.success = function(response){
      self.html(selector ?
        $('<div>').html(response.replace(rscript, "")).find(selector)
        : response)
      callback && callback.apply(self, arguments)
    }
    $.ajax(options)
    return this
  }

  var escape = encodeURIComponent

  function serialize(params, obj, traditional, scope){
    var type, array = $.isArray(obj), hash = $.isPlainObject(obj)
    $.each(obj, function(key, value) {
      type = $.type(value)
      if (scope) key = traditional ? scope :
        scope + '[' + (hash || type == 'object' || type == 'array' ? key : '') + ']'
      // handle data in serializeArray() format
      if (!scope && array) params.add(value.name, value.value)
      // recurse into nested objects
      else if (type == "array" || (!traditional && type == "object"))
        serialize(params, value, traditional, key)
      else params.add(key, value)
    })
  }

  $.param = function(obj, traditional){
    var params = []
    params.add = function(key, value) {
      if ($.isFunction(value)) value = value()
      if (value == null) value = ""
      this.push(escape(key) + '=' + escape(value))
    }
    serialize(params, obj, traditional)
    return params.join('&').replace(/%20/g, '+')
  }
})(Zepto)

;(function($){
  $.fn.serializeArray = function() {
    var name, type, result = [],
      add = function(value) {
        if (value.forEach) return value.forEach(add)
        result.push({ name: name, value: value })
      }
    if (this[0]) $.each(this[0].elements, function(_, field){
      type = field.type, name = field.name
      if (name && field.nodeName.toLowerCase() != 'fieldset' &&
        !field.disabled && type != 'submit' && type != 'reset' && type != 'button' && type != 'file' &&
        ((type != 'radio' && type != 'checkbox') || field.checked))
          add($(field).val())
    })
    return result
  }

  $.fn.serialize = function(){
    var result = []
    this.serializeArray().forEach(function(elm){
      result.push(encodeURIComponent(elm.name) + '=' + encodeURIComponent(elm.value))
    })
    return result.join('&')
  }

  $.fn.submit = function(callback) {
    if (0 in arguments) this.bind('submit', callback)
    else if (this.length) {
      var event = $.Event('submit')
      this.eq(0).trigger(event)
      if (!event.isDefaultPrevented()) this.get(0).submit()
    }
    return this
  }

})(Zepto)

;(function($){
  // __proto__ doesn't exist on IE<11, so redefine
  // the Z function to use object extension instead
  if (!('__proto__' in {})) {
    $.extend($.zepto, {
      Z: function(dom, selector){
        dom = dom || []
        $.extend(dom, $.fn)
        dom.selector = selector || ''
        dom.__Z = true
        return dom
      },
      // this is a kludge but works
      isZ: function(object){
        return $.type(object) === 'array' && '__Z' in object
      }
    })
  }

  // getComputedStyle shouldn't freak out when called
  // without a valid element as argument
  try {
    getComputedStyle(undefined)
  } catch(e) {
    var nativeGetComputedStyle = getComputedStyle;
    window.getComputedStyle = function(element){
      try {
        return nativeGetComputedStyle(element)
      } catch(e) {
        return null
      }
    }
  }
})(Zepto)
;
},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJsaWIvYXBwLmpzIiwibGliL2F1dGgvaW5kZXguanMiLCJsaWIvYXV0aC9ub25jZS5qcyIsImxpYi9wYXRoL2luZGV4LmpzIiwibGliL3BhdGgvcGFydC5qcyIsImxpYi9wYXRoL3BhcnRfYnVpbGRlci5qcyIsImxpYi91aS9hdXRoX3BhbmVsLmpzIiwibGliL3VpL2NvbXBvbmVudC5qcyIsImxpYi91aS9kZXYuanMiLCJsaWIvdWkvaW5kZXguanMiLCJsaWIvdWkvanNvbl9icm93c2VyLmpzIiwibGliL3VpL2xpc3RfY29tcG9uZW50LmpzIiwibGliL3VpL2xvb2t1cF9wYW5lLmpzIiwibGliL3VpL29wdGlvbl9zZWxlY3Rvci5qcyIsImxpYi91aS9wYXJhbV9idWlsZGVyLmpzIiwibGliL3VpL3BhdGhfZmllbGQuanMiLCJsaWIvdWkvcmVmZXJlbmNlX3BhbmVsLmpzIiwibGliL3VpL3JlcXVlc3RfaGVhZGVyLmpzIiwibGliL3VpL3JlcXVlc3Rfdmlld2VyLmpzIiwibGliL3VpL3RpcC5qcyIsImxpYi91aS91dGlsLmpzIiwibm9kZV9tb2R1bGVzL2V2ZW50cy9ldmVudHMuanMiLCJub2RlX21vZHVsZXMvZm4vZm4uanMiLCJub2RlX21vZHVsZXMvcHJvY2Vzcy9icm93c2VyLmpzIiwibm9kZV9tb2R1bGVzL3F1ZXJ5c3RyaW5nLWVzMy9kZWNvZGUuanMiLCJub2RlX21vZHVsZXMvcXVlcnlzdHJpbmctZXMzL2VuY29kZS5qcyIsIm5vZGVfbW9kdWxlcy9xdWVyeXN0cmluZy1lczMvaW5kZXguanMiLCJub2RlX21vZHVsZXMvdXRpbC9ub2RlX21vZHVsZXMvaW5oZXJpdHMvaW5oZXJpdHNfYnJvd3Nlci5qcyIsIm5vZGVfbW9kdWxlcy91dGlsL3N1cHBvcnQvaXNCdWZmZXJCcm93c2VyLmpzIiwibm9kZV9tb2R1bGVzL3V0aWwvdXRpbC5qcyIsIm5vZGVfbW9kdWxlcy96ZXB0by1i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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN1NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6T0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcExBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ0pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUNMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FDMWtCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIlxuaWYgKCF3aW5kb3cpIHRocm93IG5ldyBFcnJvcihcIk5vdCBhIGJyb3dzZXIgd2luZG93LlwiKTtcblxudmFyIHBhdGggICAgICAgICA9IHJlcXVpcmUoJy4vcGF0aCcpLFxuICAgIHVpICAgICAgICAgICA9IHJlcXVpcmUoJy4vdWknKSxcbiAgICBxdWVyeXN0cmluZyAgPSByZXF1aXJlKCdxdWVyeXN0cmluZycpLFxuICAgIGRldiAgICAgICAgICA9IG5ldyB1aS5EZXYoKSxcbiAgICBxdWVyeXN0cmluZyAgPSByZXF1aXJlKCdxdWVyeXN0cmluZycpLFxuICAgICQgICAgICAgICAgICA9IHJlcXVpcmUoJ3plcHRvLWJyb3dzZXJpZnknKS4kLFxuICAgIGF1dGhTY2hlbWUgICA9IHJlcXVpcmUoJy4vYXV0aCcpKCk7XG5cbiQoZnVuY3Rpb24oKSB7XG5cbnZhciBhdXRoUGFuZWwgPSBuZXcgdWkuQXV0aFBhbmVsKCcjYXV0aCcsIHtcbiAgICAgICdzY2hlbWUnOiBhdXRoLFxuICAgICAgJ29uQ2hlY2tUb2tlbicgOiBmdW5jdGlvbihhdXRoLCBjYWxsYmFjaykge1xuICAgICAgICBzZW5kUmVxdWVzdCh7cGF0aDonL3YxL21lJ30sIGNhbGxiYWNrKTtcbiAgICAgIH1cbiAgICB9KSxcbiAgICBhdXRoID0gYXV0aFNjaGVtZShhdXRoUGFuZWwpLFxuICAgIHNlbmQgPSBhdXRoLnJlcXVlc3QuYmluZChhdXRoKSxcbiAgICByZWZlcmVuY2VQYW5lbCA9IG5ldyB1aS5SZWZlcmVuY2VQYW5lbCh7XG4gICAgICAnc2VhcmNoX3VybCcgOiByZXN0X2FwaV9jb25zb2xlLnNlYXJjaF91cmwsXG4gICAgICAnZGVmYXVsdFZhbHVlJyA6IFtdLFxuICAgICAgJ3ZlcnNpb25TZWxlY3RvcicgOiAkKCcjdmVyc2lvbnMnKSxcbiAgICAgIC8vJ2ZpbHRlcicgOiBkZXYuZmlsdGVyRW5kcG9pbnRzLmJpbmQoZGV2KSxcbiAgICAgICdvblNlbGVjdCcgOiBmdW5jdGlvbihlbmRwb2ludCkge1xuICAgICAgICBzZWxlY3RFbmRwb2ludChlbmRwb2ludCk7XG4gICAgICB9LFxuICAgICAgJ29uTG9hZFZlcnNpb25zJzogZnVuY3Rpb24ob25Mb2FkKSB7XG4gICAgICAgIC8vIHNlbmQoeyB2ZXJzaW9uOicxLjEnLCBwYXRoOicvdmVyc2lvbnMnLCBxdWVyeTogXCJpbmNsdWRlX2Rldj10cnVlXCIgfSwgZnVuY3Rpb24oZXJyLCByZXNwb25zZSkge1xuICAgICAgICAgIG9uTG9hZChudWxsLCBbXCIyXCJdLCBcIjJcIik7XG4gICAgICAgIC8vIH0pO1xuICAgICAgfSxcbiAgICAgICdvbkxvYWRFbmRwb2ludHMnOiBmdW5jdGlvbih2ZXJzaW9uLCBvbkluZGV4KSB7XG4gICAgICAgIC8vIFRPRE86IHN0YXNoIGVuZHBvaW50cyBpbiBsb2NhbCBzdG9yYWdlIHNvIHdlIGNhbiBsb2FkIHRoZW0gaW1tZWRpYXRlbHkgaW4gdGhlIGZ1dHVyZVxuICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgIGhlYWRlcnM6IHsgJ2FjY2VwdCc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxuICAgICAgICAgIHVybDogcmVzdF9hcGlfY29uc29sZS5yZXN0X3VybCxcbiAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICBvbkluZGV4KG51bGwsIGRhdGEpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSksXG4gICAgbWV0aG9kU2VsZWN0b3IgPSBuZXcgdWkuT3B0aW9uU2VsZWN0b3IoJCgnI21ldGhvZCcpLCB7IHZhbHVlczogWydHRVQnLCAnUE9TVCcsICdQVVQnLCAnREVMRVRFJywgJ09QVElPTlMnXSB9ICksXG4gICAgcXVlcnlCdWlsZGVyID0gbmV3IHVpLlBhcmFtQnVpbGRlcigkKCcjcXVlcnknKSwgeyd0aXRsZSc6J1F1ZXJ5J30pLFxuICAgIGJvZHlCdWlsZGVyID0gbmV3IHVpLlBhcmFtQnVpbGRlcigkKCcjYm9keScpLCB7J3RpdGxlJzonQm9keSd9KSxcbiAgICB0aXAgPSBuZXcgdWkuVGlwKCcjdGlwJyksXG4gICAgcGF0aEZpZWxkID0gbmV3IHVpLlBhdGhGaWVsZCgkKCcjcGF0aCcpLCB7XG4gICAgICAnZGVmYXVsdFZhbHVlJzpuZXcgcGF0aC5EZWZhdWx0UGF0aCgpLFxuICAgICAgJ2l0ZW1UZW1wbGF0ZSc6IGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgaWYgKHR5cGVvZiBpdGVtID09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgcmV0dXJuICQoXCI8bGk+PC9saT5cIikuYWRkQ2xhc3MoJ2dyb3VwJykuYWRkQ2xhc3MoJ3Vuc2VsZWN0YWJsZScpLnRleHQoaXRlbSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGl0ZW0ubG9hZGluZyA9PT0gdHJ1ZSkge1xuICAgICAgICAgIHJldHVybiAkKFwiPGxpPjwvbGk+XCIpLmFkZENsYXNzKCd1bnNlbGVjdGFibGUnKS5hZGRDbGFzcygnbG9hZGluZycpLmFwcGVuZCgkKFwiPGRpdj48ZGl2PjwvZGl2PjwvZGl2PlwiKS5hZGRDbGFzcygndGhyb2JiZXInKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGl0ZW0uaGlzdG9yeSA9PT0gdHJ1ZSkge1xuICAgICAgICAgIHJldHVybiAkKFwiPGxpPjwvbGk+XCIpLmFkZENsYXNzKCd1bnNlbGVjdGFibGUnKS5hZGRDbGFzcygnaGlzdG9yeScpLnRleHQoaXRlbS5sYWJlbCkuYWRkQ2xhc3MoJ2dyb3VwJyk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGxpc3RJdGVtID0gJChcIjxsaT48L2xpPlwiKSxcbiAgICAgICAgICAgIG1ldGhvZCA9ICQoXCI8c3Bhbj48L3NwYW4+XCIpLnRleHQoaXRlbS5tZXRob2QpLmFwcGVuZFRvKGxpc3RJdGVtKSxcbiAgICAgICAgICAgIHBhdGggPSAkKFwiPGNvZGU+PC9jb2RlPlwiKS50ZXh0KGl0ZW0ucGF0aF9sYWJlbGVkKS5hcHBlbmRUbyhsaXN0SXRlbS5hcHBlbmQoXCIgXCIpKSxcbiAgICAgICAgICAgIGdyb3VwID0gJChcIjxzdHJvbmc+PC9zdHJvbmc+XCIpLnRleHQoaXRlbS5uYW1lc3BhY2UpLmFwcGVuZFRvKGxpc3RJdGVtLmFwcGVuZChcIiBcIikpLFxuICAgICAgICAgICAgZGVzY3JpcHRpb24gPSAkKFwiPGVtPjwvZW0+XCIpLnRleHQoaXRlbS5kZXNjcmlwdGlvbikuYXBwZW5kVG8obGlzdEl0ZW0uYXBwZW5kKFwiIFwiKSk7XG5cbiAgICAgICAgcmV0dXJuIGxpc3RJdGVtO1xuICAgICAgfSxcbiAgICAgICdvblNlbGVjdCc6IGZ1bmN0aW9uKGVuZHBvaW50KSB7XG4gICAgICAgIHNlbGVjdEVuZHBvaW50KGVuZHBvaW50KTtcbiAgICAgIH0sXG4gICAgICAnb25TZWFyY2gnOiByZWZlcmVuY2VQYW5lbC5vblNlYXJjaCxcbiAgICB9IC8vIFBhdGhGaWVsZCBvcHRpb25zXG4gICAgKSwgLy8gUGF0aEZpZWxkIGNvbnN0cnVjdG9yXG4gICAgc2VsZWN0RW5kcG9pbnQgPSBmdW5jdGlvbihlbmRwb2ludCkge1xuICAgICAgdmFyIGVuZHBvaW50UGF0aCA9IG5ldyBwYXRoLlBhdGgoZW5kcG9pbnQucGF0aF9sYWJlbGVkLCB7fS8qZW5kcG9pbnQucmVxdWVzdC5wYXRoKi8pO1xuXG4gICAgICBlbmRwb2ludFBhdGgucGFydHMucHVzaChuZXcgcGF0aC5QYXJ0KCc/Jywge2xhYmVsOic/JywgdHlwZTonc2VnbWVudCcsIGVkaXRhYmxlOmZhbHNlfSkpO1xuICAgICAgZW5kcG9pbnRQYXRoLnBhcnRzLnB1c2gobmV3IHBhdGguUXVlcnlQYXJ0KCkpO1xuXG4gICAgICBwYXRoRmllbGQuc2V0VmFsdWUoZW5kcG9pbnRQYXRoKTtcbiAgICAgIG1ldGhvZFNlbGVjdG9yLnNldFZhbHVlKGVuZHBvaW50Lm1ldGhvZCk7XG4gICAgICBtZXRob2RTZWxlY3Rvci5kaXNhYmxlKCk7XG5cbiAgICAgIHF1ZXJ5QnVpbGRlci5zZXRWYWx1ZSh7fS8qZW5kcG9pbnQucmVxdWVzdC5xdWVyeSovKTtcbiAgICAgIGJvZHlCdWlsZGVyLnNldFZhbHVlKHt9LyplbmRwb2ludC5yZXF1ZXN0LmJvZHkqLyk7XG5cbiAgICAgIHJlZmVyZW5jZVBhbmVsLmFkZEhpc3RvcnkoZW5kcG9pbnQpO1xuICAgIH0sXG4gICAgc2VuZFJlcXVlc3QgPSBmdW5jdGlvbiAocmVxdWVzdCwgY2FsbGJhY2spIHtcbiAgICAgIHZhciB2aWV3ZXIgPSBuZXcgdWkuUmVxdWVzdFZpZXdlcih7XG4gICAgICAgICAgICAnY29udGFpbmVyJyA6ICcjcmVxdWVzdHMnXG4gICAgICAgICAgfSk7XG5cbiAgICAgIGlmIChyZXF1ZXN0LnBhdGggJiYgcmVxdWVzdC5wYXRoLmluZGV4T2YoJy8nKSAhPT0gMCkge1xuICAgICAgICByZXF1ZXN0LnBhdGggPSBcIi9cIiArIHJlcXVlc3QucGF0aDtcbiAgICAgIH1cblxuICAgICAgcmVxdWVzdC5wYXRoID0gcmVxdWVzdC5wYXRoLmNoYXJBdChyZXF1ZXN0LnBhdGgubGVuZ3RoIC0gMSkgPT0gJz8nID8gcmVxdWVzdC5wYXRoLnN1YnN0cmluZygwLCByZXF1ZXN0LnBhdGgubGVuZ3RoLTEpIDogcmVxdWVzdC5wYXRoO1xuICAgICAgLy8gVE9ETzogZGVmYXVsdCB0byB0aGUgdmVyc2lvbiBzZWxlY3RlZCBpbiB0aGUgcmVmZXJlbmNlIHBhbmVsXG4gICAgICByZXF1ZXN0LmFwaVZlcnNpb24gPSAnMS4xJztcbiAgICAgIC8vIHBhcnNlIG91dCB0aGUgdmVyc2lvbiBmcm9tIHRoZSBwYXRoXG4gICAgICB2YXIgdmVyc2lvblJlZyA9IC9eXFwvdihbXFxkXVteXFwvXXswLH0pXFwvLztcbiAgICAgIHZhciBwYXJ0cyA9IHJlcXVlc3QucGF0aC5tYXRjaCh2ZXJzaW9uUmVnKTtcbiAgICAgIGlmIChwYXJ0cykge1xuICAgICAgICByZXF1ZXN0LmFwaVZlcnNpb24gPSBwYXJ0c1sxXTtcbiAgICAgICAgcmVxdWVzdC5wYXRoID0gcmVxdWVzdC5wYXRoLnJlcGxhY2UodmVyc2lvblJlZywgJy8nKTtcbiAgICAgIH1cblxuICAgICAgdmlld2VyLnNldFZhbHVlKHJlcXVlc3QpO1xuXG4gICAgICBzZW5kKHJlcXVlc3QsIGZ1bmN0aW9uKGVyciwgcmVzcG9uc2UsIHhocil7XG4gICAgICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgICAgIGNhbGxiYWNrKGVyciwgcmVzcG9uc2UsIHhocik7XG4gICAgICAgIH1cbiAgICAgICAgdmlld2VyLm9uUmVzcG9uc2UoZXJyLCByZXNwb25zZSwgeGhyKTtcbiAgICAgIH0pO1xuICAgICAgdmlld2VyLnNlbnQoKTtcbiAgICAgIHJldHVybiB2aWV3ZXI7XG4gICAgfTtcblxuYm9keUJ1aWxkZXIuZGlzYWJsZSgpO1xuXG5tZXRob2RTZWxlY3Rvci5vbignZW5hYmxlZCcsIGZ1bmN0aW9uKCl7XG4gIG1ldGhvZFNlbGVjdG9yLm5vZGUuYXR0cigndGFiaW5kZXgnLCcxJykuYWRkQ2xhc3MoJ2VuYWJsZWQnKTtcbn0pO1xuXG5tZXRob2RTZWxlY3Rvci5vbignZGlzYWJsZWQnLCBmdW5jdGlvbigpe1xuICBtZXRob2RTZWxlY3Rvci5ub2RlLmF0dHIoJ3RhYmluZGV4JywgbnVsbCkucmVtb3ZlQ2xhc3MoJ2VuYWJsZWQnKTtcbn0pO1xuXG5tZXRob2RTZWxlY3Rvci5vbignY2hhbmdlJywgZnVuY3Rpb24oKSB7XG4gIGlmICggLTEgPT09IFsnR0VUJywgJ0RFTEVURScsICdPUFRJT05TJ10uaW5kZXhPZiggbWV0aG9kU2VsZWN0b3IuZ2V0VmFsdWUoKSApICkge1xuICAgIGJvZHlCdWlsZGVyLmVuYWJsZSgpO1xuICB9IGVsc2Uge1xuICAgIGJvZHlCdWlsZGVyLmRpc2FibGUoKTtcbiAgfVxufSk7XG5cbnBhdGhGaWVsZC5vbigncmVzZXQnLCBmdW5jdGlvbigpe1xuICBtZXRob2RTZWxlY3Rvci5lbmFibGUoKTtcbiAgcXVlcnlCdWlsZGVyLnJlc2V0KCk7XG4gIGJvZHlCdWlsZGVyLnJlc2V0KCk7XG4gIHRpcC5yZXNldCgpO1xufSk7XG5cbi8vIGdsb2JhbCBob3RrZXlzXG4kKGRvY3VtZW50KS5vbigna2V5ZG93bicsIGZ1bmN0aW9uKGUpIHtcblxuICBpZiAoZS53aGljaCA9PSA3NyAmJiBlLmN0cmxLZXkgJiYgIWUuYWx0S2V5ICYmICFlLnNoaWZ0S2V5ICYmICFlLm1ldGFLZXkpIHsgLy8gJ20nICsgY3RybFxuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBtZXRob2RTZWxlY3Rvci50b2dnbGUoKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBpZiAoZS53aGljaCA9PSAxOTEgJiYgZS5jdHJsS2V5ICYmICFlLmFsdEtleSAmJiAhZS5zaGlmdEtleSAmJiAhZS5tZXRhS2V5KSB7IC8vICcvJyArIGN0cmxcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgcGF0aEZpZWxkLmZvY3VzKCk7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgaWYgKGUud2hpY2ggPT0gMjcpIHsgLy8gZXNjXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgICBwYXRoRmllbGQucmVzZXQoKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxufSk7XG5cbmJvZHlCdWlsZGVyLm9uKCdkaXNhYmxlJywgZnVuY3Rpb24oKSB7XG4gIGJvZHlCdWlsZGVyLm5vZGUuYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7XG59KTtcblxuYm9keUJ1aWxkZXIub24oJ2VuYWJsZScsIGZ1bmN0aW9uKCkge1xuICBib2R5QnVpbGRlci5ub2RlLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xufSk7XG5cbnZhciBvblRpcCA9IHRpcC5zZXRWYWx1ZS5iaW5kKHRpcCk7XG5cbnBhdGhGaWVsZC5vbigndGlwJywgb25UaXApO1xucXVlcnlCdWlsZGVyLm9uKCd0aXAnLCBvblRpcCk7XG5ib2R5QnVpbGRlci5vbigndGlwJywgb25UaXApO1xuXG5wYXRoRmllbGQub24oJ2NoYW5nZVBhcmFtcycsIGZ1bmN0aW9uKHBhcmFtcykge1xuICB2YXIgcXVlcnkgPSBwYXJhbXMucXVlcnk7XG4gIHF1ZXJ5QnVpbGRlci5zZXRQYXJhbXMocXVlcnlzdHJpbmcucGFyc2UocXVlcnkpKTtcbn0pO1xuXG5xdWVyeUJ1aWxkZXIub24oJ2NoYW5nZVBhcmFtcycsIGZ1bmN0aW9uKHBhcmFtcyl7XG4gIHBhdGhGaWVsZC5zZXRGaWVsZFZhbHVlKCdxdWVyeScsICQucGFyYW0ocGFyYW1zKSk7XG59KTtcblxudmFyIGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG5wYXRoRmllbGQub24oJ3N1Ym1pdCcsIGZ1bmN0aW9uKHBhdGgpe1xuXG4gIHZhciBtZXRob2QgPSBtZXRob2RTZWxlY3Rvci5nZXRWYWx1ZSgpLFxuICAgICAgYm9keSA9IGJvZHlCdWlsZGVyLmdldFF1ZXJ5KCksXG4gICAgICByZXF1ZXN0ID0ge21ldGhvZDptZXRob2QsIGJvZHk6Ym9keX07XG5cbiAgYS5ocmVmID0gcGF0aDtcblxuICByZXF1ZXN0LnBhdGggPSBhLnBhdGhuYW1lO1xuICByZXF1ZXN0LnF1ZXJ5ID0gYS5zZWFyY2guc3Vic3RyaW5nKDEsIGEuc2VhcmNoLmxlbmd0aCk7XG5cbiAgc2VuZFJlcXVlc3QocmVxdWVzdCkuZm9jdXMoKTtcblxufSk7XG5cblxudHJ5IHtcbiAgcmVmZXJlbmNlUGFuZWwuc2V0SGlzdG9yeShKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5oaXN0b3J5KSk7XG59IGNhdGNoKGUpIHtcbiAgLy8gdW5hYmxlIHRvIGxvYWQgaGlzdG9yeVxufVxuXG5yZWZlcmVuY2VQYW5lbC5vbignaGlzdG9yeScsIGZ1bmN0aW9uKGVuZHBvaW50cykge1xuICBsb2NhbFN0b3JhZ2UuaGlzdG9yeSA9IEpTT04uc3RyaW5naWZ5KGVuZHBvaW50cyk7XG59KTtcblxucmVmZXJlbmNlUGFuZWwub24oJ2NoYW5nZScsIGZ1bmN0aW9uKCkge1xuICBwYXRoRmllbGQucmVxdWVyeSgpO1xufSk7XG5cbmRldi5vbignY2hhbmdlJywgZnVuY3Rpb24oZGV2KSB7XG4gIGlmIChkZXYpIHtcbiAgICBjb25zb2xlLmxvZyhcIkRldmVsb3BlciBtb2RlIGFjdGl2YXRlZFwiKTtcbiAgICBsb2NhbFN0b3JhZ2UuZGV2ZWxvcGVyID0gJ2E4Yyc7XG4gIH0gZWxzZSB7XG4gICAgZGVsZXRlIGxvY2FsU3RvcmFnZS5kZXZlbG9wZXI7XG4gIH1cblxuICByZWZlcmVuY2VQYW5lbC5yZWZyZXNoKCk7XG5cbn0pO1xuXG5kZXYuc2V0VmFsdWUobG9jYWxTdG9yYWdlLmRldmVsb3BlciA9PT0gJ2E4YycpO1xuXG5yZWZlcmVuY2VQYW5lbC5sb2FkKCk7XG5cbndpbmRvdy5zZW5kID0gc2VuZFJlcXVlc3Q7XG5cbn0pOyAvLyAkKCk7IiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbigpIHtcblxuICAgIHJldHVybiByZXF1aXJlKCcuL25vbmNlJykoKTtcblxufTsiLCJ2YXIgJCA9IHJlcXVpcmUoJ3plcHRvLWJyb3dzZXJpZnknKS4kO1xuXG5mdW5jdGlvbiBhdXRoSGVhZGVycygpIHtcblxuICBpZiAocmVzdF9hcGlfY29uc29sZS5yZXN0X25vbmNlKSB7XG4gICAgcmV0dXJuIHsgJ1gtV1AtTm9uY2UnIDogcmVzdF9hcGlfY29uc29sZS5yZXN0X25vbmNlIH07XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHt9O1xuICB9XG5cbn1cblxuZnVuY3Rpb24gc2VuZFJlcXVlc3QocmVxLCBjYWxsYmFjaykge1xuXG4gIC8vIFRPRE86IGZvcm1hdCB0aGUgcmVxdWVzdCBjb3JyZWN0bHkgYmVmb3JlIHNlbmRpbmdcbiAgLy8gY2hlY2sgdGhlIHZlcnNpb25cbiAgLy8gY2xlYW4gdXAgdGhlIHBhdGggaW4gY2FzZSBpdCdzIGFuIGFic29sdXRlIFVSSVxuXG4gICQuYWpheCh7XG4gICAgdHlwZTogcmVxLm1ldGhvZCxcbiAgICB1cmw6IHJlc3RfYXBpX2NvbnNvbGUucmVzdF91cmwgKyByZXEucGF0aCArIChyZXEucXVlcnkgPyBcIj9cIiArIHJlcS5xdWVyeSA6ICcnICksXG4gICAgZGF0YTogLTEgPT09IFsnR0VUJywgJ0RFTEVURScsICdPUFRJT05TJ10uaW5kZXhPZiggcmVxLm1ldGhvZCApID8gcmVxLmJvZHkgOiBudWxsLFxuICAgIGhlYWRlcnM6ICQuZXh0ZW5kKHsnYWNjZXB0JzonYXBwbGljYXRpb24vanNvbid9LCBhdXRoSGVhZGVycygpKSxcbiAgICBzdWNjZXNzOiBmdW5jdGlvbihkYXRhLCBzdGF0dXMsIHhocikge1xuICAgICAgY2FsbGJhY2sobnVsbCwgZGF0YSwgeGhyKTtcbiAgICB9LFxuICAgIGVycm9yOiBmdW5jdGlvbih4aHIsIGVycm9yVHlwZSwgZXJyb3IpIHtcbiAgICAgIHZhciBib2R5ID0geGhyLnJlc3BvbnNlO1xuXG4gICAgICB0cnkge1xuICAgICAgICBib2R5ID0gSlNPTi5wYXJzZShib2R5KTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgLy8gbm90IHZhbGlkIGpzb25cbiAgICAgIH1cbiAgICAgIGNhbGxiYWNrKHtcbiAgICAgICAgc3RhdHVzOiB4aHIuc3RhdHVzLFxuICAgICAgICBlcnJvcjogZXJyb3IsXG4gICAgICAgIGVycm9yVHlwZTogZXJyb3JUeXBlLFxuICAgICAgICBib2R5OiBib2R5LFxuICAgICAgfSwgbnVsbCwgeGhyKTtcbiAgICB9XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBhdXRoKHBhbmVsKSB7XG59XG5cbmF1dGgucHJvdG90eXBlLnJlcXVlc3QgPSBzZW5kUmVxdWVzdDtcblxuZnVuY3Rpb24gYnVpbGRBdXRoKHBhbmVsKSB7XG4gIHJldHVybiBuZXcgYXV0aChwYW5lbCk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiBidWlsZEF1dGg7XG59OyIsInZhciBQQVRIX1NFUEVSQVRPUiA9IFwiL1wiLFxuICAgIFZBUklBQkxFX1NUQVJUID0gXCJ7XCIsXG4gICAgVkFSSUFCTEVfRU5EID0gXCJ9XCIsXG4gICAgcGFydF9idWlsZGVyID0gcmVxdWlyZSgnLi9wYXJ0X2J1aWxkZXInKSxcbiAgICBidWlsZGVyID0gcGFydF9idWlsZGVyKCksXG4gICAgUGFydCA9IHJlcXVpcmUoJy4vcGFydCcpLlBhcnQ7XG5cbmZ1bmN0aW9uIFBhdGgocGF0aCwgcGFyYW1zKSB7XG5cbiAgaWYgKCFwYXJhbXMpIHBhcmFtcyA9IHt9O1xuXG4gIHRoaXMucGF0aCA9IHBhdGg7XG5cbiAgdGhpcy5wYXJ0cyA9IHJlZHVjZVBhcnRzKHBhdGgsIGZ1bmN0aW9uKHBhcnQpIHtcbiAgICByZXR1cm4gYnVpbGRlci5idWlsZChwYXJ0LCBwYXJhbXMpO1xuICB9KTtcbn1cblxuUGF0aC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbih2YWx1ZXMpIHtcbiAgdmFyIHMgPSBcIlwiO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMucGFydHMubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgcGFydCA9IHRoaXMucGFydHNbaV07XG4gICAgcyArPSBwYXJ0LnRvU3RyaW5nKHZhbHVlcyk7XG4gIH1cbiAgcmV0dXJuIHM7XG59O1xuXG5mdW5jdGlvbiByZWR1Y2VQYXJ0cyhwYXRoLCBvblBhcnQpIHtcbiAgdmFyIGkgPSAwLFxuICAgIHBhcnRzID0gW10sXG4gICAgcHVzaCA9IGZ1bmN0aW9uKHBhcnQpIHtcbiAgICAgIGlmIChwYXJ0KSBwYXJ0cy5wdXNoKHBhcnQpO1xuICAgIH07XG4gIGRvIHtcbiAgICB2YXIgJCA9IHBhdGguaW5kZXhPZihWQVJJQUJMRV9TVEFSVCwgaSksXG4gICAgICAkZW5kID0gcGF0aC5pbmRleE9mKFZBUklBQkxFX0VORCwgJCk7XG5cbiAgICAvLyBubyB2YXJpYWJsZSBsZWZ0LCB0aGUgcmVtYWluZGVyIGlzIGEgc2luZ2xlIHBhcnRcbiAgICBpZiAoJCA9PT0gLTEpIHtcbiAgICAgIHB1c2gob25QYXJ0KHBhdGguc2xpY2UoaSkpKTtcbiAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIC8vIHZhcmlhYmxlIGlzIG5vdCBhdCB0aGUgYmVnaW5uaW5nLCB0aGVyZSdzIGEgcHJlZml4XG4gICAgaWYgKCQgPiBpKSB7XG4gICAgICBwdXNoKG9uUGFydChwYXRoLnNsaWNlKGksICQpKSk7XG4gICAgfVxuXG4gICAgLy8gdGhlcmUgYXJlIG5vIG1vcmUgc2VnbWVudHMsIHRoZSByZXN0IGlzIGEgdmFyaWFibGVcbiAgICBpZiAoJGVuZCA9PT0gLTEpIHtcbiAgICAgIHB1c2gob25QYXJ0KHBhdGguc2xpY2UoJCkpKTtcbiAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIHB1c2gob25QYXJ0KHBhdGguc2xpY2UoJCwgJGVuZCArIDEpKSk7XG5cbiAgICBpID0gJGVuZCArIDE7XG5cbiAgfSB3aGlsZShpPHBhdGgubGVuZ3RoKTtcblxuICByZXR1cm4gcGFydHM7XG59XG5cbmZ1bmN0aW9uIERlZmF1bHRQYXRoKCkge1xuICB2YXIgcGFydCA9IG5ldyBQYXJ0KFwicGF0aFwiLCB7bGFiZWw6XCJcIiwgdHlwZTpcInBhcmFtXCIsIGVkaXRhYmxlOnRydWV9KTtcbiAgcGFydC50b1N0cmluZyA9IGZ1bmN0aW9uKHZhbHVlcykge1xuICAgIHJldHVybiB0aGlzLmVuY29kZSh2YWx1ZXMucGF0aCB8fCBcIlwiKTtcbiAgfTtcbiAgdGhpcy5wYXJ0cyA9IFtwYXJ0XTtcbn1cblxuRGVmYXVsdFBhdGgucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShQYXRoLnByb3RvdHlwZSk7XG5cbmZ1bmN0aW9uIFF1ZXJ5UGFydCgpIHtcbiAgUGFydC5jYWxsKHRoaXMsICdxdWVyeScsIHsgdHlwZTpcInBhcmFtXCIsIGxhYmVsOidxdWVyeScsIGVkaXRhYmxlOnRydWV9KTtcbn1cblxuUXVlcnlQYXJ0LnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoUGFydC5wcm90b3R5cGUpO1xuXG5RdWVyeVBhcnQucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24odmFsdWVzKSB7XG4gIHJldHVybiB2YWx1ZXMucXVlcnkgfHwgJyc7XG59O1xuXG5tb2R1bGUuZXhwb3J0cy5QYXRoID0gUGF0aDtcbm1vZHVsZS5leHBvcnRzLlBhcnQgPSBQYXJ0O1xubW9kdWxlLmV4cG9ydHMuRGVmYXVsdFBhdGggPSBEZWZhdWx0UGF0aDtcbm1vZHVsZS5leHBvcnRzLlF1ZXJ5UGFydCA9IFF1ZXJ5UGFydDtcbiIsImZ1bmN0aW9uIFBhcnQobmFtZSwgb3B0aW9ucykge1xuICB0aGlzLm5hbWUgPSBuYW1lO1xuICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICB0aGlzLnR5cGUgPSB0aGlzLm9wdGlvbnMudHlwZSB8fCBcIlwiO1xuICB0aGlzLmxhYmVsID0gdGhpcy5vcHRpb25zLmxhYmVsO1xuICB0aGlzLmVkaXRhYmxlID0gdGhpcy5vcHRpb25zLmVkaXRhYmxlIHx8IGZhbHNlO1xuICB0aGlzLmVuY29kZSA9IHRoaXMub3B0aW9ucy5lbmNvZGUgfHwgZnVuY3Rpb24odmFsKSB7IHJldHVybiBlbmNvZGVVUkkodmFsKTsgfTtcbn1cblxuUGFydC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbih2YWx1ZXMpIHtcbiAgaWYgKHZhbHVlcykge1xuICAgIHZhciBwYXJhbSA9IHZhbHVlc1t0aGlzLm5hbWVdO1xuICAgIGlmIChwYXJhbSkge1xuICAgICAgcmV0dXJuIHRoaXMuZW5jb2RlKHBhcmFtKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHRoaXMubmFtZTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHRoaXMubmFtZTtcbiAgfVxufTtcblxuUGFydC5wcm90b3R5cGUuZ2V0TGFiZWwgPSBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHRoaXMubGFiZWw7XG59O1xuXG5QYXJ0LnByb3RvdHlwZS5nZXRUeXBlID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiB0aGlzLnR5cGU7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKCkge1xuICBcbn07XG5cbm1vZHVsZS5leHBvcnRzLlBhcnQgPSBQYXJ0OyIsInZhciBQYXJ0ID0gcmVxdWlyZSgnLi9wYXJ0JykuUGFydDtcblxuZnVuY3Rpb24gUGFydEJ1aWxkZXIgKGJ1aWxkZXJzKSB7XG4gIHRoaXMuYnVpbGRlcnMgPSBidWlsZGVycztcbn1cblxuUGFydEJ1aWxkZXIucHJvdG90eXBlLmJ1aWxkID0gZnVuY3Rpb24gYnVpbGQocGFydCwgcGFyYW1zKSB7XG5cbiAgdmFyIHBhdGhfcGFydDtcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuYnVpbGRlcnMubGVuZ3RoOyBpKyspIHtcbiAgICBwYXRoX3BhcnQgPSB0aGlzLmJ1aWxkZXJzW2ldKHBhcnQsIHBhcmFtcyk7XG4gICAgaWYgKHBhdGhfcGFydCkge1xuICAgICAgcmV0dXJuIHBhdGhfcGFydDtcbiAgICB9XG4gIH1cblxufTtcblxuZnVuY3Rpb24gcGFyYW1UeXBlKHBhcnQsIHBhcmFtcykge1xuICBpZiAocGFydC5pbmRleE9mKCd7JykgPT09IDApIHtcbiAgICByZXR1cm4gbmV3IFBhcnQocGFydCwge3R5cGU6J3BhcmFtJywgbGFiZWw6cGFydCwgZWRpdGFibGU6dHJ1ZSwgbWV0YTpwYXJhbXNbcGFydF0sIGVuY29kZTpmdW5jdGlvbih2KSB7XG4gICAgICByZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KHYpO1xuICAgIH19KTtcbiAgfVxufVxuXG5mdW5jdGlvbiBzZWdtZW50VHlwZShwYXJ0LCBwYXJhbXMpIHtcbiAgcmV0dXJuIG5ldyBQYXJ0KHBhcnQsIHt0eXBlOidzZWdtZW50JywgbGFiZWw6cGFydCwgZWRpdGFibGU6ZmFsc2V9KTtcbn1cblxuZnVuY3Rpb24gUGF0aFBhcnQgKCkge1xuICBcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbigpe1xuICBcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiBuZXcgUGFydEJ1aWxkZXIoW3BhcmFtVHlwZSwgc2VnbWVudFR5cGVdKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzLlBhcnRCdWlsZGVyID0gUGFydEJ1aWxkZXI7XG5tb2R1bGUuZXhwb3J0cy5QYXRoUGFydCA9IFBhdGhQYXJ0O1xuIiwidmFyIENvbXBvbmVudCA9IHJlcXVpcmUoJy4vY29tcG9uZW50JyksXG4gICAgJCA9IENvbXBvbmVudC4kLFxuICAgIHRyYW5zcGFyZW50ID0gXCJkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUFFQUFBQUJDQVFBQUFDMUhBd0NBQUFBQzBsRVFWUjQybU5nWUFBQUFBTUFBU3NKVFlRQUFBQUFTVVZPUks1Q1lJST1cIjtcblxudmFyIEF1dGhQYW5lbCA9IENvbXBvbmVudC5leHRlbmQoe1xuICAnbG9hZGluZ0NsYXNzJyA6ICdsb2FkaW5nJyxcbiAgJ2F1dGhvcml6ZWRDbGFzcycgOiAnYXV0aG9yaXplZCcsXG4gICdhY3RpdmVDbGFzcycgOiAnYWN0aXZlJyxcbiAgJ2xhYmVsQ2xhc3MnIDogJ2xhYmVsJyxcbiAgJ2ltZ0NsYXNzJyAgIDogJ2ltZycsXG4gICdleHRyYUNsYXNzJyA6ICdleHRyYScsXG4gICdzaWduSW5UZXh0JyA6ICdTaWduIEluJyxcbiAgJ3NpZ25PdXRUZXh0JyA6ICdTaWduIE91dCcsXG4gICdvbkNoYW5nZScgOiBmdW5jdGlvbih2YWx1ZSkge1xuICAgIGlmICghdmFsdWUpIHtcbiAgICAgIHRoaXMuZXh0cmEudGV4dCh0aGlzLm9wdGlvbnMuc2lnbkluVGV4dCk7XG4gICAgICB0aGlzLm5vZGUucmVtb3ZlQ2xhc3ModGhpcy5vcHRpb25zLmF1dGhvcml6ZWRDbGFzcyk7XG4gICAgICB0aGlzLmF2YXRhci5hdHRyKCdzcmMnLCB0cmFuc3BhcmVudCkuaGlkZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmV4dHJhLnRleHQodGhpcy5vcHRpb25zLnNpZ25PdXRUZXh0KTtcbiAgICAgIHRoaXMubm9kZS5hZGRDbGFzcyh0aGlzLm9wdGlvbnMuYXV0aG9yaXplZENsYXNzKTtcbiAgICAgIHZhciBhdmF0YXIgPSB0aGlzLmF2YXRhci5zaG93KCk7XG4gICAgICB2YXIgaW1nID0gbmV3IEltYWdlKCk7XG4gICAgICAkKGltZykub24oJ2xvYWQnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgYXZhdGFyLmF0dHIoJ3NyYycsIHZhbHVlLmF2YXRhcl9VUkwpLmNzcygnb3BhY2l0eScsJzEnKTtcbiAgICAgIH0pLmF0dHIoJ3NyYycsIHZhbHVlID8gdmFsdWUuYXZhdGFyX1VSTCA6ICcnKTtcbiAgICB9XG4gIH0sXG4gICdvbkNoZWNrVG9rZW4nIDogZnVuY3Rpb24oKXsgY29uc29sZS53YXJuKFwiTm8gYXV0aCB0b2tlbiBjaGVja1wiKTsgfSxcbiAgJ2luaXQnOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgdGhpcy5ub2RlLm9uKCdjbGljaycsIHRoaXMub25DbGljay5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLm5vZGUub24oJ2tleWRvd24nLCB0aGlzLmRldGVjdEFjdGl2ZS5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLm5vZGUub24oJ2tleXByZXNzJywgdGhpcy5vbktleXByZXNzLmJpbmQodGhpcykpO1xuICAgIHRoaXMubGFiZWwgPSAkKCc8c3Bhbj48L3NwYW4+JykuYXBwZW5kVG8odGhpcy5ub2RlKS5hZGRDbGFzcyh0aGlzLm9wdGlvbnMubGFiZWxDbGFzcyk7XG4gICAgdGhpcy5leHRyYSA9ICQoJzxzcGFuPjwvc3Bhbj4nKS5hcHBlbmRUbyh0aGlzLm5vZGUpLmFkZENsYXNzKHRoaXMub3B0aW9ucy5leHRyYUNsYXNzKS50ZXh0KHRoaXMub3B0aW9ucy5zaWduSW5UZXh0KTtcbiAgICB0aGlzLmltZyA9ICQoJzxzcGFuPjwvc3Bhbj4nKS5hcHBlbmRUbyh0aGlzLm5vZGUpLmFkZENsYXNzKHRoaXMub3B0aW9ucy5pbWdDbGFzcyk7XG4gICAgdGhpcy5hdmF0YXIgPSAkKCc8aW1nPicpLmFwcGVuZFRvKHRoaXMuaW1nKS5oaWRlKCk7XG5cbiAgICB0aGlzLnRocm9iYmVyID0gJCgnPGRpdj48ZGl2PjwvZGl2PjwvZGl2PicpLmFkZENsYXNzKCd0aHJvYmJlcicpLmFwcGVuZFRvKHRoaXMubm9kZSk7XG4gIH1cbn0pO1xuXG5BdXRoUGFuZWwucHJvdG90eXBlLmNoZWNrQXV0aGVudGljYXRpb24gPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5ub2RlLmFkZENsYXNzKHRoaXMub3B0aW9ucy5sb2FkaW5nQ2xhc3MpO1xuICB0aGlzLmVtaXQoJ2NoZWNrJywgdGhpcy5vbkNoZWNrLmJpbmQodGhpcykpO1xufTtcblxuQXV0aFBhbmVsLnByb3RvdHlwZS5hYm9ydEF1dGggPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5ub2RlLnJlbW92ZUNsYXNzKHRoaXMub3B0aW9ucy5sb2FkaW5nQ2xhc3MpO1xuICB0aGlzLnNldFZhbHVlKG51bGwpO1xufTtcblxuQXV0aFBhbmVsLnByb3RvdHlwZS5vbkNoZWNrID0gZnVuY3Rpb24oZXJyLCByZXNwb25zZSkge1xuXG4gIHRoaXMubm9kZS5yZW1vdmVDbGFzcyh0aGlzLm9wdGlvbnMubG9hZGluZ0NsYXNzKTtcblxuICBpZiAoZXJyKSB7XG4gICAgdGhpcy5zZXRWYWx1ZShudWxsKTtcbiAgfSBlbHNlIHtcbiAgICB0aGlzLnNldFZhbHVlKHJlc3BvbnNlKTtcbiAgfVxuXG59O1xuXG5BdXRoUGFuZWwucHJvdG90eXBlLmdldFJlZGlyZWN0VXJpID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiAkKCdtZXRhW25hbWU9cmVkaXJlY3RfdXJpXScpLmF0dHIoJ2NvbnRlbnQnKTtcbn07XG5cbkF1dGhQYW5lbC5wcm90b3R5cGUucGVyZm9ybUF1dGhBY3Rpb24gPSBmdW5jdGlvbigpIHtcbiAgaWYgKHRoaXMubm9kZS5oYXNDbGFzcyh0aGlzLm9wdGlvbnMubG9hZGluZ0NsYXNzKSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmICh0aGlzLmdldFZhbHVlKCkpIHtcbiAgICB0aGlzLmVtaXQoJ3NpZ25vdXQnLCB0aGlzKTtcbiAgICByZXR1cm47XG4gIH1cblxuICB0aGlzLmVtaXQoJ3NpZ25pbicsIHRoaXMpO1xufTtcblxuQXV0aFBhbmVsLnByb3RvdHlwZS5hdXRoZW50aWNhdGUgPSBBdXRoUGFuZWwucHJvdG90eXBlLnBlcmZvcm1BdXRoQWN0aW9uO1xuXG5BdXRoUGFuZWwucHJvdG90eXBlLm9uQ2xpY2sgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5wZXJmb3JtQXV0aEFjdGlvbigpO1xufTtcblxuQXV0aFBhbmVsLnByb3RvdHlwZS5vbktleXByZXNzID0gZnVuY3Rpb24oZSkge1xuICBpZiAoZS53aGljaCA9PSAxMyB8fCBlLndoaWNoID09IDMyKSB7XG4gICAgdGhpcy5wZXJmb3JtQXV0aEFjdGlvbigpO1xuICB9XG59O1xuXG5BdXRoUGFuZWwucHJvdG90eXBlLmRldGVjdEFjdGl2ZSA9IGZ1bmN0aW9uKGUpIHtcblxuICB2YXIgbm9kZSA9IHRoaXMubm9kZSxcbiAgICAgIGNscyA9IHRoaXMub3B0aW9ucy5hY3RpdmVDbGFzcztcblxuICBpZiAoZS53aGljaCA9PSAxMyB8fCBlLndoaWNoID09IDMyKSB7XG5cbiAgICBub2RlLmFkZENsYXNzKGNscyk7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgIG5vZGUucmVtb3ZlQ2xhc3MoY2xzKTtcbiAgICB9LCAyMDApO1xuXG4gIH1cblxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBBdXRoUGFuZWw7XG4iLCJ2YXIgZXZlbnRzID0gcmVxdWlyZSgnZXZlbnRzJyksXG4gICAgdXRpbCA9IHJlcXVpcmUoJ3V0aWwnKSxcbiAgICBub29wID0gZnVuY3Rpb24oKSB7fSxcbiAgICBjb21wb25lbnRPcHRpb25zID0ge1xuICAgICAgJ2luaXQnICAgICAgICAgOiBub29wLFxuICAgICAgJ2JlZm9yZUNoYW5nZScgOiBmdW5jdGlvbigpIHsgcmV0dXJuIGFyZ3VtZW50c1swXTsgfSxcbiAgICAgICdhZnRlckNoYW5nZScgIDogbm9vcCxcbiAgICAgICdvbkNoYW5nZScgICAgIDogbm9vcCxcbiAgICAgICdvblJlc2V0JyAgICAgIDogbm9vcCxcbiAgICAgICdlbGVtZW50JyAgICAgIDogJ2RpdicsXG4gICAgICAnY2xhc3NOYW1lJyAgICA6ICcnXG4gICAgfSxcbiAgICAkID0gcmVxdWlyZSgnemVwdG8tYnJvd3NlcmlmeScpLiQ7XG5cbmZ1bmN0aW9uIENvbXBvbmVudChub2RlLCBvcHRpb25zKSB7XG5cbiAgZXZlbnRzLkV2ZW50RW1pdHRlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXG4gIHRoaXMuJCA9ICQ7XG5cbiAgdGhpcy5ub2RlID0gJChub2RlKTtcblxuICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuXG4gIHRoaXMubm9kZS5hZGRDbGFzcyh0aGlzLm9wdGlvbnMuY2xhc3NOYW1lKTtcblxuICBpZiAodGhpcy5vcHRpb25zLmluaXQpIHRoaXMub3B0aW9ucy5pbml0LmFwcGx5KHRoaXMsIFt0aGlzLm5vZGUsIHRoaXMub3B0aW9uc10pO1xuXG5cbiAgdGhpcy5zZXRWYWx1ZSh0aGlzLm9wdGlvbnMuZGVmYXVsdFZhbHVlKTtcblxuICBpZiAodGhpcy5vcHRpb25zLmFmdGVySW5pdCkgdGhpcy5vcHRpb25zLmFmdGVySW5pdC5hcHBseSh0aGlzKTtcblxufVxuXG5Db21wb25lbnQuJCA9ICQ7XG5cbnV0aWwuaW5oZXJpdHMoQ29tcG9uZW50LCBldmVudHMuRXZlbnRFbWl0dGVyKTtcblxuQ29tcG9uZW50LnByb3RvdHlwZS5mb2N1cyA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLm5vZGUuZm9jdXMoKTtcbn07XG5cbkNvbXBvbmVudC5wcm90b3R5cGUuc2V0VmFsdWUgPSBmdW5jdGlvbih2YWx1ZSkge1xuXG4gIHZhciBvbGRWYWx1ZSA9IHRoaXMudmFsdWU7XG5cbiAgdmFsdWUgPSB0aGlzLm9wdGlvbnMuYmVmb3JlQ2hhbmdlLmNhbGwodGhpcywgdmFsdWUpO1xuXG4gIGlmICh2YWx1ZSA9PT0gdGhpcy52YWx1ZSkgcmV0dXJuIHRoaXMuZ2V0VmFsdWUoKTtcblxuICB0aGlzLnZhbHVlID0gdmFsdWU7XG5cbiAgdGhpcy5vcHRpb25zLm9uQ2hhbmdlLmNhbGwodGhpcywgdGhpcy52YWx1ZSwgb2xkVmFsdWUpO1xuICB0aGlzLmVtaXQoJ2NoYW5nZScsIHRoaXMudmFsdWUsIG9sZFZhbHVlKTtcbiAgdGhpcy5vcHRpb25zLmFmdGVyQ2hhbmdlLmNhbGwodGhpcywgdGhpcy52YWx1ZSk7XG5cbiAgcmV0dXJuIHRoaXMuZ2V0VmFsdWUoKTtcblxufTtcblxuQ29tcG9uZW50LnByb3RvdHlwZS5nZXRWYWx1ZSA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gdGhpcy52YWx1ZTtcbn07XG5cbkNvbXBvbmVudC5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5zZXRWYWx1ZSh0aGlzLm9wdGlvbnMuZGVmYXVsdFZhbHVlKTtcbiAgdGhpcy5vcHRpb25zLm9uUmVzZXQuYXBwbHkodGhpcyk7XG4gIHRoaXMuZW1pdCgncmVzZXQnKTtcbn07XG5cbkNvbXBvbmVudC5leHRlbmQgPSBmdW5jdGlvbihkZWZhdWx0T3B0aW9ucykge1xuICB2YXIgY3RyID0gZnVuY3Rpb24obm9kZSwgb3B0aW9ucykge1xuICAgIGlmICgkLmlzUGxhaW5PYmplY3Qobm9kZSkpIHtcbiAgICAgIG9wdGlvbnMgPSBub2RlO1xuICAgICAgbm9kZSA9IG51bGw7XG4gICAgfVxuICAgIHZhciBvcHRzID0ge307XG4gICAgJC5leHRlbmQob3B0cywgY29tcG9uZW50T3B0aW9ucywgZGVmYXVsdE9wdGlvbnMsIG9wdGlvbnMpO1xuXG4gICAgaWYgKCFub2RlKSB7XG4gICAgICBub2RlID0gJChkb2N1bWVudC5jcmVhdGVFbGVtZW50KG9wdHMuZWxlbWVudCkpO1xuICAgIH1cblxuICAgIENvbXBvbmVudC5jYWxsKHRoaXMsIG5vZGUsIG9wdHMpO1xuICB9O1xuXG4gIHV0aWwuaW5oZXJpdHMoY3RyLCBDb21wb25lbnQpO1xuXG4gIHJldHVybiBjdHI7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IENvbXBvbmVudDtcbiIsInZhciBDb21wb25lbnQgPSByZXF1aXJlKCcuL2NvbXBvbmVudCcpLFxuICAgICQgPSBDb21wb25lbnQuJCxcbiAgICBmbiA9IHJlcXVpcmUoJ2ZuJyk7XG5cbnZhciBEZXYgPSBDb21wb25lbnQuZXh0ZW5kKHtcbiAgJ2RlZmF1bHRWYWx1ZScgOiBmYWxzZSxcbiAgJ3NlcXVlbmNlJyA6IFszOCwgMzgsIDQwLCA0MCwgMzcsIDM5LCAzNywgMzksIDY2LCA2NV0sXG4gICdpbml0JyA6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMud2FpdCA9IGZuLnJhdGVMaW1pdCgxMDAwLCB0aW1lb3V0LmJpbmQodGhpcykpO1xuICAgIHRoaXMua2V5TGlzdGVuZXIgPSBrZXlMaXN0ZW5lci5iaW5kKHRoaXMpO1xuICAgIHRoaXMuY2FuY2VsVGltZW91dCA9IGZ1bmN0aW9uKCl7fTtcbiAgICB0aGlzLnJlc2V0KCk7XG4gICAgJChkb2N1bWVudCkub24oJ2tleWRvd24nLCB0aGlzLmtleUxpc3RlbmVyKTtcbiAgfSxcbiAgJ29uQ2hhbmdlJyA6IGZ1bmN0aW9uKGRldikge1xuICAgIGlmIChkZXYpIHtcbiAgICAgICQoZG9jdW1lbnQpLm9mZigna2V5ZG93bicsIHRoaXMua2V5TGlzdGVuZXIpO1xuICAgIH1cbiAgfVxufSk7XG5cbkRldi5wcm90b3R5cGUuZmlsdGVyRW5kcG9pbnRzID0gZnVuY3Rpb24oZW5kcG9pbnRzKSB7XG4gIHZhciBpc0RldiA9IHRoaXMuZ2V0VmFsdWUoKTtcblxuICBpZiAoaXNEZXYpIHtcbiAgICByZXR1cm4gZW5kcG9pbnRzO1xuICB9XG5cbiAgcmV0dXJuIGVuZHBvaW50cy5maWx0ZXIoZnVuY3Rpb24oZW5kcG9pbnQpIHtcbiAgICByZXR1cm4gZW5kcG9pbnQuZ3JvdXAgIT0gXCJfX2RvX25vdF9kb2N1bWVudFwiO1xuICB9KTtcbn07XG5cbkRldi5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5zZXF1ZW5jZSA9IHRoaXMub3B0aW9ucy5zZXF1ZW5jZS5zbGljZSgpO1xuICB0aGlzLmNhbmNlbFRpbWVvdXQoKTtcbn07XG5cbkRldi5wcm90b3R5cGUuc3VjY2VzcyA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLnNldFZhbHVlKHRydWUpO1xufTtcblxuZnVuY3Rpb24ga2V5TGlzdGVuZXIoZSkge1xuICB0aGlzLmNhbmNlbFRpbWVvdXQgPSB0aGlzLndhaXQoKTtcblxuICBpZiAoZS53aGljaCA9PT0gdGhpcy5zZXF1ZW5jZVswXSkge1xuICAgIHRoaXMuc2VxdWVuY2Uuc2hpZnQoKTtcbiAgICBpZiAodGhpcy5zZXF1ZW5jZS5sZW5ndGggPT09IDApIHtcbiAgICAgIHRoaXMuc3VjY2VzcygpO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICB0aGlzLnJlc2V0KCk7XG4gIH1cbn1cblxuZnVuY3Rpb24gdGltZW91dCgpIHtcbiAgdGhpcy5yZXNldCgpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IERldjsiLCJcbm1vZHVsZS5leHBvcnRzID0ge1xuICBQYXRoRmllbGQ6ICAgICAgcmVxdWlyZSgnLi9wYXRoX2ZpZWxkJyksXG4gIExvb2t1cFBhbmU6ICAgICByZXF1aXJlKCcuL2xvb2t1cF9wYW5lJyksXG4gIE9wdGlvblNlbGVjdG9yOiByZXF1aXJlKCcuL29wdGlvbl9zZWxlY3RvcicpLFxuICBQYXJhbUJ1aWxkZXI6ICAgcmVxdWlyZSgnLi9wYXJhbV9idWlsZGVyJyksXG4gIFJlcXVlc3RWaWV3ZXI6ICByZXF1aXJlKCcuL3JlcXVlc3Rfdmlld2VyJyksXG4gIEF1dGhQYW5lbDogICAgICByZXF1aXJlKCcuL2F1dGhfcGFuZWwnKSxcbiAgVGlwOiAgICAgICAgICAgIHJlcXVpcmUoJy4vdGlwJyksXG4gIC8vIFJlcXVlc3REZXRhaWw6ICByZXF1aXJlKCcuL3JlcXVlc3RfZGV0YWlsJyksXG4gIFJlZmVyZW5jZVBhbmVsOiByZXF1aXJlKCcuL3JlZmVyZW5jZV9wYW5lbCcpLFxuICBEZXY6ICAgICAgICAgICAgcmVxdWlyZSgnLi9kZXYnKVxufTtcbiIsInZhciBDb21wb25lbnQgPSByZXF1aXJlKCcuL2NvbXBvbmVudCcpLFxuICAgICQgPSBDb21wb25lbnQuJCxcbiAgICB1dGlsID0gcmVxdWlyZSgnLi91dGlsJyksXG4gICAgc3RyaW5naWZ5SnNvbiA9IHV0aWwuc3RyaW5naWZ5SnNvbjtcblxuXG52YXIgSnNvbkJyb3dzZXIgPSBDb21wb25lbnQuZXh0ZW5kKHtcbiAgJ2NsYXNzTmFtZScgOiAnanNvbi1icm93c2UnLFxuICAnY29tcGFjdCcgOiBmYWxzZSxcbiAgJ2xhYmVsJyA6ICcnLFxuICAnb25DaGFuZ2UnIDogZnVuY3Rpb24oanNvbikge1xuICAgIHRoaXMubm9kZS5jaGlsZHJlbigpLnJlbW92ZSgpO1xuXG5cbiAgICBpZiAodGhpcy5vcHRpb25zLmNvbXBhY3QgPT09IHRydWUpIHtcbiAgICAgICQoXCI8b2w+PC9vbD5cIikuYXBwZW5kKGJ1aWxkUm93KHRoaXMub3B0aW9ucy5sYWJlbCwganNvbikpLmFwcGVuZFRvKHRoaXMubm9kZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlbmRlcihqc29uLCB0cnVlKS5hcHBlbmRUbyh0aGlzLm5vZGUpO1xuICAgIH1cblxuICB9XG59KTtcblxuZnVuY3Rpb24gcmVuZGVyKGpzb24sIHJlY3Vyc2l2ZSkge1xuXG4gIHJlY3Vyc2l2ZSA9IHJlY3Vyc2l2ZSA9PT0gdHJ1ZTtcblxuICBpZiAoIXJlY3Vyc2l2ZSkge1xuICAgIHZhciBub2RlID0gc3RyaW5naWZ5SnNvbihqc29uKTtcblxuICAgIHJldHVybiBub2RlO1xuXG4gIH1cblxuICBpZiAoJC5pc1BsYWluT2JqZWN0KGpzb24pKSB7XG4gICAgcmV0dXJuIHJlbmRlck9iamVjdChqc29uKTtcbiAgfVxuXG4gIGlmICgkLmlzQXJyYXkoanNvbikpIHtcbiAgICByZXR1cm4gcmVuZGVyQXJyYXkoanNvbik7XG4gIH1cblxuICByZXR1cm4gc3RyaW5naWZ5SnNvbihqc29uKTtcblxufVxuXG5mdW5jdGlvbiByZW5kZXJPYmplY3QoanNvbiwgcmVjdXJzaXZlKSB7XG5cbiAgdmFyIGxpc3QgPSAkKFwiPG9sPjwvb2w+XCIpLmFkZENsYXNzKCdicm93c2Utb2JqZWN0Jyk7XG5cbiAgcmVjdXJzaXZlID0gcmVjdXJzaXZlID09PSB0cnVlO1xuXG4gIGZvcih2YXIga2V5IGluIGpzb24pIHtcbiAgICBsaXN0LmFwcGVuZChidWlsZFJvdygkKCc8Y29kZT48L2NvZGU+JykudGV4dCgnXCInICsga2V5ICsgJ1wiJykuYXBwZW5kKCc6ICcpLCBqc29uW2tleV0sIHJlY3Vyc2l2ZSkpO1xuICB9XG5cbiAgcmV0dXJuIGxpc3Q7XG5cbn1cblxuZnVuY3Rpb24gcmVuZGVyQXJyYXkoanNvbiwgcmVjdXJzaXZlKSB7XG5cbiAgdmFyIGxpc3QgPSAkKFwiPG9sPjwvb2w+XCIpLmFkZENsYXNzKCdicm93c2UtYXJyYXknKTtcblxuICByZWN1cnNpdmUgPSByZWN1cnNpdmUgPT09IHRydWU7XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBqc29uLmxlbmd0aDsgaSsrKSB7XG4gICAgbGlzdC5hcHBlbmQoYnVpbGRSb3coJCgnPGNvZGU+PC9jb2RlPicpLnRleHQoaSkuYXBwZW5kKCc6ICcpLCBqc29uW2ldKSk7XG4gIH1cblxuICByZXR1cm4gbGlzdDtcblxufVxuXG5mdW5jdGlvbiBidWlsZFJvdyhrZXksIHZhbHVlLCByZWN1cnNpdmUpIHtcbiAgdmFyIHJvdyA9ICQoJzxsaT48L2xpPicpO1xuXG4gIHJvdy5hcHBlbmQoJChcIjxzcGFuPjwvc3Bhbj5cIikuYWRkQ2xhc3MoJ2tleScpLmFwcGVuZChrZXkpKVxuICAgICAuYXBwZW5kKHJlbmRlcih2YWx1ZSwgcmVjdXJzaXZlKSk7XG5cbiAgbWFrZUV4cGFuZGFibGUocm93LCB2YWx1ZSk7XG5cbiAgcmV0dXJuIHJvdztcbn1cblxuZnVuY3Rpb24gaXNFbXB0eUpzb24oanNvbikge1xuICBpZiAoJC5pc0FycmF5KGpzb24pICYmIGpzb24ubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICBmb3IgKHZhciBrZXkgaW4ganNvbikge1xuICAgIGlmIChqc29uLmhhc093blByb3BlcnR5KGtleSkpIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIHJldHVybiB0cnVlO1xufVxuXG5mdW5jdGlvbiBtYWtlRXhwYW5kYWJsZShub2RlLCBqc29uKSB7XG4gIGlmICghJC5pc0FycmF5KGpzb24pICYmICEkLmlzUGxhaW5PYmplY3QoanNvbikpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoaXNFbXB0eUpzb24oanNvbikpIHtcbiAgICByZXR1cm47XG4gIH1cblxuXG4gIHZhciBjb21wcmVzc2VkID0gbm9kZS5maW5kKCcuY29tcGFjdCcpLFxuICAgICAgZXhwYW5kZWQgPSBudWxsO1xuXG4gIG5vZGUuYWRkQ2xhc3MoJ2Nsb3NlZCcpO1xuXG4gIG5vZGUub24oJ2NsaWNrJywgJ3NwYW4ua2V5LCAuY29tcGFjdCcsIGZ1bmN0aW9uKGUpIHtcblxuICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgaWYgKGV4cGFuZGVkID09PSBudWxsKSB7XG4gICAgICBleHBhbmRlZCA9IHJlbmRlcihqc29uLCB0cnVlKTtcbiAgICB9XG5cbiAgICBpZiAobm9kZS5oYXNDbGFzcygnb3BlbicpKSB7XG4gICAgICBub2RlLnJlbW92ZUNsYXNzKCdvcGVuJykuYWRkQ2xhc3MoJ2Nsb3NlZCcpO1xuICAgICAgZXhwYW5kZWQucmVwbGFjZVdpdGgoY29tcHJlc3NlZCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIG5vZGUucmVtb3ZlQ2xhc3MoJ2Nsb3NlZCcpLmFkZENsYXNzKCdvcGVuJyk7XG4gICAgICBjb21wcmVzc2VkLnJlcGxhY2VXaXRoKGV4cGFuZGVkKTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9KTtcblxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IEpzb25Ccm93c2VyOyIsInZhciBDb21wb25lbnQgPSByZXF1aXJlKCcuL2NvbXBvbmVudCcpLFxuICAgICQgPSBDb21wb25lbnQuJDtcblxudmFyIExpc3RDb21wb25lbnQgPSBDb21wb25lbnQuZXh0ZW5kKHtcbiAgJ2VsZW1lbnQnICAgICAgIDogJ29sJyxcbiAgJ2RlZmF1bHRWYWx1ZScgIDogW10sXG4gICd0YWJpbmRleCcgICAgICA6ICcwJyxcbiAgJ2F1dG9TZWxlY3QnICAgIDogdHJ1ZSxcbiAgJ3NlbGVjdGVkQ2xhc3MnIDogJ3NlbGVjdGVkJyxcbiAgJ2Rpc2FibGVkQ2xhc3MnIDogJ2Rpc2FibGVkJyxcbiAgJ2l0ZW1UZW1wbGF0ZScgIDogZnVuY3Rpb24oaXRlbSkgeyByZXR1cm4gJCgnPGxpPjwvbGk+JykudGV4dChpdGVtKTsgfSxcbiAgJ2luaXQnIDogZnVuY3Rpb24obm9kZSwgb3B0aW9ucykge1xuICAgIHRoaXMubm9kZS5vbignY2xpY2snLCAnbGknLCB0aGlzLm9uQ2xpY2tJdGVtLmJpbmQodGhpcykpO1xuICAgIHRoaXMubm9kZS5vbignZGJsY2xpY2snLCAnbGknLCB0aGlzLm9uRGJsQ2xpY2tJdGVtLmJpbmQodGhpcykpO1xuICAgIHRoaXMubm9kZS5vbigna2V5ZG93bicsIHRoaXMub25LZXlkb3duLmJpbmQodGhpcykpO1xuICAgIHRoaXMubm9kZS5vbigna2V5cHJlc3MnLCB0aGlzLm9uS2V5cHJlc3MuYmluZCh0aGlzKSk7XG5cbiAgICB0aGlzLmVuYWJsZSgpO1xuICB9LFxuICAnYWZ0ZXJJbml0JyA6IGZ1bmN0aW9uKCkge1xuICAgIHVwZGF0ZUxpc3QuY2FsbCh0aGlzLCB0aGlzLm9wdGlvbnMuZGVmYXVsdFZhbHVlKTtcbiAgfSxcbiAgJ29uQ2hhbmdlJyA6IGZ1bmN0aW9uKHZhbHVlcywgb2xkVmFsdWVzKSB7XG4gICAgdXBkYXRlTGlzdC5jYWxsKHRoaXMsIHZhbHVlcyk7XG4gIH1cbn0pO1xuXG5mdW5jdGlvbiB1cGRhdGVMaXN0KHZhbHVlcykge1xuXG4gIHRoaXMubm9kZS5jaGlsZHJlbigpLnJlbW92ZSgpO1xuICBpZiAodmFsdWVzWzBdID09PSBcImFsbFwiKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgLy8gZGV0YWNoIGZyb20gcGFyZW50XG4gIHZhciBpdGVtcyA9ICQoKSxcbiAgICAgIGNvbXBvbmVudCA9IHRoaXMsXG4gICAgICB0ZW1wbGF0ZSA9IHRoaXMub3B0aW9ucy5pdGVtVGVtcGxhdGU7XG5cbiAgXy5lYWNoKHZhbHVlcywgZnVuY3Rpb24gKHJvdXRlX2RhdGEsIHJvdXRlKSB7XG4gICAgcm91dGVfZGF0YS5tZXRob2RzLmZvckVhY2goZnVuY3Rpb24gKG1ldGhvZCkge1xuICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgIG1ldGhvZDogbWV0aG9kLFxuICAgICAgICB2ZXJzaW9uOiBcIjJcIixcbiAgICAgICAgcGF0aF9sYWJlbGVkOiByb3V0ZSxcbiAgICAgICAgZGVzY3JpcHRpb246IFwiXCJcbiAgICAgIH07XG4gICAgICBpdGVtcyA9IGl0ZW1zLmFkZCh0ZW1wbGF0ZShkYXRhLCBjb21wb25lbnQpKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgdmFyIHBhcmVudCA9IHRoaXMubm9kZS5wYXJlbnQoKSxcbiAgICAgIG5leHQgPSB0aGlzLm5vZGUubmV4dCgpO1xuXG4gIHRoaXMubm9kZS5yZW1vdmUoKTtcbiAgdGhpcy5ub2RlLmNoaWxkcmVuKCkucmVtb3ZlKCk7XG4gIHRoaXMubm9kZS5hcHBlbmQoaXRlbXMpO1xuXG4gIGlmIChuZXh0Lmxlbmd0aCA+IDApIHtcbiAgICB0aGlzLm5vZGUuaW5zZXJ0QmVmb3JlKG5leHQpO1xuICB9IGVsc2Uge1xuICAgIHRoaXMubm9kZS5hcHBlbmRUbyhwYXJlbnQpO1xuICB9XG5cbiAgaWYgKHRoaXMub3B0aW9ucy5hdXRvU2VsZWN0KSB7XG4gICAgdGhpcy5zZWxlY3RJdGVtKHRoaXMubm9kZS5jaGlsZHJlbigpLmZpcnN0KCkpO1xuICB9XG5cbn1cblxuTGlzdENvbXBvbmVudC5wcm90b3R5cGUuZGlzYWJsZSA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLm5vZGUuYWRkQ2xhc3ModGhpcy5vcHRpb25zLmRpc2FibGVkQ2xhc3MpO1xuICB0aGlzLm5vZGUuYXR0cigndGFiaW5kZXgnLCBudWxsKTtcbn07XG5cbkxpc3RDb21wb25lbnQucHJvdG90eXBlLmVuYWJsZSA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLm5vZGUucmVtb3ZlQ2xhc3ModGhpcy5vcHRpb25zLmRpc2FibGVkQ2xhc3MpO1xuICB0aGlzLm5vZGUuYXR0cigndGFiaW5kZXgnLCB0aGlzLm9wdGlvbnMudGFiaW5kZXgpO1xufTtcblxuTGlzdENvbXBvbmVudC5wcm90b3R5cGUuaXNEaXNhYmxlZCA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gIXRoaXMuaXNFbmFibGVkKCk7XG59O1xuXG5MaXN0Q29tcG9uZW50LnByb3RvdHlwZS5pc0VuYWJsZWQgPSBmdW5jdGlvbigpIHtcbiAgcmV0dXJuICF0aGlzLm5vZGUuaGFzQ2xhc3ModGhpcy5vcHRpb25zLmRpc2FibGVkQ2xhc3MpO1xufTtcblxuTGlzdENvbXBvbmVudC5wcm90b3R5cGUub25LZXlkb3duID0gZnVuY3Rpb24oZSkge1xuICBpZiAodGhpcy5pc0Rpc2FibGVkKCkpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoZS53aGljaCA9PSAzOCkgeyAvLyB1cFxuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB0aGlzLnNlbGVjdFByZXZpb3VzKCk7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9IGVsc2UgaWYgKGUud2hpY2ggPT0gNDApIHsgLy8gZG93blxuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB0aGlzLnNlbGVjdE5leHQoKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn07XG5cbkxpc3RDb21wb25lbnQucHJvdG90eXBlLm9uS2V5cHJlc3MgPSBmdW5jdGlvbihlKSB7XG4gIGlmICh0aGlzLmlzRGlzYWJsZWQoKSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmIChlLndoaWNoID09IDEzKSB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgdGhpcy5zdWJtaXRJdGVtKHRoaXMuZ2V0U2VsZWN0ZWRJdGVtKCkpO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG59O1xuXG5MaXN0Q29tcG9uZW50LnByb3RvdHlwZS5nZXRTZWxlY3RlZEl0ZW0gPSBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHRoaXMubm9kZS5maW5kKCcuJyArIHRoaXMub3B0aW9ucy5zZWxlY3RlZENsYXNzKTtcbn07XG5cbkxpc3RDb21wb25lbnQucHJvdG90eXBlLm9uQ2xpY2tJdGVtID0gZnVuY3Rpb24oZSkge1xuICBpZiAodGhpcy5pc0Rpc2FibGVkKCkpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB0aGlzLnNlbGVjdEl0ZW0oJChlLmN1cnJlbnRUYXJnZXQpKTtcbn07XG5cbkxpc3RDb21wb25lbnQucHJvdG90eXBlLm9uRGJsQ2xpY2tJdGVtID0gZnVuY3Rpb24oZSkge1xuXG4gIGlmICh0aGlzLmlzRGlzYWJsZWQoKSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciB0YXJnZXQgPSAkKGUuY3VycmVudFRhcmdldCk7XG5cbiAgdGhpcy5zZWxlY3RJdGVtKHRhcmdldCk7XG4gIHRoaXMuc3VibWl0SXRlbSh0YXJnZXQpO1xufTtcblxuXG5MaXN0Q29tcG9uZW50LnByb3RvdHlwZS5zZWxlY3ROZXh0ID0gZnVuY3Rpb24oKSB7XG4gIHZhciBuZXh0ID0gdGhpcy5nZXRTZWxlY3RlZEl0ZW0oKS5uZXh0KCk7XG5cbiAgaWYgKG5leHQubGVuZ3RoID4gMCkge1xuICAgIHRoaXMuc2VsZWN0SXRlbShuZXh0KTtcbiAgfVxuXG59O1xuXG5MaXN0Q29tcG9uZW50LnByb3RvdHlwZS5zZWxlY3RQcmV2aW91cyA9IGZ1bmN0aW9uKCkge1xuICB2YXIgcHJldmlvdXMgPSB0aGlzLmdldFNlbGVjdGVkSXRlbSgpLnByZXYoKTtcblxuICBpZiAocHJldmlvdXMubGVuZ3RoID4gMCkge1xuICAgIHRoaXMuc2VsZWN0SXRlbShwcmV2aW91cyk7XG4gIH1cbn07XG5cbkxpc3RDb21wb25lbnQucHJvdG90eXBlLnJlc2VsZWN0U2VsZWN0ZWRJdGVtID0gZnVuY3Rpb24oKSB7XG4gIHZhciBzZWxlY3RlZCA9IHRoaXMuZ2V0U2VsZWN0ZWRJdGVtKCk7XG4gIGlmIChzZWxlY3RlZC5sZW5ndGggPiAwKSB7XG4gICAgdGhpcy5zZWxlY3RJdGVtKHNlbGVjdGVkKTtcbiAgfVxufTtcblxuTGlzdENvbXBvbmVudC5wcm90b3R5cGUuc2VsZWN0SXRlbSA9IGZ1bmN0aW9uKHNlbGVjdGVkKSB7XG4gIHZhciBjdXJyZW50ID0gdGhpcy5nZXRTZWxlY3RlZEl0ZW0oKSxcbiAgICAgIHZhbHVlcyA9IHRoaXMuZ2V0VmFsdWUoKSxcbiAgICAgIGN1cnJlbnRJbmRleCA9IGN1cnJlbnQuaW5kZXgoKSxcbiAgICAgIHNlbGVjdGVkSW5kZXggPSBzZWxlY3RlZC5pbmRleCgpO1xuXG4gIGN1cnJlbnQucmVtb3ZlQ2xhc3ModGhpcy5vcHRpb25zLnNlbGVjdGVkQ2xhc3MpO1xuICBzZWxlY3RlZC5hZGRDbGFzcyh0aGlzLm9wdGlvbnMuc2VsZWN0ZWRDbGFzcyk7XG5cbiAgaWYgKGN1cnJlbnQubGVuZ3RoID4gMCkge1xuICAgIHRoaXMuZW1pdCgnZGVzZWxlY3QnLCB2YWx1ZXNbY3VycmVudEluZGV4XSwgY3VycmVudEluZGV4LCBjdXJyZW50KTtcbiAgfVxuXG4gIGlmIChzZWxlY3RlZC5sZW5ndGggPiAwKSB7XG4gICAgdGhpcy5lbWl0KCdzZWxlY3QnLCB2YWx1ZXNbc2VsZWN0ZWRJbmRleF0sIHNlbGVjdGVkSW5kZXgsIHNlbGVjdGVkKTsgICAgXG4gIH1cblxufTtcblxuTGlzdENvbXBvbmVudC5wcm90b3R5cGUuc3VibWl0SXRlbSA9IGZ1bmN0aW9uKGl0ZW0pIHtcbiAgdmFyIGluZGV4ID0gaXRlbS5pbmRleCgpLFxuICAgICAgdmFsdWUgPSB0aGlzLmdldFZhbHVlKClbaW5kZXhdO1xuXG4gIGlmICh2YWx1ZSkge1xuICAgIGNvbnNvbGUubG9nKFwiU3VibWl0XCIsIHZhbHVlLCBpbmRleCwgaXRlbSk7XG4gICAgdGhpcy5lbWl0KCdzdWJtaXQnLCB2YWx1ZSwgaW5kZXgsIGl0ZW0pO1xuICB9XG5cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gTGlzdENvbXBvbmVudDsiLCJ2YXIgQ29tcG9uZW50ID0gcmVxdWlyZSgnLi9jb21wb25lbnQnKSxcbiAgICAkID0gQ29tcG9uZW50LiQ7XG5cbkxvb2t1cFBhbmUgPSBDb21wb25lbnQuZXh0ZW5kKHtcbiAgJ21heCcgICAgICAgICAgICA6IDMyLFxuICAndGVtcGxhdGUnICAgICAgIDogZnVuY3Rpb24oaXRlbSl7cmV0dXJuICQoXCI8bGk+PC9saT5cIikudGV4dChpdGVtKTsgfSxcbiAgJ2hpZ2hsaWdodENsYXNzJyA6ICdoaWdobGlnaHQnLFxuICAndW5zZWxlY3RhYmxlQ2xhc3MnIDogJ3Vuc2VsZWN0YWJsZScsXG4gICdkZWZhdWx0VmFsdWUnICAgOiBudWxsLFxuICAnaW5pdCcgICAgICAgICAgIDogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5saXN0Tm9kZSA9IENvbXBvbmVudC4kKFwiPG9sPjwvb2w+XCIpLmFwcGVuZFRvKHRoaXMubm9kZSk7XG4gICAgdGhpcy5ub2RlLm9uKCdtb3VzZWRvd24nLCAnbGknLCB0aGlzLm9uQ2xpY2suYmluZCh0aGlzKSk7XG4gICAgdGhpcy5sYXN0X2luZGV4ID0gLTE7XG4gICAgdGhpcy5lbmFibGVNb3VzZSgpO1xuICB9LFxuICAnb25DaGFuZ2UnOiBmdW5jdGlvbih2YWx1ZSwgb2xkVmFsdWUpIHtcblxuICAgIGlmIChvbGRWYWx1ZSkgb2xkVmFsdWUucmVtb3ZlQ2xhc3ModGhpcy5vcHRpb25zLmhpZ2hsaWdodENsYXNzKTtcblxuICAgIGlmICghdmFsdWUpIHtcbiAgICAgIHRoaXMubGFzdF9pbmRleCA9IC0xO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMubGFzdF9pbmRleCA9IHZhbHVlLmluZGV4KCk7XG4gICAgdmFsdWUuYWRkQ2xhc3ModGhpcy5vcHRpb25zLmhpZ2hsaWdodENsYXNzKTtcbiAgICBpZiAoIXRoaXMuZGlzYWJsZVNjcm9sbCkge1xuICAgICAgdGhpcy5zY3JvbGxTZWxlY3RlZFRvVmlzaWJsZSgpO1xuICAgIH1cblxuICB9XG59KTtcblxuTG9va3VwUGFuZS5wcm90b3R5cGUuZGlzcGxheVJlc3VsdHMgPSBmdW5jdGlvbihyZXN1bHRzLCBtYXhSZXN1bHRzKSB7XG5cbiAgdmFyIGxpc3ROb2RlID0gdGhpcy5saXN0Tm9kZSxcbiAgICAgIHRlbXBsYXRlID0gdGhpcy5vcHRpb25zLnRlbXBsYXRlLFxuICAgICAgbWF4ID0gbWF4UmVzdWx0cyA9PT0gbnVsbCA/IHRoaXMub3B0aW9ucy5tYXggOiBtYXhSZXN1bHRzO1xuXG4gIHRoaXMuY2xlYXJSZXN1bHRzKCk7XG5cbiAgdGhpcy5yZXN1bHRzID0gcmVzdWx0cztcblxuICB2YXIgaXRlbXMgPSAkKFtdKTtcbiAgdGhpcy5yZXN1bHRzLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuICAgIGl0ZW1zID0gaXRlbXMuYWRkKHRlbXBsYXRlKGl0ZW0pKTtcbiAgfSk7XG5cbiAgbGlzdE5vZGUuYXBwZW5kKGl0ZW1zKTtcblxuICBpZiAodGhpcy5sYXN0X2luZGV4ID09PSAtMSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmICh0aGlzLmxhc3RfaW5kZXggPiBpdGVtcy5sZW5ndGggLSAxKSB7XG4gICAgdGhpcy5sYXN0X2luZGV4ID0gMDtcbiAgfVxuXG4gIHRoaXMuaGlnaGxpZ2h0TmVhcmVzdFNlbGVjdGFibGUodGhpcy5sYXN0X2luZGV4KTtcblxufTtcblxuTG9va3VwUGFuZS5wcm90b3R5cGUuaGlkZSA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLm5vZGUuaGlkZSgpO1xufTtcblxuTG9va3VwUGFuZS5wcm90b3R5cGUuc2hvdyA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLm5vZGUuc2hvdygpO1xuXG4gIC8vIHNldCB0aGUgbWF4IGhlaWdoIG9mIG91ciBub2RlIHRvIHNjcmVlbiBoZWlnaHQgbWludXMgdG9wXG4gIHZhciB0b3AgPSB0aGlzLm5vZGUub2Zmc2V0KCkudG9wLFxuICAgICAgaGVpZ2h0ID0gJCh3aW5kb3cpLmhlaWdodCgpIC0gdG9wIC0gODtcbiAgXG4gIHRoaXMubGlzdE5vZGUuY3NzKCdtYXgtaGVpZ2h0JywgaGVpZ2h0KTtcblxufTtcblxuTG9va3VwUGFuZS5wcm90b3R5cGUuY2xlYXJSZXN1bHRzID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMubGlzdE5vZGUuY2hpbGRyZW4oKS5yZW1vdmUoKTtcbiAgdGhpcy5yZXN1bHRzID0gW107XG59O1xuXG5Mb29rdXBQYW5lLnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLmNsZWFyUmVzdWx0cygpO1xuICB0aGlzLmxhc3RfaW5kZXggPSAtMTtcbn07XG5cbkxvb2t1cFBhbmUucHJvdG90eXBlLm9uQ2xpY2sgPSBmdW5jdGlvbihlKSB7XG5cbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gIHZhciBjdXJyZW50ID0gJChlLmN1cnJlbnRUYXJnZXQpO1xuXG4gIGlmIChjdXJyZW50Lmhhc0NsYXNzKHRoaXMub3B0aW9ucy51bnNlbGVjdGFibGVDbGFzcykpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICB0aGlzLnNldFZhbHVlKCQoZS5jdXJyZW50VGFyZ2V0KSk7XG4gIHRoaXMuc2VsZWN0Q3VycmVudCgpO1xuICByZXR1cm4gZmFsc2U7XG59O1xuXG5Mb29rdXBQYW5lLnByb3RvdHlwZS5zZWxlY3RDdXJyZW50ID0gZnVuY3Rpb24oKSB7XG5cbiAgaWYgKCF0aGlzLmdldFZhbHVlKCkpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICB2YXIgaW5kZXggPSB0aGlzLmdldFZhbHVlKCkuaW5kZXgoKSxcbiAgICAgIHJlc3VsdCA9IHRoaXMucmVzdWx0cyA/IHRoaXMucmVzdWx0c1tpbmRleF0gOiBmYWxzZTtcblxuICBpZiAoIXJlc3VsdCkgcmV0dXJuIGZhbHNlO1xuXG4gIHRoaXMuZW1pdCgnc2VsZWN0JywgcmVzdWx0KTtcblxuICByZXR1cm4gdHJ1ZTtcblxufTtcblxuTG9va3VwUGFuZS5wcm90b3R5cGUuaGlnaGxpZ2h0Rmlyc3QgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5oaWdobGlnaHROZWFyZXN0U2VsZWN0YWJsZSgwKTtcbn07XG5cbkxvb2t1cFBhbmUucHJvdG90eXBlLmhpZ2hsaWdodExhc3QgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5oaWdobGlnaHROZWFyZXN0U2VsZWN0YWJsZSh0aGlzLmxpc3ROb2RlLmNoaWxkcmVuKCkubGVuZ3RoLTEsIC0xKTtcbn07XG5cbkxvb2t1cFBhbmUucHJvdG90eXBlLmhpZ2hsaWdodE5lYXJlc3RTZWxlY3RhYmxlID0gZnVuY3Rpb24oaW5kZXgsIGRpcmVjdGlvbikge1xuICBpZiAoZGlyZWN0aW9uID09PSBudWxsIHx8IGRpcmVjdGlvbiA9PT0gdW5kZWZpbmVkKSBkaXJlY3Rpb24gPSAxO1xuICB2YXIgY2hpbGRyZW4gPSB0aGlzLmxpc3ROb2RlLmNoaWxkcmVuKCksXG4gICAgICBpdGVtID0gbnVsbDtcblxuICBpZiAoY2hpbGRyZW4ubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuIHRoaXMuc2V0VmFsdWUobnVsbCk7XG4gIH1cblxuICBpZiAoY2hpbGRyZW4ubGVuZ3RoID09PSAxKSB7XG4gICAgcmV0dXJuIHRoaXMuc2V0VmFsdWUoY2hpbGRyZW4uZXEoMCkpO1xuICB9XG5cblxuICBkbyB7XG4gICAgaXRlbSA9IGNoaWxkcmVuLmVxKGluZGV4KTtcbiAgICBpbmRleCArPSBkaXJlY3Rpb247XG5cbiAgICBpZiAoaW5kZXggPCAwIHx8IGluZGV4ID49IGNoaWxkcmVuLmxlbmd0aCkgYnJlYWs7XG5cbiAgfSB3aGlsZShpdGVtLmxlbmd0aCA9PT0gMCB8fCBpdGVtLmhhc0NsYXNzKHRoaXMub3B0aW9ucy51bnNlbGVjdGFibGVDbGFzcykpO1xuXG4gIHRoaXMuc2V0VmFsdWUoaXRlbSk7XG5cbn07XG5cbkxvb2t1cFBhbmUucHJvdG90eXBlLmhpZ2hsaWdodE5leHQgPSBmdW5jdGlvbigpIHtcbiAgdmFyIGN1cnJlbnQgPSB0aGlzLmdldFZhbHVlKCksXG4gICAgICBuZXh0ID0gbnVsbDtcblxuICBpZiAoIWN1cnJlbnQpIHtcbiAgICByZXR1cm4gdGhpcy5oaWdobGlnaHRGaXJzdCgpO1xuICB9XG5cbiAgbmV4dCA9IGN1cnJlbnQubmV4dCgpO1xuICB3aGlsZShuZXh0Lmhhc0NsYXNzKHRoaXMub3B0aW9ucy51bnNlbGVjdGFibGVDbGFzcykpIHtcbiAgICBuZXh0ID0gbmV4dC5uZXh0KCk7XG4gIH1cblxuICBpZiAobmV4dC5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gdGhpcy5oaWdobGlnaHRGaXJzdCgpO1xuICB9XG5cbiAgdGhpcy5zZXRWYWx1ZShuZXh0KTtcblxufTtcblxuTG9va3VwUGFuZS5wcm90b3R5cGUuaGlnaGxpZ2h0UHJldmlvdXMgPSBmdW5jdGlvbigpIHtcbiAgdmFyIGN1cnJlbnQgPSB0aGlzLmdldFZhbHVlKCksXG4gICAgICBwcmV2ID0gbnVsbDtcblxuICBpZiAoIWN1cnJlbnQpIHtcbiAgICB0aGlzLmhpZ2hsaWdodExhc3QoKTtcbiAgICByZXR1cm47XG4gIH1cblxuICBwcmV2ID0gY3VycmVudC5wcmV2KCk7XG5cbiAgd2hpbGUocHJldi5oYXNDbGFzcyh0aGlzLm9wdGlvbnMudW5zZWxlY3RhYmxlQ2xhc3MpKSB7XG4gICAgcHJldiA9IHByZXYucHJldigpO1xuICB9XG5cbiAgaWYgKHByZXYubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuIHRoaXMuaGlnaGxpZ2h0TGFzdCgpO1xuICB9XG5cbiAgdGhpcy5zZXRWYWx1ZShwcmV2KTtcblxufTtcblxuTG9va3VwUGFuZS5wcm90b3R5cGUub25Ib3ZlciA9IGZ1bmN0aW9uKGUpIHtcbiAgdGhpcy5kaXNhYmxlU2Nyb2xsID0gdHJ1ZTtcbiAgdGhpcy5zZXRWYWx1ZSgkKGUuY3VycmVudFRhcmdldCkpO1xuICB0aGlzLmRpc2FibGVTY3JvbGwgPSBmYWxzZTtcbn07XG5cbkxvb2t1cFBhbmUucHJvdG90eXBlLnNjcm9sbFNlbGVjdGVkVG9WaXNpYmxlID0gZnVuY3Rpb24oKSB7XG4gIHZhciBjdXJyZW50ID0gdGhpcy5nZXRWYWx1ZSgpO1xuXG4gIGlmICghY3VycmVudCkge1xuICAgIHRoaXMubm9kZS5zY3JvbGxUb3AoMCk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIG5vZGUgICAgICAgICA9IGN1cnJlbnQsXG4gICAgICBwb3NpdGlvbiAgICAgPSBub2RlLnBvc2l0aW9uKCksXG4gICAgICB0b3AgICAgICAgICAgPSBub2RlWzBdLm9mZnNldFRvcCxcbiAgICAgIGl0ZW1IZWlnaHQgICA9IG5vZGVbMF0ub2Zmc2V0SGVpZ2h0LFxuICAgICAgYm90dG9tICAgICAgID0gdG9wICsgaXRlbUhlaWdodCxcbiAgICAgIGhlaWdodCAgICAgICA9IHRoaXMubGlzdE5vZGUuaGVpZ2h0KCksXG4gICAgICBzY3JvbGxUb3AgICAgPSB0aGlzLmxpc3ROb2RlLnNjcm9sbFRvcCgpLFxuICAgICAgc2Nyb2xsQm90dG9tID0gc2Nyb2xsVG9wICsgdGhpcy5saXN0Tm9kZS5oZWlnaHQoKTtcblxuICBpZiAodG9wIDw9IHNjcm9sbFRvcCkge1xuICAgIHRoaXMubGlzdE5vZGUuc2Nyb2xsVG9wKHRvcCAtIGl0ZW1IZWlnaHQpO1xuICB9IGVsc2UgaWYgKGJvdHRvbSA+PSBzY3JvbGxCb3R0b20pIHtcbiAgICB0aGlzLmxpc3ROb2RlLnNjcm9sbFRvcChib3R0b20gLSBoZWlnaHQgKyBpdGVtSGVpZ2h0KTtcbiAgfVxuXG5cbn07XG5cbkxvb2t1cFBhbmUucHJvdG90eXBlLmlnbm9yZU1vdXNlID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMubm9kZS5vZmYoJ21vdXNlZW50ZXIubG9va3VwLXBhbmUnKTtcbiAgdGhpcy5ub2RlLm9uZSgnbW91c2Vtb3ZlJywgdGhpcy5lbmFibGVNb3VzZS5iaW5kKHRoaXMpKTtcbn07XG5cbkxvb2t1cFBhbmUucHJvdG90eXBlLmVuYWJsZU1vdXNlID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMubm9kZS5vbignbW91c2VlbnRlci5sb29rdXAtcGFuZScsICdsaScsIHRoaXMub25Ib3Zlci5iaW5kKHRoaXMpKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gTG9va3VwUGFuZTtcbiIsInZhciBDb21wb25lbnQgPSByZXF1aXJlKCcuL2NvbXBvbmVudCcpLFxuICAgICQgPSBDb21wb25lbnQuJDtcblxudmFyIE9wdGlvblNlbGVjdG9yID0gQ29tcG9uZW50LmV4dGVuZCh7XG4gICdjbGFzc05hbWUnICAgICAgOiAnb3B0aW9uX3NlbGVjdG9yJyxcbiAgJ3ZhbHVlcycgICAgICAgICA6IFtdLFxuICAnbGFiZWxDbGFzcycgICAgIDogJ2xhYmVsJyxcbiAgJ29wdGlvbnNDbGFzcycgICA6ICdvcHRpb25zJyxcbiAgJ2hpZ2hsaWdodENsYXNzJyA6ICdoaWdobGlnaHQnLFxuICAnZGlzYWJsZWRDbGFzcycgIDogJ2Rpc2FibGVkJyxcbiAgJ3RhYkluZGV4JyAgICAgICA6IDEsXG4gICdsYWJlbCcgICAgICAgICAgOiBmdW5jdGlvbih2YWx1ZSkgeyByZXR1cm4gdmFsdWU7IH0sXG4gICdvcHRpb25MYWJlbCcgICAgOiBmdW5jdGlvbih2YWx1ZSwgaW5kZXgpIHtcbiAgICByZXR1cm4gdmFsdWU7XG4gIH0sXG4gICdpbml0JyA6IGZ1bmN0aW9uKCkge1xuXG4gICAgdGhpcy5lbmFibGVkID0gdHJ1ZTtcblxuICAgIHRoaXMubGFiZWwgPSAkKFwiPHNwYW4+PC9zcGFuPlwiKS5hZGRDbGFzcyh0aGlzLm9wdGlvbnMubGFiZWxDbGFzcykuYXBwZW5kVG8odGhpcy5ub2RlKTtcbiAgICB0aGlzLmNvbnRhaW5lciA9ICQoXCI8ZGl2PjwvZGl2PlwiKS5hZGRDbGFzcyh0aGlzLm9wdGlvbnMub3B0aW9uc0NsYXNzKS5hcHBlbmRUbyh0aGlzLm5vZGUpO1xuXG4gICAgdGhpcy5jb250YWluZXIuaGlkZSgpO1xuXG4gICAgdGhpcy5ub2RlLm9uKCdmb2N1cycsIHRoaXMub25Gb2N1cy5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLm5vZGUub24oJ2JsdXInLCB0aGlzLm9uQmx1ci5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLm5vZGUub24oJ21vdXNlbGVhdmUnLCB0aGlzLm9uTGVhdmUuYmluZCh0aGlzKSk7XG4gICAgdGhpcy5ub2RlLm9uKCdtb3VzZWRvd24nLCB0aGlzLm9uRG93bi5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLm5vZGUub24oJ2NsaWNrJywgdGhpcy5vbkNsaWNrLmJpbmQodGhpcykpO1xuICAgIHRoaXMubm9kZS5vbignY2xpY2snLCAnbGknLCB0aGlzLm9uQ2xpY2tPcHRpb24uYmluZCh0aGlzKSk7XG5cbiAgICB0aGlzLmtleUxpc3RlbmVyID0gdGhpcy5vbktleXByZXNzLmJpbmQodGhpcyk7XG5cbiAgICBpZiAodGhpcy5vcHRpb25zLnZhbHVlcy5sZW5ndGggPiAwICYmIHRoaXMub3B0aW9ucy5kZWZhdWx0VmFsdWUgIT09IGZhbHNlKSB7XG4gICAgICB0aGlzLm9wdGlvbnMuZGVmYXVsdFZhbHVlID0gdGhpcy5vcHRpb25zLnZhbHVlc1swXTtcbiAgICB9XG4gICAgdGhpcy5vcGVuID0gZmFsc2U7XG4gICAgdGhpcy5lbmFibGUoKTtcbiAgICB0aGlzLnNldE9wdGlvbnModGhpcy5vcHRpb25zLnZhbHVlcyk7XG4gICAgdGhpcy5yZXNldCgpO1xuICB9LFxuICAnb25DaGFuZ2UnIDogZnVuY3Rpb24odmFsdWUsIG9sZFZhbHVlKSB7XG4gICAgdGhpcy5sYWJlbC50ZXh0KHRoaXMub3B0aW9ucy5sYWJlbCh2YWx1ZSA/IHZhbHVlIDogXCJcIikpO1xuICAgIHRoaXMucmVmcmVzaEl0ZW1zKCk7XG4gIH1cbn0pO1xuXG5PcHRpb25TZWxlY3Rvci5wcm90b3R5cGUuZGlzYWJsZSA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLmVuYWJsZWQgPSBmYWxzZTtcbiAgdGhpc1xuICAgIC5ub2RlLmFkZENsYXNzKHRoaXMub3B0aW9ucy5kaXNhYmxlZENsYXNzKVxuICAgIC5hdHRyKCd0YWJJbmRleCcsIG51bGwpO1xuICBcbiAgdGhpcy5lbWl0KCdkaXNhYmxlZCcpO1xufTtcblxuT3B0aW9uU2VsZWN0b3IucHJvdG90eXBlLmVuYWJsZSA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLmVuYWJsZWQgPSB0cnVlO1xuICB0aGlzXG4gICAgLm5vZGUucmVtb3ZlQ2xhc3ModGhpcy5vcHRpb25zLmRpc2FibGVkQ2xhc3MpXG4gICAgLmF0dHIoJ3RhYkluZGV4JywgdGhpcy5vcHRpb25zLnRhYkluZGV4KTtcbiAgdGhpcy5lbWl0KCdlbmFibGVkJyk7XG59O1xuXG5PcHRpb25TZWxlY3Rvci5wcm90b3R5cGUub25Gb2N1cyA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLmZvY3VzZWQgPSB0cnVlO1xuICB0aGlzLnNob3dPcHRpb25zKCk7XG59O1xuXG5PcHRpb25TZWxlY3Rvci5wcm90b3R5cGUub25CbHVyID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuZm9jdXNlZCA9IGZhbHNlO1xuICB0aGlzLmhpZGVPcHRpb25zKCk7XG59O1xuXG5PcHRpb25TZWxlY3Rvci5wcm90b3R5cGUub25MZWF2ZSA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLm5vZGUuYmx1cigpO1xufTtcblxuT3B0aW9uU2VsZWN0b3IucHJvdG90eXBlLnNob3dPcHRpb25zID0gZnVuY3Rpb24oKSB7XG5cbiAgaWYgKCF0aGlzLmVuYWJsZWQpIHJldHVybjtcblxuICB0aGlzLm9wZW4gPSB0cnVlO1xuXG4gIHRoaXMucmVmcmVzaEl0ZW1zKCk7XG5cbiAgdGhpcy5jb250YWluZXIuc2hvdygpO1xuICB0aGlzLm5vZGUub2ZmKCdrZXlkb3duJywgdGhpcy5rZXlMaXN0ZW5lcik7XG4gIHRoaXMubm9kZS5vbigna2V5ZG93bicsIHRoaXMua2V5TGlzdGVuZXIpO1xuXG59O1xuXG5PcHRpb25TZWxlY3Rvci5wcm90b3R5cGUuaGlkZU9wdGlvbnMgPSBmdW5jdGlvbigpIHtcblxuICB0aGlzLm9wZW4gPSBmYWxzZTtcblxuICB0aGlzLmNvbnRhaW5lci5oaWRlKCk7XG4gIHRoaXMubm9kZS5vZmYoJ2tleWRvd24nLCB0aGlzLmtleUxpc3RlbmVyKTtcbn07XG5cbk9wdGlvblNlbGVjdG9yLnByb3RvdHlwZS5vbktleXByZXNzID0gZnVuY3Rpb24oZSkge1xuICBpZiAoZS53aGljaCA9PSAzOCkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB0aGlzLmhpZ2hsaWdodFByZXYoKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBpZiAoZS53aGljaCA9PSA0MCkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB0aGlzLmhpZ2hsaWdodE5leHQoKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBpZiAoZS53aGljaCA9PSAxMykge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuICAgIHRoaXMuc2VsZWN0SGlnaGxpZ2h0ZWQoKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBpZiAoZS53aGljaCA9PSAyNykge1xuICAgIHRoaXMubm9kZS5ibHVyKCk7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG59O1xuXG5PcHRpb25TZWxlY3Rvci5wcm90b3R5cGUub25Eb3duID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuY2xvc2VPbkNsaWNrID0gdGhpcy5vcGVuO1xufVxuXG5PcHRpb25TZWxlY3Rvci5wcm90b3R5cGUub25DbGljayA9IGZ1bmN0aW9uKGUpIHtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICBpZiAodGhpcy5jbG9zZU9uQ2xpY2spIHtcbiAgICB0aGlzLm5vZGUuYmx1cigpO1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn07XG5cbk9wdGlvblNlbGVjdG9yLnByb3RvdHlwZS5vbkNsaWNrT3B0aW9uID0gZnVuY3Rpb24oZSkge1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG4gIHZhciB2YWwgPSB0aGlzLm9wdGlvbnMudmFsdWVzWyQoZS5jdXJyZW50VGFyZ2V0KS5pbmRleCgpXTtcbiAgdGhpcy5zZXRWYWx1ZSh2YWwpO1xuICByZXR1cm4gZmFsc2U7XG59O1xuXG5PcHRpb25TZWxlY3Rvci5wcm90b3R5cGUuc2V0VmFsdWUgPSBmdW5jdGlvbih2KSB7XG5cbiAgaWYgKCF0aGlzLmVuYWJsZWQpIHJldHVybjtcblxuICBDb21wb25lbnQucHJvdG90eXBlLnNldFZhbHVlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cbn07XG5cbk9wdGlvblNlbGVjdG9yLnByb3RvdHlwZS5zZXRPcHRpb25zID0gZnVuY3Rpb24ob3B0aW9ucykge1xuICB0aGlzLm9wdGlvbnMudmFsdWVzID0gb3B0aW9ucztcblxuICBpZiAodGhpcy5vcHRpb25zLnZhbHVlcy5sZW5ndGggPD0gMSkge1xuICAgIHRoaXMuZGlzYWJsZSgpO1xuICB9IGVsc2Uge1xuICAgIHRoaXMuZW5hYmxlKCk7XG4gIH1cblxuICBpZiAodGhpcy5vcGVuKSB7XG4gICAgdGhpcy5yZWZyZXNoSXRlbXMoKTtcbiAgfVxuICBcbn07XG5cbk9wdGlvblNlbGVjdG9yLnByb3RvdHlwZS5yZWZyZXNoSXRlbXMgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5yZW1vdmVJdGVtcygpO1xuICB0aGlzLmFkZEl0ZW1zKCk7XG4gIHRoaXMuaGlnaGxpZ2h0TmV4dCgpO1xufTtcblxuT3B0aW9uU2VsZWN0b3IucHJvdG90eXBlLmFkZEl0ZW1zID0gZnVuY3Rpb24oKSB7XG5cbiAgdmFyIGxpc3QgPSAkKCc8dWw+PC91bD4nKSxcbiAgICAgIGN1cnJlbnQgPSB0aGlzLmdldFZhbHVlKCksXG4gICAgICBvcHRpb25MYWJlbCA9IHRoaXMub3B0aW9ucy5vcHRpb25MYWJlbDtcblxuICB0aGlzLm9wdGlvbnMudmFsdWVzLmZvckVhY2goZnVuY3Rpb24odiwgaSl7XG4gICAgdmFyIGl0ZW0gPSAkKFwiPGxpPjwvbGk+XCIpLFxuICAgICAgbGFiZWwgPSBvcHRpb25MYWJlbCh2LCBpKTtcblxuICAgIGlmKHYgPT09IGN1cnJlbnQpIGl0ZW0uYWRkQ2xhc3MoJ3NlbGVjdGVkJyk7XG5cbiAgICBpZiAodHlwZW9mIGxhYmVsID09ICdzdHJpbmcnKSB7XG4gICAgICBpdGVtLnRleHQobGFiZWwpO1xuICAgIH0gZWxzZSB7XG4gICAgICBpdGVtLmFwcGVuZChsYWJlbCk7XG4gICAgfVxuXG4gICAgbGlzdC5hcHBlbmQoaXRlbSk7XG4gIH0pO1xuXG4gIGxpc3QuYXBwZW5kVG8odGhpcy5jb250YWluZXIpO1xuXG59O1xuXG5PcHRpb25TZWxlY3Rvci5wcm90b3R5cGUucmVtb3ZlSXRlbXMgPSBmdW5jdGlvbigpIHtcblxuICB0aGlzLmNvbnRhaW5lci5maW5kKCd1bCcpLnJlbW92ZSgpO1xuXG59O1xuXG5PcHRpb25TZWxlY3Rvci5wcm90b3R5cGUuZ2V0SGlnaGxpZ2h0ZWQgPSBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHRoaXMuY29udGFpbmVyLmZpbmQoJ2xpLicgKyB0aGlzLm9wdGlvbnMuaGlnaGxpZ2h0Q2xhc3MpO1xufTtcblxuT3B0aW9uU2VsZWN0b3IucHJvdG90eXBlLnNlbGVjdEhpZ2hsaWdodGVkID0gZnVuY3Rpb24oKSB7XG4gIHZhciBoaWdobGlnaHRlZCA9IHRoaXMuZ2V0SGlnaGxpZ2h0ZWQoKTtcblxuICBpZiAoaGlnaGxpZ2h0ZWQubGVuZ3RoID4gMCkge1xuICAgIHRoaXMuc2V0VmFsdWUodGhpcy5vcHRpb25zLnZhbHVlc1toaWdobGlnaHRlZC5pbmRleCgpXSk7XG4gIH1cblxufTtcblxuT3B0aW9uU2VsZWN0b3IucHJvdG90eXBlLmhpZ2hsaWdodE5leHQgPSBmdW5jdGlvbigpIHtcbiAgdmFyIGhpZ2hsaWdodGVkID0gdGhpcy5nZXRIaWdobGlnaHRlZCgpLFxuICAgICAgbmV4dCA9IGhpZ2hsaWdodGVkLm5leHQoJ2xpJyk7XG5cbiAgaWYgKG5leHQubGVuZ3RoID09PSAwKSB7XG4gICAgbmV4dCA9IHRoaXMuY29udGFpbmVyLmZpbmQoJ2xpJykuZmlyc3QoKTtcbiAgfVxuXG4gIGhpZ2hsaWdodGVkLnJlbW92ZUNsYXNzKHRoaXMub3B0aW9ucy5oaWdobGlnaHRDbGFzcyk7XG4gIG5leHQuYWRkQ2xhc3ModGhpcy5vcHRpb25zLmhpZ2hsaWdodENsYXNzKTtcblxufTtcblxuT3B0aW9uU2VsZWN0b3IucHJvdG90eXBlLmhpZ2hsaWdodFByZXYgPSBmdW5jdGlvbigpIHtcbiAgdmFyIGhpZ2hsaWdodGVkID0gdGhpcy5nZXRIaWdobGlnaHRlZCgpLFxuICAgICAgcHJldiA9IGhpZ2hsaWdodGVkLnByZXYoJ2xpJyk7XG5cbiAgaWYgKHByZXYubGVuZ3RoID09PSAwKSB7XG4gICAgcHJldiA9IHRoaXMuY29udGFpbmVyLmZpbmQoJ2xpJykubGFzdCgpO1xuICB9XG5cbiAgaGlnaGxpZ2h0ZWQucmVtb3ZlQ2xhc3ModGhpcy5vcHRpb25zLmhpZ2hsaWdodENsYXNzKTtcbiAgcHJldi5hZGRDbGFzcyh0aGlzLm9wdGlvbnMuaGlnaGxpZ2h0Q2xhc3MpO1xuICBcbn07XG5cbk9wdGlvblNlbGVjdG9yLnByb3RvdHlwZS50b2dnbGUgPSBmdW5jdGlvbigpIHtcblxuICB2YXIgY3VycmVudCA9IHRoaXMuZ2V0VmFsdWUoKSxcbiAgICAgIGkgPSB0aGlzLm9wdGlvbnMudmFsdWVzLmluZGV4T2YoY3VycmVudCk7XG5cbiAgICBpZiAoaSA9PT0gdGhpcy5vcHRpb25zLnZhbHVlcy5sZW5ndGggLSAxKSB7XG4gICAgICBpID0gLTE7XG4gICAgfVxuXG4gICAgaSsrO1xuICAgIHRoaXMuc2V0VmFsdWUodGhpcy5vcHRpb25zLnZhbHVlc1tpXSk7XG5cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gT3B0aW9uU2VsZWN0b3I7IiwidmFyIENvbXBvbmVudCA9IHJlcXVpcmUoJy4vY29tcG9uZW50JyksXG4gICAgJCA9IENvbXBvbmVudC4kLFxuICAgIHF1ZXJ5c3RyaW5nID0gcmVxdWlyZSgncXVlcnlzdHJpbmcnKSxcbiAgICBmbiA9IHJlcXVpcmUoJ2ZuJyk7XG5cbnZhciBQYXJhbUJ1aWxkZXIgPSBDb21wb25lbnQuZXh0ZW5kKHtcbiAgJ3RpdGxlJyAgICAgIDogbnVsbCxcbiAgJ3Jhd0NsYXNzJyAgIDogJ3JhdycsXG4gICd0YWJsZUNsYXNzJyA6ICd0YWJsZScsXG4gICdpbml0JyAgICAgICA6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuZW5hYmxlZCA9IHRydWU7XG5cbiAgICB0aGlzLm5vZGUuYXBwZW5kKCQoXCI8aGVhZGVyPjwvaGVhZGVyPlwiKS50ZXh0KHRoaXMub3B0aW9ucy50aXRsZSkpO1xuXG4gICAgdGhpcy5mb2N1c0xpc3RlbmVyID0gdGhpcy5vbkZvY3VzLmJpbmQodGhpcyk7XG4gICAgdGhpcy5ibHVyTGlzdGVuZXIgPSB0aGlzLm9uQmx1ci5iaW5kKHRoaXMpO1xuICAgIHRoaXMuY2hhbmdlTGlzdGVuZXIgPSB0aGlzLm9uQ2hhbmdlLmJpbmQodGhpcyk7XG4gICAgdGhpcy5pbnB1dExpc3RlbmVyID0gdGhpcy5vbklucHV0LmJpbmQodGhpcyk7XG4gICAgdGhpcy5wYXN0ZUxpc3RlbmVyID0gdGhpcy5vblBhc3RlLmJpbmQodGhpcyk7XG5cbiAgICB0aGlzLnNjcm9sbENhbmNlbCA9IGZ1bmN0aW9uKCl7fTtcbiAgICB0aGlzLnNjcm9sbENhbGN1bGF0b3IgPSBmbi5yYXRlTGltaXQoMTAwLCB0aGlzLnNjcm9sbEludG9WaWV3LmJpbmQodGhpcykpO1xuXG4gICAgdGhpcy5zZWN0aW9uID0gJCgnPGRpdj48L2Rpdj4nKS5hZGRDbGFzcygnY29udGFpbmVyJykuYXBwZW5kVG8odGhpcy5ub2RlKTtcblxuICAgIHRoaXMuc2Nyb2xsZXIgPSAkKCc8ZGl2PjwvZGl2PicpLmFkZENsYXNzKCdzY3JvbGxlcicpLmFwcGVuZFRvKHRoaXMuc2VjdGlvbik7XG5cbiAgICB0aGlzLnRhYmxlID0gJCgnPHRhYmxlPjwvdGFibGU+JykuYWRkQ2xhc3ModGhpcy5vcHRpb25zLnRhYmxlQ2xhc3MpLmFwcGVuZFRvKHRoaXMuc2Nyb2xsZXIpO1xuICAgIHRoaXMucmF3ID0gJCgnPGRpdj48L2Rpdj4nKVxuICAgICAgLmFkZENsYXNzKHRoaXMub3B0aW9ucy5yYXdDbGFzcylcbiAgICAgIC5hcHBlbmRUbyh0aGlzLm5vZGUpO1xuXG4gICAgdGhpcy5zZXR1cElucHV0KHRoaXMucmF3LCBmdW5jdGlvbihidWlsZGVyLCBlKXtcbiAgICAgIGJ1aWxkZXIucmF3UGFyYW1zID0gYnVpbGRlci5yYXcudGV4dCgpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5wYXJhbXMgPSB7fTtcblxuICAgIHRoaXMuc2VjdGlvbi5oaWRlKCk7XG5cbiAgICB0aGlzLnNjcm9sbGVyLm9uKCdzY3JvbGwnLCB0aGlzLm9uU2Nyb2xsLmJpbmQodGhpcykpO1xuICB9LFxuICAnYmVmb3JlQ2hhbmdlJyA6IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgaWYgKCQuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHJldHVybiB2YWx1ZTtcbiAgfSxcbiAgJ29uQ2hhbmdlJyA6IGZ1bmN0aW9uKHZhbHVlLCBvbGRWYWx1ZSkge1xuXG4gICAgdmFyIHJvd3MgPSAkKFtdKTtcblxuICAgIGlmICghdmFsdWUpIHtcbiAgICAgIHRoaXMuc2VjdGlvbi5oaWRlKCk7XG4gICAgICB0aGlzLnJhdy5zaG93KCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5zZWN0aW9uLnNob3coKTtcbiAgICB0aGlzLnJhdy5oaWRlKCk7XG5cbiAgICB0aGlzLmZpZWxkcyA9IHt9O1xuXG4gICAgZm9yKHZhciBuYW1lIGluIHZhbHVlKSB7XG4gICAgICByb3dzID0gcm93cy5hZGQoJChcIjx0cj48L3RyPlwiKVxuICAgICAgICAuYXBwZW5kKCQoXCI8dGg+PC90aD5cIikudGV4dChuYW1lKSlcbiAgICAgICAgLmFwcGVuZCgkKFwiPHRkPjwvdGQ+XCIpLmFwcGVuZCh0aGlzLnNldHVwRmllbGRJbnB1dChuYW1lLCAkKFwiPGRpdj48L2Rpdj5cIikudGV4dCh0aGlzLmdldFBhcmFtKG5hbWUpKSkpXG4gICAgICApKTtcbiAgICB9XG5cbiAgICAvLyByZW1vdmUgYWxsIGV4aXN0aW5nIGxpc3RlbmVycyBmcm9tIHRhYmxlIGVkaXRhYmxlc1xuICAgIHRoaXMudGFibGUuZmluZCgnZGl2Jykub2ZmKCk7XG4gICAgLy8gcmVtb3ZlIGV4aXN0aW5nIHJvd3NcbiAgICB0aGlzLnRhYmxlLmZpbmQoJ3RyJykucmVtb3ZlKCk7XG4gICAgdGhpcy50YWJsZS5hcHBlbmQocm93cyk7XG4gICAgdGhpcy50YWJsZS5vbignY2xpY2snLCAndGgnLCBmdW5jdGlvbihlKXtcbiAgICAgICQoZS5jdXJyZW50VGFyZ2V0KS5wYXJlbnRzKCd0cicpLmZpbmQoJ2RpdicpLmZvY3VzKCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLnVwZGF0ZVNjcm9sbGVyKCk7XG4gIH1cbn0pO1xuXG5QYXJhbUJ1aWxkZXIucHJvdG90eXBlLnNldHVwSW5wdXQgPSBmdW5jdGlvbihmaWVsZCwgZnVuYykge1xuXG4gIGlmICghZnVuYykge1xuICAgIGZvcm1hdHRlciA9IGZ1bmN0aW9uKCl7fTtcbiAgfVxuXG4gIGZpZWxkXG4gICAgLmF0dHIoXCJjb250ZW50ZWRpdGFibGVcIix0cnVlKVxuICAgIC5hdHRyKFwidGFiaW5kZXhcIixcIjFcIilcbiAgICAub24oJ2tleWRvd24nLCB0aGlzLmlucHV0TGlzdGVuZXIpXG4gICAgLm9uKCdrZXl1cCcsIGZuLmFyZ2xvY2sodGhpcy5jaGFuZ2VMaXN0ZW5lciwgZnVuYykpXG4gICAgLm9uKCdwYXN0ZScsIHRoaXMucGFzdGVMaXN0ZW5lcik7XG5cbiAgcmV0dXJuIGZpZWxkO1xufTtcblxuUGFyYW1CdWlsZGVyLnByb3RvdHlwZS5zZXR1cEZpZWxkSW5wdXQgPSBmdW5jdGlvbihuYW1lLCBub2RlKSB7XG5cbiAgdmFyIGZvcm1hdCA9IGZ1bmN0aW9uKGJ1aWxkZXIpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gbm9kZS5odG1sKCkucmVwbGFjZSgvPGJyPjxicj4kLywgJ1xcbicpLnJlcGxhY2UoLzxicj4vZywgJ1xcbicpLnRyaW0oKTtcbiAgICAgICAgYnVpbGRlci5zZXRQYXJhbShuYW1lLCB2YWx1ZSk7XG4gICAgICB9LFxuICAgICAgdGlwID0gJC5leHRlbmQoe25hbWU6bmFtZSwgY29udGV4dDpub2RlfSwgdGhpcy52YWx1ZVtuYW1lXSk7XG5cbiAgdGhpcy5maWVsZHNbbmFtZV0gPSBub2RlLmVxKDApO1xuXG4gIHJldHVybiB0aGlzLnNldHVwSW5wdXQobm9kZSwgZm9ybWF0KVxuICAgICAgICAgIC5vbignZm9jdXMnLCBmbi5hcmdsb2NrKHRoaXMuZm9jdXNMaXN0ZW5lciwgbm9kZSwgdGlwKSlcbiAgICAgICAgICAub24oJ2JsdXInLCBmbi5hcmdsb2NrKHRoaXMuYmx1ckxpc3RlbmVyLCBub2RlKSk7XG59O1xuXG5QYXJhbUJ1aWxkZXIucHJvdG90eXBlLnNldFBhcmFtID0gZnVuY3Rpb24obmFtZSwgdmFsdWUpIHtcblxuICBpZiAodmFsdWUgPT09IFwiXCIpIHtcbiAgICBkZWxldGUgdGhpcy5wYXJhbXNbbmFtZV07XG4gIH0gZWxzZSB7XG4gICAgdGhpcy5wYXJhbXNbbmFtZV0gPSB2YWx1ZTtcbiAgfVxuXG4gIHRoaXMuZW1pdCgnY2hhbmdlUGFyYW1zJywgdGhpcy5wYXJhbXMpO1xuXG59O1xuXG5QYXJhbUJ1aWxkZXIucHJvdG90eXBlLmdldFBhcmFtcyA9IGZ1bmN0aW9uKCkge1xuICB2YXIgcGFyYW1zID0ge307XG5cbiAgZm9yKHZhciBwYXJhbSBpbiB0aGlzLnZhbHVlKSB7XG4gICAgaWYgKHRoaXMucGFyYW1zW3BhcmFtXSAmJiB0aGlzLnBhcmFtc1twYXJhbV0gIT09IFwiXCIpIHtcbiAgICAgIHBhcmFtc1twYXJhbV0gPSB0aGlzLnBhcmFtc1twYXJhbV07XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHBhcmFtcztcbn07XG5cblBhcmFtQnVpbGRlci5wcm90b3R5cGUuc2V0UGFyYW1zID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gIHRoaXMucGFyYW1zID0gcGFyYW1zO1xuXG4gIGZvcih2YXIgZmllbGQgaW4gdGhpcy5maWVsZHMpIHtcbiAgICAkKHRoaXMuZmllbGRzW2ZpZWxkXSkudGV4dCh0aGlzLnBhcmFtc1tmaWVsZF0gfHwgJycpO1xuICB9XG5cbn07XG5cblBhcmFtQnVpbGRlci5wcm90b3R5cGUuZ2V0UGFyYW0gPSBmdW5jdGlvbihuYW1lKSB7XG4gIHZhciB2YWx1ZSA9IHRoaXMucGFyYW1zW25hbWVdO1xuXG4gIHJldHVybiB2YWx1ZSB8fCBcIlwiO1xuXG59O1xuXG5QYXJhbUJ1aWxkZXIucHJvdG90eXBlLmVuYWJsZSA9IGZ1bmN0aW9uKCkge1xuXG4gIHRoaXMuZW5hYmxlZCA9IHRydWU7XG5cbiAgdGhpcy50YWJsZS5maW5kKCdkaXYnKS5hZGQodGhpcy5yYXcpXG4gICAgLmF0dHIoJ2NvbnRlbnRlZGl0YWJsZScsIHRydWUpXG4gICAgLmF0dHIoJ3RhYmluZGV4JywgJzEnKTtcblxuICB0aGlzLmVtaXQoJ2VuYWJsZScpO1xuXG59O1xuXG5QYXJhbUJ1aWxkZXIucHJvdG90eXBlLmRpc2FibGUgPSBmdW5jdGlvbigpIHtcblxuICB0aGlzLmVuYWJsZWQgPSBmYWxzZTtcbiAgLy8gcmVtb3ZlIGFsbCBmb2N1c2FiaWxpdHlcbiAgdGhpcy50YWJsZS5maW5kKCdkaXYnKS5hZGQodGhpcy5yYXcpXG4gICAgLmF0dHIoJ2NvbnRlbnRlZGl0YWJsZScsIG51bGwpXG4gICAgLmF0dHIoJ3RhYmluZGV4JywgbnVsbCk7XG5cbiAgdGhpcy5lbWl0KCdkaXNhYmxlJyk7XG5cbn07XG5cblBhcmFtQnVpbGRlci5wcm90b3R5cGUub25Gb2N1cyA9IGZ1bmN0aW9uKGVkaXRhYmxlTm9kZSwgdGlwLCBlKSB7XG4gIHRoaXMuZm9jdXNlZFRpcCA9IHRpcDtcbiAgdGhpcy5lbWl0KCd0aXAnLCB0aXApO1xufTtcblxuUGFyYW1CdWlsZGVyLnByb3RvdHlwZS5vbkJsdXIgPSBmdW5jdGlvbihlZGl0YWJsZU5vZGUsIGUpIHtcbiAgdGhpcy5mb2N1c2VkVGlwID0gbnVsbDtcbn07XG5cblBhcmFtQnVpbGRlci5wcm90b3R5cGUub25DaGFuZ2UgPSBmdW5jdGlvbihmbiwgZSkge1xuICB2YXIgdGFyZ2V0ID0gJChlLmN1cnJlbnRUYXJnZXQpLFxuICAgICAgcXVlcnkgPSBxdWVyeXN0cmluZy5wYXJzZSh0YXJnZXQudGV4dCgpKTtcblxuICBmbih0aGlzLCBlKTtcblxuICB0aGlzLnVwZGF0ZVNjcm9sbGVyKCk7XG59O1xuXG5QYXJhbUJ1aWxkZXIucHJvdG90eXBlLm9uSW5wdXQgPSBmdW5jdGlvbihlKSB7XG4gIGlmIChlLndoaWNoID09PSAxMykge1xuICAgIGRvY3VtZW50LmV4ZWNDb21tYW5kKCdpbnNlcnRIVE1MJywgZmFsc2UsICc8YnI+PGJyPicpO1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn07XG5cblBhcmFtQnVpbGRlci5wcm90b3R5cGUub25QYXN0ZSA9IGZ1bmN0aW9uKGUpIHtcblxuICB2YXIgY29udGVudCA9IGUuY2xpcGJvYXJkRGF0YS5nZXREYXRhKCd0ZXh0L3BsYWluJyk7XG4gIGUucHJldmVudERlZmF1bHQoKTtcbiAgZG9jdW1lbnQuZXhlY0NvbW1hbmQoJ2luc2VydEhUTUwnLCBmYWxzZSwgY29udGVudC5yZXBsYWNlKC9cXG4kLywgJzxicj48YnI+JykucmVwbGFjZSgvXFxuL2csICc8YnI+JykpO1xuICByZXR1cm4gZmFsc2U7XG5cbn07XG5cblBhcmFtQnVpbGRlci5wcm90b3R5cGUub25TY3JvbGwgPSBmdW5jdGlvbihlKSB7XG5cbiAgaWYgKHRoaXMuZm9jdXNlZFRpcCkge1xuICAgIHRoaXMuZW1pdCgndGlwJywgbnVsbCk7XG4gIH1cblxuICB0aGlzLnVwZGF0ZVNjcm9sbGVyKCk7XG5cbiAgdGhpcy5zY3JvbGxDYW5jZWwoKTtcbiAgdGhpcy5zY3JvbGxDYW5jZWwgPSB0aGlzLnNjcm9sbENhbGN1bGF0b3IoKTtcblxufTtcblxuUGFyYW1CdWlsZGVyLnByb3RvdHlwZS5zY3JvbGxJbnRvVmlldyA9IGZ1bmN0aW9uKCkge1xuXG4gIHZhciBub2RlID0gdGhpcy5zY3JvbGxlci5nZXQoMCksXG4gICAgICBzY3JvbGxCb3VuZHMgPSB7XG4gICAgICAgIHRvcDogbm9kZS5zY3JvbGxUb3AsXG4gICAgICAgIGJvdHRvbTogbm9kZS5jbGllbnRIZWlnaHQgKyBub2RlLnNjcm9sbFRvcCxcbiAgICAgICAgaGVpZ2h0OiBub2RlLmNsaWVudEhlaWdodFxuICAgICAgfTtcblxuICBpZiAodGhpcy5mb2N1c2VkVGlwKSB7XG4gICAgdmFyIHBvc2l0aW9uID0gdGhpcy5mb2N1c2VkVGlwLmNvbnRleHQucG9zaXRpb24oKTtcblxuICAgIHBvc2l0aW9uLmJvdHRvbSA9IHBvc2l0aW9uLnRvcCArIHRoaXMuZm9jdXNlZFRpcC5jb250ZXh0LmhlaWdodCgpO1xuXG4gICAgaWYgKHBvc2l0aW9uLmJvdHRvbSA+IDAgJiYgcG9zaXRpb24udG9wIDwgc2Nyb2xsQm91bmRzLmhlaWdodCkge1xuICAgICAgdGhpcy5lbWl0KCd0aXAnLCB0aGlzLmZvY3VzZWRUaXApO1xuICAgIH1cblxuICB9XG4gIFxufTtcblxuUGFyYW1CdWlsZGVyLnByb3RvdHlwZS51cGRhdGVTY3JvbGxlciA9IGZ1bmN0aW9uKCkge1xuXG4gIHZhciBub2RlID0gdGhpcy5zY3JvbGxlci5nZXQoMCksXG4gICAgICBzY3JvbGxUb3AgPSBub2RlLnNjcm9sbFRvcCxcbiAgICAgIGF0VG9wID0gc2Nyb2xsVG9wID09PSAwLFxuICAgICAgYXRCb3R0b20gPSBub2RlLnNjcm9sbEhlaWdodCAtIHNjcm9sbFRvcCA9PT0gbm9kZS5jbGllbnRIZWlnaHQ7XG5cbiAgaWYgKHRoaXMuc2VjdGlvbi5oYXNDbGFzcygnYXQtdG9wJykgJiYgIWF0VG9wKSB7XG4gICAgdGhpcy5zZWN0aW9uLnJlbW92ZUNsYXNzKCdhdC10b3AnKTtcbiAgfSBlbHNlIGlmICghdGhpcy5zZWN0aW9uLmhhc0NsYXNzKCdhdC10b3AnKSAmJiBhdFRvcCkge1xuICAgIHRoaXMuc2VjdGlvbi5hZGRDbGFzcygnYXQtdG9wJyk7XG4gIH1cblxuICBpZiAodGhpcy5zZWN0aW9uLmhhc0NsYXNzKCdhdC1ib3R0b20nKSAmJiAhYXRCb3R0b20pIHtcbiAgICB0aGlzLnNlY3Rpb24ucmVtb3ZlQ2xhc3MoJ2F0LWJvdHRvbScpO1xuICB9IGVsc2UgaWYgKCF0aGlzLnNlY3Rpb24uaGFzQ2xhc3MoJ2F0LWJvdHRvbScpICYmIGF0Qm90dG9tKSB7XG4gICAgdGhpcy5zZWN0aW9uLmFkZENsYXNzKCdhdC1ib3R0b20nKTtcbiAgfVxuXG59O1xuXG5QYXJhbUJ1aWxkZXIucHJvdG90eXBlLmdldFF1ZXJ5ID0gZnVuY3Rpb24oKSB7XG5cbiAgaWYgKCF0aGlzLnZhbHVlIHx8IHRoaXMudmFsdWUgPT09ICcnKSB7XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBxdWVyeXN0cmluZy5wYXJzZSh0aGlzLnJhdy50ZXh0KCkpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHJldHVybiB7fTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gdGhpcy5nZXRQYXJhbXMoKTtcblxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBQYXJhbUJ1aWxkZXI7IiwidmFyIENvbXBvbmVudCA9IHJlcXVpcmUoJy4vY29tcG9uZW50JyksXG4gICAgJCA9IENvbXBvbmVudC4kLFxuICAgIExvb2t1cFBhbmUgPSByZXF1aXJlKCcuL2xvb2t1cF9wYW5lJyksXG4gICAgZm4gPSByZXF1aXJlKCdmbicpLFxuICAgIG5vb3AgPSBmdW5jdGlvbigpe30sXG4gICAgdXRpbCA9IHJlcXVpcmUoJ3V0aWwnKTtcblxuXG52YXIgUGF0aEZpZWxkID0gQ29tcG9uZW50LmV4dGVuZCh7XG4gICdkZWNvcmF0b3JzJyAgOicjbWV0aG9kLCNzdWJtaXQsI3NlYXJjaCwjcGFydHMsI2xvb2t1cCcsXG4gICdzdWJtaXQnICAgICAgOicjc3VibWl0JyxcbiAgJ3NlYXJjaCcgICAgICA6JyNzZWFyY2gnLFxuICAnY29udGFpbmVyJyAgIDonI3BhcnRzJyxcbiAgJ2xvb2t1cCcgICAgICA6JyNsb29rdXAnLFxuICAnYWN0aXZlQ2xhc3MnIDonYWN0aXZlJyxcbiAgJ29uU2VhcmNoJyAgICA6bm9vcCxcbiAgJ29uU2VsZWN0JyAgICA6bm9vcCxcbiAgJ2l0ZW1UZW1wbGF0ZSc6ZnVuY3Rpb24oaXRlbSl7XG4gICAgcmV0dXJuICQoXCI8bGk+PC9saT5cIikudGV4dChcIml0ZW1cIik7XG4gIH0sXG4gICdpbml0JzpmdW5jdGlvbigpIHtcbiAgICB0aGlzLnZhbHVlcyA9IHsncGF0aCc6Jyd9O1xuXG4gICAgdGhpcy5ub2RlLm9uKCdjbGljaycsIHRoaXMub3B0aW9ucy5zdWJtaXQsIHRoaXMuYnVpbGRQYXRoLmJpbmQodGhpcykpO1xuICAgIHRoaXMubm9kZS5vbignY2xpY2snLCB0aGlzLm9wdGlvbnMuc2VhcmNoLCB0aGlzLm9uU2VhcmNoLmJpbmQodGhpcykpO1xuXG4gICAgdGhpcy5ub2RlLm9uKCdrZXlkb3duJywgdGhpcy5vcHRpb25zLnN1Ym1pdCwgdGhpcy5kZXRlY3RBY3RpdmUuYmluZCh0aGlzKSk7XG4gICAgdGhpcy5ub2RlLm9uKCdrZXlwcmVzcycsIHRoaXMub3B0aW9ucy5zdWJtaXQsIHRoaXMub25TdWJtaXRLZXlwcmVzcy5iaW5kKHRoaXMpKTtcblxuICAgIHRoaXMucGFydHNOb2RlID0gdGhpcy5ub2RlLmZpbmQodGhpcy5vcHRpb25zLmNvbnRhaW5lcik7XG5cbiAgICB0aGlzLmxvb2t1cFBhbmUgPSBuZXcgTG9va3VwUGFuZSgkKHRoaXMub3B0aW9ucy5sb29rdXApLCB7XG4gICAgICB0ZW1wbGF0ZTogdGhpcy5vcHRpb25zLml0ZW1UZW1wbGF0ZVxuICAgIH0pO1xuXG4gICAgdGhpcy5sYXN0X3F1ZXJ5ID0gbnVsbDtcbiAgICB0aGlzLmNhbmNlbF9zZWFyY2ggPSBub29wO1xuXG5cbiAgICB0aGlzLnNlYXJjaCA9IGZuLnJhdGVMaW1pdCgyMDAsIChmdW5jdGlvbihxKXtcbiAgICAgIHRoaXMub3B0aW9ucy5vblNlYXJjaChxLCBmbi5hcmdsb2NrKHRoaXMub25SZXN1bHRzLCBxKS5iaW5kKHRoaXMpKTtcbiAgICB9KS5iaW5kKHRoaXMpKTtcblxuICAgIHRoaXMubG9va3VwUGFuZS5vbignc2VsZWN0JywgdGhpcy5vcHRpb25zLm9uU2VsZWN0KTtcblxuICAgIHRoaXMua2V5TGlzdGVuZXIgPSB0aGlzLm9uS2V5ZG93bi5iaW5kKHRoaXMpO1xuXG4gICAgJChkb2N1bWVudCkub24oJ2tleWRvd24nLCB0aGlzLmtleUxpc3RlbmVyKTtcbiAgfSxcbiAgJ29uQ2hhbmdlJyA6IGZ1bmN0aW9uKHBhdGgpIHtcblxuICAgIGlmICghcGF0aCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuY2xlYXJOb2RlcygpO1xuXG4gICAgaWYgKHRoaXMuaGFzU2VsZWN0aW9uKCkpIHtcbiAgICAgIHRoaXMubm9kZS5hZGRDbGFzcygnZW5kcG9pbnQnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5ub2RlLnJlbW92ZUNsYXNzKCdlbmRwb2ludCcpO1xuICAgIH1cblxuICAgIHRoaXMuZm9jdXNhYmxlX3BhcnRzID0gW107XG4gICAgcGF0aC5wYXJ0cy5mb3JFYWNoKGJ1aWxkTm9kZS5iaW5kKHRoaXMpKTtcblxuICAgIHRoaXMuZm9jdXMoKTtcblxuICAgIGlmICh0aGlzLmhhc1NlbGVjdGlvbigpKSB7XG4gICAgICB0aGlzLmxvb2t1cFBhbmUuaGlkZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmxvb2t1cFBhbmUuc2hvdygpO1xuICAgIH1cblxuICAgIHRoaXMubGFzdF9xdWVyeSA9IG51bGw7XG4gIH1cbn0pO1xuXG5QYXRoRmllbGQucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24oKSB7XG5cbiAgaWYgKHRoaXMuaGFzU2VsZWN0aW9uKCkpIHtcbiAgICBDb21wb25lbnQucHJvdG90eXBlLnJlc2V0LmFwcGx5KHRoaXMpO1xuICB9IGVsc2Uge1xuICAgIHRoaXMubGFzdF9xdWVyeSA9IG51bGw7XG4gICAgZGVidWdfb25fc2VhcmNoID0gdHJ1ZTtcbiAgICB0aGlzLmNhbmNlbF9zZWFyY2goKTtcbiAgICB0aGlzLmxvb2t1cFBhbmUucmVzZXQoKTtcbiAgICB0aGlzLmxvb2t1cFBhbmUuaGlkZSgpO1xuICB9XG5cbn07XG5cblBhdGhGaWVsZC5wcm90b3R5cGUuY2xlYXJOb2RlcyA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLnBhcnRzTm9kZS5jaGlsZHJlbigpLm5vdCh0aGlzLm9wdGlvbnMuZGVjb3JhdG9ycykucmVtb3ZlKCk7XG59O1xuXG5QYXRoRmllbGQucHJvdG90eXBlLmhhc1NlbGVjdGlvbiA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gdGhpcy5vcHRpb25zLmRlZmF1bHRWYWx1ZSAhPT0gdGhpcy52YWx1ZTtcbn07XG5cblBhdGhGaWVsZC5wcm90b3R5cGUuaGFzUGF0aCA9IGZ1bmN0aW9uKCkge1xuXG4gIHJldHVybiB0aGlzLnZhbHVlLnRvU3RyaW5nKHRoaXMudmFsdWVzKSAhPT0gXCJcIjtcblxufTtcblxuUGF0aEZpZWxkLnByb3RvdHlwZS5idWlsZFBhdGggPSBmdW5jdGlvbigpIHtcblxuICBpZiAodGhpcy5oYXNQYXRoKCkpIHtcbiAgICB0aGlzLmNhbmNlbF9zZWFyY2goKTtcbiAgICB0aGlzLmVtaXQoJ3N1Ym1pdCcsIHRoaXMudmFsdWUudG9TdHJpbmcodGhpcy52YWx1ZXMpLCB0aGlzLmhhc1NlbGVjdGlvbigpID8gdGhpcy52YWx1ZSA6IG51bGwpO1xuICB9XG5cbn07XG5cblBhdGhGaWVsZC5wcm90b3R5cGUuc2V0RmllbGRWYWx1ZSA9IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7XG5cbiAgdmFyIGZpZWxkID0gdGhpcy5nZXRGaWVsZChuYW1lKSxcbiAgICAgICRub2RlID0gJChmaWVsZC5ub2RlKTtcblxuICB0aGlzLnZhbHVlc1tuYW1lXSA9IHZhbHVlO1xuICAkbm9kZS50ZXh0KHZhbHVlKTtcblxuICBpZiAodmFsdWUgJiYgdmFsdWUgIT09ICcnKSB7XG4gICAgJG5vZGUuYWRkQ2xhc3MoJ21vZGlmaWVkJyk7XG4gIH1cblxufTtcblxuUGF0aEZpZWxkLnByb3RvdHlwZS5nZXRGaWVsZCA9IGZ1bmN0aW9uKG5hbWUpIHtcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuZm9jdXNhYmxlX3BhcnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgdmFyIHBhcnQgPSB0aGlzLmZvY3VzYWJsZV9wYXJ0c1tpXTtcbiAgICBpZiAobmFtZSA9PSBwYXJ0LnBhcnQubmFtZSkge1xuICAgICAgcmV0dXJuIHBhcnQ7XG4gICAgfVxuICB9XG4gIHJldHVybiBudWxsO1xufTtcblxuUGF0aEZpZWxkLnByb3RvdHlwZS5zZXRQYXJhbSA9IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7XG4gIGlmKHRoaXMudmFsdWVzW25hbWVdICE9IHZhbHVlKSB7XG5cbiAgICB0aGlzLnZhbHVlc1tuYW1lXSA9IHZhbHVlO1xuICAgIHRoaXMuZW1pdCgnY2hhbmdlUGFyYW1zJywgdGhpcy52YWx1ZXMpO1xuXG4gICAgdGhpcy5wZXJmb3JtU2VhcmNoKCk7XG5cbiAgfVxufTtcblxuUGF0aEZpZWxkLnByb3RvdHlwZS5wZXJmb3JtU2VhcmNoID0gZnVuY3Rpb24oKSB7XG5cbiAgaWYgKHRoaXMuaGFzU2VsZWN0aW9uKCkpIHJldHVybjtcblxuICB2YXIgcXVlcnkgPSBkZWNvZGVVUkkodGhpcy52YWx1ZS50b1N0cmluZyh0aGlzLnZhbHVlcykpO1xuXG4gIGlmICh0aGlzLmxhc3RfcXVlcnkgPT09IHF1ZXJ5KSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdGhpcy5sYXN0X3F1ZXJ5ID0gcXVlcnk7XG5cbiAgdGhpcy5jYW5jZWxfc2VhcmNoKCk7XG4gIHRoaXMuY2FuY2VsX3NlYXJjaCA9IHRoaXMuc2VhcmNoKHF1ZXJ5KTtcblxufTtcblxuUGF0aEZpZWxkLnByb3RvdHlwZS5yZXF1ZXJ5ID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMubGFzdF9xdWVyeSA9IG51bGw7XG4gIHRoaXMucGVyZm9ybVNlYXJjaCgpO1xufTtcblxuUGF0aEZpZWxkLnByb3RvdHlwZS5nZXRQYXJhbSA9IGZ1bmN0aW9uKG5hbWUpIHtcbiAgcmV0dXJuIHRoaXMudmFsdWVzW25hbWVdIHx8IFwiXCI7XG59O1xuXG5QYXRoRmllbGQucHJvdG90eXBlLm9uU2VhcmNoID0gZnVuY3Rpb24oKSB7XG4gIGlmICh0aGlzLmhhc1NlbGVjdGlvbigpKSB7XG4gICAgdGhpcy5yZXNldCgpO1xuICB9XG4gIHRoaXMuZm9jdXMoKTtcbn07XG5cblBhdGhGaWVsZC5wcm90b3R5cGUub25SZXN1bHRzID0gZnVuY3Rpb24ocXVlcnksIHJlc3VsdHMpIHtcbiAgLy8gVE9ETzogbWFrZSBzdXJlIHdlJ3JlIHdhaXRpbmcgZm9yIHRoZSBzYW1lIHF1ZXJ5XG4gIHRoaXMubG9va3VwUGFuZS5kaXNwbGF5UmVzdWx0cyhyZXN1bHRzKTtcbn07XG5cblBhdGhGaWVsZC5wcm90b3R5cGUuZm9jdXMgPSBmdW5jdGlvbihwYXJ0KSB7XG5cbiAgaWYgKCFwYXJ0KSB7XG4gICAgcGFydCA9IHRoaXMuZm9jdXNhYmxlX3BhcnRzWzBdO1xuICB9XG5cbiAgaWYgKHBhcnQpIHtcbiAgICAkKHBhcnQubm9kZSkuZm9jdXMoKTtcbiAgfSBlbHNlIHtcbiAgICB0aGlzLm5vZGUuZmluZCh0aGlzLm9wdGlvbnMuc3VibWl0KS5mb2N1cygpO1xuICB9XG5cbn07XG5cblBhdGhGaWVsZC5wcm90b3R5cGUudXBkYXRlUmFuZ2UgPSBmdW5jdGlvbihwYXJ0LCBub2RlKSB7XG4gIHZhciByYW5nZSA9IGRvY3VtZW50LmNyZWF0ZVJhbmdlKCksXG4gICAgICBzZWxlY3Rpb24gPSB3aW5kb3cuZ2V0U2VsZWN0aW9uKCksXG4gICAgICB2YWx1ZSA9IHRoaXMuZ2V0UGFyYW0ocGFydC5uYW1lKTtcblxuICBpZiAodmFsdWUgPT09IFwiXCIpIHtcbiAgICByYW5nZS5zZXRTdGFydChub2RlLCAwKTtcbiAgfSBlbHNlIHtcbiAgICByYW5nZS5zZXRTdGFydEFmdGVyKG5vZGUuZmlyc3RDaGlsZCk7XG4gIH1cblxuICBzZWxlY3Rpb24ucmVtb3ZlQWxsUmFuZ2VzKCk7XG4gIHNlbGVjdGlvbi5hZGRSYW5nZShyYW5nZSk7XG59O1xuXG5QYXRoRmllbGQucHJvdG90eXBlLm9uS2V5ZG93biA9IGZ1bmN0aW9uKGUpIHtcblxuICB2YXIgaGFzU2VsZWN0aW9uID0gdGhpcy5oYXNTZWxlY3Rpb24oKTtcblxuICBpZiAoZS53aGljaCA9PSAxMykge1xuXG4gICAgaWYgKCFoYXNTZWxlY3Rpb24gJiYgdGhpcy5sb29rdXBQYW5lLnNlbGVjdEN1cnJlbnQoKSkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICB9XG5cbn07XG5cblBhdGhGaWVsZC5wcm90b3R5cGUuZGV0ZWN0QWN0aXZlID0gZnVuY3Rpb24oZSkge1xuXG4gIHZhciBzdWJtaXQgPSB0aGlzLm5vZGUuZmluZCh0aGlzLm9wdGlvbnMuc3VibWl0KSxcbiAgICAgIGNscyA9IHRoaXMub3B0aW9ucy5hY3RpdmVDbGFzcztcblxuICBpZiAoZS53aGljaCA9PSAxMyB8fCBlLndoaWNoID09IDMyKSB7XG4gICAgaWYgKGUudHlwZSA9PSAna2V5ZG93bicpIHtcbiAgICAgIC8vIHByZXZlbnQgd2luZG93IGZyb20gcmVjZWl2aW5nXG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuXG4gICAgICBpZiAoIXRoaXMuaGFzUGF0aCgpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgc3VibWl0LmFkZENsYXNzKGNscyk7XG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICBzdWJtaXQucmVtb3ZlQ2xhc3MoY2xzKTtcbiAgICAgIH0sIDEwMCk7XG4gICAgfVxuICB9XG5cblxufTtcblxuUGF0aEZpZWxkLnByb3RvdHlwZS5vblN1Ym1pdEtleXByZXNzID0gZnVuY3Rpb24oZSkge1xuXG4gIGlmIChlLndoaWNoID09IDEzIHx8IGUud2hpY2ggPT0gMzIpIHsgLy8gcmV0dXJuIG9yIHNwYWNlXG4gICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICB0aGlzLmJ1aWxkUGF0aCgpO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG59O1xuXG5QYXRoRmllbGQucHJvdG90eXBlLm9uRm9jdXNQYXJ0ID0gZnVuY3Rpb24ocGFydCwgbm9kZSkge1xuXG4gIGNsZWFyVGltZW91dCh0aGlzLmJsdXJfdGltZW91dCk7XG4gIGlmICghdGhpcy5oYXNTZWxlY3Rpb24oKSkge1xuICAgIHRoaXMucGVyZm9ybVNlYXJjaCgpO1xuICAgIHRoaXMubG9va3VwUGFuZS5zaG93KCk7XG4gIH1cblxuICB0aGlzLnVwZGF0ZVJhbmdlKHBhcnQsIG5vZGUpO1xufTtcblxuUGF0aEZpZWxkLnByb3RvdHlwZS5vbkJsdXJQYXJ0ID0gZnVuY3Rpb24ocGFydCwgbm9kZSkge1xuICB2YXIgZmllbGQgPSB0aGlzO1xuICB0aGlzLmJsdXJfdGltZW91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICBpZiAoIWZpZWxkLmhhc1NlbGVjdGlvbigpKSB7XG4gICAgICBmaWVsZC5sb29rdXBQYW5lLmhpZGUoKTtcbiAgICB9XG4gIH0sIDEwKTtcbn07XG5cbmZ1bmN0aW9uIGJ1aWxkTm9kZShwYXJ0KSB7XG5cbiAgdmFyIGZpZWxkID0gdGhpcyxcbiAgICAgIG5vZGUgPSAkKFwiPGRpdj48L2Rpdj5cIilcbiAgICAgICAgICAgICAgLnRleHQocGFydC5nZXRMYWJlbCgpKVxuICAgICAgICAgICAgICAuYWRkQ2xhc3MocGFydC5nZXRUeXBlKCkpXG4gICAgICAgICAgICAgIC5hcHBlbmRUbyh0aGlzLnBhcnRzTm9kZSk7XG5cbiAgaWYgKHBhcnQub3B0aW9ucy5lZGl0YWJsZSkge1xuICAgIHZhciBsYXN0X3BhcnQgPSBmaWVsZC5mb2N1c2FibGVfcGFydHNbZmllbGQuZm9jdXNhYmxlX3BhcnRzLmxlbmd0aCAtIDFdLFxuICAgICAgICBmb2N1c2FibGUgPSB7bm9kZTpub2RlLmdldCgwKSwgcGFydDpwYXJ0LCBwcmV2aW91czpsYXN0X3BhcnR9LFxuICAgICAgICB2YWx1ZSA9IGZpZWxkLmdldFBhcmFtKHBhcnQubmFtZSksXG4gICAgICAgIG1vZGlmaWVkID0gdmFsdWUgJiYgdmFsdWUgIT09IFwiXCI7XG5cbiAgICBpZiAobGFzdF9wYXJ0KSBsYXN0X3BhcnQubmV4dCA9IGZvY3VzYWJsZTtcbiAgICBmaWVsZC5mb2N1c2FibGVfcGFydHMucHVzaChmb2N1c2FibGUpO1xuICAgIG5vZGVcbiAgICAgIC50ZXh0KHZhbHVlKVxuICAgICAgLnRvZ2dsZUNsYXNzKCdtb2RpZmllZCcsIG1vZGlmaWVkKVxuICAgICAgLmF0dHIoJ2NvbnRlbnRlZGl0YWJsZScsIHRydWUpXG4gICAgICAuYXR0cihcInRhYmluZGV4XCIsIDEpXG4gICAgICAuYXR0cihcImRhdGEtbGFiZWxcIiwgcGFydC5nZXRMYWJlbCgpKVxuICAgICAgLm9uKCdwYXN0ZScsIGZ1bmN0aW9uKGUpe1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGRvY3VtZW50LmV4ZWNDb21tYW5kKCdpbnNlcnRUZXh0JywgZmFsc2UsIGUuY2xpcGJvYXJkRGF0YS5nZXREYXRhKCd0ZXh0L3BsYWluJykpO1xuICAgICAgICBpZiAobm9kZS50ZXh0KCkgIT09ICcnKSB7XG4gICAgICAgICAgbm9kZS5hZGRDbGFzcygnbW9kaWZpZWQnKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9KVxuICAgICAgLm9uKCdrZXlkb3duJywgZnVuY3Rpb24oZSkge1xuICAgICAgICB2YXIgaGFzU2VsZWN0aW9uID0gZmllbGQuaGFzU2VsZWN0aW9uKCk7XG4gICAgICAgIGlmICghaGFzU2VsZWN0aW9uKSB7XG4gICAgICAgICAgZmllbGQubG9va3VwUGFuZS5pZ25vcmVNb3VzZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGUud2hpY2ggPT0gMzggJiYgIWhhc1NlbGVjdGlvbikgeyAvLyB1cFxuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICBmaWVsZC5sb29rdXBQYW5lLmhpZ2hsaWdodFByZXZpb3VzKCk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IGVsc2UgaWYgKGUud2hpY2ggPT0gNDAgJiYgIWhhc1NlbGVjdGlvbikgeyAvLyBkb3duXG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIGZpZWxkLnBlcmZvcm1TZWFyY2goKTtcbiAgICAgICAgICBmaWVsZC5sb29rdXBQYW5lLnNob3coKTtcbiAgICAgICAgICBmaWVsZC5sb29rdXBQYW5lLmhpZ2hsaWdodE5leHQoKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH0gZWxzZSBpZiAoZS53aGljaCA9PSAxMykgeyAvLyByZXR1cm5cbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgLy8gYW4gZW5kcG9pbnQgaXMgYXBwbGllZCBPUiB0aGUgdXNlciBkaWRuJ3Qgc2VsZWN0ZWQgb25lIGZyb20gdGhlIGRyb3Bkb3duIGxpc3RcbiAgICAgICAgICBpZiAoaGFzU2VsZWN0aW9uIHx8ICFmaWVsZC5sb29rdXBQYW5lLnNlbGVjdEN1cnJlbnQoKSl7XG4gICAgICAgICAgICBmaWVsZC5sb29rdXBQYW5lLmhpZGUoKTtcblxuICAgICAgICAgICAgaWYgKGZvY3VzYWJsZS5uZXh0KSB7XG4gICAgICAgICAgICAgIGZpZWxkLmZvY3VzKGZvY3VzYWJsZS5uZXh0KTtcbiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmaWVsZC5idWlsZFBhdGgoKTtcbiAgICAgICAgICAgIGZpZWxkLmRldGVjdEFjdGl2ZShlKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9IGVsc2UgaWYgKGUud2hpY2ggPT0gMjcgJiYgIWhhc1NlbGVjdGlvbikge1xuICAgICAgICAgIGZpZWxkLnByZXZlbnRTZWFyY2ggPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGUud2hpY2ggPT0gOCAmJiAhbm9kZS5oYXNDbGFzcygnbW9kaWZpZWQnKSkge1xuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICBpZiAoZm9jdXNhYmxlLnByZXZpb3VzKSB7XG4gICAgICAgICAgICBmaWVsZC5mb2N1cyhmb2N1c2FibGUucHJldmlvdXMpO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmIChmaWVsZC5oYXNTZWxlY3Rpb24oKSkge1xuICAgICAgICAgICAgZmllbGQucmVzZXQoKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgfVxuXG4gICAgICB9KVxuICAgICAgLm9uKCdrZXlwcmVzcycsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgaWYgKGUuY2hhckNvZGUgPiAwICYmICFub2RlLmhhc0NsYXNzKCdtb2RpZmllZCcpKSB7XG4gICAgICAgICAgbm9kZS5hZGRDbGFzcygnbW9kaWZpZWQnKTtcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIC5vbigna2V5dXAnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgZmllbGQuc2V0UGFyYW0ocGFydC5uYW1lLCBub2RlLnRleHQoKSk7XG4gICAgICAgIGlmIChmaWVsZC5nZXRQYXJhbShwYXJ0Lm5hbWUpID09PSAnJykge1xuICAgICAgICAgIG5vZGUucmVtb3ZlQ2xhc3MoJ21vZGlmaWVkJyk7XG4gICAgICAgICAgbm9kZS5odG1sKCcnKTtcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIC5vbignZm9jdXMnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gZmllbGQuZ2V0UGFyYW0ocGFydC5uYW1lKTtcblxuICAgICAgICBpZiAocGFydC5vcHRpb25zLm1ldGEpIHtcbiAgICAgICAgICBmaWVsZC5lbWl0KCd0aXAnLCAkLmV4dGVuZCh7bmFtZTpwYXJ0Lm5hbWUsY29udGV4dDpub2RlLHBvc2l0aW9uOidiZWxvdyd9LCBwYXJ0Lm9wdGlvbnMubWV0YSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHZhbHVlICE9PSAnJykge1xuICAgICAgICAgIG5vZGUuYWRkQ2xhc3MoJ21vZGlmaWVkJyk7XG4gICAgICAgIH1cbiAgICAgICAgZmllbGQuZm9jdXNlZCA9IHRydWU7XG4gICAgICAgIGZpZWxkLm9uRm9jdXNQYXJ0KHBhcnQsIG5vZGUuZ2V0KDApKTtcbiAgICAgIH0pXG4gICAgICAub24oJ2JsdXInLCBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHZhbCA9IGZpZWxkLmdldFBhcmFtKHBhcnQubmFtZSk7XG4gICAgICAgIGZpZWxkLmZvY3VzZWQgPSBmYWxzZTtcbiAgICAgICAgZmllbGQub25CbHVyUGFydChwYXJ0LCBub2RlKTtcbiAgICAgIH0pO1xuICB9XG5cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBQYXRoRmllbGQ7XG4iLCJ2YXIgQ29tcG9uZW50ID0gcmVxdWlyZSgnLi9jb21wb25lbnQnKSxcbiAgICAkID0gQ29tcG9uZW50LiQsXG4gICAgTGlzdENvbXBvbmVudCA9IHJlcXVpcmUoJy4vbGlzdF9jb21wb25lbnQnKSxcbiAgICBPcHRpb25TZWxlY3RvciA9IHJlcXVpcmUoJy4vb3B0aW9uX3NlbGVjdG9yJyksXG4gICAgZm4gPSByZXF1aXJlKCdmbicpO1xuXG52YXIgUmVmZXJlbmNlUGFuZWwgPSBDb21wb25lbnQuZXh0ZW5kKHtcbiAgJ29wZW5DbGFzcycgICAgICAgOiAnb3BlbicsXG4gICdicm93c2VyQ2xhc3MnICAgIDogJ2Jyb3dzZXInLFxuICAnaGlzdG9yeScgICAgICAgICA6IFtdLFxuICAnc2VhcmNoX3VybCcgICAgICA6IG51bGwsXG4gICdmaWx0ZXInICAgICAgICAgIDogZnVuY3Rpb24oKXsgcmV0dXJuIGFyZ3VtZW50c1swXTsgfSxcbiAgJ29uU2VsZWN0JyAgICAgICAgOiBmdW5jdGlvbigpe30sXG4gICdvbkxvYWRWZXJzaW9ucycgIDogZnVuY3Rpb24oKXt9LFxuICAnb25Mb2FkRW5kcG9pbnRzJyA6IGZ1bmN0aW9uKCl7fSxcbiAgJ2luaXQnIDogZnVuY3Rpb24obm9kZSwgb3B0aW9ucykge1xuICAgIHRoaXMub25TZWFyY2ggPSB0aGlzLnNlYXJjaC5iaW5kKHRoaXMpO1xuICAgIHRoaXMub25SZWZlcmVuY2UgPSB0aGlzLnBhcnRpdGlvbmVkRW5kcG9pbnRzLmJpbmQodGhpcyk7XG4gICAgdGhpcy5ncm91cHNMaXN0ID0gbmV3IExpc3RDb21wb25lbnQoe1xuICAgICAgJ3RhYmluZGV4JyA6ICcxJyxcbiAgICAgICdjbGFzc05hbWUnIDogJ2dyb3VwcycsXG4gICAgICAnaXRlbVRlbXBsYXRlJzpmdW5jdGlvbihpdGVtKXtcbiAgICAgICAgcmV0dXJuICQoJzxsaT48L2xpPicpLmFwcGVuZCgkKFwiPHNwYW4+PC9zcGFuPlwiKS50ZXh0KGl0ZW0pKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHRoaXMuZW5kcG9pbnRzTGlzdCA9IG5ldyBMaXN0Q29tcG9uZW50KHtcbiAgICAgICd0YWJpbmRleCcgOiAnMScsXG4gICAgICAnY2xhc3NOYW1lJyA6ICdlbmRwb2ludHMnLFxuICAgICAgJ2l0ZW1UZW1wbGF0ZScgOiBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgIHJldHVybiAkKCc8bGk+PC9saT4nKVxuICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkKFwiPHNwYW4+PC9zcGFuPlwiKS50ZXh0KGl0ZW0ubWV0aG9kICsgXCIgXCIgKyAoaXRlbS5wYXRoX2xhYmVsZWQgfHwgXCI/XCIpKS5hZGRDbGFzcygncGF0aCcpKVxuICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkKFwiPHNwYW4+PC9zcGFuPlwiKS50ZXh0KGl0ZW0uZGVzY3JpcHRpb24pLmFkZENsYXNzKCdkZXNjcmlwdGlvbicpKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHRoaXMuZ3JvdXBPcHRpb24gPSBuZXcgT3B0aW9uU2VsZWN0b3Ioe1xuICAgICAgZGVmYXVsdFZhbHVlOiBcImFsbFwiXG4gICAgfSk7XG5cbiAgICB0aGlzLnZlcnNpb25PcHRpb24gPSBuZXcgT3B0aW9uU2VsZWN0b3IodGhpcy5vcHRpb25zLnZlcnNpb25TZWxlY3Rvciwge1xuICAgICAgdGFiSW5kZXg6ICcyJyxcbiAgICAgIGxhYmVsOiBmdW5jdGlvbih2KSB7IHJldHVybiAndicgKyB2OyB9LFxuICAgICAgb3B0aW9uTGFiZWw6IGZ1bmN0aW9uKHYpIHsgcmV0dXJuICd2JyArIHY7IH1cbiAgICB9KTtcblxuICAgIHRoaXMuaGVhZGVyID0gJChcIjxoZWFkZXI+PC9oZWFkZXI+XCIpLmFwcGVuZFRvKHRoaXMubm9kZSk7XG4gICAgdGhpcy5icm93c2VyID0gJChcIjxkaXY+PC9kaXY+XCIpLmFkZENsYXNzKHRoaXMub3B0aW9ucy5icm93c2VyQ2xhc3MpLmFwcGVuZFRvKHRoaXMubm9kZSk7XG4gICAgdGhpcy5oZWFkZXJcbiAgICAgIC5hcHBlbmQoJChcIjxoMj48L2gyPlwiKS50ZXh0KFwiQVBJIFJlZmVyZW5jZVwiKSlcbiAgICAgIC5hcHBlbmQoJChcIjxkaXY+PC9kaXY+XCIpLmFwcGVuZCgkKCc8c3Bhbj48L3NwYW4+JykudGV4dCgnR3JvdXAnKSkuYXBwZW5kKHRoaXMuZ3JvdXBPcHRpb24ubm9kZSkpO1xuXG4gICAgLy8gdGhpcy5ncm91cHNMaXN0Lm9uKCdzZWxlY3QnLCB0aGlzLnVwZGF0ZUVuZHBvaW50cy5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLmdyb3VwT3B0aW9uLm9uKCdjaGFuZ2UnLCB0aGlzLnVwZGF0ZUVuZHBvaW50cy5iaW5kKHRoaXMpKTtcbiAgICAvLyB0aGlzLmdyb3Vwc0xpc3Qub24oJ3N1Ym1pdCcsIHRoaXMuZW5kcG9pbnRzTGlzdC5mb2N1cy5iaW5kKHRoaXMuZW5kcG9pbnRzTGlzdCkpO1xuXG4gICAgdGhpcy5lbmRwb2ludHNMaXN0Lm9uKCdzZWxlY3QnLCB0aGlzLnVwZGF0ZURldGFpbC5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLmVuZHBvaW50c0xpc3Qub24oJ3N1Ym1pdCcsIHRoaXMuc2VsZWN0RW5kcG9pbnQuYmluZCh0aGlzKSk7XG5cbiAgICAvLyB0aGlzLmdyb3Vwc0xpc3Qubm9kZS5hcHBlbmRUbygkKCc8ZGl2PjwvZGl2PicpLmFwcGVuZFRvKHRoaXMuYnJvd3NlcikpO1xuXG4gICAgdGhpcy5lbmRwb2ludHNMaXN0Lm5vZGUuYXBwZW5kVG8oJCgnPGRpdj48L2Rpdj4nKS5hcHBlbmRUbyh0aGlzLmJyb3dzZXIpKTtcbiAgICB0aGlzLmRldGFpbCA9ICQoJzxkaXY+PC9kaXY+JykuYXBwZW5kVG8odGhpcy5icm93c2VyKTtcbiAgICB0aGlzLm5vZGUuYWRkQ2xhc3ModGhpcy5vcHRpb25zLm9wZW5DbGFzcyk7XG5cbiAgICAvLyByZWZyZXNoIHRoZSBzZWxlY3RlZCB2ZXJzaW9uJ3MgaGVscCByZXNvdXJjZXMgd2hlbiB2ZXJzaW9uIGlzIGNoYW5nZWRcbiAgICB0aGlzLnZlcnNpb25PcHRpb24ub24oJ2NoYW5nZScsIChmdW5jdGlvbih2ZXJzaW9uKSB7XG4gICAgICB0aGlzLmxvYWRpbmdFbmRwb2ludHMgPSB0cnVlO1xuICAgICAgdGhpcy5vcHRpb25zLm9uTG9hZEVuZHBvaW50cyh2ZXJzaW9uLCBmbi5hcmdsb2NrKHRoaXMub25JbmRleCwgdmVyc2lvbikuYmluZCh0aGlzKSk7XG4gICAgfSkuYmluZCh0aGlzKSk7XG5cbiAgICB0aGlzLnZlcnNpb25PcHRpb24ubm9kZS5oaWRlKCk7XG5cbiAgICB0aGlzLnJhbmtlciA9IG5ldyBXb3JrZXIodGhpcy5vcHRpb25zLnNlYXJjaF91cmwgfHwgXCJzZWFyY2guanNcIik7XG4gICAgdGhpcy5yYW5rZXIub25tZXNzYWdlID0gKGZ1bmN0aW9uKGUpIHtcbiAgICAgIGNvbnNvbGUubG9nKFwiUmVzdWx0c1wiLCBlLmRhdGEubXMpO1xuICAgICAgdGhpcy5vblJhbmtpbmcoZS5kYXRhLnJlc3VsdHMpO1xuICAgIH0pLmJpbmQodGhpcyk7XG5cbiAgfSxcbiAgJ29uQ2hhbmdlJyA6IGZ1bmN0aW9uKHZhbHVlLCBvbGRWYWx1ZSkge1xuICAgIHZhciBncm91cHMgPSBbXSxcbiAgICAgICAgZ3JvdXBfZW5kcG9pbnRzID0ge307XG5cbiAgICB2YXIgZmlsdGVyZWQgPSB0aGlzLmdldEVuZHBvaW50cygpO1xuXG4gICAgXy5lYWNoKGZpbHRlcmVkLCBmdW5jdGlvbiAoZW5kcG9pbnRzLCByb3V0ZSkge1xuICAgICAgdmFyIGdyb3VwID0gZW5kcG9pbnRzLm5hbWVzcGFjZSB8fCBcIlwiO1xuXG4gICAgICBpZiAoZ3JvdXBzLmluZGV4T2YoZ3JvdXApID09PSAtMSkge1xuICAgICAgICBncm91cHMucHVzaChncm91cCk7XG4gICAgICB9XG5cbiAgICAgIGlmICghZ3JvdXBfZW5kcG9pbnRzW2dyb3VwXSkge1xuICAgICAgICBncm91cF9lbmRwb2ludHNbZ3JvdXBdID0ge307XG4gICAgICB9XG5cbiAgICAgIGdyb3VwX2VuZHBvaW50c1tncm91cF1bcm91dGVdID0gZW5kcG9pbnRzO1xuICAgIH0pO1xuXG4gICAgZ3JvdXBzLnNvcnQoZnVuY3Rpb24oYSwgYikge1xuICAgICAgdmFyIGFfbCA9IGEudG9Mb3dlckNhc2UoKSxcbiAgICAgICAgICBiX2wgPSBiLnRvTG93ZXJDYXNlKCk7XG5cbiAgICAgIGlmIChhX2wgPT0gYl9sKSByZXR1cm4gMDtcbiAgICAgIHJldHVybiBhX2wgPCBiX2wgPyAtMSA6IDE7XG4gICAgfSk7XG5cbiAgICBncm91cHMudW5zaGlmdCgnYWxsJyk7XG4gICAgZ3JvdXBfZW5kcG9pbnRzLmFsbCA9IGZpbHRlcmVkO1xuICAgIHRoaXMuZ3JvdXBzID0gZ3JvdXBzO1xuICAgIHRoaXMuZ3JvdXBfZW5kcG9pbnRzID0gZ3JvdXBfZW5kcG9pbnRzO1xuXG4gICAgdGhpcy5ncm91cE9wdGlvbi5zZXRPcHRpb25zKGdyb3Vwcyk7XG4gICAgdGhpcy5ncm91cHNMaXN0LnNldFZhbHVlKGdyb3Vwcyk7XG4gICAgdGhpcy5lbmRwb2ludHNMaXN0LnNldFZhbHVlKGZpbHRlcmVkKTtcblxuICB9XG59KTtcblxuUmVmZXJlbmNlUGFuZWwucHJvdG90eXBlLmxvYWQgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5vcHRpb25zLm9uTG9hZFZlcnNpb25zKHRoaXMub25WZXJzaW9ucy5iaW5kKHRoaXMpKTtcbn07XG5cblJlZmVyZW5jZVBhbmVsLnByb3RvdHlwZS5yZWZyZXNoID0gZnVuY3Rpb24oKSB7XG4gIHZhciBlbmRwb2ludHMgPSB0aGlzLmdldFZhbHVlKCk7XG5cbiAgdGhpcy5yZXNldCgpO1xuICB0aGlzLnNldFZhbHVlKGVuZHBvaW50cyk7XG5cbn07XG5cblJlZmVyZW5jZVBhbmVsLnByb3RvdHlwZS50b2dnbGUgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5ub2RlLnRvZ2dsZUNsYXNzKHRoaXMub3B0aW9ucy5vcGVuQ2xhc3MpO1xuXG4gIGlmICh0aGlzLm5vZGUuaGFzQ2xhc3ModGhpcy5vcHRpb25zLm9wZW5DbGFzcykpIHtcbiAgICB0aGlzLm9uT3BlbigpO1xuICB9IGVsc2Uge1xuICAgIHRoaXMub25DbG9zZSgpO1xuICB9XG5cbn07XG5cblJlZmVyZW5jZVBhbmVsLnByb3RvdHlwZS5pc09wZW4gPSBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHRoaXMubm9kZS5oYXNDbGFzcyh0aGlzLm9wdGlvbnMub3BlbkNsYXNzKTtcbn07XG5cblxuUmVmZXJlbmNlUGFuZWwucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24oKSB7XG4gIGlmICh0aGlzLmlzT3BlbigpKSB7XG4gICAgdGhpcy50b2dnbGUoKTtcbiAgfVxufTtcblxuUmVmZXJlbmNlUGFuZWwucHJvdG90eXBlLm9wZW4gPSBmdW5jdGlvbigpIHtcbiAgaWYgKCF0aGlzLmlzT3BlbigpKSB7XG4gICAgdGhpcy50b2dnbGUoKTtcbiAgfVxufTtcblxuUmVmZXJlbmNlUGFuZWwucHJvdG90eXBlLm9uT3BlbiA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLmdyb3Vwc0xpc3QuZW5hYmxlKCk7XG4gIHRoaXMuZW5kcG9pbnRzTGlzdC5lbmFibGUoKTtcbiAgdGhpcy5lbmRwb2ludHNMaXN0Lm5vZGUuZm9jdXMoKTtcbn07XG5cblJlZmVyZW5jZVBhbmVsLnByb3RvdHlwZS5vbkNsb3NlID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuZ3JvdXBzTGlzdC5kaXNhYmxlKCk7XG4gIHRoaXMuZW5kcG9pbnRzTGlzdC5kaXNhYmxlKCk7ICBcbn07XG5cblJlZmVyZW5jZVBhbmVsLnByb3RvdHlwZS5nZXRFbmRwb2ludHMgPSBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHRoaXMub3B0aW9ucy5maWx0ZXIodGhpcy5nZXRWYWx1ZSgpKTtcbn07XG5cblJlZmVyZW5jZVBhbmVsLnByb3RvdHlwZS5wYXJ0aXRpb25lZEVuZHBvaW50cyA9IGZ1bmN0aW9uKCkge1xuICB2YXIgYWxsID0gW10sXG4gICAgICBncm91cHMgPSB0aGlzLmdyb3VwcyB8fCBbXSxcbiAgICAgIGdyb3VwZWQgPSB0aGlzLmdyb3VwX2VuZHBvaW50cztcbiAgJC5lYWNoKGdyb3VwcywgZnVuY3Rpb24oaSwgZ3JvdXApIHtcbiAgICBpZiAoZ3JvdXAgPT0gJ2FsbCcpIHJldHVybjtcbiAgICBhbGwucHVzaChncm91cCk7XG4gICAgXy5lYWNoKGdyb3VwZWRbZ3JvdXBdLCBmdW5jdGlvbiAocm91dGVfZGF0YSwgcm91dGUpIHtcbiAgICAgIHJvdXRlX2RhdGEubWV0aG9kcy5mb3JFYWNoKGZ1bmN0aW9uIChtZXRob2QpIHtcbiAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgbWV0aG9kOiBtZXRob2QsXG4gICAgICAgICAgdmVyc2lvbjogXCIyXCIsXG4gICAgICAgICAgcGF0aF9sYWJlbGVkOiByb3V0ZSxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogXCJcIlxuICAgICAgICB9O1xuICAgICAgICBhbGwucHVzaChkYXRhKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBpZih0aGlzLm9wdGlvbnMuaGlzdG9yeS5sZW5ndGggPiAwKSB7XG4gICAgYWxsID0gW3toaXN0b3J5OiB0cnVlLCBsYWJlbDogJ1JlY2VudCd9XS5jb25jYXQodGhpcy5vcHRpb25zLmhpc3RvcnkpLmNvbmNhdChhbGwpO1xuICB9XG4gIHJldHVybiBhbGw7XG59O1xuXG5SZWZlcmVuY2VQYW5lbC5wcm90b3R5cGUudXBkYXRlRW5kcG9pbnRzID0gZnVuY3Rpb24oZ3JvdXApIHtcbiAgdmFyIGVuZHBvaW50cyA9IHRoaXMuZ3JvdXBfZW5kcG9pbnRzW2dyb3VwXTtcbiAgdGhpcy5lbmRwb2ludHNMaXN0LnNldFZhbHVlKGVuZHBvaW50cyk7XG59O1xuXG5SZWZlcmVuY2VQYW5lbC5wcm90b3R5cGUudXBkYXRlRGV0YWlsID0gZnVuY3Rpb24oZW5kcG9pbnQpIHtcbiAgdGhpcy5kZXRhaWwuY2hpbGRyZW4oKS5yZW1vdmUoKTtcbiAgJCgnPHByZT48L3ByZT4nKS5hcHBlbmRUbyh0aGlzLmRldGFpbCkudGV4dChKU09OLnN0cmluZ2lmeShlbmRwb2ludCwgbnVsbCwgXCIgIFwiKSk7XG59O1xuXG5SZWZlcmVuY2VQYW5lbC5wcm90b3R5cGUuc2VhcmNoID0gZnVuY3Rpb24ocSwgY2FsbGJhY2spIHtcblxuICBpZiAodGhpcy5sb2FkaW5nRW5kcG9pbnRzKSB7XG4gICAgY2FsbGJhY2sodGhpcy5wYXJ0aXRpb25lZEVuZHBvaW50cygpLmNvbmNhdChbe2xvYWRpbmc6dHJ1ZX1dKSk7XG4gICAgdGhpcy5vbkxvYWRpbmdDb21wbGV0ZSA9IGZuLmFyZ2xvY2sodGhpcy5zZWFyY2gsIHEsIGNhbGxiYWNrKS5iaW5kKHRoaXMpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGRlbGV0ZSB0aGlzLm9uTG9hZGluZ0NvbXBsZXRlO1xuXG4gIGlmIChxID09PSBcIlwiIHx8IHEgPT09IG51bGwpIHtcbiAgICBjYWxsYmFjayh0aGlzLnBhcnRpdGlvbmVkRW5kcG9pbnRzKCkpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHRoaXMucmFua2VyLnBvc3RNZXNzYWdlKHtxdWVyeTogcSwgaW5kZXg6IHRoaXMuZ2V0RW5kcG9pbnRzKCl9KTtcbiAgdGhpcy5vblJhbmtpbmcgPSBjYWxsYmFjaztcblxufTtcblxuUmVmZXJlbmNlUGFuZWwucHJvdG90eXBlLnNlbGVjdEVuZHBvaW50ID0gZnVuY3Rpb24oZW5kcG9pbnQpIHtcbiAgdGhpcy5vcHRpb25zLm9uU2VsZWN0KGVuZHBvaW50KTtcbn07XG5cblJlZmVyZW5jZVBhbmVsLnByb3RvdHlwZS5vblZlcnNpb25zID0gZnVuY3Rpb24oZXJyLCB2ZXJzaW9ucywgZGVmYXVsdFZlcnNpb24pIHtcblxuICB0aGlzLnZlcnNpb25PcHRpb24uZGlzYWJsZSgpO1xuICB0aGlzLnZlcnNpb25PcHRpb24uc2V0T3B0aW9ucyh2ZXJzaW9ucyk7XG4gIHRoaXMudmVyc2lvbk9wdGlvbi5lbmFibGUoKTtcbiAgdGhpcy52ZXJzaW9uT3B0aW9uLnNldFZhbHVlKGRlZmF1bHRWZXJzaW9uKTtcbiAgdGhpcy52ZXJzaW9uT3B0aW9uLm5vZGUudG9nZ2xlKHZlcnNpb25zLmxlbmd0aCA+IDEpO1xuXG59O1xuXG5SZWZlcmVuY2VQYW5lbC5wcm90b3R5cGUub25JbmRleCA9IGZ1bmN0aW9uICh2ZXJzaW9uLCBlcnIsIGluZGV4KSB7XG4gIHRoaXMuc2V0VmFsdWUoaW5kZXgucm91dGVzKTtcbiAgdGhpcy5sb2FkaW5nRW5kcG9pbnRzID0gZmFsc2U7XG4gIGlmICh0aGlzLm9uTG9hZGluZ0NvbXBsZXRlKSB0aGlzLm9uTG9hZGluZ0NvbXBsZXRlKCk7XG59O1xuXG5SZWZlcmVuY2VQYW5lbC5wcm90b3R5cGUuc2V0SGlzdG9yeSA9IGZ1bmN0aW9uKGVuZHBvaW50cykge1xuICB0aGlzLm9wdGlvbnMuaGlzdG9yeSA9IGVuZHBvaW50cztcbn07XG5cblJlZmVyZW5jZVBhbmVsLnByb3RvdHlwZS5hZGRIaXN0b3J5ID0gZnVuY3Rpb24oZW5kcG9pbnQpIHtcbiAgaWYgKCF0aGlzLm9wdGlvbnMuaGlzdG9yeSkgdGhpcy5vcHRpb25zLmhpc3RvcnkgPSBbXTtcblxuICB0aGlzLm9wdGlvbnMuaGlzdG9yeSA9IHRoaXMub3B0aW9ucy5oaXN0b3J5LmZpbHRlcihmdW5jdGlvbihpdGVtKSB7XG4gICAgcmV0dXJuICEoaXRlbS5wYXRoX2xhYmVsZWQgPT0gZW5kcG9pbnQucGF0aF9sYWJlbGVkICYmIGl0ZW0ubWV0aG9kID09IGVuZHBvaW50Lm1ldGhvZCk7XG4gIH0pLnNsaWNlKDAsIDEwKTtcblxuICB0aGlzLm9wdGlvbnMuaGlzdG9yeS51bnNoaWZ0KGVuZHBvaW50KTtcblxuICB0aGlzLmVtaXQoJ2hpc3RvcnknLCB0aGlzLm9wdGlvbnMuaGlzdG9yeSk7XG5cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gUmVmZXJlbmNlUGFuZWw7XG4iLCJ2YXIgQ29tcG9uZW50ID0gcmVxdWlyZSgnLi9jb21wb25lbnQnKSxcbiAgICBxdWVyeXN0cmluZyA9IHJlcXVpcmUoJ3F1ZXJ5c3RyaW5nJyksXG4gICAgJCA9IENvbXBvbmVudC4kO1xuICBcblxudmFyIFJlcXVlc3RIZWFkZXIgPSBDb21wb25lbnQuZXh0ZW5kKHtcbiAgJ2VsZW1lbnQnIDogJ2hlYWRlcicsXG4gICdpbml0JyA6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMubm9kZS5hcHBlbmQoJzxjb2RlPjwvY29kZT48Y29kZT48L2NvZGU+Jyk7XG5cbiAgICB2YXIgY29kZXMgPSB0aGlzLm5vZGUuZmluZCgnY29kZScpO1xuXG4gICAgdGhpcy5tZXRob2QgPSBjb2Rlcy5lcSgwKTtcbiAgICB0aGlzLnBhdGggPSBjb2Rlcy5lcSgxKTtcblxuICB9LFxuICAnb25DaGFuZ2UnIDogZnVuY3Rpb24ocmVxdWVzdCkge1xuXG4gICAgdGhpcy5tZXRob2QudGV4dChyZXF1ZXN0Lm1ldGhvZCB8fCAnR0VUJyk7XG4gICAgdGhpcy5wYXRoLnRleHQocmVxdWVzdC5wYXRoKTtcblxuICAgIHZhciBxdWVyeSA9ICQuaXNQbGFpbk9iamVjdChyZXF1ZXN0LnF1ZXJ5KSA/IHF1ZXJ5c3RyaW5nLnN0cmluZ2lmeShyZXF1ZXN0LnF1ZXJ5KSA6IHJlcXVlc3QucXVlcnk7XG5cbiAgICBpZiAocXVlcnkgJiYgcXVlcnkgIT09ICcnKSB7XG4gICAgICB0aGlzLnBhdGguYXBwZW5kKCQoJzxlbT48L2VtPicpLnRleHQoXCI/XCIgKyBxdWVyeSkpO1xuICAgIH1cbiAgfVxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gUmVxdWVzdEhlYWRlcjsiLCJ2YXIgQ29tcG9uZW50ID0gcmVxdWlyZSgnLi9jb21wb25lbnQnKSxcbiAgICAkID0gQ29tcG9uZW50LiQsXG4gICAgUmVxdWVzdEhlYWRlciA9IHJlcXVpcmUoJy4vcmVxdWVzdF9oZWFkZXInKSxcbiAgICBKc29uQnJvd3NlciA9IHJlcXVpcmUoJy4vanNvbl9icm93c2VyJyksXG4gICAgZm4gPSByZXF1aXJlKCdmbicpLFxuICAgIHV0aWwgPSByZXF1aXJlKCcuL3V0aWwnKTtcblxudmFyIFJlcXVlc3RWaWV3ZXIgPSBDb21wb25lbnQuZXh0ZW5kKHtcbiAgJ2NvbnRhaW5lcicgICAgIDogJyNyZXF1ZXN0cycsXG4gICdkb3dubG9hZExhYmVsJyA6ICdEb3dubG9hZCcsXG4gICdsb2FkaW5nQ2xhc3MnICA6ICdsb2FkaW5nJyxcbiAgJ2NvbXBsZXRlQ2xhc3MnIDogJ2NvbXBsZXRlJyxcbiAgJ2NsYXNzTmFtZScgICAgIDogJ2xvZycsXG4gICdlcnJvckNsYXNzJyAgICA6ICdyZXF1ZXN0LWVycm9yJyxcbiAgJ2luaXQnIDogZnVuY3Rpb24oKSB7XG5cbiAgICB0aGlzLmNvbnRhaW5lciA9ICQodGhpcy5vcHRpb25zLmNvbnRhaW5lcik7XG5cbiAgICB0aGlzLmhlYWRlciA9IG5ldyBSZXF1ZXN0SGVhZGVyKCk7XG4gICAgdGhpcy5kaXNjbG9zdXJlID0gJCgnPGRpdj48L2Rpdj4nKTtcblxuICAgIHRoaXMubm9kZS5hcHBlbmQoXG4gICAgICAkKFwiPGRpdj48L2Rpdj5cIikuYXBwZW5kKHRoaXMuaGVhZGVyLm5vZGUpLmFkZCh0aGlzLmRpc2Nsb3N1cmUpXG4gICAgKTtcblxuICAgIHRoaXMubm9kZS5wcmVwZW5kVG8odGhpcy5jb250YWluZXIpO1xuXG4gICAgdGhpcy5vblJlc3BvbnNlID0gdGhpcy5vblJlc3BvbnNlLmJpbmQodGhpcyk7XG5cbiAgfSxcbiAgJ29uQ2hhbmdlJyA6IGZ1bmN0aW9uKHJlcXVlc3QpIHtcbiAgICB0aGlzLmhlYWRlci5zZXRWYWx1ZShyZXF1ZXN0KTtcbiAgfVxufSk7XG5cblJlcXVlc3RWaWV3ZXIucHJvdG90eXBlLnNlbnQgPSBmdW5jdGlvbigpIHtcblxuICB0aGlzLnN0YXJ0X3RpbWUgPSB0cygpO1xuXG4gIHRoaXMubm9kZS5hZGRDbGFzcyh0aGlzLm9wdGlvbnMubG9hZGluZ0NsYXNzKTtcblxuICB0aGlzLmRpc2Nsb3N1cmUuYXBwZW5kKCQoJzxkaXYgY2xhc3M9XCJ0aHJvYmJlclwiPjxkaXY+PC9kaXY+PC9kaXY+JykpO1xuXG59O1xuXG5SZXF1ZXN0Vmlld2VyLnByb3RvdHlwZS5vblJlc3BvbnNlID0gZnVuY3Rpb24oZXJyLCByZXNwb25zZSkge1xuXG4gIHZhciBzdGF0dXMgPSAkKCc8c3Bhbj48L3NwYW4+JykuYXBwZW5kVG8odGhpcy5oZWFkZXIubm9kZSk7XG5cbiAgdGhpcy5yZXNwb25zZSA9IHJlc3BvbnNlO1xuICB0aGlzLnJlc3BvbnNlRXJyb3IgPSBlcnI7XG5cbiAgdGhpcy5ub2RlXG4gICAgICAgIC5yZW1vdmVDbGFzcyh0aGlzLm9wdGlvbnMubG9hZGluZ0NsYXNzKVxuICAgICAgICAuYWRkQ2xhc3ModGhpcy5vcHRpb25zLmNvbXBsZXRlQ2xhc3MpO1xuXG4gIHRoaXMuZW5kX3RpbWUgPSB0cygpO1xuICB0aGlzLmVsbGFwc2VkID0gdGhpcy5lbmRfdGltZSAtIHRoaXMuc3RhcnRfdGltZTtcblxuICB2YXIgYm9keSA9IG51bGw7XG5cbiAgaWYgKGVycikge1xuICAgIHRoaXMubm9kZS5hZGRDbGFzcyh0aGlzLm9wdGlvbnMuZXJyb3JDbGFzcyk7XG4gICAgaWYgKGVyci5lcnJvclR5cGUgIT09ICdhYm9ydCcpIHtcbiAgICAgIHN0YXR1cy50ZXh0KGVyci5zdGF0dXMgKyBcIiDigJMgXCIgKyBlcnIuZXJyb3IpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzdGF0dXMudGV4dChcIkNsaWVudCBFcnJvclwiKTtcbiAgICB9XG4gICAgYm9keSA9IGVyci5ib2R5O1xuICB9IGVsc2Uge1xuICAgIHN0YXR1cy50ZXh0KHRoaXMuZWxsYXBzZWQgKyAnbXMnKTtcbiAgICBib2R5ID0gcmVzcG9uc2U7XG4gIH1cblxuICB0aGlzLmRpc2Nsb3N1cmUuY2hpbGRyZW4oKS5yZW1vdmUoKTtcblxuICBpZiAoYm9keSkge1xuICAgIHZhciBkb3dubG9hZCA9ICQoJzxhPjwvYT4nKVxuICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKCd0aXRsZScsIHRoaXMub3B0aW9ucy5kb3dubG9hZExhYmVsKVxuICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKCdocmVmJywgJ2RhdGE6YXBwbGljYXRpb24vanNvbjtjaGFyc2V0PVVURi04LCcgKyBlbmNvZGVVUklDb21wb25lbnQoSlNPTi5zdHJpbmdpZnkoYm9keSwgbnVsbCwgXCJcXHRcIikpKVxuICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKCdkb3dubG9hZCcsIHRoaXMuZ2V0RG93bmxvYWRGaWxlTmFtZSgpKVxuICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKCd0YXJnZXQnLCAnX2JsYW5rJyksXG4gICAgICAgIGJyb3dzZXIgPSBuZXcgSnNvbkJyb3dzZXIoKTtcblxuXG4gICAgdGhpcy5kaXNjbG9zdXJlLmFwcGVuZChkb3dubG9hZCk7XG5cbiAgICBicm93c2VyLnNldFZhbHVlKGJvZHkpO1xuXG4gICAgJCgnPGRpdj48L2Rpdj4nKVxuICAgICAgLmFwcGVuZChicm93c2VyLm5vZGUpXG4gICAgICAuYWRkQ2xhc3MoJ2JvZHknKS5hcHBlbmRUbyh0aGlzLmhlYWRlci5ub2RlLnBhcmVudCgpKTtcbiAgfVxuXG5cbiAgdGhpcy5lbWl0KCdyZXNwb25zZScsIGVyciwgcmVzcG9uc2UpO1xuXG59O1xuXG5SZXF1ZXN0Vmlld2VyLnByb3RvdHlwZS5zdHJpbmdpZnkgPSB1dGlsLnN0cmluZ2lmeUpzb247XG5cblJlcXVlc3RWaWV3ZXIucHJvdG90eXBlLmdldERvd25sb2FkRmlsZU5hbWUgPSBmdW5jdGlvbigpIHtcbiAgdmFyIHBhdGggPSB0aGlzLmdldFZhbHVlKCkucGF0aDtcblxuICBpZiAocGF0aC5pbmRleE9mKFwiL1wiKSA9PT0gMCkge1xuICAgIHBhdGggPSBwYXRoLnNsaWNlKDEpO1xuICB9XG5cbiAgcmV0dXJuIHBhdGgucmVwbGFjZSgvXFwvL2csICctJykgKyAnLmpzb24nO1xufTtcblxuUmVxdWVzdFZpZXdlci5wcm90b3R5cGUub25LZXlkb3duID0gZnVuY3Rpb24oZSkge1xuXG4gIHZhciBwcmV2ZW50ID0gZmFsc2U7XG5cbiAgaWYgKGUud2hpY2ggPT0gNzQgfHwgZS53aGljaCA9PSA0MCkgeyAvLyBqXG4gICAgcHJldmVudCA9IHRydWU7XG4gICAgdGhpcy5ub2RlLm5leHQoKS5mb2N1cygpO1xuICB9IGVsc2UgaWYgKGUud2hpY2ggPT0gNzUgfHwgZS53aGljaCA9PSAzOCkgeyAvLyBrXG4gICAgcHJldmVudCA9IHRydWU7XG4gICAgdGhpcy5ub2RlLnByZXYoKS5mb2N1cygpO1xuICB9IGVsc2UgaWYgKGUud2hpY2ggPT0gMTMgfHwgZS53aGljaCA9PSAzMiB8fCBlLndoaWNoID09IDM5KSB7IC8vIHJldHVybiBvciBzcGFjZSBvciByaWdodFxuICAgIHByZXZlbnQgPSB0cnVlO1xuICAgIHRoaXMuZW1pdCgnb3BlbicsIHRoaXMpO1xuICB9XG5cbiAgaWYgKHByZXZlbnQpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59O1xuXG5SZXF1ZXN0Vmlld2VyLnByb3RvdHlwZS5vbkNsaWNrID0gZnVuY3Rpb24oZSkge1xuXG4gIGlmICgkKGUudGFyZ2V0KS5pcygnYVtkb3dubG9hZF0nKSkge1xuICAgIC8vIGNvbnRpbnVlO1xuICB9IGVsc2Uge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB0aGlzLmVtaXQoJ29wZW4nLCB0aGlzKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxufTtcblxuZnVuY3Rpb24gdHMoKSB7XG4gIHJldHVybiAobmV3IERhdGUoKSkuZ2V0VGltZSgpO1xufVxuXG5cbm1vZHVsZS5leHBvcnRzID0gUmVxdWVzdFZpZXdlcjsiLCJ2YXIgQ29tcG9uZW50ID0gcmVxdWlyZSgnLi9jb21wb25lbnQnKSxcbiAgICAkID0gQ29tcG9uZW50LiQsXG4gICAgZm4gPSByZXF1aXJlKCdmbicpO1xuXG52YXIgVGlwID0gQ29tcG9uZW50LmV4dGVuZCh7XG4gICdvcGFjaXR5JyA6ICcwLjknLFxuICAnaW5pdCcgOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmhlYWRlciA9IHRoaXMubm9kZS5maW5kKCdoZWFkZXInKTtcbiAgICB0aGlzLm5hbWUgPSB0aGlzLmhlYWRlci5maW5kKCdjb2RlJyk7XG4gICAgdGhpcy50eXBlID0gdGhpcy5oZWFkZXIuZmluZCgnZW0nKTtcbiAgICB0aGlzLmFuY2hvciA9IHRoaXMubm9kZS5maW5kKCcuYW5jaG9yJyk7XG4gICAgdGhpcy5jYW5jZWwgPSBmdW5jdGlvbigpIHt9O1xuICAgIHRoaXMuY2FuY2VsUmVzaXplID0gZnVuY3Rpb24oKSB7fTtcbiAgICB0aGlzLmNvbnRleHRCbHVyTGlzdGVuZXIgPSB0aGlzLm9uQmx1ci5iaW5kKHRoaXMpO1xuICAgIHRoaXMucmVzaXplTGlzdGVuZXIgPSB0aGlzLm9uUmVzaXplLmJpbmQodGhpcyk7XG4gICAgdGhpcy5wb3NpdGlvbkRlbGF5ZWQgPSBmbi5yYXRlTGltaXQoMjAwLCB0aGlzLnBvc2l0aW9uVGlwLmJpbmQodGhpcykpO1xuICAgIHRoaXMucmVkaXNwbGF5ID0gZm4ucmF0ZUxpbWl0KDEwMCwgdGhpcy5yZWRpc3BsYXlUaXAuYmluZCh0aGlzKSk7XG5cbiAgICAkKHdpbmRvdykub24oJ3Jlc2l6ZScsIHRoaXMucmVzaXplTGlzdGVuZXIpO1xuXG4gICAgdGhpcy5oaWRlKCk7XG4gIH0sXG4gICdvbkNoYW5nZScgOiBmdW5jdGlvbih2YWx1ZSwgb2xkVmFsdWUpIHtcblxuICAgIGlmICh0aGlzLmN1cnJlbnRDb250ZXh0KSB7XG4gICAgICB0aGlzLmN1cnJlbnRDb250ZXh0Lm9mZignYmx1cicsIHRoaXMuY29udGV4dEJsdXJMaXN0ZW5lcik7XG4gICAgfVxuXG4gICAgaWYgKCF2YWx1ZSkge1xuICAgICAgdGhpcy5jYW5jZWwoKTtcbiAgICAgIHRoaXMuaGlkZSgpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMubmFtZS50ZXh0KHZhbHVlLm5hbWUpO1xuICAgIHRoaXMudHlwZS50ZXh0KHZhbHVlLnR5cGUpO1xuXG5cbiAgICB0aGlzLmRpc3BsYXlEZXNjcmlwdGlvbih2YWx1ZS5kZXNjcmlwdGlvbik7XG5cbiAgICBpZiAodmFsdWUuY29udGV4dCkge1xuXG4gICAgICB0aGlzLmN1cnJlbnRDb250ZXh0ID0gdmFsdWUuY29udGV4dDtcbiAgICAgIHRoaXMuY2FuY2VsKCk7XG4gICAgICB0aGlzLmNhbmNlbCA9IHRoaXMucG9zaXRpb25EZWxheWVkKHZhbHVlLmNvbnRleHQsIHZhbHVlLnBvc2l0aW9uKTtcblxuICAgICAgdmFsdWUuY29udGV4dC5vbmUoJ2JsdXInLCB0aGlzLmNvbnRleHRCbHVyTGlzdGVuZXIpO1xuICAgIH1cbiAgfVxufSk7XG5cblRpcC5wcm90b3R5cGUucmVkaXNwbGF5VGlwID0gZnVuY3Rpb24oKSB7XG5cbiAgaWYgKCF0aGlzLnZhbHVlKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgLy8gZGV0ZWN0IGlmIHRoZSBpdGVtIGlzIG9mZnNjcmVlbiBvciBub3RcbiAgdmFyIGNvbnRleHROb2RlID0gdGhpcy52YWx1ZS5jb250ZXh0IHx8IG51bGw7XG5cbiAgaWYgKCFjb250ZXh0Tm9kZSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHRoaXMub3B0aW9ucy5vbkNoYW5nZS5jYWxsKHRoaXMsIHRoaXMudmFsdWUpO1xufTtcblxuVGlwLnByb3RvdHlwZS5wb3NpdGlvblRpcCA9IGZ1bmN0aW9uKGNvbnRleHQsIHBvc2l0aW9uLCBhdHRlbXB0cykge1xuXG4gIHZhciBvZmZzZXQgPSBjb250ZXh0Lm9mZnNldCgpLFxuICAgICAgJGJvZHkgPSAkKCdib2R5JyksXG4gICAgICBzY3JlZW4sXG4gICAgICBib3VuZHMsXG4gICAgICBwb3NpdGlvbkNzcyA9IHt9LFxuICAgICAgYW5jaG9yQ3NzID0ge30sXG4gICAgICByZXRyeSA9IGZhbHNlO1xuXG4gIGF0dGVtcHRzID0gYXR0ZW1wdHMgfHwgW107XG4gIHBvc2l0aW9uID0gcG9zaXRpb24gfHwgJ3JpZ2h0JztcblxuICB0aGlzLm5vZGUuaGlkZSgpO1xuXG4gIGxpbWl0ID0ge1xuICAgIHdpZHRoOiAkYm9keS53aWR0aCgpLFxuICAgIGhlaWdodDogJGJvZHkuaGVpZ2h0KClcbiAgfTtcblxuICAvLyBsYXlvdXQgdG8gZ2V0IHdpZHRoL2hlaWdodFxuICB0aGlzLm5vZGUuY3NzKHsnb3BhY2l0eSc6JzAnLCAndmlzaWJpbGl0eSc6ICdoaWRkZW4nLCBsZWZ0OjAsIHRvcDowLCAnd2lkdGgnOiBudWxsfSkuc2hvdygpO1xuXG4gIC8vIHN0b3JlIHRoZSBib3VuZHNcbiAgYm91bmRzID0gdGhpcy5ub2RlLm9mZnNldCgpO1xuXG4gIHRoaXMubm9kZS5jc3Moeyd3aWR0aCc6IGJvdW5kcy53aWR0aH0pO1xuXG4gIC8vIGRldGVybWluZSB3aGVyZSBpdCBzaG91bGQgZ28gcmVsYXRpdmUgdGhlIGNvbnRleHRcbiAgc3dpdGNoIChwb3NpdGlvbikge1xuICBjYXNlICdhYm92ZSc6XG4gICAgcG9zaXRpb25Dc3MgPSB7dG9wOiBvZmZzZXQudG9wIC0gYm91bmRzLmhlaWdodCAtIDgsIGxlZnQ6IG9mZnNldC5sZWZ0IH07XG4gICAgYW5jaG9yQ3NzID0ge3RvcDogYm91bmRzLmhlaWdodCwgbGVmdDogMTZ9O1xuICAgIGJyZWFrO1xuICBjYXNlICdiZWxvdyc6XG4gICAgcG9zaXRpb25Dc3MgPSB7dG9wOiBvZmZzZXQudG9wICsgb2Zmc2V0LmhlaWdodCArIDgsIGxlZnQ6IG9mZnNldC5sZWZ0fTtcbiAgICBhbmNob3JDc3MgPSB7IHRvcDogMCwgbGVmdDogMTZ9O1xuICAgIGJyZWFrO1xuICBjYXNlICdyaWdodCc6XG4gICAgcG9zaXRpb25Dc3MgPSB7dG9wOiBvZmZzZXQudG9wLCBsZWZ0OiBvZmZzZXQud2lkdGggKyBvZmZzZXQubGVmdCArIDh9O1xuICAgIGFuY2hvckNzcyA9IHsgdG9wOiAxNiwgbGVmdDogMH07XG4gICAgYnJlYWs7XG4gIGNhc2UgJ2xlZnQnOlxuICAgIHBvc2l0aW9uQ3NzID0ge3RvcDogb2Zmc2V0LnRvcCwgbGVmdDogb2Zmc2V0LmxlZnQgLSBib3VuZHMud2lkdGggLSA4fTtcbiAgICBhbmNob3JDc3MgPSB7IHRvcDogMTYsIGxlZnQ6IGJvdW5kcy53aWR0aCB9O1xuICAgIGJyZWFrO1xuICB9XG5cbiAgdGhpcy5hbmNob3IuY3NzKGFuY2hvckNzcyk7XG4gIHRoaXMubm9kZS5jc3MocG9zaXRpb25Dc3MpO1xuXG4gIGJvdW5kcyA9IHRoaXMubm9kZS5vZmZzZXQoKTtcbiAgYm91bmRzLnJpZ2h0ID0gYm91bmRzLmxlZnQgKyBib3VuZHMud2lkdGg7XG4gIGJvdW5kcy5ib3R0b20gPSBib3VuZHMudG9wICsgYm91bmRzLmhlaWdodDtcblxuICBzd2l0Y2ggKHBvc2l0aW9uKSB7XG4gIGNhc2UgJ2JlbG93JzpcbiAgICBpZiAoYm91bmRzLmJvdHRvbSA+IGxpbWl0LmhlaWdodCkge1xuICAgICAgcmV0cnkgPSAncmlnaHQnO1xuICAgIH1cbiAgICBicmVhaztcbiAgY2FzZSAnYWJvdmUnOlxuICAgIGlmIChib3VuZHMudG9wIDwgMCkge1xuICAgICAgcmV0cnkgPSAnbGVmdCc7XG4gICAgfVxuICAgIGJyZWFrO1xuICBjYXNlICdsZWZ0JzpcbiAgICBpZiAoYm91bmRzLmxlZnQgPCAwKSB7XG4gICAgICByZXRyeSA9ICdiZWxvdyc7XG4gICAgfVxuICAgIGJyZWFrO1xuICBjYXNlICdyaWdodCc6XG4gICAgaWYgKGJvdW5kcy5yaWdodCA+IGxpbWl0LndpZHRoKSB7XG4gICAgICByZXRyeSA9ICdhYm92ZSc7XG4gICAgfVxuICAgIGJyZWFrO1xuICB9XG5cbiAgaWYgKHJldHJ5ICE9PSBmYWxzZSkge1xuICAgIGlmIChhdHRlbXB0cy5pbmRleE9mKHJldHJ5KSA9PT0gLTEpIHtcbiAgICAgIHRoaXMucG9zaXRpb25UaXAoY29udGV4dCwgcmV0cnksIGF0dGVtcHRzLmNvbmNhdChwb3NpdGlvbikpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgfVxuXG4gIHZhciBhZGp1c3QsIGRlbHRhO1xuXG4gIGlmIChib3VuZHMucmlnaHQgPiBsaW1pdC53aWR0aCAtIDgpIHtcbiAgICBhZGp1c3QgPSBsaW1pdC53aWR0aCAtIGJvdW5kcy53aWR0aCAtIDg7XG4gICAgZGVsdGEgPSBhZGp1c3QgLSBib3VuZHMubGVmdDtcblxuICAgIHRoaXMubm9kZS5jc3MoJ2xlZnQnLCBhZGp1c3QpO1xuICAgIHRoaXMuYW5jaG9yLmNzcyh7J2xlZnQnOiBhbmNob3JDc3MubGVmdCAtIGRlbHRhfSk7XG4gIH1cblxuICBpZiAoYm91bmRzLmJvdHRvbSA+IGxpbWl0LmhlaWdodCAtIDgpIHtcbiAgICBhZGp1c3QgPSBNYXRoLm1heCg4LGxpbWl0LmhlaWdodCAtIGJvdW5kcy5oZWlnaHQgLSA4KTtcbiAgICBkZWx0YSA9IGFkanVzdCAtIGJvdW5kcy50b3A7XG5cbiAgICB0aGlzLm5vZGUuY3NzKCd0b3AnLCBhZGp1c3QpO1xuICAgIHRoaXMuYW5jaG9yLmNzcygndG9wJywgYW5jaG9yQ3NzLnRvcCAtIGRlbHRhKTtcbiAgfVxuXG4gIHRoaXMubm9kZS5jc3Moeyd2aXNpYmlsaXR5JzondmlzaWJsZScsICdvcGFjaXR5Jzp0aGlzLm9wdGlvbnMub3BhY2l0eX0pO1xuXG59O1xuXG5UaXAucHJvdG90eXBlLmRpc3BsYXlEZXNjcmlwdGlvbiA9IGZ1bmN0aW9uKGRlc2NyaXB0aW9uKSB7XG4gIHZhciBsaXN0ID0gdGhpcy5ub2RlLmZpbmQoJ3VsJyksXG4gICAgICBpdGVtcyA9ICQoKTtcblxuICBsaXN0LmZpbmQoJ2xpJykucmVtb3ZlKCk7XG5cbiAgaWYgKCFDb21wb25lbnQuJC5pc1BsYWluT2JqZWN0KGRlc2NyaXB0aW9uKSkge1xuICAgIHRoaXMuZm9ybWF0RGVzY3JpcHRpb24oZGVzY3JpcHRpb24pLmFwcGVuZFRvKGxpc3QpO1xuICAgIHJldHVybjtcbiAgfVxuICBcbiAgZm9yICh2YXIgbmFtZSBpbiBkZXNjcmlwdGlvbikge1xuICAgIGl0ZW1zID0gaXRlbXMuYWRkKHRoaXMuZm9ybWF0RGVzY3JpcHRpb24obmFtZSwgZGVzY3JpcHRpb25bbmFtZV0pKTtcbiAgfVxuXG4gIGxpc3QuYXBwZW5kKGl0ZW1zKTtcblxufTtcblxuVGlwLnByb3RvdHlwZS5vblJlc2l6ZSA9IGZ1bmN0aW9uKCkge1xuXG4gIHRoaXMuY2FuY2VsKCk7XG4gIHRoaXMubm9kZS5oaWRlKCk7XG5cbiAgdGhpcy5jYW5jZWxSZXNpemUoKTtcbiAgdGhpcy5jYW5jZWxSZXNpemUgPSB0aGlzLnJlZGlzcGxheSgpO1xuXG59O1xuXG5UaXAucHJvdG90eXBlLm9uQmx1ciA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLmhpZGUoKTtcbn07XG5cblRpcC5wcm90b3R5cGUuZm9ybWF0RGVzY3JpcHRpb24gPSBmdW5jdGlvbihuYW1lLCBkZXNjcmlwdGlvbikge1xuXG4gIHZhciBpdGVtID0gJCgnPGxpPjwvbGk+JyksIGRlZiA9ICcoZGVmYXVsdCknLCBvcHQgPSAnT3B0aW9uYWwuJztcblxuICBpZiAoIWRlc2NyaXB0aW9uKSB7XG4gICAgZGVzY3JpcHRpb24gPSBuYW1lO1xuICB9IGVsc2Uge1xuICAgIGl0ZW0uYXBwZW5kKCQoJzxjb2RlPjwvY29kZT4nKS50ZXh0KG5hbWUpKS5hcHBlbmQoJyDigJMgJyk7XG4gIH1cblxuICBpZiAoIWRlc2NyaXB0aW9uKSB7XG4gICAgcmV0dXJuIGl0ZW07XG4gIH1cblxuICBpZiAoZGVzY3JpcHRpb24uaW5kZXhPZihkZWYpID09PSAwKSB7XG4gICAgaXRlbS5hcHBlbmQoJCgnPGVtPjwvZW0+JykudGV4dCgnRGVmYXVsdCcpKTtcbiAgICBkZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uLnNsaWNlKGRlZi5sZW5ndGgpO1xuICAgIGlmIChkZXNjcmlwdGlvbi50cmltKCkgIT09ICcnKSB7XG4gICAgICBpdGVtLmFwcGVuZCgnIOKAkyAnKTtcbiAgICB9XG4gIH1cblxuICBpZiAoZGVzY3JpcHRpb24uaW5kZXhPZihvcHQpID09PSAwKSB7XG4gICAgaXRlbS5hcHBlbmQoJCgnPGVtPjwvZW0+JykudGV4dCgnT3B0aW9uYWwnKSkuYXBwZW5kKCcg4oCTICcpO1xuICAgIGRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb24uc2xpY2Uob3B0Lmxlbmd0aCk7XG4gIH1cblxuICByZXR1cm4gaXRlbS5hcHBlbmQoJCgnPHNwYW4+PC9zcGFuPicpLnRleHQoZGVzY3JpcHRpb24pKTtcblxufTtcblxuVGlwLnByb3RvdHlwZS5oaWRlID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMudmFsdWUgPSBudWxsO1xuICB0aGlzLmNhbmNlbCgpO1xuICB0aGlzLm5vZGUuaGlkZSgpO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBUaXA7IiwidmFyICQgPSByZXF1aXJlKCd6ZXB0by1icm93c2VyaWZ5JykuJDtcblxuZnVuY3Rpb24gc3RyaW5naWZ5SnNvbihvYmplY3QsIG5vZGUpIHtcbiAgICBpZiAoIW5vZGUpIHtcbiAgICAgIG5vZGUgPSAkKCc8Y29kZT48L2NvZGU+JykuYWRkQ2xhc3MoJ2NvbXBhY3QnKTtcbiAgICB9XG5cbiAgICBpZiAoJC5pc1BsYWluT2JqZWN0KG9iamVjdCkpIHtcbiAgICAgIG5vZGUuYXBwZW5kKFwie1wiKTtcbiAgICAgIHZhciB0cmFpbGluZyA9IFwiXCI7XG4gICAgICBmb3IodmFyIGtleSBpbiBvYmplY3QpIHtcbiAgICAgICAgbm9kZS5hcHBlbmQodHJhaWxpbmcpO1xuICAgICAgICB0cmFpbGluZyA9IFwiLCBcIjtcbiAgICAgICAgbm9kZS5hcHBlbmQoJCgnPHNwYW4+PC9zcGFuPicpLmFkZENsYXNzKCdrZXknKS50ZXh0KCdcIicgKyBrZXkgKyAnXCInKSkuYXBwZW5kKFwiOiBcIik7XG4gICAgICAgIHN0cmluZ2lmeUpzb24ob2JqZWN0W2tleV0sIG5vZGUpO1xuICAgICAgICBpZiAobm9kZS50ZXh0KCkubGVuZ3RoID4gMjAwKSB7XG4gICAgICAgICAgbm9kZS5hcHBlbmQoXCIg4oCmfVwiKTtcbiAgICAgICAgICByZXR1cm4gbm9kZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgbm9kZS5sYXN0KCkucmVtb3ZlKCk7XG4gICAgICBub2RlLmFwcGVuZCgnfScpO1xuICAgIH0gZWxzZSBpZiAoJC5pc0FycmF5KG9iamVjdCkpIHtcbiAgICAgIG5vZGUuYXBwZW5kKCdbJyk7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG9iamVjdC5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoaSA+IDApIHtcbiAgICAgICAgICBub2RlLmFwcGVuZCgnLCAnKTtcbiAgICAgICAgfVxuICAgICAgICBzdHJpbmdpZnlKc29uKG9iamVjdFtpXSwgbm9kZSk7XG5cbiAgICAgICAgaWYgKG5vZGUudGV4dCgpLmxlbmd0aCA+IDIwMCkge1xuICAgICAgICAgIG5vZGUuYXBwZW5kKCcg4oCmXScpO1xuICAgICAgICAgIHJldHVybiBub2RlO1xuICAgICAgICB9XG5cbiAgICAgIH1cbiAgICAgIG5vZGUuYXBwZW5kKCddJyk7XG4gICAgfSBlbHNlIGlmICh0eXBlb2Ygb2JqZWN0ID09ICdzdHJpbmcnKSB7XG4gICAgICBub2RlLmFwcGVuZCgkKFwiPHNwYW4+PC9zcGFuPlwiKS5hZGRDbGFzcygnc3RyaW5nJykudGV4dCgnXCInICsgb2JqZWN0LnJlcGxhY2UoL1wiL2csIFwiXFxcXFxcXCJcIikgKyAnXCInKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIG5vZGUuYXBwZW5kKCQoXCI8c3Bhbj48L3NwYW4+XCIpLmFkZENsYXNzKHR5cGVvZiBvYmplY3QpLnRleHQob2JqZWN0KSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG5vZGU7XG4gIH1cblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIHN0cmluZ2lmeUpzb246IHN0cmluZ2lmeUpzb25cbn07IiwiLy8gQ29weXJpZ2h0IEpveWVudCwgSW5jLiBhbmQgb3RoZXIgTm9kZSBjb250cmlidXRvcnMuXG4vL1xuLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGFcbi8vIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGVcbi8vIFwiU29mdHdhcmVcIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZ1xuLy8gd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLFxuLy8gZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdFxuLy8gcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlXG4vLyBmb2xsb3dpbmcgY29uZGl0aW9uczpcbi8vXG4vLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZFxuLy8gaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4vL1xuLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTU1xuLy8gT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRlxuLy8gTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTlxuLy8gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sXG4vLyBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1Jcbi8vIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEVcbi8vIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuXG5cbmZ1bmN0aW9uIEV2ZW50RW1pdHRlcigpIHtcbiAgdGhpcy5fZXZlbnRzID0gdGhpcy5fZXZlbnRzIHx8IHt9O1xuICB0aGlzLl9tYXhMaXN0ZW5lcnMgPSB0aGlzLl9tYXhMaXN0ZW5lcnMgfHwgdW5kZWZpbmVkO1xufVxubW9kdWxlLmV4cG9ydHMgPSBFdmVudEVtaXR0ZXI7XG5cbi8vIEJhY2t3YXJkcy1jb21wYXQgd2l0aCBub2RlIDAuMTAueFxuRXZlbnRFbWl0dGVyLkV2ZW50RW1pdHRlciA9IEV2ZW50RW1pdHRlcjtcblxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5fZXZlbnRzID0gdW5kZWZpbmVkO1xuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5fbWF4TGlzdGVuZXJzID0gdW5kZWZpbmVkO1xuXG4vLyBCeSBkZWZhdWx0IEV2ZW50RW1pdHRlcnMgd2lsbCBwcmludCBhIHdhcm5pbmcgaWYgbW9yZSB0aGFuIDEwIGxpc3RlbmVycyBhcmVcbi8vIGFkZGVkIHRvIGl0LiBUaGlzIGlzIGEgdXNlZnVsIGRlZmF1bHQgd2hpY2ggaGVscHMgZmluZGluZyBtZW1vcnkgbGVha3MuXG5FdmVudEVtaXR0ZXIuZGVmYXVsdE1heExpc3RlbmVycyA9IDEwO1xuXG4vLyBPYnZpb3VzbHkgbm90IGFsbCBFbWl0dGVycyBzaG91bGQgYmUgbGltaXRlZCB0byAxMC4gVGhpcyBmdW5jdGlvbiBhbGxvd3Ncbi8vIHRoYXQgdG8gYmUgaW5jcmVhc2VkLiBTZXQgdG8gemVybyBmb3IgdW5saW1pdGVkLlxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5zZXRNYXhMaXN0ZW5lcnMgPSBmdW5jdGlvbihuKSB7XG4gIGlmICghaXNOdW1iZXIobikgfHwgbiA8IDAgfHwgaXNOYU4obikpXG4gICAgdGhyb3cgVHlwZUVycm9yKCduIG11c3QgYmUgYSBwb3NpdGl2ZSBudW1iZXInKTtcbiAgdGhpcy5fbWF4TGlzdGVuZXJzID0gbjtcbiAgcmV0dXJuIHRoaXM7XG59O1xuXG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLmVtaXQgPSBmdW5jdGlvbih0eXBlKSB7XG4gIHZhciBlciwgaGFuZGxlciwgbGVuLCBhcmdzLCBpLCBsaXN0ZW5lcnM7XG5cbiAgaWYgKCF0aGlzLl9ldmVudHMpXG4gICAgdGhpcy5fZXZlbnRzID0ge307XG5cbiAgLy8gSWYgdGhlcmUgaXMgbm8gJ2Vycm9yJyBldmVudCBsaXN0ZW5lciB0aGVuIHRocm93LlxuICBpZiAodHlwZSA9PT0gJ2Vycm9yJykge1xuICAgIGlmICghdGhpcy5fZXZlbnRzLmVycm9yIHx8XG4gICAgICAgIChpc09iamVjdCh0aGlzLl9ldmVudHMuZXJyb3IpICYmICF0aGlzLl9ldmVudHMuZXJyb3IubGVuZ3RoKSkge1xuICAgICAgZXIgPSBhcmd1bWVudHNbMV07XG4gICAgICBpZiAoZXIgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgICB0aHJvdyBlcjsgLy8gVW5oYW5kbGVkICdlcnJvcicgZXZlbnRcbiAgICAgIH1cbiAgICAgIHRocm93IFR5cGVFcnJvcignVW5jYXVnaHQsIHVuc3BlY2lmaWVkIFwiZXJyb3JcIiBldmVudC4nKTtcbiAgICB9XG4gIH1cblxuICBoYW5kbGVyID0gdGhpcy5fZXZlbnRzW3R5cGVdO1xuXG4gIGlmIChpc1VuZGVmaW5lZChoYW5kbGVyKSlcbiAgICByZXR1cm4gZmFsc2U7XG5cbiAgaWYgKGlzRnVuY3Rpb24oaGFuZGxlcikpIHtcbiAgICBzd2l0Y2ggKGFyZ3VtZW50cy5sZW5ndGgpIHtcbiAgICAgIC8vIGZhc3QgY2FzZXNcbiAgICAgIGNhc2UgMTpcbiAgICAgICAgaGFuZGxlci5jYWxsKHRoaXMpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgMjpcbiAgICAgICAgaGFuZGxlci5jYWxsKHRoaXMsIGFyZ3VtZW50c1sxXSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAzOlxuICAgICAgICBoYW5kbGVyLmNhbGwodGhpcywgYXJndW1lbnRzWzFdLCBhcmd1bWVudHNbMl0pO1xuICAgICAgICBicmVhaztcbiAgICAgIC8vIHNsb3dlclxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgbGVuID0gYXJndW1lbnRzLmxlbmd0aDtcbiAgICAgICAgYXJncyA9IG5ldyBBcnJheShsZW4gLSAxKTtcbiAgICAgICAgZm9yIChpID0gMTsgaSA8IGxlbjsgaSsrKVxuICAgICAgICAgIGFyZ3NbaSAtIDFdID0gYXJndW1lbnRzW2ldO1xuICAgICAgICBoYW5kbGVyLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgIH1cbiAgfSBlbHNlIGlmIChpc09iamVjdChoYW5kbGVyKSkge1xuICAgIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGg7XG4gICAgYXJncyA9IG5ldyBBcnJheShsZW4gLSAxKTtcbiAgICBmb3IgKGkgPSAxOyBpIDwgbGVuOyBpKyspXG4gICAgICBhcmdzW2kgLSAxXSA9IGFyZ3VtZW50c1tpXTtcblxuICAgIGxpc3RlbmVycyA9IGhhbmRsZXIuc2xpY2UoKTtcbiAgICBsZW4gPSBsaXN0ZW5lcnMubGVuZ3RoO1xuICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkrKylcbiAgICAgIGxpc3RlbmVyc1tpXS5hcHBseSh0aGlzLCBhcmdzKTtcbiAgfVxuXG4gIHJldHVybiB0cnVlO1xufTtcblxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5hZGRMaXN0ZW5lciA9IGZ1bmN0aW9uKHR5cGUsIGxpc3RlbmVyKSB7XG4gIHZhciBtO1xuXG4gIGlmICghaXNGdW5jdGlvbihsaXN0ZW5lcikpXG4gICAgdGhyb3cgVHlwZUVycm9yKCdsaXN0ZW5lciBtdXN0IGJlIGEgZnVuY3Rpb24nKTtcblxuICBpZiAoIXRoaXMuX2V2ZW50cylcbiAgICB0aGlzLl9ldmVudHMgPSB7fTtcblxuICAvLyBUbyBhdm9pZCByZWN1cnNpb24gaW4gdGhlIGNhc2UgdGhhdCB0eXBlID09PSBcIm5ld0xpc3RlbmVyXCIhIEJlZm9yZVxuICAvLyBhZGRpbmcgaXQgdG8gdGhlIGxpc3RlbmVycywgZmlyc3QgZW1pdCBcIm5ld0xpc3RlbmVyXCIuXG4gIGlmICh0aGlzLl9ldmVudHMubmV3TGlzdGVuZXIpXG4gICAgdGhpcy5lbWl0KCduZXdMaXN0ZW5lcicsIHR5cGUsXG4gICAgICAgICAgICAgIGlzRnVuY3Rpb24obGlzdGVuZXIubGlzdGVuZXIpID9cbiAgICAgICAgICAgICAgbGlzdGVuZXIubGlzdGVuZXIgOiBsaXN0ZW5lcik7XG5cbiAgaWYgKCF0aGlzLl9ldmVudHNbdHlwZV0pXG4gICAgLy8gT3B0aW1pemUgdGhlIGNhc2Ugb2Ygb25lIGxpc3RlbmVyLiBEb24ndCBuZWVkIHRoZSBleHRyYSBhcnJheSBvYmplY3QuXG4gICAgdGhpcy5fZXZlbnRzW3R5cGVdID0gbGlzdGVuZXI7XG4gIGVsc2UgaWYgKGlzT2JqZWN0KHRoaXMuX2V2ZW50c1t0eXBlXSkpXG4gICAgLy8gSWYgd2UndmUgYWxyZWFkeSBnb3QgYW4gYXJyYXksIGp1c3QgYXBwZW5kLlxuICAgIHRoaXMuX2V2ZW50c1t0eXBlXS5wdXNoKGxpc3RlbmVyKTtcbiAgZWxzZVxuICAgIC8vIEFkZGluZyB0aGUgc2Vjb25kIGVsZW1lbnQsIG5lZWQgdG8gY2hhbmdlIHRvIGFycmF5LlxuICAgIHRoaXMuX2V2ZW50c1t0eXBlXSA9IFt0aGlzLl9ldmVudHNbdHlwZV0sIGxpc3RlbmVyXTtcblxuICAvLyBDaGVjayBmb3IgbGlzdGVuZXIgbGVha1xuICBpZiAoaXNPYmplY3QodGhpcy5fZXZlbnRzW3R5cGVdKSAmJiAhdGhpcy5fZXZlbnRzW3R5cGVdLndhcm5lZCkge1xuICAgIHZhciBtO1xuICAgIGlmICghaXNVbmRlZmluZWQodGhpcy5fbWF4TGlzdGVuZXJzKSkge1xuICAgICAgbSA9IHRoaXMuX21heExpc3RlbmVycztcbiAgICB9IGVsc2Uge1xuICAgICAgbSA9IEV2ZW50RW1pdHRlci5kZWZhdWx0TWF4TGlzdGVuZXJzO1xuICAgIH1cblxuICAgIGlmIChtICYmIG0gPiAwICYmIHRoaXMuX2V2ZW50c1t0eXBlXS5sZW5ndGggPiBtKSB7XG4gICAgICB0aGlzLl9ldmVudHNbdHlwZV0ud2FybmVkID0gdHJ1ZTtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJyhub2RlKSB3YXJuaW5nOiBwb3NzaWJsZSBFdmVudEVtaXR0ZXIgbWVtb3J5ICcgK1xuICAgICAgICAgICAgICAgICAgICAnbGVhayBkZXRlY3RlZC4gJWQgbGlzdGVuZXJzIGFkZGVkLiAnICtcbiAgICAgICAgICAgICAgICAgICAgJ1VzZSBlbWl0dGVyLnNldE1heExpc3RlbmVycygpIHRvIGluY3JlYXNlIGxpbWl0LicsXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2V2ZW50c1t0eXBlXS5sZW5ndGgpO1xuICAgICAgaWYgKHR5cGVvZiBjb25zb2xlLnRyYWNlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIC8vIG5vdCBzdXBwb3J0ZWQgaW4gSUUgMTBcbiAgICAgICAgY29uc29sZS50cmFjZSgpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiB0aGlzO1xufTtcblxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5vbiA9IEV2ZW50RW1pdHRlci5wcm90b3R5cGUuYWRkTGlzdGVuZXI7XG5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUub25jZSA9IGZ1bmN0aW9uKHR5cGUsIGxpc3RlbmVyKSB7XG4gIGlmICghaXNGdW5jdGlvbihsaXN0ZW5lcikpXG4gICAgdGhyb3cgVHlwZUVycm9yKCdsaXN0ZW5lciBtdXN0IGJlIGEgZnVuY3Rpb24nKTtcblxuICB2YXIgZmlyZWQgPSBmYWxzZTtcblxuICBmdW5jdGlvbiBnKCkge1xuICAgIHRoaXMucmVtb3ZlTGlzdGVuZXIodHlwZSwgZyk7XG5cbiAgICBpZiAoIWZpcmVkKSB7XG4gICAgICBmaXJlZCA9IHRydWU7XG4gICAgICBsaXN0ZW5lci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH1cbiAgfVxuXG4gIGcubGlzdGVuZXIgPSBsaXN0ZW5lcjtcbiAgdGhpcy5vbih0eXBlLCBnKTtcblxuICByZXR1cm4gdGhpcztcbn07XG5cbi8vIGVtaXRzIGEgJ3JlbW92ZUxpc3RlbmVyJyBldmVudCBpZmYgdGhlIGxpc3RlbmVyIHdhcyByZW1vdmVkXG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLnJlbW92ZUxpc3RlbmVyID0gZnVuY3Rpb24odHlwZSwgbGlzdGVuZXIpIHtcbiAgdmFyIGxpc3QsIHBvc2l0aW9uLCBsZW5ndGgsIGk7XG5cbiAgaWYgKCFpc0Z1bmN0aW9uKGxpc3RlbmVyKSlcbiAgICB0aHJvdyBUeXBlRXJyb3IoJ2xpc3RlbmVyIG11c3QgYmUgYSBmdW5jdGlvbicpO1xuXG4gIGlmICghdGhpcy5fZXZlbnRzIHx8ICF0aGlzLl9ldmVudHNbdHlwZV0pXG4gICAgcmV0dXJuIHRoaXM7XG5cbiAgbGlzdCA9IHRoaXMuX2V2ZW50c1t0eXBlXTtcbiAgbGVuZ3RoID0gbGlzdC5sZW5ndGg7XG4gIHBvc2l0aW9uID0gLTE7XG5cbiAgaWYgKGxpc3QgPT09IGxpc3RlbmVyIHx8XG4gICAgICAoaXNGdW5jdGlvbihsaXN0Lmxpc3RlbmVyKSAmJiBsaXN0Lmxpc3RlbmVyID09PSBsaXN0ZW5lcikpIHtcbiAgICBkZWxldGUgdGhpcy5fZXZlbnRzW3R5cGVdO1xuICAgIGlmICh0aGlzLl9ldmVudHMucmVtb3ZlTGlzdGVuZXIpXG4gICAgICB0aGlzLmVtaXQoJ3JlbW92ZUxpc3RlbmVyJywgdHlwZSwgbGlzdGVuZXIpO1xuXG4gIH0gZWxzZSBpZiAoaXNPYmplY3QobGlzdCkpIHtcbiAgICBmb3IgKGkgPSBsZW5ndGg7IGktLSA+IDA7KSB7XG4gICAgICBpZiAobGlzdFtpXSA9PT0gbGlzdGVuZXIgfHxcbiAgICAgICAgICAobGlzdFtpXS5saXN0ZW5lciAmJiBsaXN0W2ldLmxpc3RlbmVyID09PSBsaXN0ZW5lcikpIHtcbiAgICAgICAgcG9zaXRpb24gPSBpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAocG9zaXRpb24gPCAwKVxuICAgICAgcmV0dXJuIHRoaXM7XG5cbiAgICBpZiAobGlzdC5sZW5ndGggPT09IDEpIHtcbiAgICAgIGxpc3QubGVuZ3RoID0gMDtcbiAgICAgIGRlbGV0ZSB0aGlzLl9ldmVudHNbdHlwZV07XG4gICAgfSBlbHNlIHtcbiAgICAgIGxpc3Quc3BsaWNlKHBvc2l0aW9uLCAxKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5fZXZlbnRzLnJlbW92ZUxpc3RlbmVyKVxuICAgICAgdGhpcy5lbWl0KCdyZW1vdmVMaXN0ZW5lcicsIHR5cGUsIGxpc3RlbmVyKTtcbiAgfVxuXG4gIHJldHVybiB0aGlzO1xufTtcblxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5yZW1vdmVBbGxMaXN0ZW5lcnMgPSBmdW5jdGlvbih0eXBlKSB7XG4gIHZhciBrZXksIGxpc3RlbmVycztcblxuICBpZiAoIXRoaXMuX2V2ZW50cylcbiAgICByZXR1cm4gdGhpcztcblxuICAvLyBub3QgbGlzdGVuaW5nIGZvciByZW1vdmVMaXN0ZW5lciwgbm8gbmVlZCB0byBlbWl0XG4gIGlmICghdGhpcy5fZXZlbnRzLnJlbW92ZUxpc3RlbmVyKSB7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApXG4gICAgICB0aGlzLl9ldmVudHMgPSB7fTtcbiAgICBlbHNlIGlmICh0aGlzLl9ldmVudHNbdHlwZV0pXG4gICAgICBkZWxldGUgdGhpcy5fZXZlbnRzW3R5cGVdO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLy8gZW1pdCByZW1vdmVMaXN0ZW5lciBmb3IgYWxsIGxpc3RlbmVycyBvbiBhbGwgZXZlbnRzXG4gIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSB7XG4gICAgZm9yIChrZXkgaW4gdGhpcy5fZXZlbnRzKSB7XG4gICAgICBpZiAoa2V5ID09PSAncmVtb3ZlTGlzdGVuZXInKSBjb250aW51ZTtcbiAgICAgIHRoaXMucmVtb3ZlQWxsTGlzdGVuZXJzKGtleSk7XG4gICAgfVxuICAgIHRoaXMucmVtb3ZlQWxsTGlzdGVuZXJzKCdyZW1vdmVMaXN0ZW5lcicpO1xuICAgIHRoaXMuX2V2ZW50cyA9IHt9O1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgbGlzdGVuZXJzID0gdGhpcy5fZXZlbnRzW3R5cGVdO1xuXG4gIGlmIChpc0Z1bmN0aW9uKGxpc3RlbmVycykpIHtcbiAgICB0aGlzLnJlbW92ZUxpc3RlbmVyKHR5cGUsIGxpc3RlbmVycyk7XG4gIH0gZWxzZSB7XG4gICAgLy8gTElGTyBvcmRlclxuICAgIHdoaWxlIChsaXN0ZW5lcnMubGVuZ3RoKVxuICAgICAgdGhpcy5yZW1vdmVMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcnNbbGlzdGVuZXJzLmxlbmd0aCAtIDFdKTtcbiAgfVxuICBkZWxldGUgdGhpcy5fZXZlbnRzW3R5cGVdO1xuXG4gIHJldHVybiB0aGlzO1xufTtcblxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5saXN0ZW5lcnMgPSBmdW5jdGlvbih0eXBlKSB7XG4gIHZhciByZXQ7XG4gIGlmICghdGhpcy5fZXZlbnRzIHx8ICF0aGlzLl9ldmVudHNbdHlwZV0pXG4gICAgcmV0ID0gW107XG4gIGVsc2UgaWYgKGlzRnVuY3Rpb24odGhpcy5fZXZlbnRzW3R5cGVdKSlcbiAgICByZXQgPSBbdGhpcy5fZXZlbnRzW3R5cGVdXTtcbiAgZWxzZVxuICAgIHJldCA9IHRoaXMuX2V2ZW50c1t0eXBlXS5zbGljZSgpO1xuICByZXR1cm4gcmV0O1xufTtcblxuRXZlbnRFbWl0dGVyLmxpc3RlbmVyQ291bnQgPSBmdW5jdGlvbihlbWl0dGVyLCB0eXBlKSB7XG4gIHZhciByZXQ7XG4gIGlmICghZW1pdHRlci5fZXZlbnRzIHx8ICFlbWl0dGVyLl9ldmVudHNbdHlwZV0pXG4gICAgcmV0ID0gMDtcbiAgZWxzZSBpZiAoaXNGdW5jdGlvbihlbWl0dGVyLl9ldmVudHNbdHlwZV0pKVxuICAgIHJldCA9IDE7XG4gIGVsc2VcbiAgICByZXQgPSBlbWl0dGVyLl9ldmVudHNbdHlwZV0ubGVuZ3RoO1xuICByZXR1cm4gcmV0O1xufTtcblxuZnVuY3Rpb24gaXNGdW5jdGlvbihhcmcpIHtcbiAgcmV0dXJuIHR5cGVvZiBhcmcgPT09ICdmdW5jdGlvbic7XG59XG5cbmZ1bmN0aW9uIGlzTnVtYmVyKGFyZykge1xuICByZXR1cm4gdHlwZW9mIGFyZyA9PT0gJ251bWJlcic7XG59XG5cbmZ1bmN0aW9uIGlzT2JqZWN0KGFyZykge1xuICByZXR1cm4gdHlwZW9mIGFyZyA9PT0gJ29iamVjdCcgJiYgYXJnICE9PSBudWxsO1xufVxuXG5mdW5jdGlvbiBpc1VuZGVmaW5lZChhcmcpIHtcbiAgcmV0dXJuIGFyZyA9PT0gdm9pZCAwO1xufVxuIiwiXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgYXJnbG9jazogYXJnbG9jayxcbiAgd2hlbjogd2hlbixcbiAgY291bnRzOiBjb3VudHMsXG4gIGRlYm91bmNlOiBkZWJvdW5jZSxcbiAgdGltZXM6IHRpbWVzLFxuICByYXRlTGltaXQ6IHJhdGVMaW1pdFxufTtcblxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKipcblxud2hlbihjaGVjaywgZm4sIGFyZ3MgLi4uKVxuXG5yZXR1cm5zIGEgZnVuY3Rpb24gdGhhdCB3aWxsIG9ubHkgYmUgY2FsbGVkIHdoZW4gYGNoZWNrKClgIHJldHVybnMgdHJ1ZS5cbkFkZGl0aW9uYWwgYXJncnVtZW50IGFyZSB1c2VkIGluIHRoZSByZXR1cm5lZCBmdW5jdGlvbi5cblxuY2hlY2sgLSBmdW5jdGlvbiB0byBkZXRlcm1pbmUgaWYgYGZuYCBzaG91bGQgYmUgY2FsbGVkXG5mbiAtIGZ1bmN0aW9uIHRvIGJlIGNhbGxlZCBpZiBgY2hlY2tgIHJldHVybnMgdHJ1ZVxuYXJncyAtIGFyZ3VtZW50cyB0byBiZSB1c2VkIHdoZW4gYGZuYCBpcyBjYWxsZWRcblxucmV0dXJucyBmdW5jdGlvblxuXG5FeGFtcGxlXG5cbiAgICB2YXIgZG9Mb2cgPSBmYWxzZTtcbiAgICAgICAgdG9nZ2xlID0gZnVuY3Rpb24oKSB7IGRvTG9nID0gIWRvTG9nOyByZXR1cm4gZG9Mb2c7IH07XG4gICAgICAgIGxvZ0V2ZXJ5T3RoZXIgPSBmbi53aGVuKHRvZ2dsZSwgY29uc29sZS5sb2cuYmluZChjb25zb2xlKSwgJ0hlbGxvIFdvcmxkJyk7XG5cbmxvZ0V2ZXJ5T3RoZXIoJ2Jvb20nKTtcblxuLy8gPT4gJ0hlbGxvIFdvcmxkJywgJ2Jvb20nXG5cbmxvZ0V2ZXJ5T3RoZXIoJ2JhbScpO1xuXG4vLyA8IHNpbGVuY2UgPlxuXG5sb2dFdmVyeU90aGVyKCdmb28nLCAnYmFyJyk7XG5cbi8vID0+ICdIZWxsbyBXb3JsZCcsICdmb28nLCAnYmFyJ1xuXG5cbioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuZnVuY3Rpb24gd2hlbihjaGVjaywgZm4pe1xuXG4gIHZhciBhcmdzID0gW10uc2xpY2UuY2FsbChhcmd1bWVudHMsIDIpO1xuXG4gIHJldHVybiBmdW5jdGlvbigpe1xuICAgIGlmIChjaGVjaygpKSByZXR1cm4gZm4uYXBwbHkodGhpcywgYXJncy5jb25jYXQoW10uc2xpY2UuY2FsbChhcmd1bWVudHMpKSk7XG4gIH07XG5cbn1cblxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKipcbmRlYm91bmNlKGV2ZXJ5LCBmbiwgYXJncyAuLi4pXG5cblBlcmZvcm0gYSBmdW5jdGlvbiBldmVyeSBgbmAgdGltZXMuIEFkZGl0aW9uYWwgYXJndW1lbnRzIGFyZSBhcHBsaWVkIHRvIGBmbmAgd2hlbiBjYWxsZWQuIFxuXG5ldmVyeSAtIG51bWJlciBvZiB0aW1lcyB0byBjYWxsIGZ1bmN0aW9uIGJlZm9yZSBmaXJpbmcgYGZuYFxuZm4gLSBmdW5jdGlvbiB0byBiZSBjYWxsZWQgYWZ0ZXIgYGV2ZXJ5YCBuIHRpbWVzLlxuYXJncyAtIGFkZGl0aW5hbCBhcmdzIHRvIGJlIGFwcGxpZWQgdG8gYGZuYCB3aGVuIGNhbGxlZFxuXG5FeGFtcGxlOlxuXG4gIHZhciBsb2dFdmVyeTQgPSBmbi5kZWJvdW5jZSg1LCBjb25zb2xlLmxvZy5iaW5kKGNvbnNvbGUpLCBcIkxvZyFcIik7XG5cbiAgbG9nRXZlcnk0KCdIaScpO1xuICA9PiA8IHNpbGVuY2UgPiBcbiAgXG4gIGxvZ0V2ZXJ5NCgnSGknKTtcbiAgPT4gPCBzaWxlbmNlID4gXG4gIFxuICBsb2dFdmVyeTQoJ0hpJyk7XG4gID0+IDwgc2lsZW5jZSA+IFxuICBcbiAgbG9nRXZlcnk0KCdIaScpO1xuICA9PiBcIkxvZyFcIiwgXCJIaVwiXG5cbioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5mdW5jdGlvbiBkZWJvdW5jZShldmVyeSwgZm4pe1xuXG4gIHZhciBhcmdzID0gW10uc2xpY2UuY2FsbChhcmd1bWVudHMsIDIpLFxuICAgICAgY291bnQgPSAwLFxuICAgICAgZGVib3VuY2VyID0gZnVuY3Rpb24oKXtcbiAgICAgICAgY291bnQgKys7XG4gICAgICAgIHJldHVybiBjb3VudCAlIGV2ZXJ5ID09PSAwO1xuICAgICAgfTtcblxuICByZXR1cm4gd2hlbi5hcHBseSh0aGlzLCBbZGVib3VuY2VyLCBmbl0uY29uY2F0KGFyZ3MpKTtcbn1cblxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKipcbmNvdW50cyh0aW1lcywgZm4sIGFyZ3MgLi4uKVxuXG5SZXR1cm5lZCBmdW5jdGlvbiB3aWxsIGV4ZWN1dGUgYSBtYXhpbXVtIG9mIGB0aW1lc2AuXG5cbnRpbWVzIC0gbnVtYmVyIG9mIHRpbWVzIGBmbmAgY2FuIGJlIGV4ZWN1dGVkXG5mbiAtIGZ1bmN0aW9uIHRvIGJlIGNhbGxlZFxuYXJncyAtIGFwcGxpZWQgdG8gYGZuYCB3aGVuIGNhbGxlZFxuXG5FeGFtcGxlOlxuXG4gIHZhciBsb2cgPSBmbi5jb3VudHMoMiwgY29uc29sZS5sb2cuYmluZChjb25zb2xlKSwgJ0hlbGxvJyk7XG5cbiAgbG9nKCdXb3JsZCEpO1xuICAvLyA9PiAnSGVsbG8nLCAnV29ybGQhJ1xuICBcbiAgbG9nKCdFdmVyeW9uZScpO1xuICAvLyA9PiAnSGVsbG8nLCAnRXZlcnlvbmUnXG4gIFxuICBsb2coJ1dvcmxkISk7XG4gIC8vID0+IDxzaWxlbmNlPlxuICBcbioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5mdW5jdGlvbiBjb3VudHModGltZXMsIGZuKXtcblxuICB2YXIgYXJncyA9IFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAyKSxcbiAgICBjb3VudCA9IDAsXG4gICAgY291bnRlciA9IGZ1bmN0aW9uKCl7XG4gICAgICBpZiAoY291bnQgPT0gdGltZXMpIHJldHVybiB0cnVlO1xuICAgICAgY291bnQgKys7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcblxuICByZXR1cm4gd2hlbi5hcHBseSh0aGlzLCBbY291bnRlciwgZm5dLmNvbmNhdChhcmdzKSk7XG5cbn1cblxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKlxuYXJnbG9jayhmbiwgYXJncyAuLi4pXG5cblJldHVybnMgZnVuY3Rpb24gdGhhdCB3aWxsIGhhdmUgYGFyZ3NgIGFwcGxpZWQgd2hlbiBjYWxsZWQuXG5cbkV4YW1wbGU6XG5cbiAgdmFyIGxvZyA9IGZuLmFyZ2xvY2soY29uc29sZS5sb2cuYmluZChjb25zb2xlKSwgJ1Rlc3QnKTtcblxuICBsb2coJzEnKTtcbiAgPT4gJ1Rlc3QnLCAnMSdcblxuKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuZnVuY3Rpb24gYXJnbG9jaygpe1xuICB2YXIgc2xpY2UgPSBbXS5zbGljZSxcbiAgICAgIGFyZ3MgPSBzbGljZS5hcHBseShhcmd1bWVudHMpO1xuXG4gIGlmIChhcmdzLmxlbmd0aCA9PT0gMCB8fCB0eXBlb2YoYXJnc1swXSkgIT0gJ2Z1bmN0aW9uJykgdGhyb3cgbmV3IEVycm9yKFwiZmlyc3QgYXJndW1lbnQgbXVzdCBiZSBhIGZ1bmN0aW9uXCIpO1xuXG4gIHZhciBmbiA9IGFyZ3Muc2hpZnQoKTtcblxuICByZXR1cm4gZnVuY3Rpb24oKXtcbiAgICByZXR1cm4gZm4uYXBwbHkodGhpcywgYXJncy5jb25jYXQoc2xpY2UuYXBwbHkoYXJndW1lbnRzKSkpO1xuICB9O1xufVxuXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqXG50aW1lcyhjb3VudCwgZm4sIGFyZ3MgLi4uKVxuXG5SZXR1cm5zIGEgZnVuY3Rpb24gdGhhdCB3aWxsIGV4ZWN1dGUgYGZuYCBgY291bnRgIHRpbWVzIHdpdGggYGFyZ3NgIGFwcGxpZWQuXG5cbmNvdW50IC0gbnVtYmVyIGZvIHRpbWVzIHRvIGNhbGwgYGZuYFxuZm4gLSBjYWxsYmFjayB0byBiZSBleGVjdWl0ZWRcbmFyZ3MgLSBhcmd1bWVudHMgdG8gYmUgYXBwbGllZCB0byBgZm5gIHdoZW4gY2FsbGVkXG5cbkV4YW1wbGU6XG5cbiAgdmFyIGxvZyA9IGZuLnRpbWVzKDMsIGNvbnNvbGUubG9nLmJpbmQoY29uc29sZSksICdIZWxsbycpO1xuXG4gIGxvZygnV29ybGQhKTtcbiAgPT4gJ0hlbGxvJywgJ1dvcmxkISdcbiAgPT4gJ0hlbGxvJywgJ1dvcmxkISdcbiAgPT4gJ0hlbGxvJywgJ1dvcmxkISdcblxuXG4qKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5mdW5jdGlvbiB0aW1lcyhjb3VudCwgZm4pe1xuXG4gIHZhciBhcmdzID0gW10uc2xpY2UuY2FsbChhcmd1bWVudHMsIDIpLFxuICAgICAgbXVsdGlwbGllZCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHZhciByZXN1bHRzID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY291bnQ7IGkrKykge1xuICAgICAgICAgIHJlc3VsdHMucHVzaChmbi5hcHBseSh0aGlzLCBhcmdzKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdHM7XG4gICAgICB9O1xuXG4gIHJldHVybiBtdWx0aXBsaWVkO1xuXG59XG5cbi8qKioqKioqKioqKioqKioqKioqKioqKioqKlxucmF0ZUxpbWl0KHdhaXQsIGZuLCBhcmdzKTtcblxuUmV0dXJucyBhIGZ1bmN0aW9uIHRoYXQgd2lsbCBvbmx5IGV4ZWN1dGUgYGZuYCBhZnRlciB3YWl0aW5nIGB3YWl0YCBtaWxsaXNlY29uZHNcbnNpbmNlIHRoZSBsYXN0IHRpbWUgY2FsbGVkLlxuXG53YWl0IC0gbnVtYmVyIG9mIG1pbGxpc2Vjb25kcyB0byB3YWl0XG5mbiAtIGZ1bmN0aW9uIHRvIGNhbGwgYWZ0ZXIgd2FpdGluZyBgd2FpdGAgbWlsbGlzZWNvbmRzXG5hcmdzIC0gYXJndW1lbnRzIHRvIGFwcGx5IHRvIGBmbmAgd2hlbiBjYWxsZWRcblxucmV0dXJucyBmdW5jdGlvbiAtIHNldHMgdGltZW91dCB3aGVuIGNhbGxlZCB0aGF0IHdhaXRzIGB3YWl0YCBtaWxsaXNlY29uZHMgdG8gY2FsbCBgZm5gIGFuZCBcbiAgICAgICAgcmV0dXJucyBhIGZ1bmN0aW9uIHRoYXQgY2FuY2VscyB0aGUgdGltZW91dCB3aGVuIGNhbGxlZC5cblxuRXhhbXBsZTpcblxuICB2YXIgbG9nID0gZm4ucmF0ZUxpbWl0KDEwMCwgY29uc29sZS5sb2cuYmluZChjb25zb2xlKSwgJ0hlbGxvJyksXG4gICAgICBjYW5jZWwgPSBsb2coJ1dvcmxkIScpO1xuICBcbiAgLy8gYWZ0ZXIgMTAwIG1zIHVubGVzcyBgY2FuY2VsYCBpcyBjYWxsZWRcbiAgLy8gPT4gJ0hlbGxvJywgJ1dvcmxkISdcblxuXG4qKioqKioqKioqKioqKioqKioqKioqKioqKi9cbmZ1bmN0aW9uIHJhdGVMaW1pdCh3YWl0LCBmbikge1xuXG4gIHZhciBjbGVhcixcbiAgICAgIGxpbWl0ZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKGNsZWFyKSBjbGVhcigpO1xuXG4gICAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzLFxuICAgICAgICB0aW1lb3V0SWQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgZm4uYXBwbHkodGhpcywgYXJncyk7XG4gICAgICAgIH0sIHdhaXQpO1xuXG4gICAgICAgIGNsZWFyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIGNsZWFyO1xuXG4gICAgICB9O1xuXG4gIHJldHVybiBsaW1pdGVkO1xuXG59IiwiLy8gc2hpbSBmb3IgdXNpbmcgcHJvY2VzcyBpbiBicm93c2VyXG52YXIgcHJvY2VzcyA9IG1vZHVsZS5leHBvcnRzID0ge307XG5cbi8vIGNhY2hlZCBmcm9tIHdoYXRldmVyIGdsb2JhbCBpcyBwcmVzZW50IHNvIHRoYXQgdGVzdCBydW5uZXJzIHRoYXQgc3R1YiBpdFxuLy8gZG9uJ3QgYnJlYWsgdGhpbmdzLiAgQnV0IHdlIG5lZWQgdG8gd3JhcCBpdCBpbiBhIHRyeSBjYXRjaCBpbiBjYXNlIGl0IGlzXG4vLyB3cmFwcGVkIGluIHN0cmljdCBtb2RlIGNvZGUgd2hpY2ggZG9lc24ndCBkZWZpbmUgYW55IGdsb2JhbHMuICBJdCdzIGluc2lkZSBhXG4vLyBmdW5jdGlvbiBiZWNhdXNlIHRyeS9jYXRjaGVzIGRlb3B0aW1pemUgaW4gY2VydGFpbiBlbmdpbmVzLlxuXG52YXIgY2FjaGVkU2V0VGltZW91dDtcbnZhciBjYWNoZWRDbGVhclRpbWVvdXQ7XG5cbmZ1bmN0aW9uIGRlZmF1bHRTZXRUaW1vdXQoKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdzZXRUaW1lb3V0IGhhcyBub3QgYmVlbiBkZWZpbmVkJyk7XG59XG5mdW5jdGlvbiBkZWZhdWx0Q2xlYXJUaW1lb3V0ICgpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ2NsZWFyVGltZW91dCBoYXMgbm90IGJlZW4gZGVmaW5lZCcpO1xufVxuKGZ1bmN0aW9uICgpIHtcbiAgICB0cnkge1xuICAgICAgICBpZiAodHlwZW9mIHNldFRpbWVvdXQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBzZXRUaW1lb3V0O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IGRlZmF1bHRTZXRUaW1vdXQ7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBkZWZhdWx0U2V0VGltb3V0O1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgICBpZiAodHlwZW9mIGNsZWFyVGltZW91dCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gY2xlYXJUaW1lb3V0O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gZGVmYXVsdENsZWFyVGltZW91dDtcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gZGVmYXVsdENsZWFyVGltZW91dDtcbiAgICB9XG59ICgpKVxuZnVuY3Rpb24gcnVuVGltZW91dChmdW4pIHtcbiAgICBpZiAoY2FjaGVkU2V0VGltZW91dCA9PT0gc2V0VGltZW91dCkge1xuICAgICAgICAvL25vcm1hbCBlbnZpcm9tZW50cyBpbiBzYW5lIHNpdHVhdGlvbnNcbiAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuLCAwKTtcbiAgICB9XG4gICAgLy8gaWYgc2V0VGltZW91dCB3YXNuJ3QgYXZhaWxhYmxlIGJ1dCB3YXMgbGF0dGVyIGRlZmluZWRcbiAgICBpZiAoKGNhY2hlZFNldFRpbWVvdXQgPT09IGRlZmF1bHRTZXRUaW1vdXQgfHwgIWNhY2hlZFNldFRpbWVvdXQpICYmIHNldFRpbWVvdXQpIHtcbiAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IHNldFRpbWVvdXQ7XG4gICAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1biwgMCk7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIC8vIHdoZW4gd2hlbiBzb21lYm9keSBoYXMgc2NyZXdlZCB3aXRoIHNldFRpbWVvdXQgYnV0IG5vIEkuRS4gbWFkZG5lc3NcbiAgICAgICAgcmV0dXJuIGNhY2hlZFNldFRpbWVvdXQoZnVuLCAwKTtcbiAgICB9IGNhdGNoKGUpe1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gV2hlbiB3ZSBhcmUgaW4gSS5FLiBidXQgdGhlIHNjcmlwdCBoYXMgYmVlbiBldmFsZWQgc28gSS5FLiBkb2Vzbid0IHRydXN0IHRoZSBnbG9iYWwgb2JqZWN0IHdoZW4gY2FsbGVkIG5vcm1hbGx5XG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkU2V0VGltZW91dC5jYWxsKG51bGwsIGZ1biwgMCk7XG4gICAgICAgIH0gY2F0Y2goZSl7XG4gICAgICAgICAgICAvLyBzYW1lIGFzIGFib3ZlIGJ1dCB3aGVuIGl0J3MgYSB2ZXJzaW9uIG9mIEkuRS4gdGhhdCBtdXN0IGhhdmUgdGhlIGdsb2JhbCBvYmplY3QgZm9yICd0aGlzJywgaG9wZnVsbHkgb3VyIGNvbnRleHQgY29ycmVjdCBvdGhlcndpc2UgaXQgd2lsbCB0aHJvdyBhIGdsb2JhbCBlcnJvclxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZFNldFRpbWVvdXQuY2FsbCh0aGlzLCBmdW4sIDApO1xuICAgICAgICB9XG4gICAgfVxuXG5cbn1cbmZ1bmN0aW9uIHJ1bkNsZWFyVGltZW91dChtYXJrZXIpIHtcbiAgICBpZiAoY2FjaGVkQ2xlYXJUaW1lb3V0ID09PSBjbGVhclRpbWVvdXQpIHtcbiAgICAgICAgLy9ub3JtYWwgZW52aXJvbWVudHMgaW4gc2FuZSBzaXR1YXRpb25zXG4gICAgICAgIHJldHVybiBjbGVhclRpbWVvdXQobWFya2VyKTtcbiAgICB9XG4gICAgLy8gaWYgY2xlYXJUaW1lb3V0IHdhc24ndCBhdmFpbGFibGUgYnV0IHdhcyBsYXR0ZXIgZGVmaW5lZFxuICAgIGlmICgoY2FjaGVkQ2xlYXJUaW1lb3V0ID09PSBkZWZhdWx0Q2xlYXJUaW1lb3V0IHx8ICFjYWNoZWRDbGVhclRpbWVvdXQpICYmIGNsZWFyVGltZW91dCkge1xuICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBjbGVhclRpbWVvdXQ7XG4gICAgICAgIHJldHVybiBjbGVhclRpbWVvdXQobWFya2VyKTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgLy8gd2hlbiB3aGVuIHNvbWVib2R5IGhhcyBzY3Jld2VkIHdpdGggc2V0VGltZW91dCBidXQgbm8gSS5FLiBtYWRkbmVzc1xuICAgICAgICByZXR1cm4gY2FjaGVkQ2xlYXJUaW1lb3V0KG1hcmtlcik7XG4gICAgfSBjYXRjaCAoZSl7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBXaGVuIHdlIGFyZSBpbiBJLkUuIGJ1dCB0aGUgc2NyaXB0IGhhcyBiZWVuIGV2YWxlZCBzbyBJLkUuIGRvZXNuJ3QgIHRydXN0IHRoZSBnbG9iYWwgb2JqZWN0IHdoZW4gY2FsbGVkIG5vcm1hbGx5XG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkQ2xlYXJUaW1lb3V0LmNhbGwobnVsbCwgbWFya2VyKTtcbiAgICAgICAgfSBjYXRjaCAoZSl7XG4gICAgICAgICAgICAvLyBzYW1lIGFzIGFib3ZlIGJ1dCB3aGVuIGl0J3MgYSB2ZXJzaW9uIG9mIEkuRS4gdGhhdCBtdXN0IGhhdmUgdGhlIGdsb2JhbCBvYmplY3QgZm9yICd0aGlzJywgaG9wZnVsbHkgb3VyIGNvbnRleHQgY29ycmVjdCBvdGhlcndpc2UgaXQgd2lsbCB0aHJvdyBhIGdsb2JhbCBlcnJvci5cbiAgICAgICAgICAgIC8vIFNvbWUgdmVyc2lvbnMgb2YgSS5FLiBoYXZlIGRpZmZlcmVudCBydWxlcyBmb3IgY2xlYXJUaW1lb3V0IHZzIHNldFRpbWVvdXRcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRDbGVhclRpbWVvdXQuY2FsbCh0aGlzLCBtYXJrZXIpO1xuICAgICAgICB9XG4gICAgfVxuXG5cblxufVxudmFyIHF1ZXVlID0gW107XG52YXIgZHJhaW5pbmcgPSBmYWxzZTtcbnZhciBjdXJyZW50UXVldWU7XG52YXIgcXVldWVJbmRleCA9IC0xO1xuXG5mdW5jdGlvbiBjbGVhblVwTmV4dFRpY2soKSB7XG4gICAgaWYgKCFkcmFpbmluZyB8fCAhY3VycmVudFF1ZXVlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZHJhaW5pbmcgPSBmYWxzZTtcbiAgICBpZiAoY3VycmVudFF1ZXVlLmxlbmd0aCkge1xuICAgICAgICBxdWV1ZSA9IGN1cnJlbnRRdWV1ZS5jb25jYXQocXVldWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHF1ZXVlSW5kZXggPSAtMTtcbiAgICB9XG4gICAgaWYgKHF1ZXVlLmxlbmd0aCkge1xuICAgICAgICBkcmFpblF1ZXVlKCk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBkcmFpblF1ZXVlKCkge1xuICAgIGlmIChkcmFpbmluZykge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciB0aW1lb3V0ID0gcnVuVGltZW91dChjbGVhblVwTmV4dFRpY2spO1xuICAgIGRyYWluaW5nID0gdHJ1ZTtcblxuICAgIHZhciBsZW4gPSBxdWV1ZS5sZW5ndGg7XG4gICAgd2hpbGUobGVuKSB7XG4gICAgICAgIGN1cnJlbnRRdWV1ZSA9IHF1ZXVlO1xuICAgICAgICBxdWV1ZSA9IFtdO1xuICAgICAgICB3aGlsZSAoKytxdWV1ZUluZGV4IDwgbGVuKSB7XG4gICAgICAgICAgICBpZiAoY3VycmVudFF1ZXVlKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudFF1ZXVlW3F1ZXVlSW5kZXhdLnJ1bigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHF1ZXVlSW5kZXggPSAtMTtcbiAgICAgICAgbGVuID0gcXVldWUubGVuZ3RoO1xuICAgIH1cbiAgICBjdXJyZW50UXVldWUgPSBudWxsO1xuICAgIGRyYWluaW5nID0gZmFsc2U7XG4gICAgcnVuQ2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xufVxuXG5wcm9jZXNzLm5leHRUaWNrID0gZnVuY3Rpb24gKGZ1bikge1xuICAgIHZhciBhcmdzID0gbmV3IEFycmF5KGFyZ3VtZW50cy5sZW5ndGggLSAxKTtcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGFyZ3NbaSAtIDFdID0gYXJndW1lbnRzW2ldO1xuICAgICAgICB9XG4gICAgfVxuICAgIHF1ZXVlLnB1c2gobmV3IEl0ZW0oZnVuLCBhcmdzKSk7XG4gICAgaWYgKHF1ZXVlLmxlbmd0aCA9PT0gMSAmJiAhZHJhaW5pbmcpIHtcbiAgICAgICAgcnVuVGltZW91dChkcmFpblF1ZXVlKTtcbiAgICB9XG59O1xuXG4vLyB2OCBsaWtlcyBwcmVkaWN0aWJsZSBvYmplY3RzXG5mdW5jdGlvbiBJdGVtKGZ1biwgYXJyYXkpIHtcbiAgICB0aGlzLmZ1biA9IGZ1bjtcbiAgICB0aGlzLmFycmF5ID0gYXJyYXk7XG59XG5JdGVtLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5mdW4uYXBwbHkobnVsbCwgdGhpcy5hcnJheSk7XG59O1xucHJvY2Vzcy50aXRsZSA9ICdicm93c2VyJztcbnByb2Nlc3MuYnJvd3NlciA9IHRydWU7XG5wcm9jZXNzLmVudiA9IHt9O1xucHJvY2Vzcy5hcmd2ID0gW107XG5wcm9jZXNzLnZlcnNpb24gPSAnJzsgLy8gZW1wdHkgc3RyaW5nIHRvIGF2b2lkIHJlZ2V4cCBpc3N1ZXNcbnByb2Nlc3MudmVyc2lvbnMgPSB7fTtcblxuZnVuY3Rpb24gbm9vcCgpIHt9XG5cbnByb2Nlc3Mub24gPSBub29wO1xucHJvY2Vzcy5hZGRMaXN0ZW5lciA9IG5vb3A7XG5wcm9jZXNzLm9uY2UgPSBub29wO1xucHJvY2Vzcy5vZmYgPSBub29wO1xucHJvY2Vzcy5yZW1vdmVMaXN0ZW5lciA9IG5vb3A7XG5wcm9jZXNzLnJlbW92ZUFsbExpc3RlbmVycyA9IG5vb3A7XG5wcm9jZXNzLmVtaXQgPSBub29wO1xuXG5wcm9jZXNzLmJpbmRpbmcgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgIHRocm93IG5ldyBFcnJvcigncHJvY2Vzcy5iaW5kaW5nIGlzIG5vdCBzdXBwb3J0ZWQnKTtcbn07XG5cbnByb2Nlc3MuY3dkID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gJy8nIH07XG5wcm9jZXNzLmNoZGlyID0gZnVuY3Rpb24gKGRpcikge1xuICAgIHRocm93IG5ldyBFcnJvcigncHJvY2Vzcy5jaGRpciBpcyBub3Qgc3VwcG9ydGVkJyk7XG59O1xucHJvY2Vzcy51bWFzayA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gMDsgfTtcbiIsIi8vIENvcHlyaWdodCBKb3llbnQsIEluYy4gYW5kIG90aGVyIE5vZGUgY29udHJpYnV0b3JzLlxuLy9cbi8vIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhXG4vLyBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlXG4vLyBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmdcbi8vIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCxcbi8vIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXRcbi8vIHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZVxuLy8gZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4vL1xuLy8gVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWRcbi8vIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuLy9cbi8vIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1Ncbi8vIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0Zcbi8vIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU5cbi8vIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLFxuLy8gREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SXG4vLyBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFXG4vLyBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLlxuXG4ndXNlIHN0cmljdCc7XG5cbi8vIElmIG9iai5oYXNPd25Qcm9wZXJ0eSBoYXMgYmVlbiBvdmVycmlkZGVuLCB0aGVuIGNhbGxpbmdcbi8vIG9iai5oYXNPd25Qcm9wZXJ0eShwcm9wKSB3aWxsIGJyZWFrLlxuLy8gU2VlOiBodHRwczovL2dpdGh1Yi5jb20vam95ZW50L25vZGUvaXNzdWVzLzE3MDdcbmZ1bmN0aW9uIGhhc093blByb3BlcnR5KG9iaiwgcHJvcCkge1xuICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ocXMsIHNlcCwgZXEsIG9wdGlvbnMpIHtcbiAgc2VwID0gc2VwIHx8ICcmJztcbiAgZXEgPSBlcSB8fCAnPSc7XG4gIHZhciBvYmogPSB7fTtcblxuICBpZiAodHlwZW9mIHFzICE9PSAnc3RyaW5nJyB8fCBxcy5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gb2JqO1xuICB9XG5cbiAgdmFyIHJlZ2V4cCA9IC9cXCsvZztcbiAgcXMgPSBxcy5zcGxpdChzZXApO1xuXG4gIHZhciBtYXhLZXlzID0gMTAwMDtcbiAgaWYgKG9wdGlvbnMgJiYgdHlwZW9mIG9wdGlvbnMubWF4S2V5cyA9PT0gJ251bWJlcicpIHtcbiAgICBtYXhLZXlzID0gb3B0aW9ucy5tYXhLZXlzO1xuICB9XG5cbiAgdmFyIGxlbiA9IHFzLmxlbmd0aDtcbiAgLy8gbWF4S2V5cyA8PSAwIG1lYW5zIHRoYXQgd2Ugc2hvdWxkIG5vdCBsaW1pdCBrZXlzIGNvdW50XG4gIGlmIChtYXhLZXlzID4gMCAmJiBsZW4gPiBtYXhLZXlzKSB7XG4gICAgbGVuID0gbWF4S2V5cztcbiAgfVxuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyArK2kpIHtcbiAgICB2YXIgeCA9IHFzW2ldLnJlcGxhY2UocmVnZXhwLCAnJTIwJyksXG4gICAgICAgIGlkeCA9IHguaW5kZXhPZihlcSksXG4gICAgICAgIGtzdHIsIHZzdHIsIGssIHY7XG5cbiAgICBpZiAoaWR4ID49IDApIHtcbiAgICAgIGtzdHIgPSB4LnN1YnN0cigwLCBpZHgpO1xuICAgICAgdnN0ciA9IHguc3Vic3RyKGlkeCArIDEpO1xuICAgIH0gZWxzZSB7XG4gICAgICBrc3RyID0geDtcbiAgICAgIHZzdHIgPSAnJztcbiAgICB9XG5cbiAgICBrID0gZGVjb2RlVVJJQ29tcG9uZW50KGtzdHIpO1xuICAgIHYgPSBkZWNvZGVVUklDb21wb25lbnQodnN0cik7XG5cbiAgICBpZiAoIWhhc093blByb3BlcnR5KG9iaiwgaykpIHtcbiAgICAgIG9ialtrXSA9IHY7XG4gICAgfSBlbHNlIGlmIChpc0FycmF5KG9ialtrXSkpIHtcbiAgICAgIG9ialtrXS5wdXNoKHYpO1xuICAgIH0gZWxzZSB7XG4gICAgICBvYmpba10gPSBbb2JqW2tdLCB2XTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gb2JqO1xufTtcblxudmFyIGlzQXJyYXkgPSBBcnJheS5pc0FycmF5IHx8IGZ1bmN0aW9uICh4cykge1xuICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHhzKSA9PT0gJ1tvYmplY3QgQXJyYXldJztcbn07XG4iLCIvLyBDb3B5cmlnaHQgSm95ZW50LCBJbmMuIGFuZCBvdGhlciBOb2RlIGNvbnRyaWJ1dG9ycy5cbi8vXG4vLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYVxuLy8gY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZVxuLy8gXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nXG4vLyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsXG4vLyBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0XG4vLyBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGVcbi8vIGZvbGxvd2luZyBjb25kaXRpb25zOlxuLy9cbi8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkXG4vLyBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbi8vXG4vLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTXG4vLyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GXG4vLyBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOXG4vLyBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSxcbi8vIERBTUFHRVMgT1IgT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUlxuLy8gT1RIRVJXSVNFLCBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRVxuLy8gVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS5cblxuJ3VzZSBzdHJpY3QnO1xuXG52YXIgc3RyaW5naWZ5UHJpbWl0aXZlID0gZnVuY3Rpb24odikge1xuICBzd2l0Y2ggKHR5cGVvZiB2KSB7XG4gICAgY2FzZSAnc3RyaW5nJzpcbiAgICAgIHJldHVybiB2O1xuXG4gICAgY2FzZSAnYm9vbGVhbic6XG4gICAgICByZXR1cm4gdiA/ICd0cnVlJyA6ICdmYWxzZSc7XG5cbiAgICBjYXNlICdudW1iZXInOlxuICAgICAgcmV0dXJuIGlzRmluaXRlKHYpID8gdiA6ICcnO1xuXG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiAnJztcbiAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihvYmosIHNlcCwgZXEsIG5hbWUpIHtcbiAgc2VwID0gc2VwIHx8ICcmJztcbiAgZXEgPSBlcSB8fCAnPSc7XG4gIGlmIChvYmogPT09IG51bGwpIHtcbiAgICBvYmogPSB1bmRlZmluZWQ7XG4gIH1cblxuICBpZiAodHlwZW9mIG9iaiA9PT0gJ29iamVjdCcpIHtcbiAgICByZXR1cm4gbWFwKG9iamVjdEtleXMob2JqKSwgZnVuY3Rpb24oaykge1xuICAgICAgdmFyIGtzID0gZW5jb2RlVVJJQ29tcG9uZW50KHN0cmluZ2lmeVByaW1pdGl2ZShrKSkgKyBlcTtcbiAgICAgIGlmIChpc0FycmF5KG9ialtrXSkpIHtcbiAgICAgICAgcmV0dXJuIG1hcChvYmpba10sIGZ1bmN0aW9uKHYpIHtcbiAgICAgICAgICByZXR1cm4ga3MgKyBlbmNvZGVVUklDb21wb25lbnQoc3RyaW5naWZ5UHJpbWl0aXZlKHYpKTtcbiAgICAgICAgfSkuam9pbihzZXApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGtzICsgZW5jb2RlVVJJQ29tcG9uZW50KHN0cmluZ2lmeVByaW1pdGl2ZShvYmpba10pKTtcbiAgICAgIH1cbiAgICB9KS5qb2luKHNlcCk7XG5cbiAgfVxuXG4gIGlmICghbmFtZSkgcmV0dXJuICcnO1xuICByZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KHN0cmluZ2lmeVByaW1pdGl2ZShuYW1lKSkgKyBlcSArXG4gICAgICAgICBlbmNvZGVVUklDb21wb25lbnQoc3RyaW5naWZ5UHJpbWl0aXZlKG9iaikpO1xufTtcblxudmFyIGlzQXJyYXkgPSBBcnJheS5pc0FycmF5IHx8IGZ1bmN0aW9uICh4cykge1xuICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHhzKSA9PT0gJ1tvYmplY3QgQXJyYXldJztcbn07XG5cbmZ1bmN0aW9uIG1hcCAoeHMsIGYpIHtcbiAgaWYgKHhzLm1hcCkgcmV0dXJuIHhzLm1hcChmKTtcbiAgdmFyIHJlcyA9IFtdO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IHhzLmxlbmd0aDsgaSsrKSB7XG4gICAgcmVzLnB1c2goZih4c1tpXSwgaSkpO1xuICB9XG4gIHJldHVybiByZXM7XG59XG5cbnZhciBvYmplY3RLZXlzID0gT2JqZWN0LmtleXMgfHwgZnVuY3Rpb24gKG9iaikge1xuICB2YXIgcmVzID0gW107XG4gIGZvciAodmFyIGtleSBpbiBvYmopIHtcbiAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgcmVzLnB1c2goa2V5KTtcbiAgfVxuICByZXR1cm4gcmVzO1xufTtcbiIsIid1c2Ugc3RyaWN0JztcblxuZXhwb3J0cy5kZWNvZGUgPSBleHBvcnRzLnBhcnNlID0gcmVxdWlyZSgnLi9kZWNvZGUnKTtcbmV4cG9ydHMuZW5jb2RlID0gZXhwb3J0cy5zdHJpbmdpZnkgPSByZXF1aXJlKCcuL2VuY29kZScpO1xuIiwiaWYgKHR5cGVvZiBPYmplY3QuY3JlYXRlID09PSAnZnVuY3Rpb24nKSB7XG4gIC8vIGltcGxlbWVudGF0aW9uIGZyb20gc3RhbmRhcmQgbm9kZS5qcyAndXRpbCcgbW9kdWxlXG4gIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gaW5oZXJpdHMoY3Rvciwgc3VwZXJDdG9yKSB7XG4gICAgY3Rvci5zdXBlcl8gPSBzdXBlckN0b3JcbiAgICBjdG9yLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDdG9yLnByb3RvdHlwZSwge1xuICAgICAgY29uc3RydWN0b3I6IHtcbiAgICAgICAgdmFsdWU6IGN0b3IsXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9XG4gICAgfSk7XG4gIH07XG59IGVsc2Uge1xuICAvLyBvbGQgc2Nob29sIHNoaW0gZm9yIG9sZCBicm93c2Vyc1xuICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGluaGVyaXRzKGN0b3IsIHN1cGVyQ3Rvcikge1xuICAgIGN0b3Iuc3VwZXJfID0gc3VwZXJDdG9yXG4gICAgdmFyIFRlbXBDdG9yID0gZnVuY3Rpb24gKCkge31cbiAgICBUZW1wQ3Rvci5wcm90b3R5cGUgPSBzdXBlckN0b3IucHJvdG90eXBlXG4gICAgY3Rvci5wcm90b3R5cGUgPSBuZXcgVGVtcEN0b3IoKVxuICAgIGN0b3IucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gY3RvclxuICB9XG59XG4iLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGlzQnVmZmVyKGFyZykge1xuICByZXR1cm4gYXJnICYmIHR5cGVvZiBhcmcgPT09ICdvYmplY3QnXG4gICAgJiYgdHlwZW9mIGFyZy5jb3B5ID09PSAnZnVuY3Rpb24nXG4gICAgJiYgdHlwZW9mIGFyZy5maWxsID09PSAnZnVuY3Rpb24nXG4gICAgJiYgdHlwZW9mIGFyZy5yZWFkVUludDggPT09ICdmdW5jdGlvbic7XG59IiwiLy8gQ29weXJpZ2h0IEpveWVudCwgSW5jLiBhbmQgb3RoZXIgTm9kZSBjb250cmlidXRvcnMuXG4vL1xuLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGFcbi8vIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGVcbi8vIFwiU29mdHdhcmVcIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZ1xuLy8gd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLFxuLy8gZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdFxuLy8gcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlXG4vLyBmb2xsb3dpbmcgY29uZGl0aW9uczpcbi8vXG4vLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZFxuLy8gaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4vL1xuLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTU1xuLy8gT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRlxuLy8gTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTlxuLy8gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sXG4vLyBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1Jcbi8vIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEVcbi8vIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuXG5cbnZhciBmb3JtYXRSZWdFeHAgPSAvJVtzZGolXS9nO1xuZXhwb3J0cy5mb3JtYXQgPSBmdW5jdGlvbihmKSB7XG4gIGlmICghaXNTdHJpbmcoZikpIHtcbiAgICB2YXIgb2JqZWN0cyA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBvYmplY3RzLnB1c2goaW5zcGVjdChhcmd1bWVudHNbaV0pKTtcbiAgICB9XG4gICAgcmV0dXJuIG9iamVjdHMuam9pbignICcpO1xuICB9XG5cbiAgdmFyIGkgPSAxO1xuICB2YXIgYXJncyA9IGFyZ3VtZW50cztcbiAgdmFyIGxlbiA9IGFyZ3MubGVuZ3RoO1xuICB2YXIgc3RyID0gU3RyaW5nKGYpLnJlcGxhY2UoZm9ybWF0UmVnRXhwLCBmdW5jdGlvbih4KSB7XG4gICAgaWYgKHggPT09ICclJScpIHJldHVybiAnJSc7XG4gICAgaWYgKGkgPj0gbGVuKSByZXR1cm4geDtcbiAgICBzd2l0Y2ggKHgpIHtcbiAgICAgIGNhc2UgJyVzJzogcmV0dXJuIFN0cmluZyhhcmdzW2krK10pO1xuICAgICAgY2FzZSAnJWQnOiByZXR1cm4gTnVtYmVyKGFyZ3NbaSsrXSk7XG4gICAgICBjYXNlICclaic6XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KGFyZ3NbaSsrXSk7XG4gICAgICAgIH0gY2F0Y2ggKF8pIHtcbiAgICAgICAgICByZXR1cm4gJ1tDaXJjdWxhcl0nO1xuICAgICAgICB9XG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4geDtcbiAgICB9XG4gIH0pO1xuICBmb3IgKHZhciB4ID0gYXJnc1tpXTsgaSA8IGxlbjsgeCA9IGFyZ3NbKytpXSkge1xuICAgIGlmIChpc051bGwoeCkgfHwgIWlzT2JqZWN0KHgpKSB7XG4gICAgICBzdHIgKz0gJyAnICsgeDtcbiAgICB9IGVsc2Uge1xuICAgICAgc3RyICs9ICcgJyArIGluc3BlY3QoeCk7XG4gICAgfVxuICB9XG4gIHJldHVybiBzdHI7XG59O1xuXG5cbi8vIE1hcmsgdGhhdCBhIG1ldGhvZCBzaG91bGQgbm90IGJlIHVzZWQuXG4vLyBSZXR1cm5zIGEgbW9kaWZpZWQgZnVuY3Rpb24gd2hpY2ggd2FybnMgb25jZSBieSBkZWZhdWx0LlxuLy8gSWYgLS1uby1kZXByZWNhdGlvbiBpcyBzZXQsIHRoZW4gaXQgaXMgYSBuby1vcC5cbmV4cG9ydHMuZGVwcmVjYXRlID0gZnVuY3Rpb24oZm4sIG1zZykge1xuICAvLyBBbGxvdyBmb3IgZGVwcmVjYXRpbmcgdGhpbmdzIGluIHRoZSBwcm9jZXNzIG9mIHN0YXJ0aW5nIHVwLlxuICBpZiAoaXNVbmRlZmluZWQoZ2xvYmFsLnByb2Nlc3MpKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGV4cG9ydHMuZGVwcmVjYXRlKGZuLCBtc2cpLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfTtcbiAgfVxuXG4gIGlmIChwcm9jZXNzLm5vRGVwcmVjYXRpb24gPT09IHRydWUpIHtcbiAgICByZXR1cm4gZm47XG4gIH1cblxuICB2YXIgd2FybmVkID0gZmFsc2U7XG4gIGZ1bmN0aW9uIGRlcHJlY2F0ZWQoKSB7XG4gICAgaWYgKCF3YXJuZWQpIHtcbiAgICAgIGlmIChwcm9jZXNzLnRocm93RGVwcmVjYXRpb24pIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKG1zZyk7XG4gICAgICB9IGVsc2UgaWYgKHByb2Nlc3MudHJhY2VEZXByZWNhdGlvbikge1xuICAgICAgICBjb25zb2xlLnRyYWNlKG1zZyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLmVycm9yKG1zZyk7XG4gICAgICB9XG4gICAgICB3YXJuZWQgPSB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfVxuXG4gIHJldHVybiBkZXByZWNhdGVkO1xufTtcblxuXG52YXIgZGVidWdzID0ge307XG52YXIgZGVidWdFbnZpcm9uO1xuZXhwb3J0cy5kZWJ1Z2xvZyA9IGZ1bmN0aW9uKHNldCkge1xuICBpZiAoaXNVbmRlZmluZWQoZGVidWdFbnZpcm9uKSlcbiAgICBkZWJ1Z0Vudmlyb24gPSBwcm9jZXNzLmVudi5OT0RFX0RFQlVHIHx8ICcnO1xuICBzZXQgPSBzZXQudG9VcHBlckNhc2UoKTtcbiAgaWYgKCFkZWJ1Z3Nbc2V0XSkge1xuICAgIGlmIChuZXcgUmVnRXhwKCdcXFxcYicgKyBzZXQgKyAnXFxcXGInLCAnaScpLnRlc3QoZGVidWdFbnZpcm9uKSkge1xuICAgICAgdmFyIHBpZCA9IHByb2Nlc3MucGlkO1xuICAgICAgZGVidWdzW3NldF0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIG1zZyA9IGV4cG9ydHMuZm9ybWF0LmFwcGx5KGV4cG9ydHMsIGFyZ3VtZW50cyk7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJyVzICVkOiAlcycsIHNldCwgcGlkLCBtc2cpO1xuICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgZGVidWdzW3NldF0gPSBmdW5jdGlvbigpIHt9O1xuICAgIH1cbiAgfVxuICByZXR1cm4gZGVidWdzW3NldF07XG59O1xuXG5cbi8qKlxuICogRWNob3MgdGhlIHZhbHVlIG9mIGEgdmFsdWUuIFRyeXMgdG8gcHJpbnQgdGhlIHZhbHVlIG91dFxuICogaW4gdGhlIGJlc3Qgd2F5IHBvc3NpYmxlIGdpdmVuIHRoZSBkaWZmZXJlbnQgdHlwZXMuXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IG9iaiBUaGUgb2JqZWN0IHRvIHByaW50IG91dC5cbiAqIEBwYXJhbSB7T2JqZWN0fSBvcHRzIE9wdGlvbmFsIG9wdGlvbnMgb2JqZWN0IHRoYXQgYWx0ZXJzIHRoZSBvdXRwdXQuXG4gKi9cbi8qIGxlZ2FjeTogb2JqLCBzaG93SGlkZGVuLCBkZXB0aCwgY29sb3JzKi9cbmZ1bmN0aW9uIGluc3BlY3Qob2JqLCBvcHRzKSB7XG4gIC8vIGRlZmF1bHQgb3B0aW9uc1xuICB2YXIgY3R4ID0ge1xuICAgIHNlZW46IFtdLFxuICAgIHN0eWxpemU6IHN0eWxpemVOb0NvbG9yXG4gIH07XG4gIC8vIGxlZ2FjeS4uLlxuICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+PSAzKSBjdHguZGVwdGggPSBhcmd1bWVudHNbMl07XG4gIGlmIChhcmd1bWVudHMubGVuZ3RoID49IDQpIGN0eC5jb2xvcnMgPSBhcmd1bWVudHNbM107XG4gIGlmIChpc0Jvb2xlYW4ob3B0cykpIHtcbiAgICAvLyBsZWdhY3kuLi5cbiAgICBjdHguc2hvd0hpZGRlbiA9IG9wdHM7XG4gIH0gZWxzZSBpZiAob3B0cykge1xuICAgIC8vIGdvdCBhbiBcIm9wdGlvbnNcIiBvYmplY3RcbiAgICBleHBvcnRzLl9leHRlbmQoY3R4LCBvcHRzKTtcbiAgfVxuICAvLyBzZXQgZGVmYXVsdCBvcHRpb25zXG4gIGlmIChpc1VuZGVmaW5lZChjdHguc2hvd0hpZGRlbikpIGN0eC5zaG93SGlkZGVuID0gZmFsc2U7XG4gIGlmIChpc1VuZGVmaW5lZChjdHguZGVwdGgpKSBjdHguZGVwdGggPSAyO1xuICBpZiAoaXNVbmRlZmluZWQoY3R4LmNvbG9ycykpIGN0eC5jb2xvcnMgPSBmYWxzZTtcbiAgaWYgKGlzVW5kZWZpbmVkKGN0eC5jdXN0b21JbnNwZWN0KSkgY3R4LmN1c3RvbUluc3BlY3QgPSB0cnVlO1xuICBpZiAoY3R4LmNvbG9ycykgY3R4LnN0eWxpemUgPSBzdHlsaXplV2l0aENvbG9yO1xuICByZXR1cm4gZm9ybWF0VmFsdWUoY3R4LCBvYmosIGN0eC5kZXB0aCk7XG59XG5leHBvcnRzLmluc3BlY3QgPSBpbnNwZWN0O1xuXG5cbi8vIGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQU5TSV9lc2NhcGVfY29kZSNncmFwaGljc1xuaW5zcGVjdC5jb2xvcnMgPSB7XG4gICdib2xkJyA6IFsxLCAyMl0sXG4gICdpdGFsaWMnIDogWzMsIDIzXSxcbiAgJ3VuZGVybGluZScgOiBbNCwgMjRdLFxuICAnaW52ZXJzZScgOiBbNywgMjddLFxuICAnd2hpdGUnIDogWzM3LCAzOV0sXG4gICdncmV5JyA6IFs5MCwgMzldLFxuICAnYmxhY2snIDogWzMwLCAzOV0sXG4gICdibHVlJyA6IFszNCwgMzldLFxuICAnY3lhbicgOiBbMzYsIDM5XSxcbiAgJ2dyZWVuJyA6IFszMiwgMzldLFxuICAnbWFnZW50YScgOiBbMzUsIDM5XSxcbiAgJ3JlZCcgOiBbMzEsIDM5XSxcbiAgJ3llbGxvdycgOiBbMzMsIDM5XVxufTtcblxuLy8gRG9uJ3QgdXNlICdibHVlJyBub3QgdmlzaWJsZSBvbiBjbWQuZXhlXG5pbnNwZWN0LnN0eWxlcyA9IHtcbiAgJ3NwZWNpYWwnOiAnY3lhbicsXG4gICdudW1iZXInOiAneWVsbG93JyxcbiAgJ2Jvb2xlYW4nOiAneWVsbG93JyxcbiAgJ3VuZGVmaW5lZCc6ICdncmV5JyxcbiAgJ251bGwnOiAnYm9sZCcsXG4gICdzdHJpbmcnOiAnZ3JlZW4nLFxuICAnZGF0ZSc6ICdtYWdlbnRhJyxcbiAgLy8gXCJuYW1lXCI6IGludGVudGlvbmFsbHkgbm90IHN0eWxpbmdcbiAgJ3JlZ2V4cCc6ICdyZWQnXG59O1xuXG5cbmZ1bmN0aW9uIHN0eWxpemVXaXRoQ29sb3Ioc3RyLCBzdHlsZVR5cGUpIHtcbiAgdmFyIHN0eWxlID0gaW5zcGVjdC5zdHlsZXNbc3R5bGVUeXBlXTtcblxuICBpZiAoc3R5bGUpIHtcbiAgICByZXR1cm4gJ1xcdTAwMWJbJyArIGluc3BlY3QuY29sb3JzW3N0eWxlXVswXSArICdtJyArIHN0ciArXG4gICAgICAgICAgICdcXHUwMDFiWycgKyBpbnNwZWN0LmNvbG9yc1tzdHlsZV1bMV0gKyAnbSc7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHN0cjtcbiAgfVxufVxuXG5cbmZ1bmN0aW9uIHN0eWxpemVOb0NvbG9yKHN0ciwgc3R5bGVUeXBlKSB7XG4gIHJldHVybiBzdHI7XG59XG5cblxuZnVuY3Rpb24gYXJyYXlUb0hhc2goYXJyYXkpIHtcbiAgdmFyIGhhc2ggPSB7fTtcblxuICBhcnJheS5mb3JFYWNoKGZ1bmN0aW9uKHZhbCwgaWR4KSB7XG4gICAgaGFzaFt2YWxdID0gdHJ1ZTtcbiAgfSk7XG5cbiAgcmV0dXJuIGhhc2g7XG59XG5cblxuZnVuY3Rpb24gZm9ybWF0VmFsdWUoY3R4LCB2YWx1ZSwgcmVjdXJzZVRpbWVzKSB7XG4gIC8vIFByb3ZpZGUgYSBob29rIGZvciB1c2VyLXNwZWNpZmllZCBpbnNwZWN0IGZ1bmN0aW9ucy5cbiAgLy8gQ2hlY2sgdGhhdCB2YWx1ZSBpcyBhbiBvYmplY3Qgd2l0aCBhbiBpbnNwZWN0IGZ1bmN0aW9uIG9uIGl0XG4gIGlmIChjdHguY3VzdG9tSW5zcGVjdCAmJlxuICAgICAgdmFsdWUgJiZcbiAgICAgIGlzRnVuY3Rpb24odmFsdWUuaW5zcGVjdCkgJiZcbiAgICAgIC8vIEZpbHRlciBvdXQgdGhlIHV0aWwgbW9kdWxlLCBpdCdzIGluc3BlY3QgZnVuY3Rpb24gaXMgc3BlY2lhbFxuICAgICAgdmFsdWUuaW5zcGVjdCAhPT0gZXhwb3J0cy5pbnNwZWN0ICYmXG4gICAgICAvLyBBbHNvIGZpbHRlciBvdXQgYW55IHByb3RvdHlwZSBvYmplY3RzIHVzaW5nIHRoZSBjaXJjdWxhciBjaGVjay5cbiAgICAgICEodmFsdWUuY29uc3RydWN0b3IgJiYgdmFsdWUuY29uc3RydWN0b3IucHJvdG90eXBlID09PSB2YWx1ZSkpIHtcbiAgICB2YXIgcmV0ID0gdmFsdWUuaW5zcGVjdChyZWN1cnNlVGltZXMsIGN0eCk7XG4gICAgaWYgKCFpc1N0cmluZyhyZXQpKSB7XG4gICAgICByZXQgPSBmb3JtYXRWYWx1ZShjdHgsIHJldCwgcmVjdXJzZVRpbWVzKTtcbiAgICB9XG4gICAgcmV0dXJuIHJldDtcbiAgfVxuXG4gIC8vIFByaW1pdGl2ZSB0eXBlcyBjYW5ub3QgaGF2ZSBwcm9wZXJ0aWVzXG4gIHZhciBwcmltaXRpdmUgPSBmb3JtYXRQcmltaXRpdmUoY3R4LCB2YWx1ZSk7XG4gIGlmIChwcmltaXRpdmUpIHtcbiAgICByZXR1cm4gcHJpbWl0aXZlO1xuICB9XG5cbiAgLy8gTG9vayB1cCB0aGUga2V5cyBvZiB0aGUgb2JqZWN0LlxuICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKHZhbHVlKTtcbiAgdmFyIHZpc2libGVLZXlzID0gYXJyYXlUb0hhc2goa2V5cyk7XG5cbiAgaWYgKGN0eC5zaG93SGlkZGVuKSB7XG4gICAga2V5cyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHZhbHVlKTtcbiAgfVxuXG4gIC8vIElFIGRvZXNuJ3QgbWFrZSBlcnJvciBmaWVsZHMgbm9uLWVudW1lcmFibGVcbiAgLy8gaHR0cDovL21zZG4ubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L2llL2R3dzUyc2J0KHY9dnMuOTQpLmFzcHhcbiAgaWYgKGlzRXJyb3IodmFsdWUpXG4gICAgICAmJiAoa2V5cy5pbmRleE9mKCdtZXNzYWdlJykgPj0gMCB8fCBrZXlzLmluZGV4T2YoJ2Rlc2NyaXB0aW9uJykgPj0gMCkpIHtcbiAgICByZXR1cm4gZm9ybWF0RXJyb3IodmFsdWUpO1xuICB9XG5cbiAgLy8gU29tZSB0eXBlIG9mIG9iamVjdCB3aXRob3V0IHByb3BlcnRpZXMgY2FuIGJlIHNob3J0Y3V0dGVkLlxuICBpZiAoa2V5cy5sZW5ndGggPT09IDApIHtcbiAgICBpZiAoaXNGdW5jdGlvbih2YWx1ZSkpIHtcbiAgICAgIHZhciBuYW1lID0gdmFsdWUubmFtZSA/ICc6ICcgKyB2YWx1ZS5uYW1lIDogJyc7XG4gICAgICByZXR1cm4gY3R4LnN0eWxpemUoJ1tGdW5jdGlvbicgKyBuYW1lICsgJ10nLCAnc3BlY2lhbCcpO1xuICAgIH1cbiAgICBpZiAoaXNSZWdFeHAodmFsdWUpKSB7XG4gICAgICByZXR1cm4gY3R4LnN0eWxpemUoUmVnRXhwLnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHZhbHVlKSwgJ3JlZ2V4cCcpO1xuICAgIH1cbiAgICBpZiAoaXNEYXRlKHZhbHVlKSkge1xuICAgICAgcmV0dXJuIGN0eC5zdHlsaXplKERhdGUucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodmFsdWUpLCAnZGF0ZScpO1xuICAgIH1cbiAgICBpZiAoaXNFcnJvcih2YWx1ZSkpIHtcbiAgICAgIHJldHVybiBmb3JtYXRFcnJvcih2YWx1ZSk7XG4gICAgfVxuICB9XG5cbiAgdmFyIGJhc2UgPSAnJywgYXJyYXkgPSBmYWxzZSwgYnJhY2VzID0gWyd7JywgJ30nXTtcblxuICAvLyBNYWtlIEFycmF5IHNheSB0aGF0IHRoZXkgYXJlIEFycmF5XG4gIGlmIChpc0FycmF5KHZhbHVlKSkge1xuICAgIGFycmF5ID0gdHJ1ZTtcbiAgICBicmFjZXMgPSBbJ1snLCAnXSddO1xuICB9XG5cbiAgLy8gTWFrZSBmdW5jdGlvbnMgc2F5IHRoYXQgdGhleSBhcmUgZnVuY3Rpb25zXG4gIGlmIChpc0Z1bmN0aW9uKHZhbHVlKSkge1xuICAgIHZhciBuID0gdmFsdWUubmFtZSA/ICc6ICcgKyB2YWx1ZS5uYW1lIDogJyc7XG4gICAgYmFzZSA9ICcgW0Z1bmN0aW9uJyArIG4gKyAnXSc7XG4gIH1cblxuICAvLyBNYWtlIFJlZ0V4cHMgc2F5IHRoYXQgdGhleSBhcmUgUmVnRXhwc1xuICBpZiAoaXNSZWdFeHAodmFsdWUpKSB7XG4gICAgYmFzZSA9ICcgJyArIFJlZ0V4cC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh2YWx1ZSk7XG4gIH1cblxuICAvLyBNYWtlIGRhdGVzIHdpdGggcHJvcGVydGllcyBmaXJzdCBzYXkgdGhlIGRhdGVcbiAgaWYgKGlzRGF0ZSh2YWx1ZSkpIHtcbiAgICBiYXNlID0gJyAnICsgRGF0ZS5wcm90b3R5cGUudG9VVENTdHJpbmcuY2FsbCh2YWx1ZSk7XG4gIH1cblxuICAvLyBNYWtlIGVycm9yIHdpdGggbWVzc2FnZSBmaXJzdCBzYXkgdGhlIGVycm9yXG4gIGlmIChpc0Vycm9yKHZhbHVlKSkge1xuICAgIGJhc2UgPSAnICcgKyBmb3JtYXRFcnJvcih2YWx1ZSk7XG4gIH1cblxuICBpZiAoa2V5cy5sZW5ndGggPT09IDAgJiYgKCFhcnJheSB8fCB2YWx1ZS5sZW5ndGggPT0gMCkpIHtcbiAgICByZXR1cm4gYnJhY2VzWzBdICsgYmFzZSArIGJyYWNlc1sxXTtcbiAgfVxuXG4gIGlmIChyZWN1cnNlVGltZXMgPCAwKSB7XG4gICAgaWYgKGlzUmVnRXhwKHZhbHVlKSkge1xuICAgICAgcmV0dXJuIGN0eC5zdHlsaXplKFJlZ0V4cC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh2YWx1ZSksICdyZWdleHAnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGN0eC5zdHlsaXplKCdbT2JqZWN0XScsICdzcGVjaWFsJyk7XG4gICAgfVxuICB9XG5cbiAgY3R4LnNlZW4ucHVzaCh2YWx1ZSk7XG5cbiAgdmFyIG91dHB1dDtcbiAgaWYgKGFycmF5KSB7XG4gICAgb3V0cHV0ID0gZm9ybWF0QXJyYXkoY3R4LCB2YWx1ZSwgcmVjdXJzZVRpbWVzLCB2aXNpYmxlS2V5cywga2V5cyk7XG4gIH0gZWxzZSB7XG4gICAgb3V0cHV0ID0ga2V5cy5tYXAoZnVuY3Rpb24oa2V5KSB7XG4gICAgICByZXR1cm4gZm9ybWF0UHJvcGVydHkoY3R4LCB2YWx1ZSwgcmVjdXJzZVRpbWVzLCB2aXNpYmxlS2V5cywga2V5LCBhcnJheSk7XG4gICAgfSk7XG4gIH1cblxuICBjdHguc2Vlbi5wb3AoKTtcblxuICByZXR1cm4gcmVkdWNlVG9TaW5nbGVTdHJpbmcob3V0cHV0LCBiYXNlLCBicmFjZXMpO1xufVxuXG5cbmZ1bmN0aW9uIGZvcm1hdFByaW1pdGl2ZShjdHgsIHZhbHVlKSB7XG4gIGlmIChpc1VuZGVmaW5lZCh2YWx1ZSkpXG4gICAgcmV0dXJuIGN0eC5zdHlsaXplKCd1bmRlZmluZWQnLCAndW5kZWZpbmVkJyk7XG4gIGlmIChpc1N0cmluZyh2YWx1ZSkpIHtcbiAgICB2YXIgc2ltcGxlID0gJ1xcJycgKyBKU09OLnN0cmluZ2lmeSh2YWx1ZSkucmVwbGFjZSgvXlwifFwiJC9nLCAnJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC8nL2csIFwiXFxcXCdcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9cXFxcXCIvZywgJ1wiJykgKyAnXFwnJztcbiAgICByZXR1cm4gY3R4LnN0eWxpemUoc2ltcGxlLCAnc3RyaW5nJyk7XG4gIH1cbiAgaWYgKGlzTnVtYmVyKHZhbHVlKSlcbiAgICByZXR1cm4gY3R4LnN0eWxpemUoJycgKyB2YWx1ZSwgJ251bWJlcicpO1xuICBpZiAoaXNCb29sZWFuKHZhbHVlKSlcbiAgICByZXR1cm4gY3R4LnN0eWxpemUoJycgKyB2YWx1ZSwgJ2Jvb2xlYW4nKTtcbiAgLy8gRm9yIHNvbWUgcmVhc29uIHR5cGVvZiBudWxsIGlzIFwib2JqZWN0XCIsIHNvIHNwZWNpYWwgY2FzZSBoZXJlLlxuICBpZiAoaXNOdWxsKHZhbHVlKSlcbiAgICByZXR1cm4gY3R4LnN0eWxpemUoJ251bGwnLCAnbnVsbCcpO1xufVxuXG5cbmZ1bmN0aW9uIGZvcm1hdEVycm9yKHZhbHVlKSB7XG4gIHJldHVybiAnWycgKyBFcnJvci5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh2YWx1ZSkgKyAnXSc7XG59XG5cblxuZnVuY3Rpb24gZm9ybWF0QXJyYXkoY3R4LCB2YWx1ZSwgcmVjdXJzZVRpbWVzLCB2aXNpYmxlS2V5cywga2V5cykge1xuICB2YXIgb3V0cHV0ID0gW107XG4gIGZvciAodmFyIGkgPSAwLCBsID0gdmFsdWUubGVuZ3RoOyBpIDwgbDsgKytpKSB7XG4gICAgaWYgKGhhc093blByb3BlcnR5KHZhbHVlLCBTdHJpbmcoaSkpKSB7XG4gICAgICBvdXRwdXQucHVzaChmb3JtYXRQcm9wZXJ0eShjdHgsIHZhbHVlLCByZWN1cnNlVGltZXMsIHZpc2libGVLZXlzLFxuICAgICAgICAgIFN0cmluZyhpKSwgdHJ1ZSkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBvdXRwdXQucHVzaCgnJyk7XG4gICAgfVxuICB9XG4gIGtleXMuZm9yRWFjaChmdW5jdGlvbihrZXkpIHtcbiAgICBpZiAoIWtleS5tYXRjaCgvXlxcZCskLykpIHtcbiAgICAgIG91dHB1dC5wdXNoKGZvcm1hdFByb3BlcnR5KGN0eCwgdmFsdWUsIHJlY3Vyc2VUaW1lcywgdmlzaWJsZUtleXMsXG4gICAgICAgICAga2V5LCB0cnVlKSk7XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIG91dHB1dDtcbn1cblxuXG5mdW5jdGlvbiBmb3JtYXRQcm9wZXJ0eShjdHgsIHZhbHVlLCByZWN1cnNlVGltZXMsIHZpc2libGVLZXlzLCBrZXksIGFycmF5KSB7XG4gIHZhciBuYW1lLCBzdHIsIGRlc2M7XG4gIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHZhbHVlLCBrZXkpIHx8IHsgdmFsdWU6IHZhbHVlW2tleV0gfTtcbiAgaWYgKGRlc2MuZ2V0KSB7XG4gICAgaWYgKGRlc2Muc2V0KSB7XG4gICAgICBzdHIgPSBjdHguc3R5bGl6ZSgnW0dldHRlci9TZXR0ZXJdJywgJ3NwZWNpYWwnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc3RyID0gY3R4LnN0eWxpemUoJ1tHZXR0ZXJdJywgJ3NwZWNpYWwnKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgaWYgKGRlc2Muc2V0KSB7XG4gICAgICBzdHIgPSBjdHguc3R5bGl6ZSgnW1NldHRlcl0nLCAnc3BlY2lhbCcpO1xuICAgIH1cbiAgfVxuICBpZiAoIWhhc093blByb3BlcnR5KHZpc2libGVLZXlzLCBrZXkpKSB7XG4gICAgbmFtZSA9ICdbJyArIGtleSArICddJztcbiAgfVxuICBpZiAoIXN0cikge1xuICAgIGlmIChjdHguc2Vlbi5pbmRleE9mKGRlc2MudmFsdWUpIDwgMCkge1xuICAgICAgaWYgKGlzTnVsbChyZWN1cnNlVGltZXMpKSB7XG4gICAgICAgIHN0ciA9IGZvcm1hdFZhbHVlKGN0eCwgZGVzYy52YWx1ZSwgbnVsbCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzdHIgPSBmb3JtYXRWYWx1ZShjdHgsIGRlc2MudmFsdWUsIHJlY3Vyc2VUaW1lcyAtIDEpO1xuICAgICAgfVxuICAgICAgaWYgKHN0ci5pbmRleE9mKCdcXG4nKSA+IC0xKSB7XG4gICAgICAgIGlmIChhcnJheSkge1xuICAgICAgICAgIHN0ciA9IHN0ci5zcGxpdCgnXFxuJykubWFwKGZ1bmN0aW9uKGxpbmUpIHtcbiAgICAgICAgICAgIHJldHVybiAnICAnICsgbGluZTtcbiAgICAgICAgICB9KS5qb2luKCdcXG4nKS5zdWJzdHIoMik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc3RyID0gJ1xcbicgKyBzdHIuc3BsaXQoJ1xcbicpLm1hcChmdW5jdGlvbihsaW5lKSB7XG4gICAgICAgICAgICByZXR1cm4gJyAgICcgKyBsaW5lO1xuICAgICAgICAgIH0pLmpvaW4oJ1xcbicpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHN0ciA9IGN0eC5zdHlsaXplKCdbQ2lyY3VsYXJdJywgJ3NwZWNpYWwnKTtcbiAgICB9XG4gIH1cbiAgaWYgKGlzVW5kZWZpbmVkKG5hbWUpKSB7XG4gICAgaWYgKGFycmF5ICYmIGtleS5tYXRjaCgvXlxcZCskLykpIHtcbiAgICAgIHJldHVybiBzdHI7XG4gICAgfVxuICAgIG5hbWUgPSBKU09OLnN0cmluZ2lmeSgnJyArIGtleSk7XG4gICAgaWYgKG5hbWUubWF0Y2goL15cIihbYS16QS1aX11bYS16QS1aXzAtOV0qKVwiJC8pKSB7XG4gICAgICBuYW1lID0gbmFtZS5zdWJzdHIoMSwgbmFtZS5sZW5ndGggLSAyKTtcbiAgICAgIG5hbWUgPSBjdHguc3R5bGl6ZShuYW1lLCAnbmFtZScpO1xuICAgIH0gZWxzZSB7XG4gICAgICBuYW1lID0gbmFtZS5yZXBsYWNlKC8nL2csIFwiXFxcXCdcIilcbiAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL1xcXFxcIi9nLCAnXCInKVxuICAgICAgICAgICAgICAgICAucmVwbGFjZSgvKF5cInxcIiQpL2csIFwiJ1wiKTtcbiAgICAgIG5hbWUgPSBjdHguc3R5bGl6ZShuYW1lLCAnc3RyaW5nJyk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG5hbWUgKyAnOiAnICsgc3RyO1xufVxuXG5cbmZ1bmN0aW9uIHJlZHVjZVRvU2luZ2xlU3RyaW5nKG91dHB1dCwgYmFzZSwgYnJhY2VzKSB7XG4gIHZhciBudW1MaW5lc0VzdCA9IDA7XG4gIHZhciBsZW5ndGggPSBvdXRwdXQucmVkdWNlKGZ1bmN0aW9uKHByZXYsIGN1cikge1xuICAgIG51bUxpbmVzRXN0Kys7XG4gICAgaWYgKGN1ci5pbmRleE9mKCdcXG4nKSA+PSAwKSBudW1MaW5lc0VzdCsrO1xuICAgIHJldHVybiBwcmV2ICsgY3VyLnJlcGxhY2UoL1xcdTAwMWJcXFtcXGRcXGQ/bS9nLCAnJykubGVuZ3RoICsgMTtcbiAgfSwgMCk7XG5cbiAgaWYgKGxlbmd0aCA+IDYwKSB7XG4gICAgcmV0dXJuIGJyYWNlc1swXSArXG4gICAgICAgICAgIChiYXNlID09PSAnJyA/ICcnIDogYmFzZSArICdcXG4gJykgK1xuICAgICAgICAgICAnICcgK1xuICAgICAgICAgICBvdXRwdXQuam9pbignLFxcbiAgJykgK1xuICAgICAgICAgICAnICcgK1xuICAgICAgICAgICBicmFjZXNbMV07XG4gIH1cblxuICByZXR1cm4gYnJhY2VzWzBdICsgYmFzZSArICcgJyArIG91dHB1dC5qb2luKCcsICcpICsgJyAnICsgYnJhY2VzWzFdO1xufVxuXG5cbi8vIE5PVEU6IFRoZXNlIHR5cGUgY2hlY2tpbmcgZnVuY3Rpb25zIGludGVudGlvbmFsbHkgZG9uJ3QgdXNlIGBpbnN0YW5jZW9mYFxuLy8gYmVjYXVzZSBpdCBpcyBmcmFnaWxlIGFuZCBjYW4gYmUgZWFzaWx5IGZha2VkIHdpdGggYE9iamVjdC5jcmVhdGUoKWAuXG5mdW5jdGlvbiBpc0FycmF5KGFyKSB7XG4gIHJldHVybiBBcnJheS5pc0FycmF5KGFyKTtcbn1cbmV4cG9ydHMuaXNBcnJheSA9IGlzQXJyYXk7XG5cbmZ1bmN0aW9uIGlzQm9vbGVhbihhcmcpIHtcbiAgcmV0dXJuIHR5cGVvZiBhcmcgPT09ICdib29sZWFuJztcbn1cbmV4cG9ydHMuaXNCb29sZWFuID0gaXNCb29sZWFuO1xuXG5mdW5jdGlvbiBpc051bGwoYXJnKSB7XG4gIHJldHVybiBhcmcgPT09IG51bGw7XG59XG5leHBvcnRzLmlzTnVsbCA9IGlzTnVsbDtcblxuZnVuY3Rpb24gaXNOdWxsT3JVbmRlZmluZWQoYXJnKSB7XG4gIHJldHVybiBhcmcgPT0gbnVsbDtcbn1cbmV4cG9ydHMuaXNOdWxsT3JVbmRlZmluZWQgPSBpc051bGxPclVuZGVmaW5lZDtcblxuZnVuY3Rpb24gaXNOdW1iZXIoYXJnKSB7XG4gIHJldHVybiB0eXBlb2YgYXJnID09PSAnbnVtYmVyJztcbn1cbmV4cG9ydHMuaXNOdW1iZXIgPSBpc051bWJlcjtcblxuZnVuY3Rpb24gaXNTdHJpbmcoYXJnKSB7XG4gIHJldHVybiB0eXBlb2YgYXJnID09PSAnc3RyaW5nJztcbn1cbmV4cG9ydHMuaXNTdHJpbmcgPSBpc1N0cmluZztcblxuZnVuY3Rpb24gaXNTeW1ib2woYXJnKSB7XG4gIHJldHVybiB0eXBlb2YgYXJnID09PSAnc3ltYm9sJztcbn1cbmV4cG9ydHMuaXNTeW1ib2wgPSBpc1N5bWJvbDtcblxuZnVuY3Rpb24gaXNVbmRlZmluZWQoYXJnKSB7XG4gIHJldHVybiBhcmcgPT09IHZvaWQgMDtcbn1cbmV4cG9ydHMuaXNVbmRlZmluZWQgPSBpc1VuZGVmaW5lZDtcblxuZnVuY3Rpb24gaXNSZWdFeHAocmUpIHtcbiAgcmV0dXJuIGlzT2JqZWN0KHJlKSAmJiBvYmplY3RUb1N0cmluZyhyZSkgPT09ICdbb2JqZWN0IFJlZ0V4cF0nO1xufVxuZXhwb3J0cy5pc1JlZ0V4cCA9IGlzUmVnRXhwO1xuXG5mdW5jdGlvbiBpc09iamVjdChhcmcpIHtcbiAgcmV0dXJuIHR5cGVvZiBhcmcgPT09ICdvYmplY3QnICYmIGFyZyAhPT0gbnVsbDtcbn1cbmV4cG9ydHMuaXNPYmplY3QgPSBpc09iamVjdDtcblxuZnVuY3Rpb24gaXNEYXRlKGQpIHtcbiAgcmV0dXJuIGlzT2JqZWN0KGQpICYmIG9iamVjdFRvU3RyaW5nKGQpID09PSAnW29iamVjdCBEYXRlXSc7XG59XG5leHBvcnRzLmlzRGF0ZSA9IGlzRGF0ZTtcblxuZnVuY3Rpb24gaXNFcnJvcihlKSB7XG4gIHJldHVybiBpc09iamVjdChlKSAmJlxuICAgICAgKG9iamVjdFRvU3RyaW5nKGUpID09PSAnW29iamVjdCBFcnJvcl0nIHx8IGUgaW5zdGFuY2VvZiBFcnJvcik7XG59XG5leHBvcnRzLmlzRXJyb3IgPSBpc0Vycm9yO1xuXG5mdW5jdGlvbiBpc0Z1bmN0aW9uKGFyZykge1xuICByZXR1cm4gdHlwZW9mIGFyZyA9PT0gJ2Z1bmN0aW9uJztcbn1cbmV4cG9ydHMuaXNGdW5jdGlvbiA9IGlzRnVuY3Rpb247XG5cbmZ1bmN0aW9uIGlzUHJpbWl0aXZlKGFyZykge1xuICByZXR1cm4gYXJnID09PSBudWxsIHx8XG4gICAgICAgICB0eXBlb2YgYXJnID09PSAnYm9vbGVhbicgfHxcbiAgICAgICAgIHR5cGVvZiBhcmcgPT09ICdudW1iZXInIHx8XG4gICAgICAgICB0eXBlb2YgYXJnID09PSAnc3RyaW5nJyB8fFxuICAgICAgICAgdHlwZW9mIGFyZyA9PT0gJ3N5bWJvbCcgfHwgIC8vIEVTNiBzeW1ib2xcbiAgICAgICAgIHR5cGVvZiBhcmcgPT09ICd1bmRlZmluZWQnO1xufVxuZXhwb3J0cy5pc1ByaW1pdGl2ZSA9IGlzUHJpbWl0aXZlO1xuXG5leHBvcnRzLmlzQnVmZmVyID0gcmVxdWlyZSgnLi9zdXBwb3J0L2lzQnVmZmVyJyk7XG5cbmZ1bmN0aW9uIG9iamVjdFRvU3RyaW5nKG8pIHtcbiAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvKTtcbn1cblxuXG5mdW5jdGlvbiBwYWQobikge1xuICByZXR1cm4gbiA8IDEwID8gJzAnICsgbi50b1N0cmluZygxMCkgOiBuLnRvU3RyaW5nKDEwKTtcbn1cblxuXG52YXIgbW9udGhzID0gWydKYW4nLCAnRmViJywgJ01hcicsICdBcHInLCAnTWF5JywgJ0p1bicsICdKdWwnLCAnQXVnJywgJ1NlcCcsXG4gICAgICAgICAgICAgICdPY3QnLCAnTm92JywgJ0RlYyddO1xuXG4vLyAyNiBGZWIgMTY6MTk6MzRcbmZ1bmN0aW9uIHRpbWVzdGFtcCgpIHtcbiAgdmFyIGQgPSBuZXcgRGF0ZSgpO1xuICB2YXIgdGltZSA9IFtwYWQoZC5nZXRIb3VycygpKSxcbiAgICAgICAgICAgICAgcGFkKGQuZ2V0TWludXRlcygpKSxcbiAgICAgICAgICAgICAgcGFkKGQuZ2V0U2Vjb25kcygpKV0uam9pbignOicpO1xuICByZXR1cm4gW2QuZ2V0RGF0ZSgpLCBtb250aHNbZC5nZXRNb250aCgpXSwgdGltZV0uam9pbignICcpO1xufVxuXG5cbi8vIGxvZyBpcyBqdXN0IGEgdGhpbiB3cmFwcGVyIHRvIGNvbnNvbGUubG9nIHRoYXQgcHJlcGVuZHMgYSB0aW1lc3RhbXBcbmV4cG9ydHMubG9nID0gZnVuY3Rpb24oKSB7XG4gIGNvbnNvbGUubG9nKCclcyAtICVzJywgdGltZXN0YW1wKCksIGV4cG9ydHMuZm9ybWF0LmFwcGx5KGV4cG9ydHMsIGFyZ3VtZW50cykpO1xufTtcblxuXG4vKipcbiAqIEluaGVyaXQgdGhlIHByb3RvdHlwZSBtZXRob2RzIGZyb20gb25lIGNvbnN0cnVjdG9yIGludG8gYW5vdGhlci5cbiAqXG4gKiBUaGUgRnVuY3Rpb24ucHJvdG90eXBlLmluaGVyaXRzIGZyb20gbGFuZy5qcyByZXdyaXR0ZW4gYXMgYSBzdGFuZGFsb25lXG4gKiBmdW5jdGlvbiAobm90IG9uIEZ1bmN0aW9uLnByb3RvdHlwZSkuIE5PVEU6IElmIHRoaXMgZmlsZSBpcyB0byBiZSBsb2FkZWRcbiAqIGR1cmluZyBib290c3RyYXBwaW5nIHRoaXMgZnVuY3Rpb24gbmVlZHMgdG8gYmUgcmV3cml0dGVuIHVzaW5nIHNvbWUgbmF0aXZlXG4gKiBmdW5jdGlvbnMgYXMgcHJvdG90eXBlIHNldHVwIHVzaW5nIG5vcm1hbCBKYXZhU2NyaXB0IGRvZXMgbm90IHdvcmsgYXNcbiAqIGV4cGVjdGVkIGR1cmluZyBib290c3RyYXBwaW5nIChzZWUgbWlycm9yLmpzIGluIHIxMTQ5MDMpLlxuICpcbiAqIEBwYXJhbSB7ZnVuY3Rpb259IGN0b3IgQ29uc3RydWN0b3IgZnVuY3Rpb24gd2hpY2ggbmVlZHMgdG8gaW5oZXJpdCB0aGVcbiAqICAgICBwcm90b3R5cGUuXG4gKiBAcGFyYW0ge2Z1bmN0aW9ufSBzdXBlckN0b3IgQ29uc3RydWN0b3IgZnVuY3Rpb24gdG8gaW5oZXJpdCBwcm90b3R5cGUgZnJvbS5cbiAqL1xuZXhwb3J0cy5pbmhlcml0cyA9IHJlcXVpcmUoJ2luaGVyaXRzJyk7XG5cbmV4cG9ydHMuX2V4dGVuZCA9IGZ1bmN0aW9uKG9yaWdpbiwgYWRkKSB7XG4gIC8vIERvbid0IGRvIGFueXRoaW5nIGlmIGFkZCBpc24ndCBhbiBvYmplY3RcbiAgaWYgKCFhZGQgfHwgIWlzT2JqZWN0KGFkZCkpIHJldHVybiBvcmlnaW47XG5cbiAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhhZGQpO1xuICB2YXIgaSA9IGtleXMubGVuZ3RoO1xuICB3aGlsZSAoaS0tKSB7XG4gICAgb3JpZ2luW2tleXNbaV1dID0gYWRkW2tleXNbaV1dO1xuICB9XG4gIHJldHVybiBvcmlnaW47XG59O1xuXG5mdW5jdGlvbiBoYXNPd25Qcm9wZXJ0eShvYmosIHByb3ApIHtcbiAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApO1xufVxuIiwiLyogWmVwdG8gdjEuMS42IC0gemVwdG8gZXZlbnQgYWpheCBmb3JtIGllIC0gemVwdG9qcy5jb20vbGljZW5zZSAqL1xuXG52YXIgWmVwdG8gPSAoZnVuY3Rpb24oKSB7XG4gIHZhciB1bmRlZmluZWQsIGtleSwgJCwgY2xhc3NMaXN0LCBlbXB0eUFycmF5ID0gW10sIHNsaWNlID0gZW1wdHlBcnJheS5zbGljZSwgZmlsdGVyID0gZW1wdHlBcnJheS5maWx0ZXIsXG4gICAgZG9jdW1lbnQgPSB3aW5kb3cuZG9jdW1lbnQsXG4gICAgZWxlbWVudERpc3BsYXkgPSB7fSwgY2xhc3NDYWNoZSA9IHt9LFxuICAgIGNzc051bWJlciA9IHsgJ2NvbHVtbi1jb3VudCc6IDEsICdjb2x1bW5zJzogMSwgJ2ZvbnQtd2VpZ2h0JzogMSwgJ2xpbmUtaGVpZ2h0JzogMSwnb3BhY2l0eSc6IDEsICd6LWluZGV4JzogMSwgJ3pvb20nOiAxIH0sXG4gICAgZnJhZ21lbnRSRSA9IC9eXFxzKjwoXFx3K3whKVtePl0qPi8sXG4gICAgc2luZ2xlVGFnUkUgPSAvXjwoXFx3KylcXHMqXFwvPz4oPzo8XFwvXFwxPnwpJC8sXG4gICAgdGFnRXhwYW5kZXJSRSA9IC88KD8hYXJlYXxicnxjb2x8ZW1iZWR8aHJ8aW1nfGlucHV0fGxpbmt8bWV0YXxwYXJhbSkoKFtcXHc6XSspW14+XSopXFwvPi9pZyxcbiAgICByb290Tm9kZVJFID0gL14oPzpib2R5fGh0bWwpJC9pLFxuICAgIGNhcGl0YWxSRSA9IC8oW0EtWl0pL2csXG5cbiAgICAvLyBzcGVjaWFsIGF0dHJpYnV0ZXMgdGhhdCBzaG91bGQgYmUgZ2V0L3NldCB2aWEgbWV0aG9kIGNhbGxzXG4gICAgbWV0aG9kQXR0cmlidXRlcyA9IFsndmFsJywgJ2NzcycsICdodG1sJywgJ3RleHQnLCAnZGF0YScsICd3aWR0aCcsICdoZWlnaHQnLCAnb2Zmc2V0J10sXG5cbiAgICBhZGphY2VuY3lPcGVyYXRvcnMgPSBbICdhZnRlcicsICdwcmVwZW5kJywgJ2JlZm9yZScsICdhcHBlbmQnIF0sXG4gICAgdGFibGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0YWJsZScpLFxuICAgIHRhYmxlUm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKSxcbiAgICBjb250YWluZXJzID0ge1xuICAgICAgJ3RyJzogZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGJvZHknKSxcbiAgICAgICd0Ym9keSc6IHRhYmxlLCAndGhlYWQnOiB0YWJsZSwgJ3Rmb290JzogdGFibGUsXG4gICAgICAndGQnOiB0YWJsZVJvdywgJ3RoJzogdGFibGVSb3csXG4gICAgICAnKic6IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgfSxcbiAgICByZWFkeVJFID0gL2NvbXBsZXRlfGxvYWRlZHxpbnRlcmFjdGl2ZS8sXG4gICAgc2ltcGxlU2VsZWN0b3JSRSA9IC9eW1xcdy1dKiQvLFxuICAgIGNsYXNzMnR5cGUgPSB7fSxcbiAgICB0b1N0cmluZyA9IGNsYXNzMnR5cGUudG9TdHJpbmcsXG4gICAgemVwdG8gPSB7fSxcbiAgICBjYW1lbGl6ZSwgdW5pcSxcbiAgICB0ZW1wUGFyZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JyksXG4gICAgcHJvcE1hcCA9IHtcbiAgICAgICd0YWJpbmRleCc6ICd0YWJJbmRleCcsXG4gICAgICAncmVhZG9ubHknOiAncmVhZE9ubHknLFxuICAgICAgJ2Zvcic6ICdodG1sRm9yJyxcbiAgICAgICdjbGFzcyc6ICdjbGFzc05hbWUnLFxuICAgICAgJ21heGxlbmd0aCc6ICdtYXhMZW5ndGgnLFxuICAgICAgJ2NlbGxzcGFjaW5nJzogJ2NlbGxTcGFjaW5nJyxcbiAgICAgICdjZWxscGFkZGluZyc6ICdjZWxsUGFkZGluZycsXG4gICAgICAncm93c3Bhbic6ICdyb3dTcGFuJyxcbiAgICAgICdjb2xzcGFuJzogJ2NvbFNwYW4nLFxuICAgICAgJ3VzZW1hcCc6ICd1c2VNYXAnLFxuICAgICAgJ2ZyYW1lYm9yZGVyJzogJ2ZyYW1lQm9yZGVyJyxcbiAgICAgICdjb250ZW50ZWRpdGFibGUnOiAnY29udGVudEVkaXRhYmxlJ1xuICAgIH0sXG4gICAgaXNBcnJheSA9IEFycmF5LmlzQXJyYXkgfHxcbiAgICAgIGZ1bmN0aW9uKG9iamVjdCl7IHJldHVybiBvYmplY3QgaW5zdGFuY2VvZiBBcnJheSB9XG5cbiAgemVwdG8ubWF0Y2hlcyA9IGZ1bmN0aW9uKGVsZW1lbnQsIHNlbGVjdG9yKSB7XG4gICAgaWYgKCFzZWxlY3RvciB8fCAhZWxlbWVudCB8fCBlbGVtZW50Lm5vZGVUeXBlICE9PSAxKSByZXR1cm4gZmFsc2VcbiAgICB2YXIgbWF0Y2hlc1NlbGVjdG9yID0gZWxlbWVudC53ZWJraXRNYXRjaGVzU2VsZWN0b3IgfHwgZWxlbWVudC5tb3pNYXRjaGVzU2VsZWN0b3IgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5vTWF0Y2hlc1NlbGVjdG9yIHx8IGVsZW1lbnQubWF0Y2hlc1NlbGVjdG9yXG4gICAgaWYgKG1hdGNoZXNTZWxlY3RvcikgcmV0dXJuIG1hdGNoZXNTZWxlY3Rvci5jYWxsKGVsZW1lbnQsIHNlbGVjdG9yKVxuICAgIC8vIGZhbGwgYmFjayB0byBwZXJmb3JtaW5nIGEgc2VsZWN0b3I6XG4gICAgdmFyIG1hdGNoLCBwYXJlbnQgPSBlbGVtZW50LnBhcmVudE5vZGUsIHRlbXAgPSAhcGFyZW50XG4gICAgaWYgKHRlbXApIChwYXJlbnQgPSB0ZW1wUGFyZW50KS5hcHBlbmRDaGlsZChlbGVtZW50KVxuICAgIG1hdGNoID0gfnplcHRvLnFzYShwYXJlbnQsIHNlbGVjdG9yKS5pbmRleE9mKGVsZW1lbnQpXG4gICAgdGVtcCAmJiB0ZW1wUGFyZW50LnJlbW92ZUNoaWxkKGVsZW1lbnQpXG4gICAgcmV0dXJuIG1hdGNoXG4gIH1cblxuICBmdW5jdGlvbiB0eXBlKG9iaikge1xuICAgIHJldHVybiBvYmogPT0gbnVsbCA/IFN0cmluZyhvYmopIDpcbiAgICAgIGNsYXNzMnR5cGVbdG9TdHJpbmcuY2FsbChvYmopXSB8fCBcIm9iamVjdFwiXG4gIH1cblxuICBmdW5jdGlvbiBpc0Z1bmN0aW9uKHZhbHVlKSB7IHJldHVybiB0eXBlKHZhbHVlKSA9PSBcImZ1bmN0aW9uXCIgfVxuICBmdW5jdGlvbiBpc1dpbmRvdyhvYmopICAgICB7IHJldHVybiBvYmogIT0gbnVsbCAmJiBvYmogPT0gb2JqLndpbmRvdyB9XG4gIGZ1bmN0aW9uIGlzRG9jdW1lbnQob2JqKSAgIHsgcmV0dXJuIG9iaiAhPSBudWxsICYmIG9iai5ub2RlVHlwZSA9PSBvYmouRE9DVU1FTlRfTk9ERSB9XG4gIGZ1bmN0aW9uIGlzT2JqZWN0KG9iaikgICAgIHsgcmV0dXJuIHR5cGUob2JqKSA9PSBcIm9iamVjdFwiIH1cbiAgZnVuY3Rpb24gaXNQbGFpbk9iamVjdChvYmopIHtcbiAgICByZXR1cm4gaXNPYmplY3Qob2JqKSAmJiAhaXNXaW5kb3cob2JqKSAmJiBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqKSA9PSBPYmplY3QucHJvdG90eXBlXG4gIH1cbiAgZnVuY3Rpb24gbGlrZUFycmF5KG9iaikgeyByZXR1cm4gdHlwZW9mIG9iai5sZW5ndGggPT0gJ251bWJlcicgfVxuXG4gIGZ1bmN0aW9uIGNvbXBhY3QoYXJyYXkpIHsgcmV0dXJuIGZpbHRlci5jYWxsKGFycmF5LCBmdW5jdGlvbihpdGVtKXsgcmV0dXJuIGl0ZW0gIT0gbnVsbCB9KSB9XG4gIGZ1bmN0aW9uIGZsYXR0ZW4oYXJyYXkpIHsgcmV0dXJuIGFycmF5Lmxlbmd0aCA+IDAgPyAkLmZuLmNvbmNhdC5hcHBseShbXSwgYXJyYXkpIDogYXJyYXkgfVxuICBjYW1lbGl6ZSA9IGZ1bmN0aW9uKHN0cil7IHJldHVybiBzdHIucmVwbGFjZSgvLSsoLik/L2csIGZ1bmN0aW9uKG1hdGNoLCBjaHIpeyByZXR1cm4gY2hyID8gY2hyLnRvVXBwZXJDYXNlKCkgOiAnJyB9KSB9XG4gIGZ1bmN0aW9uIGRhc2hlcml6ZShzdHIpIHtcbiAgICByZXR1cm4gc3RyLnJlcGxhY2UoLzo6L2csICcvJylcbiAgICAgICAgICAgLnJlcGxhY2UoLyhbQS1aXSspKFtBLVpdW2Etel0pL2csICckMV8kMicpXG4gICAgICAgICAgIC5yZXBsYWNlKC8oW2EtelxcZF0pKFtBLVpdKS9nLCAnJDFfJDInKVxuICAgICAgICAgICAucmVwbGFjZSgvXy9nLCAnLScpXG4gICAgICAgICAgIC50b0xvd2VyQ2FzZSgpXG4gIH1cbiAgdW5pcSA9IGZ1bmN0aW9uKGFycmF5KXsgcmV0dXJuIGZpbHRlci5jYWxsKGFycmF5LCBmdW5jdGlvbihpdGVtLCBpZHgpeyByZXR1cm4gYXJyYXkuaW5kZXhPZihpdGVtKSA9PSBpZHggfSkgfVxuXG4gIGZ1bmN0aW9uIGNsYXNzUkUobmFtZSkge1xuICAgIHJldHVybiBuYW1lIGluIGNsYXNzQ2FjaGUgP1xuICAgICAgY2xhc3NDYWNoZVtuYW1lXSA6IChjbGFzc0NhY2hlW25hbWVdID0gbmV3IFJlZ0V4cCgnKF58XFxcXHMpJyArIG5hbWUgKyAnKFxcXFxzfCQpJykpXG4gIH1cblxuICBmdW5jdGlvbiBtYXliZUFkZFB4KG5hbWUsIHZhbHVlKSB7XG4gICAgcmV0dXJuICh0eXBlb2YgdmFsdWUgPT0gXCJudW1iZXJcIiAmJiAhY3NzTnVtYmVyW2Rhc2hlcml6ZShuYW1lKV0pID8gdmFsdWUgKyBcInB4XCIgOiB2YWx1ZVxuICB9XG5cbiAgZnVuY3Rpb24gZGVmYXVsdERpc3BsYXkobm9kZU5hbWUpIHtcbiAgICB2YXIgZWxlbWVudCwgZGlzcGxheVxuICAgIGlmICghZWxlbWVudERpc3BsYXlbbm9kZU5hbWVdKSB7XG4gICAgICBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChub2RlTmFtZSlcbiAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZWxlbWVudClcbiAgICAgIGRpc3BsYXkgPSBnZXRDb21wdXRlZFN0eWxlKGVsZW1lbnQsICcnKS5nZXRQcm9wZXJ0eVZhbHVlKFwiZGlzcGxheVwiKVxuICAgICAgZWxlbWVudC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGVsZW1lbnQpXG4gICAgICBkaXNwbGF5ID09IFwibm9uZVwiICYmIChkaXNwbGF5ID0gXCJibG9ja1wiKVxuICAgICAgZWxlbWVudERpc3BsYXlbbm9kZU5hbWVdID0gZGlzcGxheVxuICAgIH1cbiAgICByZXR1cm4gZWxlbWVudERpc3BsYXlbbm9kZU5hbWVdXG4gIH1cblxuICBmdW5jdGlvbiBjaGlsZHJlbihlbGVtZW50KSB7XG4gICAgcmV0dXJuICdjaGlsZHJlbicgaW4gZWxlbWVudCA/XG4gICAgICBzbGljZS5jYWxsKGVsZW1lbnQuY2hpbGRyZW4pIDpcbiAgICAgICQubWFwKGVsZW1lbnQuY2hpbGROb2RlcywgZnVuY3Rpb24obm9kZSl7IGlmIChub2RlLm5vZGVUeXBlID09IDEpIHJldHVybiBub2RlIH0pXG4gIH1cblxuICAvLyBgJC56ZXB0by5mcmFnbWVudGAgdGFrZXMgYSBodG1sIHN0cmluZyBhbmQgYW4gb3B0aW9uYWwgdGFnIG5hbWVcbiAgLy8gdG8gZ2VuZXJhdGUgRE9NIG5vZGVzIG5vZGVzIGZyb20gdGhlIGdpdmVuIGh0bWwgc3RyaW5nLlxuICAvLyBUaGUgZ2VuZXJhdGVkIERPTSBub2RlcyBhcmUgcmV0dXJuZWQgYXMgYW4gYXJyYXkuXG4gIC8vIFRoaXMgZnVuY3Rpb24gY2FuIGJlIG92ZXJyaWRlbiBpbiBwbHVnaW5zIGZvciBleGFtcGxlIHRvIG1ha2VcbiAgLy8gaXQgY29tcGF0aWJsZSB3aXRoIGJyb3dzZXJzIHRoYXQgZG9uJ3Qgc3VwcG9ydCB0aGUgRE9NIGZ1bGx5LlxuICB6ZXB0by5mcmFnbWVudCA9IGZ1bmN0aW9uKGh0bWwsIG5hbWUsIHByb3BlcnRpZXMpIHtcbiAgICB2YXIgZG9tLCBub2RlcywgY29udGFpbmVyXG5cbiAgICAvLyBBIHNwZWNpYWwgY2FzZSBvcHRpbWl6YXRpb24gZm9yIGEgc2luZ2xlIHRhZ1xuICAgIGlmIChzaW5nbGVUYWdSRS50ZXN0KGh0bWwpKSBkb20gPSAkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoUmVnRXhwLiQxKSlcblxuICAgIGlmICghZG9tKSB7XG4gICAgICBpZiAoaHRtbC5yZXBsYWNlKSBodG1sID0gaHRtbC5yZXBsYWNlKHRhZ0V4cGFuZGVyUkUsIFwiPCQxPjwvJDI+XCIpXG4gICAgICBpZiAobmFtZSA9PT0gdW5kZWZpbmVkKSBuYW1lID0gZnJhZ21lbnRSRS50ZXN0KGh0bWwpICYmIFJlZ0V4cC4kMVxuICAgICAgaWYgKCEobmFtZSBpbiBjb250YWluZXJzKSkgbmFtZSA9ICcqJ1xuXG4gICAgICBjb250YWluZXIgPSBjb250YWluZXJzW25hbWVdXG4gICAgICBjb250YWluZXIuaW5uZXJIVE1MID0gJycgKyBodG1sXG4gICAgICBkb20gPSAkLmVhY2goc2xpY2UuY2FsbChjb250YWluZXIuY2hpbGROb2RlcyksIGZ1bmN0aW9uKCl7XG4gICAgICAgIGNvbnRhaW5lci5yZW1vdmVDaGlsZCh0aGlzKVxuICAgICAgfSlcbiAgICB9XG5cbiAgICBpZiAoaXNQbGFpbk9iamVjdChwcm9wZXJ0aWVzKSkge1xuICAgICAgbm9kZXMgPSAkKGRvbSlcbiAgICAgICQuZWFjaChwcm9wZXJ0aWVzLCBmdW5jdGlvbihrZXksIHZhbHVlKSB7XG4gICAgICAgIGlmIChtZXRob2RBdHRyaWJ1dGVzLmluZGV4T2Yoa2V5KSA+IC0xKSBub2Rlc1trZXldKHZhbHVlKVxuICAgICAgICBlbHNlIG5vZGVzLmF0dHIoa2V5LCB2YWx1ZSlcbiAgICAgIH0pXG4gICAgfVxuXG4gICAgcmV0dXJuIGRvbVxuICB9XG5cbiAgLy8gYCQuemVwdG8uWmAgc3dhcHMgb3V0IHRoZSBwcm90b3R5cGUgb2YgdGhlIGdpdmVuIGBkb21gIGFycmF5XG4gIC8vIG9mIG5vZGVzIHdpdGggYCQuZm5gIGFuZCB0aHVzIHN1cHBseWluZyBhbGwgdGhlIFplcHRvIGZ1bmN0aW9uc1xuICAvLyB0byB0aGUgYXJyYXkuIE5vdGUgdGhhdCBgX19wcm90b19fYCBpcyBub3Qgc3VwcG9ydGVkIG9uIEludGVybmV0XG4gIC8vIEV4cGxvcmVyLiBUaGlzIG1ldGhvZCBjYW4gYmUgb3ZlcnJpZGVuIGluIHBsdWdpbnMuXG4gIHplcHRvLlogPSBmdW5jdGlvbihkb20sIHNlbGVjdG9yKSB7XG4gICAgZG9tID0gZG9tIHx8IFtdXG4gICAgZG9tLl9fcHJvdG9fXyA9ICQuZm5cbiAgICBkb20uc2VsZWN0b3IgPSBzZWxlY3RvciB8fCAnJ1xuICAgIHJldHVybiBkb21cbiAgfVxuXG4gIC8vIGAkLnplcHRvLmlzWmAgc2hvdWxkIHJldHVybiBgdHJ1ZWAgaWYgdGhlIGdpdmVuIG9iamVjdCBpcyBhIFplcHRvXG4gIC8vIGNvbGxlY3Rpb24uIFRoaXMgbWV0aG9kIGNhbiBiZSBvdmVycmlkZW4gaW4gcGx1Z2lucy5cbiAgemVwdG8uaXNaID0gZnVuY3Rpb24ob2JqZWN0KSB7XG4gICAgcmV0dXJuIG9iamVjdCBpbnN0YW5jZW9mIHplcHRvLlpcbiAgfVxuXG4gIC8vIGAkLnplcHRvLmluaXRgIGlzIFplcHRvJ3MgY291bnRlcnBhcnQgdG8galF1ZXJ5J3MgYCQuZm4uaW5pdGAgYW5kXG4gIC8vIHRha2VzIGEgQ1NTIHNlbGVjdG9yIGFuZCBhbiBvcHRpb25hbCBjb250ZXh0IChhbmQgaGFuZGxlcyB2YXJpb3VzXG4gIC8vIHNwZWNpYWwgY2FzZXMpLlxuICAvLyBUaGlzIG1ldGhvZCBjYW4gYmUgb3ZlcnJpZGVuIGluIHBsdWdpbnMuXG4gIHplcHRvLmluaXQgPSBmdW5jdGlvbihzZWxlY3RvciwgY29udGV4dCkge1xuICAgIHZhciBkb21cbiAgICAvLyBJZiBub3RoaW5nIGdpdmVuLCByZXR1cm4gYW4gZW1wdHkgWmVwdG8gY29sbGVjdGlvblxuICAgIGlmICghc2VsZWN0b3IpIHJldHVybiB6ZXB0by5aKClcbiAgICAvLyBPcHRpbWl6ZSBmb3Igc3RyaW5nIHNlbGVjdG9yc1xuICAgIGVsc2UgaWYgKHR5cGVvZiBzZWxlY3RvciA9PSAnc3RyaW5nJykge1xuICAgICAgc2VsZWN0b3IgPSBzZWxlY3Rvci50cmltKClcbiAgICAgIC8vIElmIGl0J3MgYSBodG1sIGZyYWdtZW50LCBjcmVhdGUgbm9kZXMgZnJvbSBpdFxuICAgICAgLy8gTm90ZTogSW4gYm90aCBDaHJvbWUgMjEgYW5kIEZpcmVmb3ggMTUsIERPTSBlcnJvciAxMlxuICAgICAgLy8gaXMgdGhyb3duIGlmIHRoZSBmcmFnbWVudCBkb2Vzbid0IGJlZ2luIHdpdGggPFxuICAgICAgaWYgKHNlbGVjdG9yWzBdID09ICc8JyAmJiBmcmFnbWVudFJFLnRlc3Qoc2VsZWN0b3IpKVxuICAgICAgICBkb20gPSB6ZXB0by5mcmFnbWVudChzZWxlY3RvciwgUmVnRXhwLiQxLCBjb250ZXh0KSwgc2VsZWN0b3IgPSBudWxsXG4gICAgICAvLyBJZiB0aGVyZSdzIGEgY29udGV4dCwgY3JlYXRlIGEgY29sbGVjdGlvbiBvbiB0aGF0IGNvbnRleHQgZmlyc3QsIGFuZCBzZWxlY3RcbiAgICAgIC8vIG5vZGVzIGZyb20gdGhlcmVcbiAgICAgIGVsc2UgaWYgKGNvbnRleHQgIT09IHVuZGVmaW5lZCkgcmV0dXJuICQoY29udGV4dCkuZmluZChzZWxlY3RvcilcbiAgICAgIC8vIElmIGl0J3MgYSBDU1Mgc2VsZWN0b3IsIHVzZSBpdCB0byBzZWxlY3Qgbm9kZXMuXG4gICAgICBlbHNlIGRvbSA9IHplcHRvLnFzYShkb2N1bWVudCwgc2VsZWN0b3IpXG4gICAgfVxuICAgIC8vIElmIGEgZnVuY3Rpb24gaXMgZ2l2ZW4sIGNhbGwgaXQgd2hlbiB0aGUgRE9NIGlzIHJlYWR5XG4gICAgZWxzZSBpZiAoaXNGdW5jdGlvbihzZWxlY3RvcikpIHJldHVybiAkKGRvY3VtZW50KS5yZWFkeShzZWxlY3RvcilcbiAgICAvLyBJZiBhIFplcHRvIGNvbGxlY3Rpb24gaXMgZ2l2ZW4sIGp1c3QgcmV0dXJuIGl0XG4gICAgZWxzZSBpZiAoemVwdG8uaXNaKHNlbGVjdG9yKSkgcmV0dXJuIHNlbGVjdG9yXG4gICAgZWxzZSB7XG4gICAgICAvLyBub3JtYWxpemUgYXJyYXkgaWYgYW4gYXJyYXkgb2Ygbm9kZXMgaXMgZ2l2ZW5cbiAgICAgIGlmIChpc0FycmF5KHNlbGVjdG9yKSkgZG9tID0gY29tcGFjdChzZWxlY3RvcilcbiAgICAgIC8vIFdyYXAgRE9NIG5vZGVzLlxuICAgICAgZWxzZSBpZiAoaXNPYmplY3Qoc2VsZWN0b3IpKVxuICAgICAgICBkb20gPSBbc2VsZWN0b3JdLCBzZWxlY3RvciA9IG51bGxcbiAgICAgIC8vIElmIGl0J3MgYSBodG1sIGZyYWdtZW50LCBjcmVhdGUgbm9kZXMgZnJvbSBpdFxuICAgICAgZWxzZSBpZiAoZnJhZ21lbnRSRS50ZXN0KHNlbGVjdG9yKSlcbiAgICAgICAgZG9tID0gemVwdG8uZnJhZ21lbnQoc2VsZWN0b3IudHJpbSgpLCBSZWdFeHAuJDEsIGNvbnRleHQpLCBzZWxlY3RvciA9IG51bGxcbiAgICAgIC8vIElmIHRoZXJlJ3MgYSBjb250ZXh0LCBjcmVhdGUgYSBjb2xsZWN0aW9uIG9uIHRoYXQgY29udGV4dCBmaXJzdCwgYW5kIHNlbGVjdFxuICAgICAgLy8gbm9kZXMgZnJvbSB0aGVyZVxuICAgICAgZWxzZSBpZiAoY29udGV4dCAhPT0gdW5kZWZpbmVkKSByZXR1cm4gJChjb250ZXh0KS5maW5kKHNlbGVjdG9yKVxuICAgICAgLy8gQW5kIGxhc3QgYnV0IG5vIGxlYXN0LCBpZiBpdCdzIGEgQ1NTIHNlbGVjdG9yLCB1c2UgaXQgdG8gc2VsZWN0IG5vZGVzLlxuICAgICAgZWxzZSBkb20gPSB6ZXB0by5xc2EoZG9jdW1lbnQsIHNlbGVjdG9yKVxuICAgIH1cbiAgICAvLyBjcmVhdGUgYSBuZXcgWmVwdG8gY29sbGVjdGlvbiBmcm9tIHRoZSBub2RlcyBmb3VuZFxuICAgIHJldHVybiB6ZXB0by5aKGRvbSwgc2VsZWN0b3IpXG4gIH1cblxuICAvLyBgJGAgd2lsbCBiZSB0aGUgYmFzZSBgWmVwdG9gIG9iamVjdC4gV2hlbiBjYWxsaW5nIHRoaXNcbiAgLy8gZnVuY3Rpb24ganVzdCBjYWxsIGAkLnplcHRvLmluaXQsIHdoaWNoIG1ha2VzIHRoZSBpbXBsZW1lbnRhdGlvblxuICAvLyBkZXRhaWxzIG9mIHNlbGVjdGluZyBub2RlcyBhbmQgY3JlYXRpbmcgWmVwdG8gY29sbGVjdGlvbnNcbiAgLy8gcGF0Y2hhYmxlIGluIHBsdWdpbnMuXG4gICQgPSBmdW5jdGlvbihzZWxlY3RvciwgY29udGV4dCl7XG4gICAgcmV0dXJuIHplcHRvLmluaXQoc2VsZWN0b3IsIGNvbnRleHQpXG4gIH1cblxuICBmdW5jdGlvbiBleHRlbmQodGFyZ2V0LCBzb3VyY2UsIGRlZXApIHtcbiAgICBmb3IgKGtleSBpbiBzb3VyY2UpXG4gICAgICBpZiAoZGVlcCAmJiAoaXNQbGFpbk9iamVjdChzb3VyY2Vba2V5XSkgfHwgaXNBcnJheShzb3VyY2Vba2V5XSkpKSB7XG4gICAgICAgIGlmIChpc1BsYWluT2JqZWN0KHNvdXJjZVtrZXldKSAmJiAhaXNQbGFpbk9iamVjdCh0YXJnZXRba2V5XSkpXG4gICAgICAgICAgdGFyZ2V0W2tleV0gPSB7fVxuICAgICAgICBpZiAoaXNBcnJheShzb3VyY2Vba2V5XSkgJiYgIWlzQXJyYXkodGFyZ2V0W2tleV0pKVxuICAgICAgICAgIHRhcmdldFtrZXldID0gW11cbiAgICAgICAgZXh0ZW5kKHRhcmdldFtrZXldLCBzb3VyY2Vba2V5XSwgZGVlcClcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKHNvdXJjZVtrZXldICE9PSB1bmRlZmluZWQpIHRhcmdldFtrZXldID0gc291cmNlW2tleV1cbiAgfVxuXG4gIC8vIENvcHkgYWxsIGJ1dCB1bmRlZmluZWQgcHJvcGVydGllcyBmcm9tIG9uZSBvciBtb3JlXG4gIC8vIG9iamVjdHMgdG8gdGhlIGB0YXJnZXRgIG9iamVjdC5cbiAgJC5leHRlbmQgPSBmdW5jdGlvbih0YXJnZXQpe1xuICAgIHZhciBkZWVwLCBhcmdzID0gc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpXG4gICAgaWYgKHR5cGVvZiB0YXJnZXQgPT0gJ2Jvb2xlYW4nKSB7XG4gICAgICBkZWVwID0gdGFyZ2V0XG4gICAgICB0YXJnZXQgPSBhcmdzLnNoaWZ0KClcbiAgICB9XG4gICAgYXJncy5mb3JFYWNoKGZ1bmN0aW9uKGFyZyl7IGV4dGVuZCh0YXJnZXQsIGFyZywgZGVlcCkgfSlcbiAgICByZXR1cm4gdGFyZ2V0XG4gIH1cblxuICAvLyBgJC56ZXB0by5xc2FgIGlzIFplcHRvJ3MgQ1NTIHNlbGVjdG9yIGltcGxlbWVudGF0aW9uIHdoaWNoXG4gIC8vIHVzZXMgYGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGxgIGFuZCBvcHRpbWl6ZXMgZm9yIHNvbWUgc3BlY2lhbCBjYXNlcywgbGlrZSBgI2lkYC5cbiAgLy8gVGhpcyBtZXRob2QgY2FuIGJlIG92ZXJyaWRlbiBpbiBwbHVnaW5zLlxuICB6ZXB0by5xc2EgPSBmdW5jdGlvbihlbGVtZW50LCBzZWxlY3Rvcil7XG4gICAgdmFyIGZvdW5kLFxuICAgICAgICBtYXliZUlEID0gc2VsZWN0b3JbMF0gPT0gJyMnLFxuICAgICAgICBtYXliZUNsYXNzID0gIW1heWJlSUQgJiYgc2VsZWN0b3JbMF0gPT0gJy4nLFxuICAgICAgICBuYW1lT25seSA9IG1heWJlSUQgfHwgbWF5YmVDbGFzcyA/IHNlbGVjdG9yLnNsaWNlKDEpIDogc2VsZWN0b3IsIC8vIEVuc3VyZSB0aGF0IGEgMSBjaGFyIHRhZyBuYW1lIHN0aWxsIGdldHMgY2hlY2tlZFxuICAgICAgICBpc1NpbXBsZSA9IHNpbXBsZVNlbGVjdG9yUkUudGVzdChuYW1lT25seSlcbiAgICByZXR1cm4gKGlzRG9jdW1lbnQoZWxlbWVudCkgJiYgaXNTaW1wbGUgJiYgbWF5YmVJRCkgP1xuICAgICAgKCAoZm91bmQgPSBlbGVtZW50LmdldEVsZW1lbnRCeUlkKG5hbWVPbmx5KSkgPyBbZm91bmRdIDogW10gKSA6XG4gICAgICAoZWxlbWVudC5ub2RlVHlwZSAhPT0gMSAmJiBlbGVtZW50Lm5vZGVUeXBlICE9PSA5KSA/IFtdIDpcbiAgICAgIHNsaWNlLmNhbGwoXG4gICAgICAgIGlzU2ltcGxlICYmICFtYXliZUlEID9cbiAgICAgICAgICBtYXliZUNsYXNzID8gZWxlbWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKG5hbWVPbmx5KSA6IC8vIElmIGl0J3Mgc2ltcGxlLCBpdCBjb3VsZCBiZSBhIGNsYXNzXG4gICAgICAgICAgZWxlbWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShzZWxlY3RvcikgOiAvLyBPciBhIHRhZ1xuICAgICAgICAgIGVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChzZWxlY3RvcikgLy8gT3IgaXQncyBub3Qgc2ltcGxlLCBhbmQgd2UgbmVlZCB0byBxdWVyeSBhbGxcbiAgICAgIClcbiAgfVxuXG4gIGZ1bmN0aW9uIGZpbHRlcmVkKG5vZGVzLCBzZWxlY3Rvcikge1xuICAgIHJldHVybiBzZWxlY3RvciA9PSBudWxsID8gJChub2RlcykgOiAkKG5vZGVzKS5maWx0ZXIoc2VsZWN0b3IpXG4gIH1cblxuICAkLmNvbnRhaW5zID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNvbnRhaW5zID9cbiAgICBmdW5jdGlvbihwYXJlbnQsIG5vZGUpIHtcbiAgICAgIHJldHVybiBwYXJlbnQgIT09IG5vZGUgJiYgcGFyZW50LmNvbnRhaW5zKG5vZGUpXG4gICAgfSA6XG4gICAgZnVuY3Rpb24ocGFyZW50LCBub2RlKSB7XG4gICAgICB3aGlsZSAobm9kZSAmJiAobm9kZSA9IG5vZGUucGFyZW50Tm9kZSkpXG4gICAgICAgIGlmIChub2RlID09PSBwYXJlbnQpIHJldHVybiB0cnVlXG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG5cbiAgZnVuY3Rpb24gZnVuY0FyZyhjb250ZXh0LCBhcmcsIGlkeCwgcGF5bG9hZCkge1xuICAgIHJldHVybiBpc0Z1bmN0aW9uKGFyZykgPyBhcmcuY2FsbChjb250ZXh0LCBpZHgsIHBheWxvYWQpIDogYXJnXG4gIH1cblxuICBmdW5jdGlvbiBzZXRBdHRyaWJ1dGUobm9kZSwgbmFtZSwgdmFsdWUpIHtcbiAgICB2YWx1ZSA9PSBudWxsID8gbm9kZS5yZW1vdmVBdHRyaWJ1dGUobmFtZSkgOiBub2RlLnNldEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSlcbiAgfVxuXG4gIC8vIGFjY2VzcyBjbGFzc05hbWUgcHJvcGVydHkgd2hpbGUgcmVzcGVjdGluZyBTVkdBbmltYXRlZFN0cmluZ1xuICBmdW5jdGlvbiBjbGFzc05hbWUobm9kZSwgdmFsdWUpe1xuICAgIHZhciBrbGFzcyA9IG5vZGUuY2xhc3NOYW1lIHx8ICcnLFxuICAgICAgICBzdmcgICA9IGtsYXNzICYmIGtsYXNzLmJhc2VWYWwgIT09IHVuZGVmaW5lZFxuXG4gICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHJldHVybiBzdmcgPyBrbGFzcy5iYXNlVmFsIDoga2xhc3NcbiAgICBzdmcgPyAoa2xhc3MuYmFzZVZhbCA9IHZhbHVlKSA6IChub2RlLmNsYXNzTmFtZSA9IHZhbHVlKVxuICB9XG5cbiAgLy8gXCJ0cnVlXCIgID0+IHRydWVcbiAgLy8gXCJmYWxzZVwiID0+IGZhbHNlXG4gIC8vIFwibnVsbFwiICA9PiBudWxsXG4gIC8vIFwiNDJcIiAgICA9PiA0MlxuICAvLyBcIjQyLjVcIiAgPT4gNDIuNVxuICAvLyBcIjA4XCIgICAgPT4gXCIwOFwiXG4gIC8vIEpTT04gICAgPT4gcGFyc2UgaWYgdmFsaWRcbiAgLy8gU3RyaW5nICA9PiBzZWxmXG4gIGZ1bmN0aW9uIGRlc2VyaWFsaXplVmFsdWUodmFsdWUpIHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIHZhbHVlID9cbiAgICAgICAgdmFsdWUgPT0gXCJ0cnVlXCIgfHxcbiAgICAgICAgKCB2YWx1ZSA9PSBcImZhbHNlXCIgPyBmYWxzZSA6XG4gICAgICAgICAgdmFsdWUgPT0gXCJudWxsXCIgPyBudWxsIDpcbiAgICAgICAgICArdmFsdWUgKyBcIlwiID09IHZhbHVlID8gK3ZhbHVlIDpcbiAgICAgICAgICAvXltcXFtcXHtdLy50ZXN0KHZhbHVlKSA/ICQucGFyc2VKU09OKHZhbHVlKSA6XG4gICAgICAgICAgdmFsdWUgKVxuICAgICAgICA6IHZhbHVlXG4gICAgfSBjYXRjaChlKSB7XG4gICAgICByZXR1cm4gdmFsdWVcbiAgICB9XG4gIH1cblxuICAkLnR5cGUgPSB0eXBlXG4gICQuaXNGdW5jdGlvbiA9IGlzRnVuY3Rpb25cbiAgJC5pc1dpbmRvdyA9IGlzV2luZG93XG4gICQuaXNBcnJheSA9IGlzQXJyYXlcbiAgJC5pc1BsYWluT2JqZWN0ID0gaXNQbGFpbk9iamVjdFxuXG4gICQuaXNFbXB0eU9iamVjdCA9IGZ1bmN0aW9uKG9iaikge1xuICAgIHZhciBuYW1lXG4gICAgZm9yIChuYW1lIGluIG9iaikgcmV0dXJuIGZhbHNlXG4gICAgcmV0dXJuIHRydWVcbiAgfVxuXG4gICQuaW5BcnJheSA9IGZ1bmN0aW9uKGVsZW0sIGFycmF5LCBpKXtcbiAgICByZXR1cm4gZW1wdHlBcnJheS5pbmRleE9mLmNhbGwoYXJyYXksIGVsZW0sIGkpXG4gIH1cblxuICAkLmNhbWVsQ2FzZSA9IGNhbWVsaXplXG4gICQudHJpbSA9IGZ1bmN0aW9uKHN0cikge1xuICAgIHJldHVybiBzdHIgPT0gbnVsbCA/IFwiXCIgOiBTdHJpbmcucHJvdG90eXBlLnRyaW0uY2FsbChzdHIpXG4gIH1cblxuICAvLyBwbHVnaW4gY29tcGF0aWJpbGl0eVxuICAkLnV1aWQgPSAwXG4gICQuc3VwcG9ydCA9IHsgfVxuICAkLmV4cHIgPSB7IH1cblxuICAkLm1hcCA9IGZ1bmN0aW9uKGVsZW1lbnRzLCBjYWxsYmFjayl7XG4gICAgdmFyIHZhbHVlLCB2YWx1ZXMgPSBbXSwgaSwga2V5XG4gICAgaWYgKGxpa2VBcnJheShlbGVtZW50cykpXG4gICAgICBmb3IgKGkgPSAwOyBpIDwgZWxlbWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFsdWUgPSBjYWxsYmFjayhlbGVtZW50c1tpXSwgaSlcbiAgICAgICAgaWYgKHZhbHVlICE9IG51bGwpIHZhbHVlcy5wdXNoKHZhbHVlKVxuICAgICAgfVxuICAgIGVsc2VcbiAgICAgIGZvciAoa2V5IGluIGVsZW1lbnRzKSB7XG4gICAgICAgIHZhbHVlID0gY2FsbGJhY2soZWxlbWVudHNba2V5XSwga2V5KVxuICAgICAgICBpZiAodmFsdWUgIT0gbnVsbCkgdmFsdWVzLnB1c2godmFsdWUpXG4gICAgICB9XG4gICAgcmV0dXJuIGZsYXR0ZW4odmFsdWVzKVxuICB9XG5cbiAgJC5lYWNoID0gZnVuY3Rpb24oZWxlbWVudHMsIGNhbGxiYWNrKXtcbiAgICB2YXIgaSwga2V5XG4gICAgaWYgKGxpa2VBcnJheShlbGVtZW50cykpIHtcbiAgICAgIGZvciAoaSA9IDA7IGkgPCBlbGVtZW50cy5sZW5ndGg7IGkrKylcbiAgICAgICAgaWYgKGNhbGxiYWNrLmNhbGwoZWxlbWVudHNbaV0sIGksIGVsZW1lbnRzW2ldKSA9PT0gZmFsc2UpIHJldHVybiBlbGVtZW50c1xuICAgIH0gZWxzZSB7XG4gICAgICBmb3IgKGtleSBpbiBlbGVtZW50cylcbiAgICAgICAgaWYgKGNhbGxiYWNrLmNhbGwoZWxlbWVudHNba2V5XSwga2V5LCBlbGVtZW50c1trZXldKSA9PT0gZmFsc2UpIHJldHVybiBlbGVtZW50c1xuICAgIH1cblxuICAgIHJldHVybiBlbGVtZW50c1xuICB9XG5cbiAgJC5ncmVwID0gZnVuY3Rpb24oZWxlbWVudHMsIGNhbGxiYWNrKXtcbiAgICByZXR1cm4gZmlsdGVyLmNhbGwoZWxlbWVudHMsIGNhbGxiYWNrKVxuICB9XG5cbiAgaWYgKHdpbmRvdy5KU09OKSAkLnBhcnNlSlNPTiA9IEpTT04ucGFyc2VcblxuICAvLyBQb3B1bGF0ZSB0aGUgY2xhc3MydHlwZSBtYXBcbiAgJC5lYWNoKFwiQm9vbGVhbiBOdW1iZXIgU3RyaW5nIEZ1bmN0aW9uIEFycmF5IERhdGUgUmVnRXhwIE9iamVjdCBFcnJvclwiLnNwbGl0KFwiIFwiKSwgZnVuY3Rpb24oaSwgbmFtZSkge1xuICAgIGNsYXNzMnR5cGVbIFwiW29iamVjdCBcIiArIG5hbWUgKyBcIl1cIiBdID0gbmFtZS50b0xvd2VyQ2FzZSgpXG4gIH0pXG5cbiAgLy8gRGVmaW5lIG1ldGhvZHMgdGhhdCB3aWxsIGJlIGF2YWlsYWJsZSBvbiBhbGxcbiAgLy8gWmVwdG8gY29sbGVjdGlvbnNcbiAgJC5mbiA9IHtcbiAgICAvLyBCZWNhdXNlIGEgY29sbGVjdGlvbiBhY3RzIGxpa2UgYW4gYXJyYXlcbiAgICAvLyBjb3B5IG92ZXIgdGhlc2UgdXNlZnVsIGFycmF5IGZ1bmN0aW9ucy5cbiAgICBmb3JFYWNoOiBlbXB0eUFycmF5LmZvckVhY2gsXG4gICAgcmVkdWNlOiBlbXB0eUFycmF5LnJlZHVjZSxcbiAgICBwdXNoOiBlbXB0eUFycmF5LnB1c2gsXG4gICAgc29ydDogZW1wdHlBcnJheS5zb3J0LFxuICAgIGluZGV4T2Y6IGVtcHR5QXJyYXkuaW5kZXhPZixcbiAgICBjb25jYXQ6IGVtcHR5QXJyYXkuY29uY2F0LFxuXG4gICAgLy8gYG1hcGAgYW5kIGBzbGljZWAgaW4gdGhlIGpRdWVyeSBBUEkgd29yayBkaWZmZXJlbnRseVxuICAgIC8vIGZyb20gdGhlaXIgYXJyYXkgY291bnRlcnBhcnRzXG4gICAgbWFwOiBmdW5jdGlvbihmbil7XG4gICAgICByZXR1cm4gJCgkLm1hcCh0aGlzLCBmdW5jdGlvbihlbCwgaSl7IHJldHVybiBmbi5jYWxsKGVsLCBpLCBlbCkgfSkpXG4gICAgfSxcbiAgICBzbGljZTogZnVuY3Rpb24oKXtcbiAgICAgIHJldHVybiAkKHNsaWNlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpXG4gICAgfSxcblxuICAgIHJlYWR5OiBmdW5jdGlvbihjYWxsYmFjayl7XG4gICAgICAvLyBuZWVkIHRvIGNoZWNrIGlmIGRvY3VtZW50LmJvZHkgZXhpc3RzIGZvciBJRSBhcyB0aGF0IGJyb3dzZXIgcmVwb3J0c1xuICAgICAgLy8gZG9jdW1lbnQgcmVhZHkgd2hlbiBpdCBoYXNuJ3QgeWV0IGNyZWF0ZWQgdGhlIGJvZHkgZWxlbWVudFxuICAgICAgaWYgKHJlYWR5UkUudGVzdChkb2N1bWVudC5yZWFkeVN0YXRlKSAmJiBkb2N1bWVudC5ib2R5KSBjYWxsYmFjaygkKVxuICAgICAgZWxzZSBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24oKXsgY2FsbGJhY2soJCkgfSwgZmFsc2UpXG4gICAgICByZXR1cm4gdGhpc1xuICAgIH0sXG4gICAgZ2V0OiBmdW5jdGlvbihpZHgpe1xuICAgICAgcmV0dXJuIGlkeCA9PT0gdW5kZWZpbmVkID8gc2xpY2UuY2FsbCh0aGlzKSA6IHRoaXNbaWR4ID49IDAgPyBpZHggOiBpZHggKyB0aGlzLmxlbmd0aF1cbiAgICB9LFxuICAgIHRvQXJyYXk6IGZ1bmN0aW9uKCl7IHJldHVybiB0aGlzLmdldCgpIH0sXG4gICAgc2l6ZTogZnVuY3Rpb24oKXtcbiAgICAgIHJldHVybiB0aGlzLmxlbmd0aFxuICAgIH0sXG4gICAgcmVtb3ZlOiBmdW5jdGlvbigpe1xuICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe1xuICAgICAgICBpZiAodGhpcy5wYXJlbnROb2RlICE9IG51bGwpXG4gICAgICAgICAgdGhpcy5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMpXG4gICAgICB9KVxuICAgIH0sXG4gICAgZWFjaDogZnVuY3Rpb24oY2FsbGJhY2spe1xuICAgICAgZW1wdHlBcnJheS5ldmVyeS5jYWxsKHRoaXMsIGZ1bmN0aW9uKGVsLCBpZHgpe1xuICAgICAgICByZXR1cm4gY2FsbGJhY2suY2FsbChlbCwgaWR4LCBlbCkgIT09IGZhbHNlXG4gICAgICB9KVxuICAgICAgcmV0dXJuIHRoaXNcbiAgICB9LFxuICAgIGZpbHRlcjogZnVuY3Rpb24oc2VsZWN0b3Ipe1xuICAgICAgaWYgKGlzRnVuY3Rpb24oc2VsZWN0b3IpKSByZXR1cm4gdGhpcy5ub3QodGhpcy5ub3Qoc2VsZWN0b3IpKVxuICAgICAgcmV0dXJuICQoZmlsdGVyLmNhbGwodGhpcywgZnVuY3Rpb24oZWxlbWVudCl7XG4gICAgICAgIHJldHVybiB6ZXB0by5tYXRjaGVzKGVsZW1lbnQsIHNlbGVjdG9yKVxuICAgICAgfSkpXG4gICAgfSxcbiAgICBhZGQ6IGZ1bmN0aW9uKHNlbGVjdG9yLGNvbnRleHQpe1xuICAgICAgcmV0dXJuICQodW5pcSh0aGlzLmNvbmNhdCgkKHNlbGVjdG9yLGNvbnRleHQpKSkpXG4gICAgfSxcbiAgICBpczogZnVuY3Rpb24oc2VsZWN0b3Ipe1xuICAgICAgcmV0dXJuIHRoaXMubGVuZ3RoID4gMCAmJiB6ZXB0by5tYXRjaGVzKHRoaXNbMF0sIHNlbGVjdG9yKVxuICAgIH0sXG4gICAgbm90OiBmdW5jdGlvbihzZWxlY3Rvcil7XG4gICAgICB2YXIgbm9kZXM9W11cbiAgICAgIGlmIChpc0Z1bmN0aW9uKHNlbGVjdG9yKSAmJiBzZWxlY3Rvci5jYWxsICE9PSB1bmRlZmluZWQpXG4gICAgICAgIHRoaXMuZWFjaChmdW5jdGlvbihpZHgpe1xuICAgICAgICAgIGlmICghc2VsZWN0b3IuY2FsbCh0aGlzLGlkeCkpIG5vZGVzLnB1c2godGhpcylcbiAgICAgICAgfSlcbiAgICAgIGVsc2Uge1xuICAgICAgICB2YXIgZXhjbHVkZXMgPSB0eXBlb2Ygc2VsZWN0b3IgPT0gJ3N0cmluZycgPyB0aGlzLmZpbHRlcihzZWxlY3RvcikgOlxuICAgICAgICAgIChsaWtlQXJyYXkoc2VsZWN0b3IpICYmIGlzRnVuY3Rpb24oc2VsZWN0b3IuaXRlbSkpID8gc2xpY2UuY2FsbChzZWxlY3RvcikgOiAkKHNlbGVjdG9yKVxuICAgICAgICB0aGlzLmZvckVhY2goZnVuY3Rpb24oZWwpe1xuICAgICAgICAgIGlmIChleGNsdWRlcy5pbmRleE9mKGVsKSA8IDApIG5vZGVzLnB1c2goZWwpXG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgICByZXR1cm4gJChub2RlcylcbiAgICB9LFxuICAgIGhhczogZnVuY3Rpb24oc2VsZWN0b3Ipe1xuICAgICAgcmV0dXJuIHRoaXMuZmlsdGVyKGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBpc09iamVjdChzZWxlY3RvcikgP1xuICAgICAgICAgICQuY29udGFpbnModGhpcywgc2VsZWN0b3IpIDpcbiAgICAgICAgICAkKHRoaXMpLmZpbmQoc2VsZWN0b3IpLnNpemUoKVxuICAgICAgfSlcbiAgICB9LFxuICAgIGVxOiBmdW5jdGlvbihpZHgpe1xuICAgICAgcmV0dXJuIGlkeCA9PT0gLTEgPyB0aGlzLnNsaWNlKGlkeCkgOiB0aGlzLnNsaWNlKGlkeCwgKyBpZHggKyAxKVxuICAgIH0sXG4gICAgZmlyc3Q6IGZ1bmN0aW9uKCl7XG4gICAgICB2YXIgZWwgPSB0aGlzWzBdXG4gICAgICByZXR1cm4gZWwgJiYgIWlzT2JqZWN0KGVsKSA/IGVsIDogJChlbClcbiAgICB9LFxuICAgIGxhc3Q6IGZ1bmN0aW9uKCl7XG4gICAgICB2YXIgZWwgPSB0aGlzW3RoaXMubGVuZ3RoIC0gMV1cbiAgICAgIHJldHVybiBlbCAmJiAhaXNPYmplY3QoZWwpID8gZWwgOiAkKGVsKVxuICAgIH0sXG4gICAgZmluZDogZnVuY3Rpb24oc2VsZWN0b3Ipe1xuICAgICAgdmFyIHJlc3VsdCwgJHRoaXMgPSB0aGlzXG4gICAgICBpZiAoIXNlbGVjdG9yKSByZXN1bHQgPSAkKClcbiAgICAgIGVsc2UgaWYgKHR5cGVvZiBzZWxlY3RvciA9PSAnb2JqZWN0JylcbiAgICAgICAgcmVzdWx0ID0gJChzZWxlY3RvcikuZmlsdGVyKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgdmFyIG5vZGUgPSB0aGlzXG4gICAgICAgICAgcmV0dXJuIGVtcHR5QXJyYXkuc29tZS5jYWxsKCR0aGlzLCBmdW5jdGlvbihwYXJlbnQpe1xuICAgICAgICAgICAgcmV0dXJuICQuY29udGFpbnMocGFyZW50LCBub2RlKVxuICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgICBlbHNlIGlmICh0aGlzLmxlbmd0aCA9PSAxKSByZXN1bHQgPSAkKHplcHRvLnFzYSh0aGlzWzBdLCBzZWxlY3RvcikpXG4gICAgICBlbHNlIHJlc3VsdCA9IHRoaXMubWFwKGZ1bmN0aW9uKCl7IHJldHVybiB6ZXB0by5xc2EodGhpcywgc2VsZWN0b3IpIH0pXG4gICAgICByZXR1cm4gcmVzdWx0XG4gICAgfSxcbiAgICBjbG9zZXN0OiBmdW5jdGlvbihzZWxlY3RvciwgY29udGV4dCl7XG4gICAgICB2YXIgbm9kZSA9IHRoaXNbMF0sIGNvbGxlY3Rpb24gPSBmYWxzZVxuICAgICAgaWYgKHR5cGVvZiBzZWxlY3RvciA9PSAnb2JqZWN0JykgY29sbGVjdGlvbiA9ICQoc2VsZWN0b3IpXG4gICAgICB3aGlsZSAobm9kZSAmJiAhKGNvbGxlY3Rpb24gPyBjb2xsZWN0aW9uLmluZGV4T2Yobm9kZSkgPj0gMCA6IHplcHRvLm1hdGNoZXMobm9kZSwgc2VsZWN0b3IpKSlcbiAgICAgICAgbm9kZSA9IG5vZGUgIT09IGNvbnRleHQgJiYgIWlzRG9jdW1lbnQobm9kZSkgJiYgbm9kZS5wYXJlbnROb2RlXG4gICAgICByZXR1cm4gJChub2RlKVxuICAgIH0sXG4gICAgcGFyZW50czogZnVuY3Rpb24oc2VsZWN0b3Ipe1xuICAgICAgdmFyIGFuY2VzdG9ycyA9IFtdLCBub2RlcyA9IHRoaXNcbiAgICAgIHdoaWxlIChub2Rlcy5sZW5ndGggPiAwKVxuICAgICAgICBub2RlcyA9ICQubWFwKG5vZGVzLCBmdW5jdGlvbihub2RlKXtcbiAgICAgICAgICBpZiAoKG5vZGUgPSBub2RlLnBhcmVudE5vZGUpICYmICFpc0RvY3VtZW50KG5vZGUpICYmIGFuY2VzdG9ycy5pbmRleE9mKG5vZGUpIDwgMCkge1xuICAgICAgICAgICAgYW5jZXN0b3JzLnB1c2gobm9kZSlcbiAgICAgICAgICAgIHJldHVybiBub2RlXG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgcmV0dXJuIGZpbHRlcmVkKGFuY2VzdG9ycywgc2VsZWN0b3IpXG4gICAgfSxcbiAgICBwYXJlbnQ6IGZ1bmN0aW9uKHNlbGVjdG9yKXtcbiAgICAgIHJldHVybiBmaWx0ZXJlZCh1bmlxKHRoaXMucGx1Y2soJ3BhcmVudE5vZGUnKSksIHNlbGVjdG9yKVxuICAgIH0sXG4gICAgY2hpbGRyZW46IGZ1bmN0aW9uKHNlbGVjdG9yKXtcbiAgICAgIHJldHVybiBmaWx0ZXJlZCh0aGlzLm1hcChmdW5jdGlvbigpeyByZXR1cm4gY2hpbGRyZW4odGhpcykgfSksIHNlbGVjdG9yKVxuICAgIH0sXG4gICAgY29udGVudHM6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMubWFwKGZ1bmN0aW9uKCkgeyByZXR1cm4gc2xpY2UuY2FsbCh0aGlzLmNoaWxkTm9kZXMpIH0pXG4gICAgfSxcbiAgICBzaWJsaW5nczogZnVuY3Rpb24oc2VsZWN0b3Ipe1xuICAgICAgcmV0dXJuIGZpbHRlcmVkKHRoaXMubWFwKGZ1bmN0aW9uKGksIGVsKXtcbiAgICAgICAgcmV0dXJuIGZpbHRlci5jYWxsKGNoaWxkcmVuKGVsLnBhcmVudE5vZGUpLCBmdW5jdGlvbihjaGlsZCl7IHJldHVybiBjaGlsZCE9PWVsIH0pXG4gICAgICB9KSwgc2VsZWN0b3IpXG4gICAgfSxcbiAgICBlbXB0eTogZnVuY3Rpb24oKXtcbiAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXsgdGhpcy5pbm5lckhUTUwgPSAnJyB9KVxuICAgIH0sXG4gICAgLy8gYHBsdWNrYCBpcyBib3Jyb3dlZCBmcm9tIFByb3RvdHlwZS5qc1xuICAgIHBsdWNrOiBmdW5jdGlvbihwcm9wZXJ0eSl7XG4gICAgICByZXR1cm4gJC5tYXAodGhpcywgZnVuY3Rpb24oZWwpeyByZXR1cm4gZWxbcHJvcGVydHldIH0pXG4gICAgfSxcbiAgICBzaG93OiBmdW5jdGlvbigpe1xuICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe1xuICAgICAgICB0aGlzLnN0eWxlLmRpc3BsYXkgPT0gXCJub25lXCIgJiYgKHRoaXMuc3R5bGUuZGlzcGxheSA9ICcnKVxuICAgICAgICBpZiAoZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLCAnJykuZ2V0UHJvcGVydHlWYWx1ZShcImRpc3BsYXlcIikgPT0gXCJub25lXCIpXG4gICAgICAgICAgdGhpcy5zdHlsZS5kaXNwbGF5ID0gZGVmYXVsdERpc3BsYXkodGhpcy5ub2RlTmFtZSlcbiAgICAgIH0pXG4gICAgfSxcbiAgICByZXBsYWNlV2l0aDogZnVuY3Rpb24obmV3Q29udGVudCl7XG4gICAgICByZXR1cm4gdGhpcy5iZWZvcmUobmV3Q29udGVudCkucmVtb3ZlKClcbiAgICB9LFxuICAgIHdyYXA6IGZ1bmN0aW9uKHN0cnVjdHVyZSl7XG4gICAgICB2YXIgZnVuYyA9IGlzRnVuY3Rpb24oc3RydWN0dXJlKVxuICAgICAgaWYgKHRoaXNbMF0gJiYgIWZ1bmMpXG4gICAgICAgIHZhciBkb20gICA9ICQoc3RydWN0dXJlKS5nZXQoMCksXG4gICAgICAgICAgICBjbG9uZSA9IGRvbS5wYXJlbnROb2RlIHx8IHRoaXMubGVuZ3RoID4gMVxuXG4gICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGluZGV4KXtcbiAgICAgICAgJCh0aGlzKS53cmFwQWxsKFxuICAgICAgICAgIGZ1bmMgPyBzdHJ1Y3R1cmUuY2FsbCh0aGlzLCBpbmRleCkgOlxuICAgICAgICAgICAgY2xvbmUgPyBkb20uY2xvbmVOb2RlKHRydWUpIDogZG9tXG4gICAgICAgIClcbiAgICAgIH0pXG4gICAgfSxcbiAgICB3cmFwQWxsOiBmdW5jdGlvbihzdHJ1Y3R1cmUpe1xuICAgICAgaWYgKHRoaXNbMF0pIHtcbiAgICAgICAgJCh0aGlzWzBdKS5iZWZvcmUoc3RydWN0dXJlID0gJChzdHJ1Y3R1cmUpKVxuICAgICAgICB2YXIgY2hpbGRyZW5cbiAgICAgICAgLy8gZHJpbGwgZG93biB0byB0aGUgaW5tb3N0IGVsZW1lbnRcbiAgICAgICAgd2hpbGUgKChjaGlsZHJlbiA9IHN0cnVjdHVyZS5jaGlsZHJlbigpKS5sZW5ndGgpIHN0cnVjdHVyZSA9IGNoaWxkcmVuLmZpcnN0KClcbiAgICAgICAgJChzdHJ1Y3R1cmUpLmFwcGVuZCh0aGlzKVxuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXNcbiAgICB9LFxuICAgIHdyYXBJbm5lcjogZnVuY3Rpb24oc3RydWN0dXJlKXtcbiAgICAgIHZhciBmdW5jID0gaXNGdW5jdGlvbihzdHJ1Y3R1cmUpXG4gICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGluZGV4KXtcbiAgICAgICAgdmFyIHNlbGYgPSAkKHRoaXMpLCBjb250ZW50cyA9IHNlbGYuY29udGVudHMoKSxcbiAgICAgICAgICAgIGRvbSAgPSBmdW5jID8gc3RydWN0dXJlLmNhbGwodGhpcywgaW5kZXgpIDogc3RydWN0dXJlXG4gICAgICAgIGNvbnRlbnRzLmxlbmd0aCA/IGNvbnRlbnRzLndyYXBBbGwoZG9tKSA6IHNlbGYuYXBwZW5kKGRvbSlcbiAgICAgIH0pXG4gICAgfSxcbiAgICB1bndyYXA6IGZ1bmN0aW9uKCl7XG4gICAgICB0aGlzLnBhcmVudCgpLmVhY2goZnVuY3Rpb24oKXtcbiAgICAgICAgJCh0aGlzKS5yZXBsYWNlV2l0aCgkKHRoaXMpLmNoaWxkcmVuKCkpXG4gICAgICB9KVxuICAgICAgcmV0dXJuIHRoaXNcbiAgICB9LFxuICAgIGNsb25lOiBmdW5jdGlvbigpe1xuICAgICAgcmV0dXJuIHRoaXMubWFwKGZ1bmN0aW9uKCl7IHJldHVybiB0aGlzLmNsb25lTm9kZSh0cnVlKSB9KVxuICAgIH0sXG4gICAgaGlkZTogZnVuY3Rpb24oKXtcbiAgICAgIHJldHVybiB0aGlzLmNzcyhcImRpc3BsYXlcIiwgXCJub25lXCIpXG4gICAgfSxcbiAgICB0b2dnbGU6IGZ1bmN0aW9uKHNldHRpbmcpe1xuICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe1xuICAgICAgICB2YXIgZWwgPSAkKHRoaXMpXG4gICAgICAgIDsoc2V0dGluZyA9PT0gdW5kZWZpbmVkID8gZWwuY3NzKFwiZGlzcGxheVwiKSA9PSBcIm5vbmVcIiA6IHNldHRpbmcpID8gZWwuc2hvdygpIDogZWwuaGlkZSgpXG4gICAgICB9KVxuICAgIH0sXG4gICAgcHJldjogZnVuY3Rpb24oc2VsZWN0b3IpeyByZXR1cm4gJCh0aGlzLnBsdWNrKCdwcmV2aW91c0VsZW1lbnRTaWJsaW5nJykpLmZpbHRlcihzZWxlY3RvciB8fCAnKicpIH0sXG4gICAgbmV4dDogZnVuY3Rpb24oc2VsZWN0b3IpeyByZXR1cm4gJCh0aGlzLnBsdWNrKCduZXh0RWxlbWVudFNpYmxpbmcnKSkuZmlsdGVyKHNlbGVjdG9yIHx8ICcqJykgfSxcbiAgICBodG1sOiBmdW5jdGlvbihodG1sKXtcbiAgICAgIHJldHVybiAwIGluIGFyZ3VtZW50cyA/XG4gICAgICAgIHRoaXMuZWFjaChmdW5jdGlvbihpZHgpe1xuICAgICAgICAgIHZhciBvcmlnaW5IdG1sID0gdGhpcy5pbm5lckhUTUxcbiAgICAgICAgICAkKHRoaXMpLmVtcHR5KCkuYXBwZW5kKCBmdW5jQXJnKHRoaXMsIGh0bWwsIGlkeCwgb3JpZ2luSHRtbCkgKVxuICAgICAgICB9KSA6XG4gICAgICAgICgwIGluIHRoaXMgPyB0aGlzWzBdLmlubmVySFRNTCA6IG51bGwpXG4gICAgfSxcbiAgICB0ZXh0OiBmdW5jdGlvbih0ZXh0KXtcbiAgICAgIHJldHVybiAwIGluIGFyZ3VtZW50cyA/XG4gICAgICAgIHRoaXMuZWFjaChmdW5jdGlvbihpZHgpe1xuICAgICAgICAgIHZhciBuZXdUZXh0ID0gZnVuY0FyZyh0aGlzLCB0ZXh0LCBpZHgsIHRoaXMudGV4dENvbnRlbnQpXG4gICAgICAgICAgdGhpcy50ZXh0Q29udGVudCA9IG5ld1RleHQgPT0gbnVsbCA/ICcnIDogJycrbmV3VGV4dFxuICAgICAgICB9KSA6XG4gICAgICAgICgwIGluIHRoaXMgPyB0aGlzWzBdLnRleHRDb250ZW50IDogbnVsbClcbiAgICB9LFxuICAgIGF0dHI6IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKXtcbiAgICAgIHZhciByZXN1bHRcbiAgICAgIHJldHVybiAodHlwZW9mIG5hbWUgPT0gJ3N0cmluZycgJiYgISgxIGluIGFyZ3VtZW50cykpID9cbiAgICAgICAgKCF0aGlzLmxlbmd0aCB8fCB0aGlzWzBdLm5vZGVUeXBlICE9PSAxID8gdW5kZWZpbmVkIDpcbiAgICAgICAgICAoIShyZXN1bHQgPSB0aGlzWzBdLmdldEF0dHJpYnV0ZShuYW1lKSkgJiYgbmFtZSBpbiB0aGlzWzBdKSA/IHRoaXNbMF1bbmFtZV0gOiByZXN1bHRcbiAgICAgICAgKSA6XG4gICAgICAgIHRoaXMuZWFjaChmdW5jdGlvbihpZHgpe1xuICAgICAgICAgIGlmICh0aGlzLm5vZGVUeXBlICE9PSAxKSByZXR1cm5cbiAgICAgICAgICBpZiAoaXNPYmplY3QobmFtZSkpIGZvciAoa2V5IGluIG5hbWUpIHNldEF0dHJpYnV0ZSh0aGlzLCBrZXksIG5hbWVba2V5XSlcbiAgICAgICAgICBlbHNlIHNldEF0dHJpYnV0ZSh0aGlzLCBuYW1lLCBmdW5jQXJnKHRoaXMsIHZhbHVlLCBpZHgsIHRoaXMuZ2V0QXR0cmlidXRlKG5hbWUpKSlcbiAgICAgICAgfSlcbiAgICB9LFxuICAgIHJlbW92ZUF0dHI6IGZ1bmN0aW9uKG5hbWUpe1xuICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpeyB0aGlzLm5vZGVUeXBlID09PSAxICYmIG5hbWUuc3BsaXQoJyAnKS5mb3JFYWNoKGZ1bmN0aW9uKGF0dHJpYnV0ZSl7XG4gICAgICAgIHNldEF0dHJpYnV0ZSh0aGlzLCBhdHRyaWJ1dGUpXG4gICAgICB9LCB0aGlzKX0pXG4gICAgfSxcbiAgICBwcm9wOiBmdW5jdGlvbihuYW1lLCB2YWx1ZSl7XG4gICAgICBuYW1lID0gcHJvcE1hcFtuYW1lXSB8fCBuYW1lXG4gICAgICByZXR1cm4gKDEgaW4gYXJndW1lbnRzKSA/XG4gICAgICAgIHRoaXMuZWFjaChmdW5jdGlvbihpZHgpe1xuICAgICAgICAgIHRoaXNbbmFtZV0gPSBmdW5jQXJnKHRoaXMsIHZhbHVlLCBpZHgsIHRoaXNbbmFtZV0pXG4gICAgICAgIH0pIDpcbiAgICAgICAgKHRoaXNbMF0gJiYgdGhpc1swXVtuYW1lXSlcbiAgICB9LFxuICAgIGRhdGE6IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKXtcbiAgICAgIHZhciBhdHRyTmFtZSA9ICdkYXRhLScgKyBuYW1lLnJlcGxhY2UoY2FwaXRhbFJFLCAnLSQxJykudG9Mb3dlckNhc2UoKVxuXG4gICAgICB2YXIgZGF0YSA9ICgxIGluIGFyZ3VtZW50cykgP1xuICAgICAgICB0aGlzLmF0dHIoYXR0ck5hbWUsIHZhbHVlKSA6XG4gICAgICAgIHRoaXMuYXR0cihhdHRyTmFtZSlcblxuICAgICAgcmV0dXJuIGRhdGEgIT09IG51bGwgPyBkZXNlcmlhbGl6ZVZhbHVlKGRhdGEpIDogdW5kZWZpbmVkXG4gICAgfSxcbiAgICB2YWw6IGZ1bmN0aW9uKHZhbHVlKXtcbiAgICAgIHJldHVybiAwIGluIGFyZ3VtZW50cyA/XG4gICAgICAgIHRoaXMuZWFjaChmdW5jdGlvbihpZHgpe1xuICAgICAgICAgIHRoaXMudmFsdWUgPSBmdW5jQXJnKHRoaXMsIHZhbHVlLCBpZHgsIHRoaXMudmFsdWUpXG4gICAgICAgIH0pIDpcbiAgICAgICAgKHRoaXNbMF0gJiYgKHRoaXNbMF0ubXVsdGlwbGUgP1xuICAgICAgICAgICAkKHRoaXNbMF0pLmZpbmQoJ29wdGlvbicpLmZpbHRlcihmdW5jdGlvbigpeyByZXR1cm4gdGhpcy5zZWxlY3RlZCB9KS5wbHVjaygndmFsdWUnKSA6XG4gICAgICAgICAgIHRoaXNbMF0udmFsdWUpXG4gICAgICAgIClcbiAgICB9LFxuICAgIG9mZnNldDogZnVuY3Rpb24oY29vcmRpbmF0ZXMpe1xuICAgICAgaWYgKGNvb3JkaW5hdGVzKSByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGluZGV4KXtcbiAgICAgICAgdmFyICR0aGlzID0gJCh0aGlzKSxcbiAgICAgICAgICAgIGNvb3JkcyA9IGZ1bmNBcmcodGhpcywgY29vcmRpbmF0ZXMsIGluZGV4LCAkdGhpcy5vZmZzZXQoKSksXG4gICAgICAgICAgICBwYXJlbnRPZmZzZXQgPSAkdGhpcy5vZmZzZXRQYXJlbnQoKS5vZmZzZXQoKSxcbiAgICAgICAgICAgIHByb3BzID0ge1xuICAgICAgICAgICAgICB0b3A6ICBjb29yZHMudG9wICAtIHBhcmVudE9mZnNldC50b3AsXG4gICAgICAgICAgICAgIGxlZnQ6IGNvb3Jkcy5sZWZ0IC0gcGFyZW50T2Zmc2V0LmxlZnRcbiAgICAgICAgICAgIH1cblxuICAgICAgICBpZiAoJHRoaXMuY3NzKCdwb3NpdGlvbicpID09ICdzdGF0aWMnKSBwcm9wc1sncG9zaXRpb24nXSA9ICdyZWxhdGl2ZSdcbiAgICAgICAgJHRoaXMuY3NzKHByb3BzKVxuICAgICAgfSlcbiAgICAgIGlmICghdGhpcy5sZW5ndGgpIHJldHVybiBudWxsXG4gICAgICB2YXIgb2JqID0gdGhpc1swXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbGVmdDogb2JqLmxlZnQgKyB3aW5kb3cucGFnZVhPZmZzZXQsXG4gICAgICAgIHRvcDogb2JqLnRvcCArIHdpbmRvdy5wYWdlWU9mZnNldCxcbiAgICAgICAgd2lkdGg6IE1hdGgucm91bmQob2JqLndpZHRoKSxcbiAgICAgICAgaGVpZ2h0OiBNYXRoLnJvdW5kKG9iai5oZWlnaHQpXG4gICAgICB9XG4gICAgfSxcbiAgICBjc3M6IGZ1bmN0aW9uKHByb3BlcnR5LCB2YWx1ZSl7XG4gICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA8IDIpIHtcbiAgICAgICAgdmFyIGNvbXB1dGVkU3R5bGUsIGVsZW1lbnQgPSB0aGlzWzBdXG4gICAgICAgIGlmKCFlbGVtZW50KSByZXR1cm5cbiAgICAgICAgY29tcHV0ZWRTdHlsZSA9IGdldENvbXB1dGVkU3R5bGUoZWxlbWVudCwgJycpXG4gICAgICAgIGlmICh0eXBlb2YgcHJvcGVydHkgPT0gJ3N0cmluZycpXG4gICAgICAgICAgcmV0dXJuIGVsZW1lbnQuc3R5bGVbY2FtZWxpemUocHJvcGVydHkpXSB8fCBjb21wdXRlZFN0eWxlLmdldFByb3BlcnR5VmFsdWUocHJvcGVydHkpXG4gICAgICAgIGVsc2UgaWYgKGlzQXJyYXkocHJvcGVydHkpKSB7XG4gICAgICAgICAgdmFyIHByb3BzID0ge31cbiAgICAgICAgICAkLmVhY2gocHJvcGVydHksIGZ1bmN0aW9uKF8sIHByb3Ape1xuICAgICAgICAgICAgcHJvcHNbcHJvcF0gPSAoZWxlbWVudC5zdHlsZVtjYW1lbGl6ZShwcm9wKV0gfHwgY29tcHV0ZWRTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKHByb3ApKVxuICAgICAgICAgIH0pXG4gICAgICAgICAgcmV0dXJuIHByb3BzXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgdmFyIGNzcyA9ICcnXG4gICAgICBpZiAodHlwZShwcm9wZXJ0eSkgPT0gJ3N0cmluZycpIHtcbiAgICAgICAgaWYgKCF2YWx1ZSAmJiB2YWx1ZSAhPT0gMClcbiAgICAgICAgICB0aGlzLmVhY2goZnVuY3Rpb24oKXsgdGhpcy5zdHlsZS5yZW1vdmVQcm9wZXJ0eShkYXNoZXJpemUocHJvcGVydHkpKSB9KVxuICAgICAgICBlbHNlXG4gICAgICAgICAgY3NzID0gZGFzaGVyaXplKHByb3BlcnR5KSArIFwiOlwiICsgbWF5YmVBZGRQeChwcm9wZXJ0eSwgdmFsdWUpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBmb3IgKGtleSBpbiBwcm9wZXJ0eSlcbiAgICAgICAgICBpZiAoIXByb3BlcnR5W2tleV0gJiYgcHJvcGVydHlba2V5XSAhPT0gMClcbiAgICAgICAgICAgIHRoaXMuZWFjaChmdW5jdGlvbigpeyB0aGlzLnN0eWxlLnJlbW92ZVByb3BlcnR5KGRhc2hlcml6ZShrZXkpKSB9KVxuICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIGNzcyArPSBkYXNoZXJpemUoa2V5KSArICc6JyArIG1heWJlQWRkUHgoa2V5LCBwcm9wZXJ0eVtrZXldKSArICc7J1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7IHRoaXMuc3R5bGUuY3NzVGV4dCArPSAnOycgKyBjc3MgfSlcbiAgICB9LFxuICAgIGluZGV4OiBmdW5jdGlvbihlbGVtZW50KXtcbiAgICAgIHJldHVybiBlbGVtZW50ID8gdGhpcy5pbmRleE9mKCQoZWxlbWVudClbMF0pIDogdGhpcy5wYXJlbnQoKS5jaGlsZHJlbigpLmluZGV4T2YodGhpc1swXSlcbiAgICB9LFxuICAgIGhhc0NsYXNzOiBmdW5jdGlvbihuYW1lKXtcbiAgICAgIGlmICghbmFtZSkgcmV0dXJuIGZhbHNlXG4gICAgICByZXR1cm4gZW1wdHlBcnJheS5zb21lLmNhbGwodGhpcywgZnVuY3Rpb24oZWwpe1xuICAgICAgICByZXR1cm4gdGhpcy50ZXN0KGNsYXNzTmFtZShlbCkpXG4gICAgICB9LCBjbGFzc1JFKG5hbWUpKVxuICAgIH0sXG4gICAgYWRkQ2xhc3M6IGZ1bmN0aW9uKG5hbWUpe1xuICAgICAgaWYgKCFuYW1lKSByZXR1cm4gdGhpc1xuICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihpZHgpe1xuICAgICAgICBpZiAoISgnY2xhc3NOYW1lJyBpbiB0aGlzKSkgcmV0dXJuXG4gICAgICAgIGNsYXNzTGlzdCA9IFtdXG4gICAgICAgIHZhciBjbHMgPSBjbGFzc05hbWUodGhpcyksIG5ld05hbWUgPSBmdW5jQXJnKHRoaXMsIG5hbWUsIGlkeCwgY2xzKVxuICAgICAgICBuZXdOYW1lLnNwbGl0KC9cXHMrL2cpLmZvckVhY2goZnVuY3Rpb24oa2xhc3Mpe1xuICAgICAgICAgIGlmICghJCh0aGlzKS5oYXNDbGFzcyhrbGFzcykpIGNsYXNzTGlzdC5wdXNoKGtsYXNzKVxuICAgICAgICB9LCB0aGlzKVxuICAgICAgICBjbGFzc0xpc3QubGVuZ3RoICYmIGNsYXNzTmFtZSh0aGlzLCBjbHMgKyAoY2xzID8gXCIgXCIgOiBcIlwiKSArIGNsYXNzTGlzdC5qb2luKFwiIFwiKSlcbiAgICAgIH0pXG4gICAgfSxcbiAgICByZW1vdmVDbGFzczogZnVuY3Rpb24obmFtZSl7XG4gICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGlkeCl7XG4gICAgICAgIGlmICghKCdjbGFzc05hbWUnIGluIHRoaXMpKSByZXR1cm5cbiAgICAgICAgaWYgKG5hbWUgPT09IHVuZGVmaW5lZCkgcmV0dXJuIGNsYXNzTmFtZSh0aGlzLCAnJylcbiAgICAgICAgY2xhc3NMaXN0ID0gY2xhc3NOYW1lKHRoaXMpXG4gICAgICAgIGZ1bmNBcmcodGhpcywgbmFtZSwgaWR4LCBjbGFzc0xpc3QpLnNwbGl0KC9cXHMrL2cpLmZvckVhY2goZnVuY3Rpb24oa2xhc3Mpe1xuICAgICAgICAgIGNsYXNzTGlzdCA9IGNsYXNzTGlzdC5yZXBsYWNlKGNsYXNzUkUoa2xhc3MpLCBcIiBcIilcbiAgICAgICAgfSlcbiAgICAgICAgY2xhc3NOYW1lKHRoaXMsIGNsYXNzTGlzdC50cmltKCkpXG4gICAgICB9KVxuICAgIH0sXG4gICAgdG9nZ2xlQ2xhc3M6IGZ1bmN0aW9uKG5hbWUsIHdoZW4pe1xuICAgICAgaWYgKCFuYW1lKSByZXR1cm4gdGhpc1xuICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihpZHgpe1xuICAgICAgICB2YXIgJHRoaXMgPSAkKHRoaXMpLCBuYW1lcyA9IGZ1bmNBcmcodGhpcywgbmFtZSwgaWR4LCBjbGFzc05hbWUodGhpcykpXG4gICAgICAgIG5hbWVzLnNwbGl0KC9cXHMrL2cpLmZvckVhY2goZnVuY3Rpb24oa2xhc3Mpe1xuICAgICAgICAgICh3aGVuID09PSB1bmRlZmluZWQgPyAhJHRoaXMuaGFzQ2xhc3Moa2xhc3MpIDogd2hlbikgP1xuICAgICAgICAgICAgJHRoaXMuYWRkQ2xhc3Moa2xhc3MpIDogJHRoaXMucmVtb3ZlQ2xhc3Moa2xhc3MpXG4gICAgICAgIH0pXG4gICAgICB9KVxuICAgIH0sXG4gICAgc2Nyb2xsVG9wOiBmdW5jdGlvbih2YWx1ZSl7XG4gICAgICBpZiAoIXRoaXMubGVuZ3RoKSByZXR1cm5cbiAgICAgIHZhciBoYXNTY3JvbGxUb3AgPSAnc2Nyb2xsVG9wJyBpbiB0aGlzWzBdXG4gICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkgcmV0dXJuIGhhc1Njcm9sbFRvcCA/IHRoaXNbMF0uc2Nyb2xsVG9wIDogdGhpc1swXS5wYWdlWU9mZnNldFxuICAgICAgcmV0dXJuIHRoaXMuZWFjaChoYXNTY3JvbGxUb3AgP1xuICAgICAgICBmdW5jdGlvbigpeyB0aGlzLnNjcm9sbFRvcCA9IHZhbHVlIH0gOlxuICAgICAgICBmdW5jdGlvbigpeyB0aGlzLnNjcm9sbFRvKHRoaXMuc2Nyb2xsWCwgdmFsdWUpIH0pXG4gICAgfSxcbiAgICBzY3JvbGxMZWZ0OiBmdW5jdGlvbih2YWx1ZSl7XG4gICAgICBpZiAoIXRoaXMubGVuZ3RoKSByZXR1cm5cbiAgICAgIHZhciBoYXNTY3JvbGxMZWZ0ID0gJ3Njcm9sbExlZnQnIGluIHRoaXNbMF1cbiAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSByZXR1cm4gaGFzU2Nyb2xsTGVmdCA/IHRoaXNbMF0uc2Nyb2xsTGVmdCA6IHRoaXNbMF0ucGFnZVhPZmZzZXRcbiAgICAgIHJldHVybiB0aGlzLmVhY2goaGFzU2Nyb2xsTGVmdCA/XG4gICAgICAgIGZ1bmN0aW9uKCl7IHRoaXMuc2Nyb2xsTGVmdCA9IHZhbHVlIH0gOlxuICAgICAgICBmdW5jdGlvbigpeyB0aGlzLnNjcm9sbFRvKHZhbHVlLCB0aGlzLnNjcm9sbFkpIH0pXG4gICAgfSxcbiAgICBwb3NpdGlvbjogZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoIXRoaXMubGVuZ3RoKSByZXR1cm5cblxuICAgICAgdmFyIGVsZW0gPSB0aGlzWzBdLFxuICAgICAgICAvLyBHZXQgKnJlYWwqIG9mZnNldFBhcmVudFxuICAgICAgICBvZmZzZXRQYXJlbnQgPSB0aGlzLm9mZnNldFBhcmVudCgpLFxuICAgICAgICAvLyBHZXQgY29ycmVjdCBvZmZzZXRzXG4gICAgICAgIG9mZnNldCAgICAgICA9IHRoaXMub2Zmc2V0KCksXG4gICAgICAgIHBhcmVudE9mZnNldCA9IHJvb3ROb2RlUkUudGVzdChvZmZzZXRQYXJlbnRbMF0ubm9kZU5hbWUpID8geyB0b3A6IDAsIGxlZnQ6IDAgfSA6IG9mZnNldFBhcmVudC5vZmZzZXQoKVxuXG4gICAgICAvLyBTdWJ0cmFjdCBlbGVtZW50IG1hcmdpbnNcbiAgICAgIC8vIG5vdGU6IHdoZW4gYW4gZWxlbWVudCBoYXMgbWFyZ2luOiBhdXRvIHRoZSBvZmZzZXRMZWZ0IGFuZCBtYXJnaW5MZWZ0XG4gICAgICAvLyBhcmUgdGhlIHNhbWUgaW4gU2FmYXJpIGNhdXNpbmcgb2Zmc2V0LmxlZnQgdG8gaW5jb3JyZWN0bHkgYmUgMFxuICAgICAgb2Zmc2V0LnRvcCAgLT0gcGFyc2VGbG9hdCggJChlbGVtKS5jc3MoJ21hcmdpbi10b3AnKSApIHx8IDBcbiAgICAgIG9mZnNldC5sZWZ0IC09IHBhcnNlRmxvYXQoICQoZWxlbSkuY3NzKCdtYXJnaW4tbGVmdCcpICkgfHwgMFxuXG4gICAgICAvLyBBZGQgb2Zmc2V0UGFyZW50IGJvcmRlcnNcbiAgICAgIHBhcmVudE9mZnNldC50b3AgICs9IHBhcnNlRmxvYXQoICQob2Zmc2V0UGFyZW50WzBdKS5jc3MoJ2JvcmRlci10b3Atd2lkdGgnKSApIHx8IDBcbiAgICAgIHBhcmVudE9mZnNldC5sZWZ0ICs9IHBhcnNlRmxvYXQoICQob2Zmc2V0UGFyZW50WzBdKS5jc3MoJ2JvcmRlci1sZWZ0LXdpZHRoJykgKSB8fCAwXG5cbiAgICAgIC8vIFN1YnRyYWN0IHRoZSB0d28gb2Zmc2V0c1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdG9wOiAgb2Zmc2V0LnRvcCAgLSBwYXJlbnRPZmZzZXQudG9wLFxuICAgICAgICBsZWZ0OiBvZmZzZXQubGVmdCAtIHBhcmVudE9mZnNldC5sZWZ0XG4gICAgICB9XG4gICAgfSxcbiAgICBvZmZzZXRQYXJlbnQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMubWFwKGZ1bmN0aW9uKCl7XG4gICAgICAgIHZhciBwYXJlbnQgPSB0aGlzLm9mZnNldFBhcmVudCB8fCBkb2N1bWVudC5ib2R5XG4gICAgICAgIHdoaWxlIChwYXJlbnQgJiYgIXJvb3ROb2RlUkUudGVzdChwYXJlbnQubm9kZU5hbWUpICYmICQocGFyZW50KS5jc3MoXCJwb3NpdGlvblwiKSA9PSBcInN0YXRpY1wiKVxuICAgICAgICAgIHBhcmVudCA9IHBhcmVudC5vZmZzZXRQYXJlbnRcbiAgICAgICAgcmV0dXJuIHBhcmVudFxuICAgICAgfSlcbiAgICB9XG4gIH1cblxuICAvLyBmb3Igbm93XG4gICQuZm4uZGV0YWNoID0gJC5mbi5yZW1vdmVcblxuICAvLyBHZW5lcmF0ZSB0aGUgYHdpZHRoYCBhbmQgYGhlaWdodGAgZnVuY3Rpb25zXG4gIDtbJ3dpZHRoJywgJ2hlaWdodCddLmZvckVhY2goZnVuY3Rpb24oZGltZW5zaW9uKXtcbiAgICB2YXIgZGltZW5zaW9uUHJvcGVydHkgPVxuICAgICAgZGltZW5zaW9uLnJlcGxhY2UoLy4vLCBmdW5jdGlvbihtKXsgcmV0dXJuIG1bMF0udG9VcHBlckNhc2UoKSB9KVxuXG4gICAgJC5mbltkaW1lbnNpb25dID0gZnVuY3Rpb24odmFsdWUpe1xuICAgICAgdmFyIG9mZnNldCwgZWwgPSB0aGlzWzBdXG4gICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkgcmV0dXJuIGlzV2luZG93KGVsKSA/IGVsWydpbm5lcicgKyBkaW1lbnNpb25Qcm9wZXJ0eV0gOlxuICAgICAgICBpc0RvY3VtZW50KGVsKSA/IGVsLmRvY3VtZW50RWxlbWVudFsnc2Nyb2xsJyArIGRpbWVuc2lvblByb3BlcnR5XSA6XG4gICAgICAgIChvZmZzZXQgPSB0aGlzLm9mZnNldCgpKSAmJiBvZmZzZXRbZGltZW5zaW9uXVxuICAgICAgZWxzZSByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGlkeCl7XG4gICAgICAgIGVsID0gJCh0aGlzKVxuICAgICAgICBlbC5jc3MoZGltZW5zaW9uLCBmdW5jQXJnKHRoaXMsIHZhbHVlLCBpZHgsIGVsW2RpbWVuc2lvbl0oKSkpXG4gICAgICB9KVxuICAgIH1cbiAgfSlcblxuICBmdW5jdGlvbiB0cmF2ZXJzZU5vZGUobm9kZSwgZnVuKSB7XG4gICAgZnVuKG5vZGUpXG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IG5vZGUuY2hpbGROb2Rlcy5sZW5ndGg7IGkgPCBsZW47IGkrKylcbiAgICAgIHRyYXZlcnNlTm9kZShub2RlLmNoaWxkTm9kZXNbaV0sIGZ1bilcbiAgfVxuXG4gIC8vIEdlbmVyYXRlIHRoZSBgYWZ0ZXJgLCBgcHJlcGVuZGAsIGBiZWZvcmVgLCBgYXBwZW5kYCxcbiAgLy8gYGluc2VydEFmdGVyYCwgYGluc2VydEJlZm9yZWAsIGBhcHBlbmRUb2AsIGFuZCBgcHJlcGVuZFRvYCBtZXRob2RzLlxuICBhZGphY2VuY3lPcGVyYXRvcnMuZm9yRWFjaChmdW5jdGlvbihvcGVyYXRvciwgb3BlcmF0b3JJbmRleCkge1xuICAgIHZhciBpbnNpZGUgPSBvcGVyYXRvckluZGV4ICUgMiAvLz0+IHByZXBlbmQsIGFwcGVuZFxuXG4gICAgJC5mbltvcGVyYXRvcl0gPSBmdW5jdGlvbigpe1xuICAgICAgLy8gYXJndW1lbnRzIGNhbiBiZSBub2RlcywgYXJyYXlzIG9mIG5vZGVzLCBaZXB0byBvYmplY3RzIGFuZCBIVE1MIHN0cmluZ3NcbiAgICAgIHZhciBhcmdUeXBlLCBub2RlcyA9ICQubWFwKGFyZ3VtZW50cywgZnVuY3Rpb24oYXJnKSB7XG4gICAgICAgICAgICBhcmdUeXBlID0gdHlwZShhcmcpXG4gICAgICAgICAgICByZXR1cm4gYXJnVHlwZSA9PSBcIm9iamVjdFwiIHx8IGFyZ1R5cGUgPT0gXCJhcnJheVwiIHx8IGFyZyA9PSBudWxsID9cbiAgICAgICAgICAgICAgYXJnIDogemVwdG8uZnJhZ21lbnQoYXJnKVxuICAgICAgICAgIH0pLFxuICAgICAgICAgIHBhcmVudCwgY29weUJ5Q2xvbmUgPSB0aGlzLmxlbmd0aCA+IDFcbiAgICAgIGlmIChub2Rlcy5sZW5ndGggPCAxKSByZXR1cm4gdGhpc1xuXG4gICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKF8sIHRhcmdldCl7XG4gICAgICAgIHBhcmVudCA9IGluc2lkZSA/IHRhcmdldCA6IHRhcmdldC5wYXJlbnROb2RlXG5cbiAgICAgICAgLy8gY29udmVydCBhbGwgbWV0aG9kcyB0byBhIFwiYmVmb3JlXCIgb3BlcmF0aW9uXG4gICAgICAgIHRhcmdldCA9IG9wZXJhdG9ySW5kZXggPT0gMCA/IHRhcmdldC5uZXh0U2libGluZyA6XG4gICAgICAgICAgICAgICAgIG9wZXJhdG9ySW5kZXggPT0gMSA/IHRhcmdldC5maXJzdENoaWxkIDpcbiAgICAgICAgICAgICAgICAgb3BlcmF0b3JJbmRleCA9PSAyID8gdGFyZ2V0IDpcbiAgICAgICAgICAgICAgICAgbnVsbFxuXG4gICAgICAgIHZhciBwYXJlbnRJbkRvY3VtZW50ID0gJC5jb250YWlucyhkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsIHBhcmVudClcblxuICAgICAgICBub2Rlcy5mb3JFYWNoKGZ1bmN0aW9uKG5vZGUpe1xuICAgICAgICAgIGlmIChjb3B5QnlDbG9uZSkgbm9kZSA9IG5vZGUuY2xvbmVOb2RlKHRydWUpXG4gICAgICAgICAgZWxzZSBpZiAoIXBhcmVudCkgcmV0dXJuICQobm9kZSkucmVtb3ZlKClcblxuICAgICAgICAgIHBhcmVudC5pbnNlcnRCZWZvcmUobm9kZSwgdGFyZ2V0KVxuICAgICAgICAgIGlmIChwYXJlbnRJbkRvY3VtZW50KSB0cmF2ZXJzZU5vZGUobm9kZSwgZnVuY3Rpb24oZWwpe1xuICAgICAgICAgICAgaWYgKGVsLm5vZGVOYW1lICE9IG51bGwgJiYgZWwubm9kZU5hbWUudG9VcHBlckNhc2UoKSA9PT0gJ1NDUklQVCcgJiZcbiAgICAgICAgICAgICAgICghZWwudHlwZSB8fCBlbC50eXBlID09PSAndGV4dC9qYXZhc2NyaXB0JykgJiYgIWVsLnNyYylcbiAgICAgICAgICAgICAgd2luZG93WydldmFsJ10uY2FsbCh3aW5kb3csIGVsLmlubmVySFRNTClcbiAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgICAgfSlcbiAgICB9XG5cbiAgICAvLyBhZnRlciAgICA9PiBpbnNlcnRBZnRlclxuICAgIC8vIHByZXBlbmQgID0+IHByZXBlbmRUb1xuICAgIC8vIGJlZm9yZSAgID0+IGluc2VydEJlZm9yZVxuICAgIC8vIGFwcGVuZCAgID0+IGFwcGVuZFRvXG4gICAgJC5mbltpbnNpZGUgPyBvcGVyYXRvcisnVG8nIDogJ2luc2VydCcrKG9wZXJhdG9ySW5kZXggPyAnQmVmb3JlJyA6ICdBZnRlcicpXSA9IGZ1bmN0aW9uKGh0bWwpe1xuICAgICAgJChodG1sKVtvcGVyYXRvcl0odGhpcylcbiAgICAgIHJldHVybiB0aGlzXG4gICAgfVxuICB9KVxuXG4gIHplcHRvLloucHJvdG90eXBlID0gJC5mblxuXG4gIC8vIEV4cG9ydCBpbnRlcm5hbCBBUEkgZnVuY3Rpb25zIGluIHRoZSBgJC56ZXB0b2AgbmFtZXNwYWNlXG4gIHplcHRvLnVuaXEgPSB1bmlxXG4gIHplcHRvLmRlc2VyaWFsaXplVmFsdWUgPSBkZXNlcmlhbGl6ZVZhbHVlXG4gICQuemVwdG8gPSB6ZXB0b1xuXG4gIHJldHVybiAkXG59KSgpXG5cbndpbmRvdy5aZXB0byA9IFplcHRvXG53aW5kb3cuJCA9PT0gdW5kZWZpbmVkICYmICh3aW5kb3cuJCA9IFplcHRvKVxuXG4vLyBBZGRlZCBieSBnaXRodWIvaml5aW55aXlvbmcgdG8gY3JlYXRlIGFuIG5wbSBwYWNrYWdlXG5leHBvcnRzLlplcHRvID0gd2luZG93LlplcHRvXG5leHBvcnRzLiQgPSB3aW5kb3cuJFxuXG47KGZ1bmN0aW9uKCQpe1xuICB2YXIgX3ppZCA9IDEsIHVuZGVmaW5lZCxcbiAgICAgIHNsaWNlID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLFxuICAgICAgaXNGdW5jdGlvbiA9ICQuaXNGdW5jdGlvbixcbiAgICAgIGlzU3RyaW5nID0gZnVuY3Rpb24ob2JqKXsgcmV0dXJuIHR5cGVvZiBvYmogPT0gJ3N0cmluZycgfSxcbiAgICAgIGhhbmRsZXJzID0ge30sXG4gICAgICBzcGVjaWFsRXZlbnRzPXt9LFxuICAgICAgZm9jdXNpblN1cHBvcnRlZCA9ICdvbmZvY3VzaW4nIGluIHdpbmRvdyxcbiAgICAgIGZvY3VzID0geyBmb2N1czogJ2ZvY3VzaW4nLCBibHVyOiAnZm9jdXNvdXQnIH0sXG4gICAgICBob3ZlciA9IHsgbW91c2VlbnRlcjogJ21vdXNlb3ZlcicsIG1vdXNlbGVhdmU6ICdtb3VzZW91dCcgfVxuXG4gIHNwZWNpYWxFdmVudHMuY2xpY2sgPSBzcGVjaWFsRXZlbnRzLm1vdXNlZG93biA9IHNwZWNpYWxFdmVudHMubW91c2V1cCA9IHNwZWNpYWxFdmVudHMubW91c2Vtb3ZlID0gJ01vdXNlRXZlbnRzJ1xuXG4gIGZ1bmN0aW9uIHppZChlbGVtZW50KSB7XG4gICAgcmV0dXJuIGVsZW1lbnQuX3ppZCB8fCAoZWxlbWVudC5femlkID0gX3ppZCsrKVxuICB9XG4gIGZ1bmN0aW9uIGZpbmRIYW5kbGVycyhlbGVtZW50LCBldmVudCwgZm4sIHNlbGVjdG9yKSB7XG4gICAgZXZlbnQgPSBwYXJzZShldmVudClcbiAgICBpZiAoZXZlbnQubnMpIHZhciBtYXRjaGVyID0gbWF0Y2hlckZvcihldmVudC5ucylcbiAgICByZXR1cm4gKGhhbmRsZXJzW3ppZChlbGVtZW50KV0gfHwgW10pLmZpbHRlcihmdW5jdGlvbihoYW5kbGVyKSB7XG4gICAgICByZXR1cm4gaGFuZGxlclxuICAgICAgICAmJiAoIWV2ZW50LmUgIHx8IGhhbmRsZXIuZSA9PSBldmVudC5lKVxuICAgICAgICAmJiAoIWV2ZW50Lm5zIHx8IG1hdGNoZXIudGVzdChoYW5kbGVyLm5zKSlcbiAgICAgICAgJiYgKCFmbiAgICAgICB8fCB6aWQoaGFuZGxlci5mbikgPT09IHppZChmbikpXG4gICAgICAgICYmICghc2VsZWN0b3IgfHwgaGFuZGxlci5zZWwgPT0gc2VsZWN0b3IpXG4gICAgfSlcbiAgfVxuICBmdW5jdGlvbiBwYXJzZShldmVudCkge1xuICAgIHZhciBwYXJ0cyA9ICgnJyArIGV2ZW50KS5zcGxpdCgnLicpXG4gICAgcmV0dXJuIHtlOiBwYXJ0c1swXSwgbnM6IHBhcnRzLnNsaWNlKDEpLnNvcnQoKS5qb2luKCcgJyl9XG4gIH1cbiAgZnVuY3Rpb24gbWF0Y2hlckZvcihucykge1xuICAgIHJldHVybiBuZXcgUmVnRXhwKCcoPzpefCApJyArIG5zLnJlcGxhY2UoJyAnLCAnIC4qID8nKSArICcoPzogfCQpJylcbiAgfVxuXG4gIGZ1bmN0aW9uIGV2ZW50Q2FwdHVyZShoYW5kbGVyLCBjYXB0dXJlU2V0dGluZykge1xuICAgIHJldHVybiBoYW5kbGVyLmRlbCAmJlxuICAgICAgKCFmb2N1c2luU3VwcG9ydGVkICYmIChoYW5kbGVyLmUgaW4gZm9jdXMpKSB8fFxuICAgICAgISFjYXB0dXJlU2V0dGluZ1xuICB9XG5cbiAgZnVuY3Rpb24gcmVhbEV2ZW50KHR5cGUpIHtcbiAgICByZXR1cm4gaG92ZXJbdHlwZV0gfHwgKGZvY3VzaW5TdXBwb3J0ZWQgJiYgZm9jdXNbdHlwZV0pIHx8IHR5cGVcbiAgfVxuXG4gIGZ1bmN0aW9uIGFkZChlbGVtZW50LCBldmVudHMsIGZuLCBkYXRhLCBzZWxlY3RvciwgZGVsZWdhdG9yLCBjYXB0dXJlKXtcbiAgICB2YXIgaWQgPSB6aWQoZWxlbWVudCksIHNldCA9IChoYW5kbGVyc1tpZF0gfHwgKGhhbmRsZXJzW2lkXSA9IFtdKSlcbiAgICBldmVudHMuc3BsaXQoL1xccy8pLmZvckVhY2goZnVuY3Rpb24oZXZlbnQpe1xuICAgICAgaWYgKGV2ZW50ID09ICdyZWFkeScpIHJldHVybiAkKGRvY3VtZW50KS5yZWFkeShmbilcbiAgICAgIHZhciBoYW5kbGVyICAgPSBwYXJzZShldmVudClcbiAgICAgIGhhbmRsZXIuZm4gICAgPSBmblxuICAgICAgaGFuZGxlci5zZWwgICA9IHNlbGVjdG9yXG4gICAgICAvLyBlbXVsYXRlIG1vdXNlZW50ZXIsIG1vdXNlbGVhdmVcbiAgICAgIGlmIChoYW5kbGVyLmUgaW4gaG92ZXIpIGZuID0gZnVuY3Rpb24oZSl7XG4gICAgICAgIHZhciByZWxhdGVkID0gZS5yZWxhdGVkVGFyZ2V0XG4gICAgICAgIGlmICghcmVsYXRlZCB8fCAocmVsYXRlZCAhPT0gdGhpcyAmJiAhJC5jb250YWlucyh0aGlzLCByZWxhdGVkKSkpXG4gICAgICAgICAgcmV0dXJuIGhhbmRsZXIuZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKVxuICAgICAgfVxuICAgICAgaGFuZGxlci5kZWwgICA9IGRlbGVnYXRvclxuICAgICAgdmFyIGNhbGxiYWNrICA9IGRlbGVnYXRvciB8fCBmblxuICAgICAgaGFuZGxlci5wcm94eSA9IGZ1bmN0aW9uKGUpe1xuICAgICAgICBlID0gY29tcGF0aWJsZShlKVxuICAgICAgICBpZiAoZS5pc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZCgpKSByZXR1cm5cbiAgICAgICAgZS5kYXRhID0gZGF0YVxuICAgICAgICB2YXIgcmVzdWx0ID0gY2FsbGJhY2suYXBwbHkoZWxlbWVudCwgZS5fYXJncyA9PSB1bmRlZmluZWQgPyBbZV0gOiBbZV0uY29uY2F0KGUuX2FyZ3MpKVxuICAgICAgICBpZiAocmVzdWx0ID09PSBmYWxzZSkgZS5wcmV2ZW50RGVmYXVsdCgpLCBlLnN0b3BQcm9wYWdhdGlvbigpXG4gICAgICAgIHJldHVybiByZXN1bHRcbiAgICAgIH1cbiAgICAgIGhhbmRsZXIuaSA9IHNldC5sZW5ndGhcbiAgICAgIHNldC5wdXNoKGhhbmRsZXIpXG4gICAgICBpZiAoJ2FkZEV2ZW50TGlzdGVuZXInIGluIGVsZW1lbnQpXG4gICAgICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihyZWFsRXZlbnQoaGFuZGxlci5lKSwgaGFuZGxlci5wcm94eSwgZXZlbnRDYXB0dXJlKGhhbmRsZXIsIGNhcHR1cmUpKVxuICAgIH0pXG4gIH1cbiAgZnVuY3Rpb24gcmVtb3ZlKGVsZW1lbnQsIGV2ZW50cywgZm4sIHNlbGVjdG9yLCBjYXB0dXJlKXtcbiAgICB2YXIgaWQgPSB6aWQoZWxlbWVudClcbiAgICA7KGV2ZW50cyB8fCAnJykuc3BsaXQoL1xccy8pLmZvckVhY2goZnVuY3Rpb24oZXZlbnQpe1xuICAgICAgZmluZEhhbmRsZXJzKGVsZW1lbnQsIGV2ZW50LCBmbiwgc2VsZWN0b3IpLmZvckVhY2goZnVuY3Rpb24oaGFuZGxlcil7XG4gICAgICAgIGRlbGV0ZSBoYW5kbGVyc1tpZF1baGFuZGxlci5pXVxuICAgICAgaWYgKCdyZW1vdmVFdmVudExpc3RlbmVyJyBpbiBlbGVtZW50KVxuICAgICAgICBlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIocmVhbEV2ZW50KGhhbmRsZXIuZSksIGhhbmRsZXIucHJveHksIGV2ZW50Q2FwdHVyZShoYW5kbGVyLCBjYXB0dXJlKSlcbiAgICAgIH0pXG4gICAgfSlcbiAgfVxuXG4gICQuZXZlbnQgPSB7IGFkZDogYWRkLCByZW1vdmU6IHJlbW92ZSB9XG5cbiAgJC5wcm94eSA9IGZ1bmN0aW9uKGZuLCBjb250ZXh0KSB7XG4gICAgdmFyIGFyZ3MgPSAoMiBpbiBhcmd1bWVudHMpICYmIHNsaWNlLmNhbGwoYXJndW1lbnRzLCAyKVxuICAgIGlmIChpc0Z1bmN0aW9uKGZuKSkge1xuICAgICAgdmFyIHByb3h5Rm4gPSBmdW5jdGlvbigpeyByZXR1cm4gZm4uYXBwbHkoY29udGV4dCwgYXJncyA/IGFyZ3MuY29uY2F0KHNsaWNlLmNhbGwoYXJndW1lbnRzKSkgOiBhcmd1bWVudHMpIH1cbiAgICAgIHByb3h5Rm4uX3ppZCA9IHppZChmbilcbiAgICAgIHJldHVybiBwcm94eUZuXG4gICAgfSBlbHNlIGlmIChpc1N0cmluZyhjb250ZXh0KSkge1xuICAgICAgaWYgKGFyZ3MpIHtcbiAgICAgICAgYXJncy51bnNoaWZ0KGZuW2NvbnRleHRdLCBmbilcbiAgICAgICAgcmV0dXJuICQucHJveHkuYXBwbHkobnVsbCwgYXJncylcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiAkLnByb3h5KGZuW2NvbnRleHRdLCBmbilcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcImV4cGVjdGVkIGZ1bmN0aW9uXCIpXG4gICAgfVxuICB9XG5cbiAgJC5mbi5iaW5kID0gZnVuY3Rpb24oZXZlbnQsIGRhdGEsIGNhbGxiYWNrKXtcbiAgICByZXR1cm4gdGhpcy5vbihldmVudCwgZGF0YSwgY2FsbGJhY2spXG4gIH1cbiAgJC5mbi51bmJpbmQgPSBmdW5jdGlvbihldmVudCwgY2FsbGJhY2spe1xuICAgIHJldHVybiB0aGlzLm9mZihldmVudCwgY2FsbGJhY2spXG4gIH1cbiAgJC5mbi5vbmUgPSBmdW5jdGlvbihldmVudCwgc2VsZWN0b3IsIGRhdGEsIGNhbGxiYWNrKXtcbiAgICByZXR1cm4gdGhpcy5vbihldmVudCwgc2VsZWN0b3IsIGRhdGEsIGNhbGxiYWNrLCAxKVxuICB9XG5cbiAgdmFyIHJldHVyblRydWUgPSBmdW5jdGlvbigpe3JldHVybiB0cnVlfSxcbiAgICAgIHJldHVybkZhbHNlID0gZnVuY3Rpb24oKXtyZXR1cm4gZmFsc2V9LFxuICAgICAgaWdub3JlUHJvcGVydGllcyA9IC9eKFtBLVpdfHJldHVyblZhbHVlJHxsYXllcltYWV0kKS8sXG4gICAgICBldmVudE1ldGhvZHMgPSB7XG4gICAgICAgIHByZXZlbnREZWZhdWx0OiAnaXNEZWZhdWx0UHJldmVudGVkJyxcbiAgICAgICAgc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uOiAnaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQnLFxuICAgICAgICBzdG9wUHJvcGFnYXRpb246ICdpc1Byb3BhZ2F0aW9uU3RvcHBlZCdcbiAgICAgIH1cblxuICBmdW5jdGlvbiBjb21wYXRpYmxlKGV2ZW50LCBzb3VyY2UpIHtcbiAgICBpZiAoc291cmNlIHx8ICFldmVudC5pc0RlZmF1bHRQcmV2ZW50ZWQpIHtcbiAgICAgIHNvdXJjZSB8fCAoc291cmNlID0gZXZlbnQpXG5cbiAgICAgICQuZWFjaChldmVudE1ldGhvZHMsIGZ1bmN0aW9uKG5hbWUsIHByZWRpY2F0ZSkge1xuICAgICAgICB2YXIgc291cmNlTWV0aG9kID0gc291cmNlW25hbWVdXG4gICAgICAgIGV2ZW50W25hbWVdID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICB0aGlzW3ByZWRpY2F0ZV0gPSByZXR1cm5UcnVlXG4gICAgICAgICAgcmV0dXJuIHNvdXJjZU1ldGhvZCAmJiBzb3VyY2VNZXRob2QuYXBwbHkoc291cmNlLCBhcmd1bWVudHMpXG4gICAgICAgIH1cbiAgICAgICAgZXZlbnRbcHJlZGljYXRlXSA9IHJldHVybkZhbHNlXG4gICAgICB9KVxuXG4gICAgICBpZiAoc291cmNlLmRlZmF1bHRQcmV2ZW50ZWQgIT09IHVuZGVmaW5lZCA/IHNvdXJjZS5kZWZhdWx0UHJldmVudGVkIDpcbiAgICAgICAgICAncmV0dXJuVmFsdWUnIGluIHNvdXJjZSA/IHNvdXJjZS5yZXR1cm5WYWx1ZSA9PT0gZmFsc2UgOlxuICAgICAgICAgIHNvdXJjZS5nZXRQcmV2ZW50RGVmYXVsdCAmJiBzb3VyY2UuZ2V0UHJldmVudERlZmF1bHQoKSlcbiAgICAgICAgZXZlbnQuaXNEZWZhdWx0UHJldmVudGVkID0gcmV0dXJuVHJ1ZVxuICAgIH1cbiAgICByZXR1cm4gZXZlbnRcbiAgfVxuXG4gIGZ1bmN0aW9uIGNyZWF0ZVByb3h5KGV2ZW50KSB7XG4gICAgdmFyIGtleSwgcHJveHkgPSB7IG9yaWdpbmFsRXZlbnQ6IGV2ZW50IH1cbiAgICBmb3IgKGtleSBpbiBldmVudClcbiAgICAgIGlmICghaWdub3JlUHJvcGVydGllcy50ZXN0KGtleSkgJiYgZXZlbnRba2V5XSAhPT0gdW5kZWZpbmVkKSBwcm94eVtrZXldID0gZXZlbnRba2V5XVxuXG4gICAgcmV0dXJuIGNvbXBhdGlibGUocHJveHksIGV2ZW50KVxuICB9XG5cbiAgJC5mbi5kZWxlZ2F0ZSA9IGZ1bmN0aW9uKHNlbGVjdG9yLCBldmVudCwgY2FsbGJhY2spe1xuICAgIHJldHVybiB0aGlzLm9uKGV2ZW50LCBzZWxlY3RvciwgY2FsbGJhY2spXG4gIH1cbiAgJC5mbi51bmRlbGVnYXRlID0gZnVuY3Rpb24oc2VsZWN0b3IsIGV2ZW50LCBjYWxsYmFjayl7XG4gICAgcmV0dXJuIHRoaXMub2ZmKGV2ZW50LCBzZWxlY3RvciwgY2FsbGJhY2spXG4gIH1cblxuICAkLmZuLmxpdmUgPSBmdW5jdGlvbihldmVudCwgY2FsbGJhY2spe1xuICAgICQoZG9jdW1lbnQuYm9keSkuZGVsZWdhdGUodGhpcy5zZWxlY3RvciwgZXZlbnQsIGNhbGxiYWNrKVxuICAgIHJldHVybiB0aGlzXG4gIH1cbiAgJC5mbi5kaWUgPSBmdW5jdGlvbihldmVudCwgY2FsbGJhY2spe1xuICAgICQoZG9jdW1lbnQuYm9keSkudW5kZWxlZ2F0ZSh0aGlzLnNlbGVjdG9yLCBldmVudCwgY2FsbGJhY2spXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gICQuZm4ub24gPSBmdW5jdGlvbihldmVudCwgc2VsZWN0b3IsIGRhdGEsIGNhbGxiYWNrLCBvbmUpe1xuICAgIHZhciBhdXRvUmVtb3ZlLCBkZWxlZ2F0b3IsICR0aGlzID0gdGhpc1xuICAgIGlmIChldmVudCAmJiAhaXNTdHJpbmcoZXZlbnQpKSB7XG4gICAgICAkLmVhY2goZXZlbnQsIGZ1bmN0aW9uKHR5cGUsIGZuKXtcbiAgICAgICAgJHRoaXMub24odHlwZSwgc2VsZWN0b3IsIGRhdGEsIGZuLCBvbmUpXG4gICAgICB9KVxuICAgICAgcmV0dXJuICR0aGlzXG4gICAgfVxuXG4gICAgaWYgKCFpc1N0cmluZyhzZWxlY3RvcikgJiYgIWlzRnVuY3Rpb24oY2FsbGJhY2spICYmIGNhbGxiYWNrICE9PSBmYWxzZSlcbiAgICAgIGNhbGxiYWNrID0gZGF0YSwgZGF0YSA9IHNlbGVjdG9yLCBzZWxlY3RvciA9IHVuZGVmaW5lZFxuICAgIGlmIChpc0Z1bmN0aW9uKGRhdGEpIHx8IGRhdGEgPT09IGZhbHNlKVxuICAgICAgY2FsbGJhY2sgPSBkYXRhLCBkYXRhID0gdW5kZWZpbmVkXG5cbiAgICBpZiAoY2FsbGJhY2sgPT09IGZhbHNlKSBjYWxsYmFjayA9IHJldHVybkZhbHNlXG5cbiAgICByZXR1cm4gJHRoaXMuZWFjaChmdW5jdGlvbihfLCBlbGVtZW50KXtcbiAgICAgIGlmIChvbmUpIGF1dG9SZW1vdmUgPSBmdW5jdGlvbihlKXtcbiAgICAgICAgcmVtb3ZlKGVsZW1lbnQsIGUudHlwZSwgY2FsbGJhY2spXG4gICAgICAgIHJldHVybiBjYWxsYmFjay5hcHBseSh0aGlzLCBhcmd1bWVudHMpXG4gICAgICB9XG5cbiAgICAgIGlmIChzZWxlY3RvcikgZGVsZWdhdG9yID0gZnVuY3Rpb24oZSl7XG4gICAgICAgIHZhciBldnQsIG1hdGNoID0gJChlLnRhcmdldCkuY2xvc2VzdChzZWxlY3RvciwgZWxlbWVudCkuZ2V0KDApXG4gICAgICAgIGlmIChtYXRjaCAmJiBtYXRjaCAhPT0gZWxlbWVudCkge1xuICAgICAgICAgIGV2dCA9ICQuZXh0ZW5kKGNyZWF0ZVByb3h5KGUpLCB7Y3VycmVudFRhcmdldDogbWF0Y2gsIGxpdmVGaXJlZDogZWxlbWVudH0pXG4gICAgICAgICAgcmV0dXJuIChhdXRvUmVtb3ZlIHx8IGNhbGxiYWNrKS5hcHBseShtYXRjaCwgW2V2dF0uY29uY2F0KHNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSkpXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgYWRkKGVsZW1lbnQsIGV2ZW50LCBjYWxsYmFjaywgZGF0YSwgc2VsZWN0b3IsIGRlbGVnYXRvciB8fCBhdXRvUmVtb3ZlKVxuICAgIH0pXG4gIH1cbiAgJC5mbi5vZmYgPSBmdW5jdGlvbihldmVudCwgc2VsZWN0b3IsIGNhbGxiYWNrKXtcbiAgICB2YXIgJHRoaXMgPSB0aGlzXG4gICAgaWYgKGV2ZW50ICYmICFpc1N0cmluZyhldmVudCkpIHtcbiAgICAgICQuZWFjaChldmVudCwgZnVuY3Rpb24odHlwZSwgZm4pe1xuICAgICAgICAkdGhpcy5vZmYodHlwZSwgc2VsZWN0b3IsIGZuKVxuICAgICAgfSlcbiAgICAgIHJldHVybiAkdGhpc1xuICAgIH1cblxuICAgIGlmICghaXNTdHJpbmcoc2VsZWN0b3IpICYmICFpc0Z1bmN0aW9uKGNhbGxiYWNrKSAmJiBjYWxsYmFjayAhPT0gZmFsc2UpXG4gICAgICBjYWxsYmFjayA9IHNlbGVjdG9yLCBzZWxlY3RvciA9IHVuZGVmaW5lZFxuXG4gICAgaWYgKGNhbGxiYWNrID09PSBmYWxzZSkgY2FsbGJhY2sgPSByZXR1cm5GYWxzZVxuXG4gICAgcmV0dXJuICR0aGlzLmVhY2goZnVuY3Rpb24oKXtcbiAgICAgIHJlbW92ZSh0aGlzLCBldmVudCwgY2FsbGJhY2ssIHNlbGVjdG9yKVxuICAgIH0pXG4gIH1cblxuICAkLmZuLnRyaWdnZXIgPSBmdW5jdGlvbihldmVudCwgYXJncyl7XG4gICAgZXZlbnQgPSAoaXNTdHJpbmcoZXZlbnQpIHx8ICQuaXNQbGFpbk9iamVjdChldmVudCkpID8gJC5FdmVudChldmVudCkgOiBjb21wYXRpYmxlKGV2ZW50KVxuICAgIGV2ZW50Ll9hcmdzID0gYXJnc1xuICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtcbiAgICAgIC8vIGhhbmRsZSBmb2N1cygpLCBibHVyKCkgYnkgY2FsbGluZyB0aGVtIGRpcmVjdGx5XG4gICAgICBpZiAoZXZlbnQudHlwZSBpbiBmb2N1cyAmJiB0eXBlb2YgdGhpc1tldmVudC50eXBlXSA9PSBcImZ1bmN0aW9uXCIpIHRoaXNbZXZlbnQudHlwZV0oKVxuICAgICAgLy8gaXRlbXMgaW4gdGhlIGNvbGxlY3Rpb24gbWlnaHQgbm90IGJlIERPTSBlbGVtZW50c1xuICAgICAgZWxzZSBpZiAoJ2Rpc3BhdGNoRXZlbnQnIGluIHRoaXMpIHRoaXMuZGlzcGF0Y2hFdmVudChldmVudClcbiAgICAgIGVsc2UgJCh0aGlzKS50cmlnZ2VySGFuZGxlcihldmVudCwgYXJncylcbiAgICB9KVxuICB9XG5cbiAgLy8gdHJpZ2dlcnMgZXZlbnQgaGFuZGxlcnMgb24gY3VycmVudCBlbGVtZW50IGp1c3QgYXMgaWYgYW4gZXZlbnQgb2NjdXJyZWQsXG4gIC8vIGRvZXNuJ3QgdHJpZ2dlciBhbiBhY3R1YWwgZXZlbnQsIGRvZXNuJ3QgYnViYmxlXG4gICQuZm4udHJpZ2dlckhhbmRsZXIgPSBmdW5jdGlvbihldmVudCwgYXJncyl7XG4gICAgdmFyIGUsIHJlc3VsdFxuICAgIHRoaXMuZWFjaChmdW5jdGlvbihpLCBlbGVtZW50KXtcbiAgICAgIGUgPSBjcmVhdGVQcm94eShpc1N0cmluZyhldmVudCkgPyAkLkV2ZW50KGV2ZW50KSA6IGV2ZW50KVxuICAgICAgZS5fYXJncyA9IGFyZ3NcbiAgICAgIGUudGFyZ2V0ID0gZWxlbWVudFxuICAgICAgJC5lYWNoKGZpbmRIYW5kbGVycyhlbGVtZW50LCBldmVudC50eXBlIHx8IGV2ZW50KSwgZnVuY3Rpb24oaSwgaGFuZGxlcil7XG4gICAgICAgIHJlc3VsdCA9IGhhbmRsZXIucHJveHkoZSlcbiAgICAgICAgaWYgKGUuaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQoKSkgcmV0dXJuIGZhbHNlXG4gICAgICB9KVxuICAgIH0pXG4gICAgcmV0dXJuIHJlc3VsdFxuICB9XG5cbiAgLy8gc2hvcnRjdXQgbWV0aG9kcyBmb3IgYC5iaW5kKGV2ZW50LCBmbilgIGZvciBlYWNoIGV2ZW50IHR5cGVcbiAgOygnZm9jdXNpbiBmb2N1c291dCBmb2N1cyBibHVyIGxvYWQgcmVzaXplIHNjcm9sbCB1bmxvYWQgY2xpY2sgZGJsY2xpY2sgJytcbiAgJ21vdXNlZG93biBtb3VzZXVwIG1vdXNlbW92ZSBtb3VzZW92ZXIgbW91c2VvdXQgbW91c2VlbnRlciBtb3VzZWxlYXZlICcrXG4gICdjaGFuZ2Ugc2VsZWN0IGtleWRvd24ga2V5cHJlc3Mga2V5dXAgZXJyb3InKS5zcGxpdCgnICcpLmZvckVhY2goZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAkLmZuW2V2ZW50XSA9IGZ1bmN0aW9uKGNhbGxiYWNrKSB7XG4gICAgICByZXR1cm4gKDAgaW4gYXJndW1lbnRzKSA/XG4gICAgICAgIHRoaXMuYmluZChldmVudCwgY2FsbGJhY2spIDpcbiAgICAgICAgdGhpcy50cmlnZ2VyKGV2ZW50KVxuICAgIH1cbiAgfSlcblxuICAkLkV2ZW50ID0gZnVuY3Rpb24odHlwZSwgcHJvcHMpIHtcbiAgICBpZiAoIWlzU3RyaW5nKHR5cGUpKSBwcm9wcyA9IHR5cGUsIHR5cGUgPSBwcm9wcy50eXBlXG4gICAgdmFyIGV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoc3BlY2lhbEV2ZW50c1t0eXBlXSB8fCAnRXZlbnRzJyksIGJ1YmJsZXMgPSB0cnVlXG4gICAgaWYgKHByb3BzKSBmb3IgKHZhciBuYW1lIGluIHByb3BzKSAobmFtZSA9PSAnYnViYmxlcycpID8gKGJ1YmJsZXMgPSAhIXByb3BzW25hbWVdKSA6IChldmVudFtuYW1lXSA9IHByb3BzW25hbWVdKVxuICAgIGV2ZW50LmluaXRFdmVudCh0eXBlLCBidWJibGVzLCB0cnVlKVxuICAgIHJldHVybiBjb21wYXRpYmxlKGV2ZW50KVxuICB9XG5cbn0pKFplcHRvKVxuXG47KGZ1bmN0aW9uKCQpe1xuICB2YXIganNvbnBJRCA9IDAsXG4gICAgICBkb2N1bWVudCA9IHdpbmRvdy5kb2N1bWVudCxcbiAgICAgIGtleSxcbiAgICAgIG5hbWUsXG4gICAgICByc2NyaXB0ID0gLzxzY3JpcHRcXGJbXjxdKig/Oig/ITxcXC9zY3JpcHQ+KTxbXjxdKikqPFxcL3NjcmlwdD4vZ2ksXG4gICAgICBzY3JpcHRUeXBlUkUgPSAvXig/OnRleHR8YXBwbGljYXRpb24pXFwvamF2YXNjcmlwdC9pLFxuICAgICAgeG1sVHlwZVJFID0gL14oPzp0ZXh0fGFwcGxpY2F0aW9uKVxcL3htbC9pLFxuICAgICAganNvblR5cGUgPSAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICBodG1sVHlwZSA9ICd0ZXh0L2h0bWwnLFxuICAgICAgYmxhbmtSRSA9IC9eXFxzKiQvLFxuICAgICAgb3JpZ2luQW5jaG9yID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpXG5cbiAgb3JpZ2luQW5jaG9yLmhyZWYgPSB3aW5kb3cubG9jYXRpb24uaHJlZlxuXG4gIC8vIHRyaWdnZXIgYSBjdXN0b20gZXZlbnQgYW5kIHJldHVybiBmYWxzZSBpZiBpdCB3YXMgY2FuY2VsbGVkXG4gIGZ1bmN0aW9uIHRyaWdnZXJBbmRSZXR1cm4oY29udGV4dCwgZXZlbnROYW1lLCBkYXRhKSB7XG4gICAgdmFyIGV2ZW50ID0gJC5FdmVudChldmVudE5hbWUpXG4gICAgJChjb250ZXh0KS50cmlnZ2VyKGV2ZW50LCBkYXRhKVxuICAgIHJldHVybiAhZXZlbnQuaXNEZWZhdWx0UHJldmVudGVkKClcbiAgfVxuXG4gIC8vIHRyaWdnZXIgYW4gQWpheCBcImdsb2JhbFwiIGV2ZW50XG4gIGZ1bmN0aW9uIHRyaWdnZXJHbG9iYWwoc2V0dGluZ3MsIGNvbnRleHQsIGV2ZW50TmFtZSwgZGF0YSkge1xuICAgIGlmIChzZXR0aW5ncy5nbG9iYWwpIHJldHVybiB0cmlnZ2VyQW5kUmV0dXJuKGNvbnRleHQgfHwgZG9jdW1lbnQsIGV2ZW50TmFtZSwgZGF0YSlcbiAgfVxuXG4gIC8vIE51bWJlciBvZiBhY3RpdmUgQWpheCByZXF1ZXN0c1xuICAkLmFjdGl2ZSA9IDBcblxuICBmdW5jdGlvbiBhamF4U3RhcnQoc2V0dGluZ3MpIHtcbiAgICBpZiAoc2V0dGluZ3MuZ2xvYmFsICYmICQuYWN0aXZlKysgPT09IDApIHRyaWdnZXJHbG9iYWwoc2V0dGluZ3MsIG51bGwsICdhamF4U3RhcnQnKVxuICB9XG4gIGZ1bmN0aW9uIGFqYXhTdG9wKHNldHRpbmdzKSB7XG4gICAgaWYgKHNldHRpbmdzLmdsb2JhbCAmJiAhKC0tJC5hY3RpdmUpKSB0cmlnZ2VyR2xvYmFsKHNldHRpbmdzLCBudWxsLCAnYWpheFN0b3AnKVxuICB9XG5cbiAgLy8gdHJpZ2dlcnMgYW4gZXh0cmEgZ2xvYmFsIGV2ZW50IFwiYWpheEJlZm9yZVNlbmRcIiB0aGF0J3MgbGlrZSBcImFqYXhTZW5kXCIgYnV0IGNhbmNlbGFibGVcbiAgZnVuY3Rpb24gYWpheEJlZm9yZVNlbmQoeGhyLCBzZXR0aW5ncykge1xuICAgIHZhciBjb250ZXh0ID0gc2V0dGluZ3MuY29udGV4dFxuICAgIGlmIChzZXR0aW5ncy5iZWZvcmVTZW5kLmNhbGwoY29udGV4dCwgeGhyLCBzZXR0aW5ncykgPT09IGZhbHNlIHx8XG4gICAgICAgIHRyaWdnZXJHbG9iYWwoc2V0dGluZ3MsIGNvbnRleHQsICdhamF4QmVmb3JlU2VuZCcsIFt4aHIsIHNldHRpbmdzXSkgPT09IGZhbHNlKVxuICAgICAgcmV0dXJuIGZhbHNlXG5cbiAgICB0cmlnZ2VyR2xvYmFsKHNldHRpbmdzLCBjb250ZXh0LCAnYWpheFNlbmQnLCBbeGhyLCBzZXR0aW5nc10pXG4gIH1cbiAgZnVuY3Rpb24gYWpheFN1Y2Nlc3MoZGF0YSwgeGhyLCBzZXR0aW5ncywgZGVmZXJyZWQpIHtcbiAgICB2YXIgY29udGV4dCA9IHNldHRpbmdzLmNvbnRleHQsIHN0YXR1cyA9ICdzdWNjZXNzJ1xuICAgIHNldHRpbmdzLnN1Y2Nlc3MuY2FsbChjb250ZXh0LCBkYXRhLCBzdGF0dXMsIHhocilcbiAgICBpZiAoZGVmZXJyZWQpIGRlZmVycmVkLnJlc29sdmVXaXRoKGNvbnRleHQsIFtkYXRhLCBzdGF0dXMsIHhocl0pXG4gICAgdHJpZ2dlckdsb2JhbChzZXR0aW5ncywgY29udGV4dCwgJ2FqYXhTdWNjZXNzJywgW3hociwgc2V0dGluZ3MsIGRhdGFdKVxuICAgIGFqYXhDb21wbGV0ZShzdGF0dXMsIHhociwgc2V0dGluZ3MpXG4gIH1cbiAgLy8gdHlwZTogXCJ0aW1lb3V0XCIsIFwiZXJyb3JcIiwgXCJhYm9ydFwiLCBcInBhcnNlcmVycm9yXCJcbiAgZnVuY3Rpb24gYWpheEVycm9yKGVycm9yLCB0eXBlLCB4aHIsIHNldHRpbmdzLCBkZWZlcnJlZCkge1xuICAgIHZhciBjb250ZXh0ID0gc2V0dGluZ3MuY29udGV4dFxuICAgIHNldHRpbmdzLmVycm9yLmNhbGwoY29udGV4dCwgeGhyLCB0eXBlLCBlcnJvcilcbiAgICBpZiAoZGVmZXJyZWQpIGRlZmVycmVkLnJlamVjdFdpdGgoY29udGV4dCwgW3hociwgdHlwZSwgZXJyb3JdKVxuICAgIHRyaWdnZXJHbG9iYWwoc2V0dGluZ3MsIGNvbnRleHQsICdhamF4RXJyb3InLCBbeGhyLCBzZXR0aW5ncywgZXJyb3IgfHwgdHlwZV0pXG4gICAgYWpheENvbXBsZXRlKHR5cGUsIHhociwgc2V0dGluZ3MpXG4gIH1cbiAgLy8gc3RhdHVzOiBcInN1Y2Nlc3NcIiwgXCJub3Rtb2RpZmllZFwiLCBcImVycm9yXCIsIFwidGltZW91dFwiLCBcImFib3J0XCIsIFwicGFyc2VyZXJyb3JcIlxuICBmdW5jdGlvbiBhamF4Q29tcGxldGUoc3RhdHVzLCB4aHIsIHNldHRpbmdzKSB7XG4gICAgdmFyIGNvbnRleHQgPSBzZXR0aW5ncy5jb250ZXh0XG4gICAgc2V0dGluZ3MuY29tcGxldGUuY2FsbChjb250ZXh0LCB4aHIsIHN0YXR1cylcbiAgICB0cmlnZ2VyR2xvYmFsKHNldHRpbmdzLCBjb250ZXh0LCAnYWpheENvbXBsZXRlJywgW3hociwgc2V0dGluZ3NdKVxuICAgIGFqYXhTdG9wKHNldHRpbmdzKVxuICB9XG5cbiAgLy8gRW1wdHkgZnVuY3Rpb24sIHVzZWQgYXMgZGVmYXVsdCBjYWxsYmFja1xuICBmdW5jdGlvbiBlbXB0eSgpIHt9XG5cbiAgJC5hamF4SlNPTlAgPSBmdW5jdGlvbihvcHRpb25zLCBkZWZlcnJlZCl7XG4gICAgaWYgKCEoJ3R5cGUnIGluIG9wdGlvbnMpKSByZXR1cm4gJC5hamF4KG9wdGlvbnMpXG5cbiAgICB2YXIgX2NhbGxiYWNrTmFtZSA9IG9wdGlvbnMuanNvbnBDYWxsYmFjayxcbiAgICAgIGNhbGxiYWNrTmFtZSA9ICgkLmlzRnVuY3Rpb24oX2NhbGxiYWNrTmFtZSkgP1xuICAgICAgICBfY2FsbGJhY2tOYW1lKCkgOiBfY2FsbGJhY2tOYW1lKSB8fCAoJ2pzb25wJyArICgrK2pzb25wSUQpKSxcbiAgICAgIHNjcmlwdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpLFxuICAgICAgb3JpZ2luYWxDYWxsYmFjayA9IHdpbmRvd1tjYWxsYmFja05hbWVdLFxuICAgICAgcmVzcG9uc2VEYXRhLFxuICAgICAgYWJvcnQgPSBmdW5jdGlvbihlcnJvclR5cGUpIHtcbiAgICAgICAgJChzY3JpcHQpLnRyaWdnZXJIYW5kbGVyKCdlcnJvcicsIGVycm9yVHlwZSB8fCAnYWJvcnQnKVxuICAgICAgfSxcbiAgICAgIHhociA9IHsgYWJvcnQ6IGFib3J0IH0sIGFib3J0VGltZW91dFxuXG4gICAgaWYgKGRlZmVycmVkKSBkZWZlcnJlZC5wcm9taXNlKHhocilcblxuICAgICQoc2NyaXB0KS5vbignbG9hZCBlcnJvcicsIGZ1bmN0aW9uKGUsIGVycm9yVHlwZSl7XG4gICAgICBjbGVhclRpbWVvdXQoYWJvcnRUaW1lb3V0KVxuICAgICAgJChzY3JpcHQpLm9mZigpLnJlbW92ZSgpXG5cbiAgICAgIGlmIChlLnR5cGUgPT0gJ2Vycm9yJyB8fCAhcmVzcG9uc2VEYXRhKSB7XG4gICAgICAgIGFqYXhFcnJvcihudWxsLCBlcnJvclR5cGUgfHwgJ2Vycm9yJywgeGhyLCBvcHRpb25zLCBkZWZlcnJlZClcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGFqYXhTdWNjZXNzKHJlc3BvbnNlRGF0YVswXSwgeGhyLCBvcHRpb25zLCBkZWZlcnJlZClcbiAgICAgIH1cblxuICAgICAgd2luZG93W2NhbGxiYWNrTmFtZV0gPSBvcmlnaW5hbENhbGxiYWNrXG4gICAgICBpZiAocmVzcG9uc2VEYXRhICYmICQuaXNGdW5jdGlvbihvcmlnaW5hbENhbGxiYWNrKSlcbiAgICAgICAgb3JpZ2luYWxDYWxsYmFjayhyZXNwb25zZURhdGFbMF0pXG5cbiAgICAgIG9yaWdpbmFsQ2FsbGJhY2sgPSByZXNwb25zZURhdGEgPSB1bmRlZmluZWRcbiAgICB9KVxuXG4gICAgaWYgKGFqYXhCZWZvcmVTZW5kKHhociwgb3B0aW9ucykgPT09IGZhbHNlKSB7XG4gICAgICBhYm9ydCgnYWJvcnQnKVxuICAgICAgcmV0dXJuIHhoclxuICAgIH1cblxuICAgIHdpbmRvd1tjYWxsYmFja05hbWVdID0gZnVuY3Rpb24oKXtcbiAgICAgIHJlc3BvbnNlRGF0YSA9IGFyZ3VtZW50c1xuICAgIH1cblxuICAgIHNjcmlwdC5zcmMgPSBvcHRpb25zLnVybC5yZXBsYWNlKC9cXD8oLispPVxcPy8sICc/JDE9JyArIGNhbGxiYWNrTmFtZSlcbiAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHNjcmlwdClcblxuICAgIGlmIChvcHRpb25zLnRpbWVvdXQgPiAwKSBhYm9ydFRpbWVvdXQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICBhYm9ydCgndGltZW91dCcpXG4gICAgfSwgb3B0aW9ucy50aW1lb3V0KVxuXG4gICAgcmV0dXJuIHhoclxuICB9XG5cbiAgJC5hamF4U2V0dGluZ3MgPSB7XG4gICAgLy8gRGVmYXVsdCB0eXBlIG9mIHJlcXVlc3RcbiAgICB0eXBlOiAnR0VUJyxcbiAgICAvLyBDYWxsYmFjayB0aGF0IGlzIGV4ZWN1dGVkIGJlZm9yZSByZXF1ZXN0XG4gICAgYmVmb3JlU2VuZDogZW1wdHksXG4gICAgLy8gQ2FsbGJhY2sgdGhhdCBpcyBleGVjdXRlZCBpZiB0aGUgcmVxdWVzdCBzdWNjZWVkc1xuICAgIHN1Y2Nlc3M6IGVtcHR5LFxuICAgIC8vIENhbGxiYWNrIHRoYXQgaXMgZXhlY3V0ZWQgdGhlIHRoZSBzZXJ2ZXIgZHJvcHMgZXJyb3JcbiAgICBlcnJvcjogZW1wdHksXG4gICAgLy8gQ2FsbGJhY2sgdGhhdCBpcyBleGVjdXRlZCBvbiByZXF1ZXN0IGNvbXBsZXRlIChib3RoOiBlcnJvciBhbmQgc3VjY2VzcylcbiAgICBjb21wbGV0ZTogZW1wdHksXG4gICAgLy8gVGhlIGNvbnRleHQgZm9yIHRoZSBjYWxsYmFja3NcbiAgICBjb250ZXh0OiBudWxsLFxuICAgIC8vIFdoZXRoZXIgdG8gdHJpZ2dlciBcImdsb2JhbFwiIEFqYXggZXZlbnRzXG4gICAgZ2xvYmFsOiB0cnVlLFxuICAgIC8vIFRyYW5zcG9ydFxuICAgIHhocjogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIG5ldyB3aW5kb3cuWE1MSHR0cFJlcXVlc3QoKVxuICAgIH0sXG4gICAgLy8gTUlNRSB0eXBlcyBtYXBwaW5nXG4gICAgLy8gSUlTIHJldHVybnMgSmF2YXNjcmlwdCBhcyBcImFwcGxpY2F0aW9uL3gtamF2YXNjcmlwdFwiXG4gICAgYWNjZXB0czoge1xuICAgICAgc2NyaXB0OiAndGV4dC9qYXZhc2NyaXB0LCBhcHBsaWNhdGlvbi9qYXZhc2NyaXB0LCBhcHBsaWNhdGlvbi94LWphdmFzY3JpcHQnLFxuICAgICAganNvbjogICBqc29uVHlwZSxcbiAgICAgIHhtbDogICAgJ2FwcGxpY2F0aW9uL3htbCwgdGV4dC94bWwnLFxuICAgICAgaHRtbDogICBodG1sVHlwZSxcbiAgICAgIHRleHQ6ICAgJ3RleHQvcGxhaW4nXG4gICAgfSxcbiAgICAvLyBXaGV0aGVyIHRoZSByZXF1ZXN0IGlzIHRvIGFub3RoZXIgZG9tYWluXG4gICAgY3Jvc3NEb21haW46IGZhbHNlLFxuICAgIC8vIERlZmF1bHQgdGltZW91dFxuICAgIHRpbWVvdXQ6IDAsXG4gICAgLy8gV2hldGhlciBkYXRhIHNob3VsZCBiZSBzZXJpYWxpemVkIHRvIHN0cmluZ1xuICAgIHByb2Nlc3NEYXRhOiB0cnVlLFxuICAgIC8vIFdoZXRoZXIgdGhlIGJyb3dzZXIgc2hvdWxkIGJlIGFsbG93ZWQgdG8gY2FjaGUgR0VUIHJlc3BvbnNlc1xuICAgIGNhY2hlOiB0cnVlXG4gIH1cblxuICBmdW5jdGlvbiBtaW1lVG9EYXRhVHlwZShtaW1lKSB7XG4gICAgaWYgKG1pbWUpIG1pbWUgPSBtaW1lLnNwbGl0KCc7JywgMilbMF1cbiAgICByZXR1cm4gbWltZSAmJiAoIG1pbWUgPT0gaHRtbFR5cGUgPyAnaHRtbCcgOlxuICAgICAgbWltZSA9PSBqc29uVHlwZSA/ICdqc29uJyA6XG4gICAgICBzY3JpcHRUeXBlUkUudGVzdChtaW1lKSA/ICdzY3JpcHQnIDpcbiAgICAgIHhtbFR5cGVSRS50ZXN0KG1pbWUpICYmICd4bWwnICkgfHwgJ3RleHQnXG4gIH1cblxuICBmdW5jdGlvbiBhcHBlbmRRdWVyeSh1cmwsIHF1ZXJ5KSB7XG4gICAgaWYgKHF1ZXJ5ID09ICcnKSByZXR1cm4gdXJsXG4gICAgcmV0dXJuICh1cmwgKyAnJicgKyBxdWVyeSkucmVwbGFjZSgvWyY/XXsxLDJ9LywgJz8nKVxuICB9XG5cbiAgLy8gc2VyaWFsaXplIHBheWxvYWQgYW5kIGFwcGVuZCBpdCB0byB0aGUgVVJMIGZvciBHRVQgcmVxdWVzdHNcbiAgZnVuY3Rpb24gc2VyaWFsaXplRGF0YShvcHRpb25zKSB7XG4gICAgaWYgKG9wdGlvbnMucHJvY2Vzc0RhdGEgJiYgb3B0aW9ucy5kYXRhICYmICQudHlwZShvcHRpb25zLmRhdGEpICE9IFwic3RyaW5nXCIpXG4gICAgICBvcHRpb25zLmRhdGEgPSAkLnBhcmFtKG9wdGlvbnMuZGF0YSwgb3B0aW9ucy50cmFkaXRpb25hbClcbiAgICBpZiAob3B0aW9ucy5kYXRhICYmICghb3B0aW9ucy50eXBlIHx8IG9wdGlvbnMudHlwZS50b1VwcGVyQ2FzZSgpID09ICdHRVQnKSlcbiAgICAgIG9wdGlvbnMudXJsID0gYXBwZW5kUXVlcnkob3B0aW9ucy51cmwsIG9wdGlvbnMuZGF0YSksIG9wdGlvbnMuZGF0YSA9IHVuZGVmaW5lZFxuICB9XG5cbiAgJC5hamF4ID0gZnVuY3Rpb24ob3B0aW9ucyl7XG4gICAgdmFyIHNldHRpbmdzID0gJC5leHRlbmQoe30sIG9wdGlvbnMgfHwge30pLFxuICAgICAgICBkZWZlcnJlZCA9ICQuRGVmZXJyZWQgJiYgJC5EZWZlcnJlZCgpLFxuICAgICAgICB1cmxBbmNob3JcbiAgICBmb3IgKGtleSBpbiAkLmFqYXhTZXR0aW5ncykgaWYgKHNldHRpbmdzW2tleV0gPT09IHVuZGVmaW5lZCkgc2V0dGluZ3Nba2V5XSA9ICQuYWpheFNldHRpbmdzW2tleV1cblxuICAgIGFqYXhTdGFydChzZXR0aW5ncylcblxuICAgIGlmICghc2V0dGluZ3MuY3Jvc3NEb21haW4pIHtcbiAgICAgIHVybEFuY2hvciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKVxuICAgICAgdXJsQW5jaG9yLmhyZWYgPSBzZXR0aW5ncy51cmxcbiAgICAgIHVybEFuY2hvci5ocmVmID0gdXJsQW5jaG9yLmhyZWZcbiAgICAgIHNldHRpbmdzLmNyb3NzRG9tYWluID0gKG9yaWdpbkFuY2hvci5wcm90b2NvbCArICcvLycgKyBvcmlnaW5BbmNob3IuaG9zdCkgIT09ICh1cmxBbmNob3IucHJvdG9jb2wgKyAnLy8nICsgdXJsQW5jaG9yLmhvc3QpXG4gICAgfVxuXG4gICAgaWYgKCFzZXR0aW5ncy51cmwpIHNldHRpbmdzLnVybCA9IHdpbmRvdy5sb2NhdGlvbi50b1N0cmluZygpXG4gICAgc2VyaWFsaXplRGF0YShzZXR0aW5ncylcblxuICAgIHZhciBkYXRhVHlwZSA9IHNldHRpbmdzLmRhdGFUeXBlLCBoYXNQbGFjZWhvbGRlciA9IC9cXD8uKz1cXD8vLnRlc3Qoc2V0dGluZ3MudXJsKVxuICAgIGlmIChoYXNQbGFjZWhvbGRlcikgZGF0YVR5cGUgPSAnanNvbnAnXG5cbiAgICBpZiAoc2V0dGluZ3MuY2FjaGUgPT09IGZhbHNlIHx8IChcbiAgICAgICAgICghb3B0aW9ucyB8fCBvcHRpb25zLmNhY2hlICE9PSB0cnVlKSAmJlxuICAgICAgICAgKCdzY3JpcHQnID09IGRhdGFUeXBlIHx8ICdqc29ucCcgPT0gZGF0YVR5cGUpXG4gICAgICAgICkpXG4gICAgICBzZXR0aW5ncy51cmwgPSBhcHBlbmRRdWVyeShzZXR0aW5ncy51cmwsICdfPScgKyBEYXRlLm5vdygpKVxuXG4gICAgaWYgKCdqc29ucCcgPT0gZGF0YVR5cGUpIHtcbiAgICAgIGlmICghaGFzUGxhY2Vob2xkZXIpXG4gICAgICAgIHNldHRpbmdzLnVybCA9IGFwcGVuZFF1ZXJ5KHNldHRpbmdzLnVybCxcbiAgICAgICAgICBzZXR0aW5ncy5qc29ucCA/IChzZXR0aW5ncy5qc29ucCArICc9PycpIDogc2V0dGluZ3MuanNvbnAgPT09IGZhbHNlID8gJycgOiAnY2FsbGJhY2s9PycpXG4gICAgICByZXR1cm4gJC5hamF4SlNPTlAoc2V0dGluZ3MsIGRlZmVycmVkKVxuICAgIH1cblxuICAgIHZhciBtaW1lID0gc2V0dGluZ3MuYWNjZXB0c1tkYXRhVHlwZV0sXG4gICAgICAgIGhlYWRlcnMgPSB7IH0sXG4gICAgICAgIHNldEhlYWRlciA9IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7IGhlYWRlcnNbbmFtZS50b0xvd2VyQ2FzZSgpXSA9IFtuYW1lLCB2YWx1ZV0gfSxcbiAgICAgICAgcHJvdG9jb2wgPSAvXihbXFx3LV0rOilcXC9cXC8vLnRlc3Qoc2V0dGluZ3MudXJsKSA/IFJlZ0V4cC4kMSA6IHdpbmRvdy5sb2NhdGlvbi5wcm90b2NvbCxcbiAgICAgICAgeGhyID0gc2V0dGluZ3MueGhyKCksXG4gICAgICAgIG5hdGl2ZVNldEhlYWRlciA9IHhoci5zZXRSZXF1ZXN0SGVhZGVyLFxuICAgICAgICBhYm9ydFRpbWVvdXRcblxuICAgIGlmIChkZWZlcnJlZCkgZGVmZXJyZWQucHJvbWlzZSh4aHIpXG5cbiAgICBpZiAoIXNldHRpbmdzLmNyb3NzRG9tYWluKSBzZXRIZWFkZXIoJ1gtUmVxdWVzdGVkLVdpdGgnLCAnWE1MSHR0cFJlcXVlc3QnKVxuICAgIHNldEhlYWRlcignQWNjZXB0JywgbWltZSB8fCAnKi8qJylcbiAgICBpZiAobWltZSA9IHNldHRpbmdzLm1pbWVUeXBlIHx8IG1pbWUpIHtcbiAgICAgIGlmIChtaW1lLmluZGV4T2YoJywnKSA+IC0xKSBtaW1lID0gbWltZS5zcGxpdCgnLCcsIDIpWzBdXG4gICAgICB4aHIub3ZlcnJpZGVNaW1lVHlwZSAmJiB4aHIub3ZlcnJpZGVNaW1lVHlwZShtaW1lKVxuICAgIH1cbiAgICBpZiAoc2V0dGluZ3MuY29udGVudFR5cGUgfHwgKHNldHRpbmdzLmNvbnRlbnRUeXBlICE9PSBmYWxzZSAmJiBzZXR0aW5ncy5kYXRhICYmIHNldHRpbmdzLnR5cGUudG9VcHBlckNhc2UoKSAhPSAnR0VUJykpXG4gICAgICBzZXRIZWFkZXIoJ0NvbnRlbnQtVHlwZScsIHNldHRpbmdzLmNvbnRlbnRUeXBlIHx8ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnKVxuXG4gICAgaWYgKHNldHRpbmdzLmhlYWRlcnMpIGZvciAobmFtZSBpbiBzZXR0aW5ncy5oZWFkZXJzKSBzZXRIZWFkZXIobmFtZSwgc2V0dGluZ3MuaGVhZGVyc1tuYW1lXSlcbiAgICB4aHIuc2V0UmVxdWVzdEhlYWRlciA9IHNldEhlYWRlclxuXG4gICAgeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCl7XG4gICAgICBpZiAoeGhyLnJlYWR5U3RhdGUgPT0gNCkge1xuICAgICAgICB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gZW1wdHlcbiAgICAgICAgY2xlYXJUaW1lb3V0KGFib3J0VGltZW91dClcbiAgICAgICAgdmFyIHJlc3VsdCwgZXJyb3IgPSBmYWxzZVxuICAgICAgICBpZiAoKHhoci5zdGF0dXMgPj0gMjAwICYmIHhoci5zdGF0dXMgPCAzMDApIHx8IHhoci5zdGF0dXMgPT0gMzA0IHx8ICh4aHIuc3RhdHVzID09IDAgJiYgcHJvdG9jb2wgPT0gJ2ZpbGU6JykpIHtcbiAgICAgICAgICBkYXRhVHlwZSA9IGRhdGFUeXBlIHx8IG1pbWVUb0RhdGFUeXBlKHNldHRpbmdzLm1pbWVUeXBlIHx8IHhoci5nZXRSZXNwb25zZUhlYWRlcignY29udGVudC10eXBlJykpXG4gICAgICAgICAgcmVzdWx0ID0geGhyLnJlc3BvbnNlVGV4dFxuXG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIGh0dHA6Ly9wZXJmZWN0aW9ua2lsbHMuY29tL2dsb2JhbC1ldmFsLXdoYXQtYXJlLXRoZS1vcHRpb25zL1xuICAgICAgICAgICAgaWYgKGRhdGFUeXBlID09ICdzY3JpcHQnKSAgICAoMSxldmFsKShyZXN1bHQpXG4gICAgICAgICAgICBlbHNlIGlmIChkYXRhVHlwZSA9PSAneG1sJykgIHJlc3VsdCA9IHhoci5yZXNwb25zZVhNTFxuICAgICAgICAgICAgZWxzZSBpZiAoZGF0YVR5cGUgPT0gJ2pzb24nKSByZXN1bHQgPSBibGFua1JFLnRlc3QocmVzdWx0KSA/IG51bGwgOiAkLnBhcnNlSlNPTihyZXN1bHQpXG4gICAgICAgICAgfSBjYXRjaCAoZSkgeyBlcnJvciA9IGUgfVxuXG4gICAgICAgICAgaWYgKGVycm9yKSBhamF4RXJyb3IoZXJyb3IsICdwYXJzZXJlcnJvcicsIHhociwgc2V0dGluZ3MsIGRlZmVycmVkKVxuICAgICAgICAgIGVsc2UgYWpheFN1Y2Nlc3MocmVzdWx0LCB4aHIsIHNldHRpbmdzLCBkZWZlcnJlZClcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBhamF4RXJyb3IoeGhyLnN0YXR1c1RleHQgfHwgbnVsbCwgeGhyLnN0YXR1cyA/ICdlcnJvcicgOiAnYWJvcnQnLCB4aHIsIHNldHRpbmdzLCBkZWZlcnJlZClcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChhamF4QmVmb3JlU2VuZCh4aHIsIHNldHRpbmdzKSA9PT0gZmFsc2UpIHtcbiAgICAgIHhoci5hYm9ydCgpXG4gICAgICBhamF4RXJyb3IobnVsbCwgJ2Fib3J0JywgeGhyLCBzZXR0aW5ncywgZGVmZXJyZWQpXG4gICAgICByZXR1cm4geGhyXG4gICAgfVxuXG4gICAgaWYgKHNldHRpbmdzLnhockZpZWxkcykgZm9yIChuYW1lIGluIHNldHRpbmdzLnhockZpZWxkcykgeGhyW25hbWVdID0gc2V0dGluZ3MueGhyRmllbGRzW25hbWVdXG5cbiAgICB2YXIgYXN5bmMgPSAnYXN5bmMnIGluIHNldHRpbmdzID8gc2V0dGluZ3MuYXN5bmMgOiB0cnVlXG4gICAgeGhyLm9wZW4oc2V0dGluZ3MudHlwZSwgc2V0dGluZ3MudXJsLCBhc3luYywgc2V0dGluZ3MudXNlcm5hbWUsIHNldHRpbmdzLnBhc3N3b3JkKVxuXG4gICAgZm9yIChuYW1lIGluIGhlYWRlcnMpIG5hdGl2ZVNldEhlYWRlci5hcHBseSh4aHIsIGhlYWRlcnNbbmFtZV0pXG5cbiAgICBpZiAoc2V0dGluZ3MudGltZW91dCA+IDApIGFib3J0VGltZW91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGVtcHR5XG4gICAgICAgIHhoci5hYm9ydCgpXG4gICAgICAgIGFqYXhFcnJvcihudWxsLCAndGltZW91dCcsIHhociwgc2V0dGluZ3MsIGRlZmVycmVkKVxuICAgICAgfSwgc2V0dGluZ3MudGltZW91dClcblxuICAgIC8vIGF2b2lkIHNlbmRpbmcgZW1wdHkgc3RyaW5nICgjMzE5KVxuICAgIHhoci5zZW5kKHNldHRpbmdzLmRhdGEgPyBzZXR0aW5ncy5kYXRhIDogbnVsbClcbiAgICByZXR1cm4geGhyXG4gIH1cblxuICAvLyBoYW5kbGUgb3B0aW9uYWwgZGF0YS9zdWNjZXNzIGFyZ3VtZW50c1xuICBmdW5jdGlvbiBwYXJzZUFyZ3VtZW50cyh1cmwsIGRhdGEsIHN1Y2Nlc3MsIGRhdGFUeXBlKSB7XG4gICAgaWYgKCQuaXNGdW5jdGlvbihkYXRhKSkgZGF0YVR5cGUgPSBzdWNjZXNzLCBzdWNjZXNzID0gZGF0YSwgZGF0YSA9IHVuZGVmaW5lZFxuICAgIGlmICghJC5pc0Z1bmN0aW9uKHN1Y2Nlc3MpKSBkYXRhVHlwZSA9IHN1Y2Nlc3MsIHN1Y2Nlc3MgPSB1bmRlZmluZWRcbiAgICByZXR1cm4ge1xuICAgICAgdXJsOiB1cmxcbiAgICAsIGRhdGE6IGRhdGFcbiAgICAsIHN1Y2Nlc3M6IHN1Y2Nlc3NcbiAgICAsIGRhdGFUeXBlOiBkYXRhVHlwZVxuICAgIH1cbiAgfVxuXG4gICQuZ2V0ID0gZnVuY3Rpb24oLyogdXJsLCBkYXRhLCBzdWNjZXNzLCBkYXRhVHlwZSAqLyl7XG4gICAgcmV0dXJuICQuYWpheChwYXJzZUFyZ3VtZW50cy5hcHBseShudWxsLCBhcmd1bWVudHMpKVxuICB9XG5cbiAgJC5wb3N0ID0gZnVuY3Rpb24oLyogdXJsLCBkYXRhLCBzdWNjZXNzLCBkYXRhVHlwZSAqLyl7XG4gICAgdmFyIG9wdGlvbnMgPSBwYXJzZUFyZ3VtZW50cy5hcHBseShudWxsLCBhcmd1bWVudHMpXG4gICAgb3B0aW9ucy50eXBlID0gJ1BPU1QnXG4gICAgcmV0dXJuICQuYWpheChvcHRpb25zKVxuICB9XG5cbiAgJC5nZXRKU09OID0gZnVuY3Rpb24oLyogdXJsLCBkYXRhLCBzdWNjZXNzICovKXtcbiAgICB2YXIgb3B0aW9ucyA9IHBhcnNlQXJndW1lbnRzLmFwcGx5KG51bGwsIGFyZ3VtZW50cylcbiAgICBvcHRpb25zLmRhdGFUeXBlID0gJ2pzb24nXG4gICAgcmV0dXJuICQuYWpheChvcHRpb25zKVxuICB9XG5cbiAgJC5mbi5sb2FkID0gZnVuY3Rpb24odXJsLCBkYXRhLCBzdWNjZXNzKXtcbiAgICBpZiAoIXRoaXMubGVuZ3RoKSByZXR1cm4gdGhpc1xuICAgIHZhciBzZWxmID0gdGhpcywgcGFydHMgPSB1cmwuc3BsaXQoL1xccy8pLCBzZWxlY3RvcixcbiAgICAgICAgb3B0aW9ucyA9IHBhcnNlQXJndW1lbnRzKHVybCwgZGF0YSwgc3VjY2VzcyksXG4gICAgICAgIGNhbGxiYWNrID0gb3B0aW9ucy5zdWNjZXNzXG4gICAgaWYgKHBhcnRzLmxlbmd0aCA+IDEpIG9wdGlvbnMudXJsID0gcGFydHNbMF0sIHNlbGVjdG9yID0gcGFydHNbMV1cbiAgICBvcHRpb25zLnN1Y2Nlc3MgPSBmdW5jdGlvbihyZXNwb25zZSl7XG4gICAgICBzZWxmLmh0bWwoc2VsZWN0b3IgP1xuICAgICAgICAkKCc8ZGl2PicpLmh0bWwocmVzcG9uc2UucmVwbGFjZShyc2NyaXB0LCBcIlwiKSkuZmluZChzZWxlY3RvcilcbiAgICAgICAgOiByZXNwb25zZSlcbiAgICAgIGNhbGxiYWNrICYmIGNhbGxiYWNrLmFwcGx5KHNlbGYsIGFyZ3VtZW50cylcbiAgICB9XG4gICAgJC5hamF4KG9wdGlvbnMpXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIHZhciBlc2NhcGUgPSBlbmNvZGVVUklDb21wb25lbnRcblxuICBmdW5jdGlvbiBzZXJpYWxpemUocGFyYW1zLCBvYmosIHRyYWRpdGlvbmFsLCBzY29wZSl7XG4gICAgdmFyIHR5cGUsIGFycmF5ID0gJC5pc0FycmF5KG9iaiksIGhhc2ggPSAkLmlzUGxhaW5PYmplY3Qob2JqKVxuICAgICQuZWFjaChvYmosIGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcbiAgICAgIHR5cGUgPSAkLnR5cGUodmFsdWUpXG4gICAgICBpZiAoc2NvcGUpIGtleSA9IHRyYWRpdGlvbmFsID8gc2NvcGUgOlxuICAgICAgICBzY29wZSArICdbJyArIChoYXNoIHx8IHR5cGUgPT0gJ29iamVjdCcgfHwgdHlwZSA9PSAnYXJyYXknID8ga2V5IDogJycpICsgJ10nXG4gICAgICAvLyBoYW5kbGUgZGF0YSBpbiBzZXJpYWxpemVBcnJheSgpIGZvcm1hdFxuICAgICAgaWYgKCFzY29wZSAmJiBhcnJheSkgcGFyYW1zLmFkZCh2YWx1ZS5uYW1lLCB2YWx1ZS52YWx1ZSlcbiAgICAgIC8vIHJlY3Vyc2UgaW50byBuZXN0ZWQgb2JqZWN0c1xuICAgICAgZWxzZSBpZiAodHlwZSA9PSBcImFycmF5XCIgfHwgKCF0cmFkaXRpb25hbCAmJiB0eXBlID09IFwib2JqZWN0XCIpKVxuICAgICAgICBzZXJpYWxpemUocGFyYW1zLCB2YWx1ZSwgdHJhZGl0aW9uYWwsIGtleSlcbiAgICAgIGVsc2UgcGFyYW1zLmFkZChrZXksIHZhbHVlKVxuICAgIH0pXG4gIH1cblxuICAkLnBhcmFtID0gZnVuY3Rpb24ob2JqLCB0cmFkaXRpb25hbCl7XG4gICAgdmFyIHBhcmFtcyA9IFtdXG4gICAgcGFyYW1zLmFkZCA9IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcbiAgICAgIGlmICgkLmlzRnVuY3Rpb24odmFsdWUpKSB2YWx1ZSA9IHZhbHVlKClcbiAgICAgIGlmICh2YWx1ZSA9PSBudWxsKSB2YWx1ZSA9IFwiXCJcbiAgICAgIHRoaXMucHVzaChlc2NhcGUoa2V5KSArICc9JyArIGVzY2FwZSh2YWx1ZSkpXG4gICAgfVxuICAgIHNlcmlhbGl6ZShwYXJhbXMsIG9iaiwgdHJhZGl0aW9uYWwpXG4gICAgcmV0dXJuIHBhcmFtcy5qb2luKCcmJykucmVwbGFjZSgvJTIwL2csICcrJylcbiAgfVxufSkoWmVwdG8pXG5cbjsoZnVuY3Rpb24oJCl7XG4gICQuZm4uc2VyaWFsaXplQXJyYXkgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgbmFtZSwgdHlwZSwgcmVzdWx0ID0gW10sXG4gICAgICBhZGQgPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUuZm9yRWFjaCkgcmV0dXJuIHZhbHVlLmZvckVhY2goYWRkKVxuICAgICAgICByZXN1bHQucHVzaCh7IG5hbWU6IG5hbWUsIHZhbHVlOiB2YWx1ZSB9KVxuICAgICAgfVxuICAgIGlmICh0aGlzWzBdKSAkLmVhY2godGhpc1swXS5lbGVtZW50cywgZnVuY3Rpb24oXywgZmllbGQpe1xuICAgICAgdHlwZSA9IGZpZWxkLnR5cGUsIG5hbWUgPSBmaWVsZC5uYW1lXG4gICAgICBpZiAobmFtZSAmJiBmaWVsZC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpICE9ICdmaWVsZHNldCcgJiZcbiAgICAgICAgIWZpZWxkLmRpc2FibGVkICYmIHR5cGUgIT0gJ3N1Ym1pdCcgJiYgdHlwZSAhPSAncmVzZXQnICYmIHR5cGUgIT0gJ2J1dHRvbicgJiYgdHlwZSAhPSAnZmlsZScgJiZcbiAgICAgICAgKCh0eXBlICE9ICdyYWRpbycgJiYgdHlwZSAhPSAnY2hlY2tib3gnKSB8fCBmaWVsZC5jaGVja2VkKSlcbiAgICAgICAgICBhZGQoJChmaWVsZCkudmFsKCkpXG4gICAgfSlcbiAgICByZXR1cm4gcmVzdWx0XG4gIH1cblxuICAkLmZuLnNlcmlhbGl6ZSA9IGZ1bmN0aW9uKCl7XG4gICAgdmFyIHJlc3VsdCA9IFtdXG4gICAgdGhpcy5zZXJpYWxpemVBcnJheSgpLmZvckVhY2goZnVuY3Rpb24oZWxtKXtcbiAgICAgIHJlc3VsdC5wdXNoKGVuY29kZVVSSUNvbXBvbmVudChlbG0ubmFtZSkgKyAnPScgKyBlbmNvZGVVUklDb21wb25lbnQoZWxtLnZhbHVlKSlcbiAgICB9KVxuICAgIHJldHVybiByZXN1bHQuam9pbignJicpXG4gIH1cblxuICAkLmZuLnN1Ym1pdCA9IGZ1bmN0aW9uKGNhbGxiYWNrKSB7XG4gICAgaWYgKDAgaW4gYXJndW1lbnRzKSB0aGlzLmJpbmQoJ3N1Ym1pdCcsIGNhbGxiYWNrKVxuICAgIGVsc2UgaWYgKHRoaXMubGVuZ3RoKSB7XG4gICAgICB2YXIgZXZlbnQgPSAkLkV2ZW50KCdzdWJtaXQnKVxuICAgICAgdGhpcy5lcSgwKS50cmlnZ2VyKGV2ZW50KVxuICAgICAgaWYgKCFldmVudC5pc0RlZmF1bHRQcmV2ZW50ZWQoKSkgdGhpcy5nZXQoMCkuc3VibWl0KClcbiAgICB9XG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG59KShaZXB0bylcblxuOyhmdW5jdGlvbigkKXtcbiAgLy8gX19wcm90b19fIGRvZXNuJ3QgZXhpc3Qgb24gSUU8MTEsIHNvIHJlZGVmaW5lXG4gIC8vIHRoZSBaIGZ1bmN0aW9uIHRvIHVzZSBvYmplY3QgZXh0ZW5zaW9uIGluc3RlYWRcbiAgaWYgKCEoJ19fcHJvdG9fXycgaW4ge30pKSB7XG4gICAgJC5leHRlbmQoJC56ZXB0bywge1xuICAgICAgWjogZnVuY3Rpb24oZG9tLCBzZWxlY3Rvcil7XG4gICAgICAgIGRvbSA9IGRvbSB8fCBbXVxuICAgICAgICAkLmV4dGVuZChkb20sICQuZm4pXG4gICAgICAgIGRvbS5zZWxlY3RvciA9IHNlbGVjdG9yIHx8ICcnXG4gICAgICAgIGRvbS5fX1ogPSB0cnVlXG4gICAgICAgIHJldHVybiBkb21cbiAgICAgIH0sXG4gICAgICAvLyB0aGlzIGlzIGEga2x1ZGdlIGJ1dCB3b3Jrc1xuICAgICAgaXNaOiBmdW5jdGlvbihvYmplY3Qpe1xuICAgICAgICByZXR1cm4gJC50eXBlKG9iamVjdCkgPT09ICdhcnJheScgJiYgJ19fWicgaW4gb2JqZWN0XG4gICAgICB9XG4gICAgfSlcbiAgfVxuXG4gIC8vIGdldENvbXB1dGVkU3R5bGUgc2hvdWxkbid0IGZyZWFrIG91dCB3aGVuIGNhbGxlZFxuICAvLyB3aXRob3V0IGEgdmFsaWQgZWxlbWVudCBhcyBhcmd1bWVudFxuICB0cnkge1xuICAgIGdldENvbXB1dGVkU3R5bGUodW5kZWZpbmVkKVxuICB9IGNhdGNoKGUpIHtcbiAgICB2YXIgbmF0aXZlR2V0Q29tcHV0ZWRTdHlsZSA9IGdldENvbXB1dGVkU3R5bGU7XG4gICAgd2luZG93LmdldENvbXB1dGVkU3R5bGUgPSBmdW5jdGlvbihlbGVtZW50KXtcbiAgICAgIHRyeSB7XG4gICAgICAgIHJldHVybiBuYXRpdmVHZXRDb21wdXRlZFN0eWxlKGVsZW1lbnQpXG4gICAgICB9IGNhdGNoKGUpIHtcbiAgICAgICAgcmV0dXJuIG51bGxcbiAgICAgIH1cbiAgICB9XG4gIH1cbn0pKFplcHRvKVxuOyJdfQ==
